{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-12T06:24:31.887388Z", "invocation_id": "5bc188b1-e30b-470c-9905-f7e712bfd576", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.710140Z", "completed_at": "2025-05-12T06:24:31.727685Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.728003Z", "completed_at": "2025-05-12T06:24:31.728012Z"}], "thread_id": "Thread-1", "execution_time": 0.020885944366455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_test.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt_db_ex2\".\"public\".\"customers\"\n),\n\nstaged as (\n    select\n        customer_id,\n        name,\n        trim(lower(email)) as email, -- Normalize email\n        created_at\n    from source\n)\n\nselect * from staged", "relation_name": "\"dbt_db_ex2\".\"public\".\"stg_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.718143Z", "completed_at": "2025-05-12T06:24:31.728535Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.728786Z", "completed_at": "2025-05-12T06:24:31.728790Z"}], "thread_id": "Thread-2", "execution_time": 0.020773887634277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_test.stg_order_items", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt_db_ex2\".\"public\".\"order_items\"\n),\n\nstaged as (\n    select\n        order_item_id,\n        order_id,\n        product_id,\n        greatest(quantity, 1) as quantity, -- Ensure minimum quantity is 1\n        coalesce(unit_price, 0) as unit_price, -- Ensure no NULL prices\n        created_at\n    from source\n)\n\nselect * from staged", "relation_name": "\"dbt_db_ex2\".\"public\".\"stg_order_items\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.721131Z", "completed_at": "2025-05-12T06:24:31.729257Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.729730Z", "completed_at": "2025-05-12T06:24:31.729734Z"}], "thread_id": "Thread-3", "execution_time": 0.021319866180419922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_test.stg_orders", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt_db_ex2\".\"public\".\"orders\"\n),\n\nstaged as (\n    select\n        order_id,\n        customer_id,\n        order_date,\n        status,\n        created_at,\n        -- Add tracking for data lineage\n        '5bc188b1-e30b-470c-9905-f7e712bfd576' as _invocation_id\n    from source\n)\n\nselect * from staged", "relation_name": "\"dbt_db_ex2\".\"public\".\"stg_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.724163Z", "completed_at": "2025-05-12T06:24:31.729495Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.730144Z", "completed_at": "2025-05-12T06:24:31.730149Z"}], "thread_id": "Thread-4", "execution_time": 0.021039962768554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_test.stg_products", "compiled": true, "compiled_code": "with source as (\n    select * from \"dbt_db_ex2\".\"public\".\"products\"\n),\n\nstaged as (\n    select\n        product_id,\n        name,\n        coalesce(price, 0) as price, -- Ensure no NULL values\n        category,\n        created_at\n    from source\n)\n\nselect * from staged", "relation_name": "\"dbt_db_ex2\".\"public\".\"stg_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.736841Z", "completed_at": "2025-05-12T06:24:31.745980Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.746491Z", "completed_at": "2025-05-12T06:24:31.746498Z"}], "thread_id": "Thread-2", "execution_time": 0.014618158340454102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_test.fct_orders", "compiled": true, "compiled_code": "\n\nwith orders as (\n    select * from \"dbt_db_ex2\".\"public\".\"stg_orders\"\n),\n\norder_items as (\n    select * from \"dbt_db_ex2\".\"public\".\"stg_order_items\"\n),\n\norder_totals as (\n    select\n        order_id,\n        sum(quantity) as total_items,\n        sum(quantity * unit_price) as total_amount\n    from order_items\n    group by 1\n),\n\nfinal as (\n    select\n        o.order_id,\n        o.customer_id,\n        o.order_date,\n        o.status,\n        coalesce(ot.total_items, 0) as total_items,\n        coalesce(ot.total_amount, 0) as total_amount,\n        o.created_at,\n        current_timestamp as updated_at,\n        o._invocation_id\n    from orders o\n    left join order_totals ot on o.order_id = ot.order_id\n)\n\nselect * from final", "relation_name": "\"dbt_db_ex2\".\"public\".\"fct_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.742734Z", "completed_at": "2025-05-12T06:24:31.746251Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.746952Z", "completed_at": "2025-05-12T06:24:31.746957Z"}], "thread_id": "Thread-4", "execution_time": 0.01429128646850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_test.dim_products", "compiled": true, "compiled_code": "\n\nwith products as (\n    select * from \"dbt_db_ex2\".\"public\".\"stg_products\"\n),\n\nproduct_sales as (\n    select\n        product_id,\n        sum(quantity) as total_quantity_sold,\n        sum(quantity * unit_price) as total_revenue\n    from \"dbt_db_ex2\".\"public\".\"stg_order_items\"\n    group by 1\n),\n\nfinal as (\n    select\n        p.product_id,\n        p.name,\n        p.price,\n        p.category,\n        p.created_at,\n        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,\n        coalesce(ps.total_revenue, 0) as total_revenue,\n        current_timestamp as updated_at\n    from products p\n    left join product_sales ps on p.product_id = ps.product_id\n)\n\nselect * from final", "relation_name": "\"dbt_db_ex2\".\"public\".\"dim_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.733447Z", "completed_at": "2025-05-12T06:24:31.747335Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.747990Z", "completed_at": "2025-05-12T06:24:31.747995Z"}], "thread_id": "Thread-1", "execution_time": 0.01658797264099121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_test.dim_customers", "compiled": true, "compiled_code": "\n\nwith customers as (\n    select * from \"dbt_db_ex2\".\"public\".\"stg_customers\"\n),\n\ncustomer_orders as (\n    select\n        customer_id,\n        count(*) as lifetime_orders,\n        min(order_date) as first_order_date,\n        max(order_date) as most_recent_order_date\n    from \"dbt_db_ex2\".\"public\".\"stg_orders\"\n    group by 1\n),\n\nfinal as (\n    select\n        c.customer_id,\n        c.name,\n        c.email,\n        c.created_at,\n        coalesce(co.lifetime_orders, 0) as lifetime_orders,\n        co.first_order_date,\n        co.most_recent_order_date,\n        current_timestamp as updated_at\n    from customers c\n    left join customer_orders co on c.customer_id = co.customer_id\n)\n\nselect * from final", "relation_name": "\"dbt_db_ex2\".\"public\".\"dim_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.739745Z", "completed_at": "2025-05-12T06:24:31.747596Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.748554Z", "completed_at": "2025-05-12T06:24:31.748558Z"}], "thread_id": "Thread-3", "execution_time": 0.016392946243286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.assert_no_duplicate_orders", "compiled": true, "compiled_code": "/*\n  Custom test to ensure there are no duplicate orders in the core table.\n  This test checks for duplicates based on customer_id and order_date within 15 minutes\n*/\n\nwith orders as (\n    select \n        customer_id,\n        order_date,\n        count(*) as order_count\n    from \"dbt_db_ex2\".\"public\".\"stg_orders\"\n    group by 1, 2\n),\n\npotential_duplicates as (\n    select\n        o1.customer_id,\n        o1.order_date as order_date_1,\n        o2.order_date as order_date_2,\n        abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) as minutes_difference\n    from \"dbt_db_ex2\".\"public\".\"stg_orders\" o1\n    join \"dbt_db_ex2\".\"public\".\"stg_orders\" o2\n        on o1.customer_id = o2.customer_id\n        and o1.order_id <> o2.order_id\n        and abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) < 15  -- Orders less than 15 minutes apart\n)\n\nselect * from potential_duplicates", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"assert_no_duplicate_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.768392Z", "completed_at": "2025-05-12T06:24:31.774403Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.774667Z", "completed_at": "2025-05-12T06:24:31.774675Z"}], "thread_id": "Thread-3", "execution_time": 0.02399921417236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"dim_products\"\nwhere name is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_dim_products_name\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.751851Z", "completed_at": "2025-05-12T06:24:31.779456Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.780000Z", "completed_at": "2025-05-12T06:24:31.780005Z"}], "thread_id": "Thread-2", "execution_time": 0.030066967010498047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"dbt_db_ex2\".\"public\".\"dim_products\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Electronics','Clothing','Footwear','Accessories'\n)\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.761493Z", "completed_at": "2025-05-12T06:24:31.779728Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.780695Z", "completed_at": "2025-05-12T06:24:31.780699Z"}], "thread_id": "Thread-4", "execution_time": 0.030491113662719727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"dbt_db_ex2\".\"public\".\"fct_orders\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'completed','processing','cancelled','refunded'\n)\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.765853Z", "completed_at": "2025-05-12T06:24:31.780427Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.781575Z", "completed_at": "2025-05-12T06:24:31.781578Z"}], "thread_id": "Thread-1", "execution_time": 0.031118154525756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items", "compiled": true, "compiled_code": "/*\n  Custom test to check if the total amount in orders table\n  matches the sum of the item amounts in order_items.\n  \n  If there are differences, this test will return the records with discrepancies.\n*/\n\nwith orders as (\n    select \n        order_id,\n        total_amount as order_total\n    from \"dbt_db_ex2\".\"public\".\"fct_orders\"\n),\n\norder_items_grouped as (\n    select\n        order_id,\n        sum(quantity * unit_price) as items_total\n    from \"dbt_db_ex2\".\"public\".\"stg_order_items\"\n    group by 1\n),\n\njoined as (\n    select\n        o.order_id,\n        o.order_total,\n        coalesce(oi.items_total, 0) as items_total,\n        abs(o.order_total - coalesce(oi.items_total, 0)) as difference\n    from orders o\n    left join order_items_grouped oi on o.order_id = oi.order_id\n)\n\nselect * from joined where difference > 0.01  -- Allow small rounding differences", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"assert_total_amount_equals_sum_of_items\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.775785Z", "completed_at": "2025-05-12T06:24:31.781324Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.782463Z", "completed_at": "2025-05-12T06:24:31.782466Z"}], "thread_id": "Thread-3", "execution_time": 0.0071868896484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"dim_products\"\nwhere price is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_dim_products_price\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.784255Z", "completed_at": "2025-05-12T06:24:31.798240Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.798816Z", "completed_at": "2025-05-12T06:24:31.798823Z"}], "thread_id": "Thread-2", "execution_time": 0.016688108444213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"dim_products\"\nwhere product_id is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_dim_products_product_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.788146Z", "completed_at": "2025-05-12T06:24:31.798557Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.799267Z", "completed_at": "2025-05-12T06:24:31.799271Z"}], "thread_id": "Thread-4", "execution_time": 0.016253948211669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"dim_products\"\nwhere total_quantity_sold is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_dim_products_total_quantity_sold\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.791538Z", "completed_at": "2025-05-12T06:24:31.799675Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.800757Z", "completed_at": "2025-05-12T06:24:31.800761Z"}], "thread_id": "Thread-1", "execution_time": 0.01702594757080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"dim_products\"\nwhere total_revenue is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_dim_products_total_revenue\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.794718Z", "completed_at": "2025-05-12T06:24:31.800175Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.801410Z", "completed_at": "2025-05-12T06:24:31.801413Z"}], "thread_id": "Thread-3", "execution_time": 0.013830900192260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"fct_orders\"\nwhere customer_id is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_fct_orders_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.806611Z", "completed_at": "2025-05-12T06:24:31.817091Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.817911Z", "completed_at": "2025-05-12T06:24:31.817917Z"}], "thread_id": "Thread-4", "execution_time": 0.016216039657592773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"fct_orders\"\nwhere order_id is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_fct_orders_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.803214Z", "completed_at": "2025-05-12T06:24:31.817312Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.818536Z", "completed_at": "2025-05-12T06:24:31.818540Z"}], "thread_id": "Thread-2", "execution_time": 0.017440080642700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"fct_orders\"\nwhere order_date is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_fct_orders_order_date\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.813383Z", "completed_at": "2025-05-12T06:24:31.817694Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.818891Z", "completed_at": "2025-05-12T06:24:31.818894Z"}], "thread_id": "Thread-3", "execution_time": 0.01262211799621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"fct_orders\"\nwhere total_amount is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_fct_orders_total_amount\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.810378Z", "completed_at": "2025-05-12T06:24:31.818319Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.819461Z", "completed_at": "2025-05-12T06:24:31.819465Z"}], "thread_id": "Thread-1", "execution_time": 0.016618967056274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"fct_orders\"\nwhere status is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_fct_orders_status\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.825652Z", "completed_at": "2025-05-12T06:24:31.844944Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.845197Z", "completed_at": "2025-05-12T06:24:31.845205Z"}], "thread_id": "Thread-2", "execution_time": 0.024371862411499023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt_db_ex2\".\"public\".\"dim_products\"\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"unique_dim_products_product_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.822312Z", "completed_at": "2025-05-12T06:24:31.849484Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.849993Z", "completed_at": "2025-05-12T06:24:31.849998Z"}], "thread_id": "Thread-4", "execution_time": 0.029660701751708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"fct_orders\"\nwhere total_items is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_fct_orders_total_items\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.830138Z", "completed_at": "2025-05-12T06:24:31.849722Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.850893Z", "completed_at": "2025-05-12T06:24:31.850896Z"}], "thread_id": "Thread-3", "execution_time": 0.02983570098876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt_db_ex2\".\"public\".\"fct_orders\"\nwhere order_id is not null\ngroup by order_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"unique_fct_orders_order_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.833190Z", "completed_at": "2025-05-12T06:24:31.850423Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.851593Z", "completed_at": "2025-05-12T06:24:31.851597Z"}], "thread_id": "Thread-1", "execution_time": 0.03001117706298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \n\ncoalesce(array_length((select regexp_matches(email, '^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$', '')), 1), 0)\n\n\n > 0\n as expression\n\n\n    from \"dbt_db_ex2\".\"public\".\"dim_customers\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.846298Z", "completed_at": "2025-05-12T06:24:31.850647Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.852011Z", "completed_at": "2025-05-12T06:24:31.852015Z"}], "thread_id": "Thread-2", "execution_time": 0.006289958953857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"dim_customers\"\nwhere customer_id is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_dim_customers_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.854941Z", "completed_at": "2025-05-12T06:24:31.873225Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.873594Z", "completed_at": "2025-05-12T06:24:31.873604Z"}], "thread_id": "Thread-4", "execution_time": 0.020869970321655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"dim_customers\"\nwhere email is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_dim_customers_email\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.859049Z", "completed_at": "2025-05-12T06:24:31.878649Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.879032Z", "completed_at": "2025-05-12T06:24:31.879041Z"}], "thread_id": "Thread-3", "execution_time": 0.025496244430541992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"dim_customers\"\nwhere lifetime_orders is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_dim_customers_lifetime_orders\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.862557Z", "completed_at": "2025-05-12T06:24:31.879496Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.880406Z", "completed_at": "2025-05-12T06:24:31.880410Z"}], "thread_id": "Thread-1", "execution_time": 0.02629685401916504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect *\nfrom \"dbt_db_ex2\".\"public\".\"dim_customers\"\nwhere name is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"not_null_dim_customers_name\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.866793Z", "completed_at": "2025-05-12T06:24:31.879715Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.880787Z", "completed_at": "2025-05-12T06:24:31.880791Z"}], "thread_id": "Thread-2", "execution_time": 0.02640700340270996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"dbt_db_ex2\".\"public\".\"fct_orders\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"dbt_db_ex2\".\"public\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.874823Z", "completed_at": "2025-05-12T06:24:31.880158Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.881444Z", "completed_at": "2025-05-12T06:24:31.881448Z"}], "thread_id": "Thread-4", "execution_time": 0.00718379020690918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"dbt_db_ex2\".\"public\".\"dim_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"unique_dim_customers_customer_id\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-12T06:24:31.882219Z", "completed_at": "2025-05-12T06:24:31.885571Z"}, {"name": "execute", "started_at": "2025-05-12T06:24:31.885803Z", "completed_at": "2025-05-12T06:24:31.885808Z"}], "thread_id": "Thread-3", "execution_time": 0.004697084426879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    email as unique_field,\n    count(*) as n_records\n\nfrom \"dbt_db_ex2\".\"public\".\"dim_customers\"\nwhere email is not null\ngroup by email\nhaving count(*) > 1\n\n\n", "relation_name": "\"dbt_db_ex2\".\"public_dbt_test__audit\".\"unique_dim_customers_email\"", "batch_results": null}], "elapsed_time": 0.317410945892334, "args": {"populate_cache": true, "invocation_command": "dbt docs generate", "vars": {}, "indirect_selection": "eager", "introspect": true, "print": true, "partial_parse_file_diff": true, "log_file_max_bytes": 10485760, "printer_width": 80, "require_resource_names_without_spaces": false, "log_level": "info", "log_path": "/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs", "strict_mode": false, "project_dir": "/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt", "select": [], "send_anonymous_usage_stats": true, "quiet": false, "warn_error_options": {"include": [], "exclude": []}, "empty_catalog": false, "macro_debugging": false, "cache_selected_only": false, "partial_parse": true, "static": false, "which": "generate", "require_explicit_package_overrides_for_builtin_materializations": true, "write_json": true, "show_resource_report": false, "compile": true, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "favor_state": false, "exclude": [], "require_batched_execution_for_custom_microbatch_strategy": false, "log_level_file": "debug", "source_freshness_run_project_hooks": false, "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_vars": false, "static_parser": true, "profiles_dir": "/Users/user/.dbt", "require_nested_cumulative_type_params": false, "use_colors_file": true, "state_modified_compare_more_unrendered_values": false, "use_colors": true, "log_format_file": "debug", "log_format": "default"}}