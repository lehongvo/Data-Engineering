[0m12:35:52.903102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d02730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c7ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c7af70>]}


============================== 12:35:52.906705 | a8724595-bff4-416b-ac7e-923767ff9824 ==============================
[0m12:35:52.906705 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:35:52.907114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --store-failures', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:35:53.057962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8724595-bff4-416b-ac7e-923767ff9824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f7b6d0>]}
[0m12:35:53.106002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8724595-bff4-416b-ac7e-923767ff9824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c41220>]}
[0m12:35:53.106869 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:35:53.197850 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:35:53.284207 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:35:53.284567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a8724595-bff4-416b-ac7e-923767ff9824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105845730>]}
[0m12:35:54.913097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:35:54.923777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8724595-bff4-416b-ac7e-923767ff9824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ac4c0>]}
[0m12:35:55.019138 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:35:55.022163 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:35:55.045062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8724595-bff4-416b-ac7e-923767ff9824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108774640>]}
[0m12:35:55.045453 [info ] [MainThread]: Found 7 models, 66 data tests, 4 sources, 810 macros
[0m12:35:55.045677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8724595-bff4-416b-ac7e-923767ff9824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109158df0>]}
[0m12:35:55.048672 [info ] [MainThread]: 
[0m12:35:55.048913 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:35:55.049108 [info ] [MainThread]: 
[0m12:35:55.049428 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:35:55.055836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m12:35:55.091591 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m12:35:55.091980 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m12:35:55.092201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:55.124974 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m12:35:55.125929 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m12:35:55.130508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public_dbt_test__audit)
[0m12:35:55.130877 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:35:55.135868 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:35:55.138068 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:35:55.138302 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:35:55.138501 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:35:55.138693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:55.138884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:55.149462 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:35:55.149820 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:35:55.150043 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:35:55.150259 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:35:55.150495 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:35:55.150746 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:35:55.154961 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m12:35:55.155273 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.004 seconds
[0m12:35:55.156293 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:35:55.157750 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:35:55.158479 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:35:55.158860 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:35:55.171017 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:55.171299 [debug] [MainThread]: On master: BEGIN
[0m12:35:55.171509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:35:55.179126 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:35:55.179442 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:55.179756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:35:55.222539 [debug] [MainThread]: SQL status: SELECT 4 in 0.042 seconds
[0m12:35:55.224215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8724595-bff4-416b-ac7e-923767ff9824', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082102b0>]}
[0m12:35:55.224595 [debug] [MainThread]: On master: ROLLBACK
[0m12:35:55.225366 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:55.225743 [debug] [MainThread]: On master: BEGIN
[0m12:35:55.226575 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.226856 [debug] [MainThread]: On master: COMMIT
[0m12:35:55.227095 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:55.227314 [debug] [MainThread]: On master: COMMIT
[0m12:35:55.227778 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:35:55.228021 [debug] [MainThread]: On master: Close
[0m12:35:55.231947 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:35:55.232291 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:35:55.232607 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:35:55.232882 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:35:55.233170 [info ] [Thread-1  ]: 1 of 66 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m12:35:55.233509 [info ] [Thread-2  ]: 2 of 66 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m12:35:55.233834 [info ] [Thread-3  ]: 3 of 66 START test assert_no_duplicate_orders .................................. [RUN]
[0m12:35:55.234147 [info ] [Thread-4  ]: 4 of 66 START test assert_total_amount_equals_sum_of_items ..................... [RUN]
[0m12:35:55.234517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:35:55.234813 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:35:55.235152 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_no_duplicate_orders'
[0m12:35:55.235487 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_total_amount_equals_sum_of_items'
[0m12:35:55.235762 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:35:55.236016 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:35:55.236250 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:35:55.236480 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:35:55.244741 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:35:55.248398 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:35:55.251299 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:35:55.254455 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:35:55.255724 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:35:55.256066 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:35:55.256325 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:35:55.262903 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:35:55.274777 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:35:55.279546 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:35:55.284877 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:35:55.289352 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:35:55.292697 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:35:55.293171 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:35:55.293528 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:35:55.293862 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:35:55.294100 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m12:35:55.294333 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items" cascade
[0m12:35:55.294584 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m12:35:55.294812 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders" cascade
[0m12:35:55.295049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:55.295265 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:35:55.295494 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:55.295719 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:35:55.311044 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:35:55.311405 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:35:55.311656 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:35:55.313559 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:35:55.313837 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.018 seconds
[0m12:35:55.314577 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:35:55.315181 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:35:55.324213 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:35:55.324974 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:35:55.325464 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:35:55.325899 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:35:55.326199 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:35:55.326654 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:35:55.326892 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:35:55.327117 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:35:55.327407 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:35:55.327856 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:55.328140 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:55.328373 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.328600 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:35:55.328816 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.329033 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:35:55.329248 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:35:55.329489 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m12:35:55.329727 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:35:55.329972 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  
  
    as
  
  (
    /*
  Custom test to ensure there are no duplicate orders in the core table.
  This test checks for duplicates based on customer_id and order_date within 15 minutes
*/

with orders as (
    select 
        customer_id,
        order_date,
        count(*) as order_count
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1, 2
),

potential_duplicates as (
    select
        o1.customer_id,
        o1.order_date as order_date_1,
        o2.order_date as order_date_2,
        abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) as minutes_difference
    from "dbt_db_ex2"."public"."stg_orders" o1
    join "dbt_db_ex2"."public"."stg_orders" o2
        on o1.customer_id = o2.customer_id
        and o1.order_id <> o2.order_id
        and abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) < 15  -- Orders less than 15 minutes apart
)

select * from potential_duplicates
  );
  
    
[0m12:35:55.330255 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
  
  
    as
  
  (
    /*
  Custom test to check if the total amount in orders table
  matches the sum of the item amounts in order_items.
  
  If there are differences, this test will return the records with discrepancies.
*/

with orders as (
    select 
        order_id,
        total_amount as order_total
    from "dbt_db_ex2"."public"."fct_orders"
),

order_items_grouped as (
    select
        order_id,
        sum(quantity * unit_price) as items_total
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

joined as (
    select
        o.order_id,
        o.order_total,
        coalesce(oi.items_total, 0) as items_total,
        abs(o.order_total - coalesce(oi.items_total, 0)) as difference
    from orders o
    left join order_items_grouped oi on o.order_id = oi.order_id
)

select * from joined where difference > 0.01  -- Allow small rounding differences
  );
  
    
[0m12:35:55.330558 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m12:35:55.335987 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:55.336332 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:55.337016 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:35:55.337617 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:35:55.337909 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:35:55.338193 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:35:55.338472 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:35:55.338728 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.008 seconds
[0m12:35:55.338963 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:55.339197 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:35:55.339944 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:35:55.340573 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:35:55.340877 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:35:55.341130 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:55.341361 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:35:55.341609 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:55.341835 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:35:55.344370 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:35:55.344717 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:35:55.345164 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:35:55.346250 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:35:55.346566 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:35:55.346869 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:35:55.347168 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:35:55.347432 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.347740 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:35:55.348000 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:55.348259 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m12:35:55.348539 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:35:55.348765 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m12:35:55.349070 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m12:35:55.349329 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m12:35:55.349728 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:35:55.349974 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.350477 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:35:55.350721 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.353535 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m12:35:55.354500 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m12:35:55.354816 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:35:55.355083 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m12:35:55.355347 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:35:55.355569 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m12:35:55.355793 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:35:55.356047 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:35:55.356422 [info ] [Thread-1  ]: 1 of 66 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.12s]
[0m12:35:55.356859 [info ] [Thread-2  ]: 2 of 66 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.12s]
[0m12:35:55.357424 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:35:55.358917 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:35:55.359521 [debug] [Thread-1  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57
[0m12:35:55.359851 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m12:35:55.360143 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m12:35:55.360431 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8
[0m12:35:55.360718 [info ] [Thread-1  ]: 5 of 66 START test assert_total_amount_equals_sum_of_items_fct_orders_ ......... [RUN]
[0m12:35:55.360998 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:35:55.361254 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:35:55.361556 [info ] [Thread-2  ]: 6 of 66 START test dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d  [RUN]
[0m12:35:55.361998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57)
[0m12:35:55.362278 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
    
      
    ) dbt_internal_test
[0m12:35:55.362552 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
    
      
    ) dbt_internal_test
[0m12:35:55.362836 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8)
[0m12:35:55.363112 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57
[0m12:35:55.363431 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8
[0m12:35:55.367089 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:35:55.370970 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.008 seconds
[0m12:35:55.372614 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: ROLLBACK
[0m12:35:55.373939 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: ROLLBACK
[0m12:35:55.377927 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: Close
[0m12:35:55.378552 [error] [Thread-3  ]: 3 of 66 FAIL 2 assert_no_duplicate_orders ...................................... [[31mFAIL 2[0m in 0.14s]
[0m12:35:55.380518 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:35:55.382028 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: Close
[0m12:35:55.382307 [debug] [Thread-3  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4
[0m12:35:55.382668 [info ] [Thread-3  ]: 7 of 66 START test dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True  [RUN]
[0m12:35:55.387209 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4)
[0m12:35:55.383019 [info ] [Thread-4  ]: 4 of 66 PASS assert_total_amount_equals_sum_of_items ........................... [[32mPASS[0m in 0.15s]
[0m12:35:55.387617 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4
[0m12:35:55.388020 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:35:55.395519 [debug] [Thread-4  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586
[0m12:35:55.395851 [info ] [Thread-4  ]: 8 of 66 START test dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp  [RUN]
[0m12:35:55.397156 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586)
[0m12:35:55.401023 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586
[0m12:35:55.458867 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:35:55.459323 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: BEGIN
[0m12:35:55.459558 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:55.465738 [debug] [Thread-2  ]: Compilation Error in test dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d (models/sources/source.yml)
  'dict object' has no attribute 'test_is_date'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:55.467908 [debug] [Thread-3  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True (models/core/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than_or_equal_to'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:55.466184 [error] [Thread-2  ]: 6 of 66 ERROR dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d .. [[31mERROR[0m in 0.10s]
[0m12:35:55.468623 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8
[0m12:35:55.468225 [error] [Thread-3  ]: 7 of 66 ERROR dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True  [[31mERROR[0m in 0.08s]
[0m12:35:55.468993 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044
[0m12:35:55.469269 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d (models/sources/source.yml)
  'dict object' has no attribute 'test_is_date'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:55.469634 [debug] [Thread-1  ]: Compilation Error in test assert_total_amount_equals_sum_of_items_fct_orders_ (models/core/schema.yml)
  'test_assert_total_amount_equals_sum_of_items' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:55.469933 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4
[0m12:35:55.470262 [info ] [Thread-2  ]: 9 of 66 START test dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp  [RUN]
[0m12:35:55.470678 [error] [Thread-1  ]: 5 of 66 ERROR assert_total_amount_equals_sum_of_items_fct_orders_ .............. [[31mERROR[0m in 0.11s]
[0m12:35:55.470989 [debug] [Thread-3  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:35:55.471273 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True (models/core/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than_or_equal_to'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:55.471600 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8, now test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044)
[0m12:35:55.471931 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57
[0m12:35:55.472191 [info ] [Thread-3  ]: 10 of 66 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m12:35:55.472693 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044
[0m12:35:55.472982 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07
[0m12:35:55.473272 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57' to be skipped because of status 'error'.  Reason: Compilation Error in test assert_total_amount_equals_sum_of_items_fct_orders_ (models/core/schema.yml)
  'test_assert_total_amount_equals_sum_of_items' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:55.473548 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:35:55.479781 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:35:55.480286 [info ] [Thread-1  ]: 11 of 66 START test dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_  [RUN]
[0m12:35:55.480825 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:35:55.481135 [debug] [Thread-4  ]: SQL status: BEGIN in 0.022 seconds
[0m12:35:55.481389 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: BEGIN
[0m12:35:55.481705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57, now test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07)
[0m12:35:55.485698 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:35:55.486040 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:35:55.486279 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:55.486512 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07
[0m12:35:55.486832 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex2".INFORMATION_SCHEMA.columns
      where table_name = 'dim_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:35:55.491823 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"
[0m12:35:55.492283 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:35:55.495596 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m12:35:55.496240 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:35:55.496521 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:35:55.496772 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:55.497061 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07
[0m12:35:55.500699 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_source_expect_45f2583dc51a45385b6a8d6f71b77768"
[0m12:35:55.501869 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"
[0m12:35:55.502290 [debug] [Thread-2  ]: SQL status: BEGIN in 0.016 seconds
[0m12:35:55.502572 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07: BEGIN
[0m12:35:55.502841 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:35:55.503103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:55.503374 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex2".INFORMATION_SCHEMA.columns
      where table_name = 'dim_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:35:55.505918 [debug] [Thread-4  ]: SQL status: SELECT 8 in 0.014 seconds
[0m12:35:55.514044 [debug] [Thread-2  ]: SQL status: SELECT 8 in 0.010 seconds
[0m12:35:55.515066 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:35:55.517434 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:35:55.517760 [debug] [Thread-3  ]: SQL status: BEGIN in 0.021 seconds
[0m12:35:55.518784 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m12:35:55.519226 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:35:55.519567 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"
[0m12:35:55.519904 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
  
  
    as
  
  (
    




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(email, '^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$', '')), 1), 0)


 > 0
 as expression


    from "dbt_db_ex2"."public"."dim_customers"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  );
  
    
[0m12:35:55.520195 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586
[0m12:35:55.520419 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044
[0m12:35:55.520684 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_source_expect_45f2583dc51a45385b6a8d6f71b77768"
  
  
    as
  
  (
    




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(email, '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$', '')), 1), 0)


 > 0
 as expression


    from "dbt_db_ex2"."public"."customers"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  );
  
    
[0m12:35:55.526039 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_e42e386f1f5fcb00fca61dbc25a22a13"
[0m12:35:55.527337 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:35:55.532369 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_0d21460a155f0cff109b3eca59430181"
[0m12:35:55.534066 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:35:55.535488 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:35:55.536750 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:35:55.537517 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_e42e386f1f5fcb00fca61dbc25a22a13"
  
  
    as
  
  (
    with relation_columns as (

        
        select
            cast('CUSTOMER_ID' as TEXT) as relation_column,
            cast('INTEGER' as TEXT) as relation_column_type
        union all
        
        select
            cast('NAME' as TEXT) as relation_column,
            cast('CHARACTER VARYING' as TEXT) as relation_column_type
        union all
        
        select
            cast('EMAIL' as TEXT) as relation_column,
            cast('TEXT' as TEXT) as relation_column_type
        union all
        
        select
            cast('CREATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP WITHOUT TIME ZONE' as TEXT) as relation_column_type
        union all
        
        select
            cast('LIFETIME_ORDERS' as TEXT) as relation_column,
            cast('BIGINT' as TEXT) as relation_column_type
        union all
        
        select
            cast('FIRST_ORDER_DATE' as TEXT) as relation_column,
            cast('TIMESTAMP WITHOUT TIME ZONE' as TEXT) as relation_column_type
        union all
        
        select
            cast('MOST_RECENT_ORDER_DATE' as TEXT) as relation_column,
            cast('TIMESTAMP WITHOUT TIME ZONE' as TEXT) as relation_column_type
        union all
        
        select
            cast('UPDATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP WITH TIME ZONE' as TEXT) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'FIRST_ORDER_DATE'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
  );
  
    
[0m12:35:55.537932 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:55.538385 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:35:55.538759 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_0d21460a155f0cff109b3eca59430181"
  
  
    as
  
  (
    with relation_columns as (

        
        select
            cast('CUSTOMER_ID' as TEXT) as relation_column,
            cast('INTEGER' as TEXT) as relation_column_type
        union all
        
        select
            cast('NAME' as TEXT) as relation_column,
            cast('CHARACTER VARYING' as TEXT) as relation_column_type
        union all
        
        select
            cast('EMAIL' as TEXT) as relation_column,
            cast('TEXT' as TEXT) as relation_column_type
        union all
        
        select
            cast('CREATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP WITHOUT TIME ZONE' as TEXT) as relation_column_type
        union all
        
        select
            cast('LIFETIME_ORDERS' as TEXT) as relation_column,
            cast('BIGINT' as TEXT) as relation_column_type
        union all
        
        select
            cast('FIRST_ORDER_DATE' as TEXT) as relation_column,
            cast('TIMESTAMP WITHOUT TIME ZONE' as TEXT) as relation_column_type
        union all
        
        select
            cast('MOST_RECENT_ORDER_DATE' as TEXT) as relation_column,
            cast('TIMESTAMP WITHOUT TIME ZONE' as TEXT) as relation_column_type
        union all
        
        select
            cast('UPDATED_AT' as TEXT) as relation_column,
            cast('TIMESTAMP WITH TIME ZONE' as TEXT) as relation_column_type
        
        
    ),
    test_data as (

        select
            *
        from
            relation_columns
        where
            relation_column = 'MOST_RECENT_ORDER_DATE'
            and
            relation_column_type not in ('TIMESTAMP')

    )
    select *
    from test_data
  );
  
    
[0m12:35:55.539607 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07: COMMIT
[0m12:35:55.540063 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:35:55.540618 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"
[0m12:35:55.541809 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07: COMMIT
[0m12:35:55.542883 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:55.543786 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:35:55.544247 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:55.544669 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"
[0m12:35:55.545222 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:35:55.546203 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:35:55.547692 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"
[0m12:35:55.548926 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07: BEGIN
[0m12:35:55.549213 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:55.549458 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.010 seconds
[0m12:35:55.549798 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.009 seconds
[0m12:35:55.550082 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:35:55.550873 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: COMMIT
[0m12:35:55.551154 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.551730 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: COMMIT
[0m12:35:55.551998 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
    
      
    ) dbt_internal_test
[0m12:35:55.552269 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:35:55.552509 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"
[0m12:35:55.552749 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:35:55.553011 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: COMMIT
[0m12:35:55.553283 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_source_expect_45f2583dc51a45385b6a8d6f71b77768"
    
      
    ) dbt_internal_test
[0m12:35:55.553557 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: COMMIT
[0m12:35:55.553804 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.554926 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: ROLLBACK
[0m12:35:55.555229 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:55.555470 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:55.555707 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:55.555952 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: Close
[0m12:35:55.556370 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:35:55.556729 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:35:55.557606 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07: ROLLBACK
[0m12:35:55.558925 [info ] [Thread-3  ]: 10 of 66 PASS dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[32mPASS[0m in 0.08s]
[0m12:35:55.559859 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:35:55.560277 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:35:55.560567 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: BEGIN
[0m12:35:55.560828 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07: Close
[0m12:35:55.561099 [debug] [Thread-3  ]: Began running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2
[0m12:35:55.561465 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:35:55.561771 [info ] [Thread-3  ]: 12 of 66 START test dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0  [RUN]
[0m12:35:55.562223 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.562527 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: BEGIN
[0m12:35:55.563302 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2)
[0m12:35:55.562984 [info ] [Thread-1  ]: 11 of 66 PASS dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_  [[32mPASS[0m in 0.08s]
[0m12:35:55.563655 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:35:55.563964 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2
[0m12:35:55.564371 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07
[0m12:35:55.564628 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.564871 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_0d21460a155f0cff109b3eca59430181"
    
      
    ) dbt_internal_test
[0m12:35:55.571879 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"
[0m12:35:55.572329 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f
[0m12:35:55.572681 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:35:55.573137 [info ] [Thread-1  ]: 13 of 66 START test dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0  [RUN]
[0m12:35:55.573480 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_e42e386f1f5fcb00fca61dbc25a22a13"
    
      
    ) dbt_internal_test
[0m12:35:55.573892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07, now test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f)
[0m12:35:55.574209 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.574506 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f
[0m12:35:55.575498 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: ROLLBACK
[0m12:35:55.575850 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.576165 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2
[0m12:35:55.581056 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"
[0m12:35:55.582700 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: ROLLBACK
[0m12:35:55.583038 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: Close
[0m12:35:55.586881 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_utils_source_expression_is_153dfd9cd11a491818a4174d0cdc2f9b"
[0m12:35:55.587693 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"
[0m12:35:55.588185 [error] [Thread-2  ]: 9 of 66 FAIL 1 dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp  [[31mFAIL 1[0m in 0.12s]
[0m12:35:55.588482 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: Close
[0m12:35:55.588785 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2: BEGIN
[0m12:35:55.589180 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044
[0m12:35:55.589484 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f
[0m12:35:55.589869 [error] [Thread-4  ]: 8 of 66 FAIL 1 dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp  [[31mFAIL 1[0m in 0.19s]
[0m12:35:55.590303 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:55.591078 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890
[0m12:35:55.594084 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_utils_source_expression_is_603970f0a6133167114fc15e9a3be35c"
[0m12:35:55.594539 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586
[0m12:35:55.595685 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"
[0m12:35:55.594920 [info ] [Thread-2  ]: 14 of 66 START test dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0  [RUN]
[0m12:35:55.596110 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:35:55.596419 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f: BEGIN
[0m12:35:55.596738 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044, now test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890)
[0m12:35:55.597020 [info ] [Thread-4  ]: 15 of 66 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m12:35:55.597316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:55.597572 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890
[0m12:35:55.597868 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:35:55.604908 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"
[0m12:35:55.605226 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:35:55.605476 [debug] [Thread-3  ]: SQL status: BEGIN in 0.015 seconds
[0m12:35:55.611143 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:35:55.611534 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"
[0m12:35:55.612046 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_utils_source_expression_is_153dfd9cd11a491818a4174d0cdc2f9b"
  
  
    as
  
  (
    



select
    *
from "dbt_db_ex2"."public"."order_items"

where not(quantity > 0)


  );
  
    
[0m12:35:55.612929 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890
[0m12:35:55.613293 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m12:35:55.617236 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_utils_source_expression_is_fc049e8250e95d89a21aa3030492639b"
[0m12:35:55.617680 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:55.617966 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:35:55.618241 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"
[0m12:35:55.618867 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"
[0m12:35:55.619569 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2: COMMIT
[0m12:35:55.624605 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:35:55.624992 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_utils_source_expression_is_603970f0a6133167114fc15e9a3be35c"
  
  
    as
  
  (
    



select
    *
from "dbt_db_ex2"."public"."order_items"

where not(unit_price >= 0)


  );
  
    
[0m12:35:55.625294 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890: BEGIN
[0m12:35:55.625588 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"
[0m12:35:55.626017 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:35:55.626304 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:55.626567 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2: COMMIT
[0m12:35:55.626823 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m12:35:55.627184 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:55.628228 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:55.628774 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"
[0m12:35:55.629335 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"
[0m12:35:55.629627 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:35:55.629883 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2: BEGIN
[0m12:35:55.630616 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f: COMMIT
[0m12:35:55.630920 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"
[0m12:35:55.631181 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f: COMMIT
[0m12:35:55.631419 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.631666 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"
[0m12:35:55.631924 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_utils_source_expression_is_153dfd9cd11a491818a4174d0cdc2f9b"
    
      
    ) dbt_internal_test
[0m12:35:55.632333 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:55.632798 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"
[0m12:35:55.633084 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.634497 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2: ROLLBACK
[0m12:35:55.635063 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"
[0m12:35:55.635352 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2: Close
[0m12:35:55.635624 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m12:35:55.635870 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f: BEGIN
[0m12:35:55.636119 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.009 seconds
[0m12:35:55.636732 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"
[0m12:35:55.636521 [info ] [Thread-3  ]: 12 of 66 PASS dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0  [[32mPASS[0m in 0.07s]
[0m12:35:55.637636 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:35:55.637971 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_utils_source_expression_is_fc049e8250e95d89a21aa3030492639b"
  
  
    as
  
  (
    



select
    *
from "dbt_db_ex2"."public"."products"

where not(price >= 0)


  );
  
    
[0m12:35:55.638613 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:55.639157 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2
[0m12:35:55.639740 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:35:55.640037 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"
[0m12:35:55.640337 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:35:55.640675 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:35:55.640955 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_utils_source_expression_is_603970f0a6133167114fc15e9a3be35c"
    
      
    ) dbt_internal_test
[0m12:35:55.641262 [info ] [Thread-3  ]: 16 of 66 START test not_null_dim_customers_email ............................... [RUN]
[0m12:35:55.642460 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:35:55.642868 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.643145 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:35:55.643401 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:55.643687 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:35:55.643943 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.004 seconds
[0m12:35:55.647499 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:35:55.648544 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f: ROLLBACK
[0m12:35:55.648852 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m12:35:55.649520 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890: COMMIT
[0m12:35:55.649919 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"
[0m12:35:55.650324 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890: COMMIT
[0m12:35:55.650565 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f: Close
[0m12:35:55.651513 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:35:55.651241 [info ] [Thread-1  ]: 13 of 66 PASS dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0  [[32mPASS[0m in 0.08s]
[0m12:35:55.658742 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:35:55.659052 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:35:55.659286 [debug] [Thread-2  ]: SQL status: COMMIT in 0.008 seconds
[0m12:35:55.659679 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f
[0m12:35:55.660133 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:35:55.660789 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:35:55.661177 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"
[0m12:35:55.661484 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:35:55.661787 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m12:35:55.662111 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:35:55.662752 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"
[0m12:35:55.663019 [info ] [Thread-1  ]: 17 of 66 START test not_null_dim_customers_lifetime_orders ..................... [RUN]
[0m12:35:55.663306 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:55.663568 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:35:55.663811 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890: BEGIN
[0m12:35:55.664090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:35:55.664715 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:35:55.669317 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:35:55.669962 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m12:35:55.670762 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m12:35:55.671091 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"
[0m12:35:55.671626 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:35:55.671911 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:35:55.672182 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_utils_source_expression_is_fc049e8250e95d89a21aa3030492639b"
    
      
    ) dbt_internal_test
[0m12:35:55.678038 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:35:55.678840 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:35:55.679504 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m12:35:55.679843 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:35:55.680312 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:55.680623 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.017 seconds
[0m12:35:55.680852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:55.681653 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:35:55.682594 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890: ROLLBACK
[0m12:35:55.683257 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:35:55.683876 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:35:55.684134 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890: Close
[0m12:35:55.684386 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:35:55.684625 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.685352 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:35:55.685663 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:35:55.685085 [info ] [Thread-2  ]: 14 of 66 PASS dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0  [[32mPASS[0m in 0.09s]
[0m12:35:55.686169 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890
[0m12:35:55.686580 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.686875 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:35:55.687304 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.687656 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:35:55.687931 [info ] [Thread-2  ]: 18 of 66 START test not_null_dim_customers_name ................................ [RUN]
[0m12:35:55.688926 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m12:35:55.689189 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where email is null



  );
  
    
[0m12:35:55.689496 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:35:55.689826 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:35:55.694308 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:35:55.694728 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m12:35:55.695092 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:55.695940 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:35:55.696239 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:35:55.696484 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:35:55.696776 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:35:55.697232 [info ] [Thread-4  ]: 15 of 66 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.10s]
[0m12:35:55.698257 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:35:55.698745 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:35:55.699002 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:35:55.699245 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m12:35:55.700057 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:35:55.700393 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:35:55.705244 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:35:55.705774 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:35:55.706078 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:35:55.706366 [info ] [Thread-4  ]: 19 of 66 START test not_null_dim_products_name ................................. [RUN]
[0m12:35:55.706840 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:35:55.707277 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:35:55.707583 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m12:35:55.707859 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.708150 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:35:55.708405 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:55.708652 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:35:55.708960 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:35:55.713399 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:35:55.713880 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m12:35:55.714151 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:35:55.714805 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:35:55.720751 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m12:35:55.722525 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:35:55.722841 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:55.723095 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:35:55.723516 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:35:55.724171 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:35:55.724427 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:35:55.724659 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:35:55.724908 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m12:35:55.725170 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:35:55.725820 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:35:55.726064 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.726275 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:55.726514 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:35:55.726977 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:35:55.727902 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m12:35:55.728267 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:35:55.728827 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: Close
[0m12:35:55.729108 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.729555 [info ] [Thread-3  ]: 16 of 66 PASS not_null_dim_customers_email ..................................... [[32mPASS[0m in 0.09s]
[0m12:35:55.729856 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:35:55.730229 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:35:55.730497 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where name is null



  );
  
    
[0m12:35:55.730811 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:35:55.731744 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m12:35:55.732526 [info ] [Thread-3  ]: 20 of 66 START test not_null_dim_products_price ................................ [RUN]
[0m12:35:55.733695 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:35:55.734057 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:35:55.734414 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:35:55.738600 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:35:55.738981 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:55.739813 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:35:55.740093 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:35:55.740335 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:35:55.740609 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:35:55.741412 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:35:55.741715 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:35:55.742011 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:35:55.742527 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:35:55.749076 [debug] [Thread-2  ]: SQL status: COMMIT in 0.008 seconds
[0m12:35:55.748872 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:35:55.749453 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:35:55.749713 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:35:55.750093 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:35:55.750464 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:35:55.750853 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m12:35:55.751203 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:55.751426 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.751642 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:55.751893 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:35:55.752120 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:35:55.752367 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:35:55.752694 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m12:35:55.752947 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where name is null



  );
  
    
[0m12:35:55.753180 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:35:55.753876 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:55.754200 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.754482 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:35:55.755689 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m12:35:55.756017 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m12:35:55.756702 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m12:35:55.757027 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.757472 [info ] [Thread-1  ]: 17 of 66 PASS not_null_dim_customers_lifetime_orders ........................... [[32mPASS[0m in 0.09s]
[0m12:35:55.759230 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m12:35:55.759543 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:35:55.759928 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:35:55.760615 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:35:55.760882 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: Close
[0m12:35:55.761148 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:35:55.761474 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:35:55.761760 [info ] [Thread-1  ]: 21 of 66 START test not_null_dim_products_product_id ........................... [RUN]
[0m12:35:55.763198 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:35:55.763693 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:35:55.762750 [info ] [Thread-2  ]: 18 of 66 PASS not_null_dim_customers_name ...................................... [[32mPASS[0m in 0.07s]
[0m12:35:55.764135 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:35:55.765002 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:35:55.765410 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:35:55.765665 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:35:55.766184 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:35:55.766499 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:35:55.770169 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:35:55.770477 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m12:35:55.770719 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:35:55.770995 [info ] [Thread-2  ]: 22 of 66 START test not_null_dim_products_total_quantity_sold .................. [RUN]
[0m12:35:55.771481 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:35:55.771924 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:35:55.772535 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.773036 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:35:55.773321 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:35:55.773556 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:35:55.777285 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:35:55.782595 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:35:55.782889 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:35:55.783156 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where price is null



  );
  
    
[0m12:35:55.783566 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:35:55.783814 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:35:55.784128 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m12:35:55.784398 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:35:55.784674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:55.791202 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:35:55.791476 [debug] [Thread-4  ]: SQL status: BEGIN in 0.007 seconds
[0m12:35:55.791057 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:35:55.792359 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:35:55.792611 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:35:55.793056 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:35:55.793348 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:35:55.793634 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m12:35:55.795654 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold" cascade
[0m12:35:55.795942 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:35:55.796222 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:55.796753 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.800556 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m12:35:55.801402 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: Close
[0m12:35:55.801749 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m12:35:55.802282 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:35:55.803140 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.018 seconds
[0m12:35:55.802737 [info ] [Thread-4  ]: 19 of 66 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.10s]
[0m12:35:55.804038 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:35:55.804449 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:35:55.805080 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:35:55.805370 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:35:55.805736 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:35:55.806088 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:35:55.806340 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:35:55.806594 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:35:55.806879 [info ] [Thread-4  ]: 23 of 66 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m12:35:55.807662 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:35:55.808123 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:35:55.809010 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.809604 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:35:55.809846 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:55.810111 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:35:55.810353 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:35:55.810581 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:35:55.810811 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:35:55.815632 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:35:55.815989 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m12:35:55.816301 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where product_id is null



  );
  
    
[0m12:35:55.816839 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.817132 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:35:55.817428 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_quantity_sold is null



  );
  
    
[0m12:35:55.817721 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.818716 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m12:35:55.819112 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:35:55.819392 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: Close
[0m12:35:55.824815 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:35:55.825110 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:55.825385 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:55.826460 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:35:55.825961 [info ] [Thread-3  ]: 20 of 66 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.09s]
[0m12:35:55.827231 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:35:55.827865 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:35:55.828190 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue" cascade
[0m12:35:55.828590 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:35:55.828843 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:35:55.829095 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:35:55.829339 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:55.829592 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:35:55.829866 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:35:55.830096 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:35:55.830415 [info ] [Thread-3  ]: 24 of 66 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m12:35:55.830964 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:35:55.831369 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:35:55.835361 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:35:55.835681 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m12:35:55.835972 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m12:35:55.836381 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:35:55.836828 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:35:55.837296 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:35:55.842995 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:35:55.843257 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:35:55.842685 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:35:55.843760 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:35:55.844019 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m12:35:55.844296 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:35:55.844553 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.844825 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:55.845065 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:35:55.845306 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:35:55.845532 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:35:55.846302 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:35:55.846662 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:35:55.847004 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:55.847508 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:35:55.847855 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:35:55.848110 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:35:55.848383 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.848632 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
    
      
    ) dbt_internal_test
[0m12:35:55.849721 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m12:35:55.850002 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.850273 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:35:55.850566 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_revenue is null



  );
  
    
[0m12:35:55.850827 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: Close
[0m12:35:55.851063 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.852882 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: ROLLBACK
[0m12:35:55.853418 [info ] [Thread-1  ]: 21 of 66 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m12:35:55.853714 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: Close
[0m12:35:55.854062 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:35:55.854390 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:35:55.854830 [info ] [Thread-2  ]: 22 of 66 PASS not_null_dim_products_total_quantity_sold ........................ [[32mPASS[0m in 0.08s]
[0m12:35:55.855226 [info ] [Thread-1  ]: 25 of 66 START test not_null_fct_orders_order_date ............................. [RUN]
[0m12:35:55.855709 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:35:55.856065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:35:55.856434 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:35:55.856953 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:35:55.857195 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:35:55.857463 [info ] [Thread-2  ]: 26 of 66 START test not_null_fct_orders_order_id ............................... [RUN]
[0m12:35:55.858232 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:35:55.906540 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.055 seconds
[0m12:35:55.909038 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:35:55.909392 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:35:55.909849 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:35:55.910442 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:35:55.910763 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:35:55.911084 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:35:55.911347 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:35:55.914734 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:35:55.915057 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:35:55.915310 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:35:55.915579 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.920260 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:35:55.920621 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:35:55.921035 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:35:55.921321 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m12:35:55.921579 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m12:35:55.921845 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:35:55.922129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:55.922381 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:55.927675 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:35:55.927981 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:35:55.928448 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:35:55.928841 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:35:55.929515 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:35:55.929860 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m12:35:55.930130 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:35:55.930391 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:55.930640 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:35:55.930890 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:35:55.931283 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:35:55.932312 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:55.932650 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:35:55.932904 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
    
      
    ) dbt_internal_test
[0m12:35:55.933632 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:55.934131 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:35:55.934589 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.935743 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m12:35:55.936183 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:35:55.936430 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m12:35:55.936673 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:35:55.936927 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:35:55.937307 [info ] [Thread-4  ]: 23 of 66 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.13s]
[0m12:35:55.938194 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:35:55.938474 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.938809 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:35:55.939317 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:35:55.939561 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:35:55.939851 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:35:55.940158 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:35:55.940435 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m12:35:55.940694 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:35:55.940938 [info ] [Thread-4  ]: 27 of 66 START test not_null_fct_orders_status ................................. [RUN]
[0m12:35:55.941788 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:35:55.942054 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.942296 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.942583 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:35:55.943399 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:35:55.943670 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:35:55.944618 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m12:35:55.945089 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:35:55.945425 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:35:55.946038 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_date is null



  );
  
    
[0m12:35:55.949891 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:35:55.950206 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m12:35:55.950864 [info ] [Thread-3  ]: 24 of 66 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.12s]
[0m12:35:55.951257 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.951619 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:35:55.951900 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:35:55.952203 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:35:55.952522 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_id is null



  );
  
    
[0m12:35:55.952779 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:35:55.953050 [info ] [Thread-3  ]: 28 of 66 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m12:35:55.958909 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:55.959286 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:35:55.959544 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:35:55.959945 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:35:55.960642 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:35:55.961052 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:35:55.961605 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:35:55.961883 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:35:55.962142 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:35:55.962406 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m12:35:55.962674 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:35:55.966372 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:35:55.966690 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:35:55.966951 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:55.967214 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:35:55.967757 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:35:55.973231 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:35:55.973615 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m12:35:55.973897 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m12:35:55.974304 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:35:55.974718 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:35:55.975097 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:35:55.975390 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m12:35:55.975850 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:55.976332 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:35:55.976607 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:35:55.976885 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:35:55.977125 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:35:55.977867 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:35:55.978139 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:35:55.978738 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:35:55.979187 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:35:55.979594 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.980182 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:55.980473 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:35:55.980708 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.980951 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:35:55.981201 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:35:55.981440 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:35:55.981682 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m12:35:55.981971 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where status is null



  );
  
    
[0m12:35:55.982484 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:55.983484 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m12:35:55.983796 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:55.984758 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m12:35:55.985125 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m12:35:55.985403 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:35:55.985648 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: Close
[0m12:35:55.986092 [info ] [Thread-2  ]: 26 of 66 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m12:35:55.986892 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:35:55.987168 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:55.987883 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:35:55.987568 [info ] [Thread-1  ]: 25 of 66 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.13s]
[0m12:35:55.988486 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:35:55.989128 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:35:55.989416 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:35:55.989793 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:35:55.990031 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:35:55.990265 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:35:55.990504 [info ] [Thread-2  ]: 29 of 66 START test not_null_fct_orders_total_items ............................ [RUN]
[0m12:35:55.990794 [debug] [Thread-1  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:35:55.991080 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:35:55.991360 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:35:55.991598 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:55.991835 [info ] [Thread-1  ]: 30 of 66 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m12:35:55.992226 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:35:55.992582 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:35:55.992894 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:35:55.996597 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:35:55.996909 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m12:35:55.997163 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m12:35:55.997421 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:35:55.997867 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:35:56.027508 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:35:56.020428 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.022 seconds
[0m12:35:56.023530 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:35:56.031082 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:35:56.029814 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:35:56.037868 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:35:56.039044 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:35:56.020068 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:35:56.028129 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:35:56.045903 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m12:35:56.047354 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:35:56.054179 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:35:56.055041 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m12:35:56.059461 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:35:56.055562 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:35:56.058799 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:35:56.059932 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m12:35:56.061279 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:35:56.058175 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:35:56.063840 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:35:56.062290 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items" cascade
[0m12:35:56.065165 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:56.064204 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m12:35:56.067099 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:56.064639 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.066149 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.003 seconds
[0m12:35:56.067754 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:35:56.069665 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: ROLLBACK
[0m12:35:56.070474 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m12:35:56.072084 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: Close
[0m12:35:56.072648 [info ] [Thread-4  ]: 27 of 66 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.13s]
[0m12:35:56.073034 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:35:56.073917 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc
[0m12:35:56.074268 [info ] [Thread-4  ]: 31 of 66 START test source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m12:35:56.074981 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc)
[0m12:35:56.075427 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc
[0m12:35:56.081532 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"
[0m12:35:56.082172 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc
[0m12:35:56.092254 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_a9307fd1c28d392945aba46545b7af22"
[0m12:35:56.093318 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"
[0m12:35:56.094611 [debug] [Thread-4  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_a9307fd1c28d392945aba46545b7af22" cascade
[0m12:35:56.095312 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:56.094157 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.023 seconds
[0m12:35:56.097369 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m12:35:56.098759 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.031 seconds
[0m12:35:56.099606 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:35:56.100289 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:35:56.100634 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:35:56.100990 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.036 seconds
[0m12:35:56.101868 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:35:56.103599 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:35:56.104557 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:35:56.105330 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m12:35:56.107014 [info ] [Thread-3  ]: 28 of 66 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.15s]
[0m12:35:56.108005 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m12:35:56.113294 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:35:56.109331 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:35:56.114782 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex2"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex2"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m12:35:56.116871 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d
[0m12:35:56.110742 [debug] [Thread-2  ]: SQL status: BEGIN in 0.006 seconds
[0m12:35:56.122943 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:35:56.123312 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_items is null



  );
  
    
[0m12:35:56.121069 [info ] [Thread-3  ]: 32 of 66 START test source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m12:35:56.124617 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d)
[0m12:35:56.125193 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d
[0m12:35:56.133949 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.010 seconds
[0m12:35:56.134625 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.016 seconds
[0m12:35:56.136350 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:35:56.139225 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"
[0m12:35:56.142325 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:35:56.143310 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:35:56.147614 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:35:56.144495 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d
[0m12:35:56.146237 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.051 seconds
[0m12:35:56.145381 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:35:56.158542 [debug] [Thread-2  ]: SQL status: COMMIT in 0.011 seconds
[0m12:35:56.162725 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_a9307fd1c28d392945aba46545b7af22"
[0m12:35:56.166086 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_3e5b67e5c60a477732a6235b190fde6e"
[0m12:35:56.167389 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:35:56.168710 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:35:56.169795 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"
[0m12:35:56.171157 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"
[0m12:35:56.177574 [debug] [Thread-3  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_3e5b67e5c60a477732a6235b190fde6e" cascade
[0m12:35:56.178007 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:56.173597 [debug] [Thread-4  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc: BEGIN
[0m12:35:56.179404 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.179724 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"
[0m12:35:56.179994 [debug] [Thread-4  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_a9307fd1c28d392945aba46545b7af22"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m12:35:56.174864 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:35:56.180702 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:35:56.175988 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m12:35:56.182146 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:35:56.183146 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:35:56.183589 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:35:56.186467 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m12:35:56.186917 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:35:56.187808 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
    
      
    ) dbt_internal_test
[0m12:35:56.188406 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m12:35:56.189279 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:35:56.189603 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m12:35:56.190120 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.010 seconds
[0m12:35:56.191329 [debug] [Thread-4  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc: COMMIT
[0m12:35:56.191699 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"
[0m12:35:56.192072 [debug] [Thread-4  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc: COMMIT
[0m12:35:56.192657 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.003 seconds
[0m12:35:56.193810 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: ROLLBACK
[0m12:35:56.194495 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:35:56.195334 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m12:35:56.201472 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"
[0m12:35:56.195679 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: Close
[0m12:35:56.203527 [info ] [Thread-2  ]: 29 of 66 PASS not_null_fct_orders_total_items .................................. [[32mPASS[0m in 0.21s]
[0m12:35:56.197690 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m12:35:56.204445 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:35:56.209059 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:35:56.209439 [info ] [Thread-2  ]: 33 of 66 START test source_not_null_ecommerce_raw_customers_customer_id ........ [RUN]
[0m12:35:56.209892 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m12:35:56.210183 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:35:56.205229 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"
[0m12:35:56.216213 [debug] [Thread-4  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc: BEGIN
[0m12:35:56.219541 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:35:56.220441 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m12:35:56.221252 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"
[0m12:35:56.221893 [debug] [Thread-4  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_a9307fd1c28d392945aba46545b7af22"
    
      
    ) dbt_internal_test
[0m12:35:56.223032 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.045 seconds
[0m12:35:56.225198 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_3e5b67e5c60a477732a6235b190fde6e"
[0m12:35:56.226769 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:35:56.227199 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m12:35:56.233519 [info ] [Thread-1  ]: 30 of 66 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.24s]
[0m12:35:56.234532 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:35:56.232407 [debug] [Thread-4  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc: ROLLBACK
[0m12:35:56.234861 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d
[0m12:35:56.235627 [info ] [Thread-1  ]: 34 of 66 START test source_not_null_ecommerce_raw_customers_email .............. [RUN]
[0m12:35:56.228652 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"
[0m12:35:56.236700 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d)
[0m12:35:56.237435 [debug] [Thread-3  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d: BEGIN
[0m12:35:56.229374 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:35:56.238065 [debug] [Thread-4  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc: Close
[0m12:35:56.256854 [info ] [Thread-4  ]: 31 of 66 PASS source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.18s]
[0m12:35:56.249279 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m12:35:56.238617 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d
[0m12:35:56.258567 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc
[0m12:35:56.255697 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_customer_id"
[0m12:35:56.261421 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"
[0m12:35:56.273707 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"
[0m12:35:56.276433 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381
[0m12:35:56.278305 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:35:56.282368 [debug] [Thread-3  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_3e5b67e5c60a477732a6235b190fde6e"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m12:35:56.285886 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_customer_id" cascade
[0m12:35:56.289216 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:56.284654 [info ] [Thread-4  ]: 35 of 66 START test source_not_null_ecommerce_raw_customers_name ............... [RUN]
[0m12:35:56.291182 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc, now test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381)
[0m12:35:56.292833 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381
[0m12:35:56.287145 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d
[0m12:35:56.309982 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.021 seconds
[0m12:35:56.312974 [debug] [Thread-3  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d: COMMIT
[0m12:35:56.320500 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"
[0m12:35:56.321957 [debug] [Thread-3  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d: COMMIT
[0m12:35:56.324104 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"
[0m12:35:56.326019 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381
[0m12:35:56.334656 [debug] [Thread-3  ]: SQL status: COMMIT in 0.012 seconds
[0m12:35:56.339501 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_name"
[0m12:35:56.340956 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_email"
[0m12:35:56.341820 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"
[0m12:35:56.343270 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"
[0m12:35:56.343905 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.055 seconds
[0m12:35:56.345022 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"
[0m12:35:56.353278 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_email" cascade
[0m12:35:56.346584 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"
[0m12:35:56.351285 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_customer_id"
[0m12:35:56.354175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:56.347392 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_name" cascade
[0m12:35:56.360014 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:56.355160 [debug] [Thread-3  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d: BEGIN
[0m12:35:56.357306 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:35:56.366768 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: BEGIN
[0m12:35:56.368429 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m12:35:56.369292 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"
[0m12:35:56.370167 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:56.370960 [debug] [Thread-3  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_accepted_values_ecommer_3e5b67e5c60a477732a6235b190fde6e"
    
      
    ) dbt_internal_test
[0m12:35:56.371619 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:35:56.373903 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."customers"
where customer_id is null



  );
  
    
[0m12:35:56.374924 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:56.376622 [debug] [Thread-3  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d: ROLLBACK
[0m12:35:56.379659 [debug] [Thread-3  ]: On test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d: Close
[0m12:35:56.380425 [info ] [Thread-3  ]: 32 of 66 PASS source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.26s]
[0m12:35:56.380836 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d
[0m12:35:56.381123 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181
[0m12:35:56.381379 [info ] [Thread-3  ]: 36 of 66 START test source_not_null_ecommerce_raw_order_items_order_id ......... [RUN]
[0m12:35:56.381708 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181)
[0m12:35:56.381968 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181
[0m12:35:56.388939 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"
[0m12:35:56.389824 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181
[0m12:35:56.390368 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.015 seconds
[0m12:35:56.396584 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_id"
[0m12:35:56.397066 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.037 seconds
[0m12:35:56.399398 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: COMMIT
[0m12:35:56.400406 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"
[0m12:35:56.400669 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.047 seconds
[0m12:35:56.401369 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_name"
[0m12:35:56.401677 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:35:56.401957 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_id" cascade
[0m12:35:56.402617 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_email"
[0m12:35:56.403216 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"
[0m12:35:56.403463 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: COMMIT
[0m12:35:56.403701 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:56.404122 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"
[0m12:35:56.404352 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381: BEGIN
[0m12:35:56.404797 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d: BEGIN
[0m12:35:56.405853 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.406173 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"
[0m12:35:56.406505 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.406756 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."customers"
where email is null



  );
  
    
[0m12:35:56.407013 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"
[0m12:35:56.407369 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m12:35:56.407613 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."customers"
where name is null



  );
  
    
[0m12:35:56.408073 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:35:56.408855 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:35:56.409590 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: BEGIN
[0m12:35:56.410517 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.410810 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:35:56.411090 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:35:56.411936 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:56.413338 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d: COMMIT
[0m12:35:56.413898 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:56.414188 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"
[0m12:35:56.415260 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: ROLLBACK
[0m12:35:56.415586 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:35:56.415892 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d: COMMIT
[0m12:35:56.416989 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381: COMMIT
[0m12:35:56.417505 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:35:56.418024 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"
[0m12:35:56.418693 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: Close
[0m12:35:56.419547 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_id"
[0m12:35:56.419836 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:56.420069 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381: COMMIT
[0m12:35:56.421010 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"
[0m12:35:56.420494 [info ] [Thread-2  ]: 33 of 66 PASS source_not_null_ecommerce_raw_customers_customer_id .............. [[32mPASS[0m in 0.21s]
[0m12:35:56.421608 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"
[0m12:35:56.421912 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181: BEGIN
[0m12:35:56.422324 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:35:56.422754 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:35:56.423208 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"
[0m12:35:56.423950 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.424213 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:56.424935 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d: BEGIN
[0m12:35:56.423513 [info ] [Thread-2  ]: 37 of 66 START test source_not_null_ecommerce_raw_order_items_order_item_id .... [RUN]
[0m12:35:56.425378 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"
[0m12:35:56.425860 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"
[0m12:35:56.426227 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0)
[0m12:35:56.426537 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."order_items"
where order_id is null



  );
  
    
[0m12:35:56.427093 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.427380 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:35:56.427690 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"
[0m12:35:56.432106 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:35:56.432507 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"
[0m12:35:56.432767 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:56.433066 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_email"
    
      
    ) dbt_internal_test
[0m12:35:56.433444 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381: BEGIN
[0m12:35:56.434157 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181: COMMIT
[0m12:35:56.434545 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"
[0m12:35:56.434798 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181: COMMIT
[0m12:35:56.435191 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:35:56.440905 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.006 seconds
[0m12:35:56.443052 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_item_id"
[0m12:35:56.443350 [debug] [Thread-3  ]: SQL status: COMMIT in 0.008 seconds
[0m12:35:56.444309 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d: ROLLBACK
[0m12:35:56.444558 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m12:35:56.444984 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:35:56.445384 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"
[0m12:35:56.445685 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"
[0m12:35:56.445959 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_item_id" cascade
[0m12:35:56.446207 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d: Close
[0m12:35:56.446682 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_customers_name"
    
      
    ) dbt_internal_test
[0m12:35:56.446990 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:56.447931 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"
[0m12:35:56.447466 [info ] [Thread-1  ]: 34 of 66 PASS source_not_null_ecommerce_raw_customers_email .................... [[32mPASS[0m in 0.21s]
[0m12:35:56.448275 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181: BEGIN
[0m12:35:56.448706 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d
[0m12:35:56.449401 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b
[0m12:35:56.449707 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.449949 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.003 seconds
[0m12:35:56.450254 [info ] [Thread-1  ]: 38 of 66 START test source_not_null_ecommerce_raw_order_items_product_id ....... [RUN]
[0m12:35:56.450567 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"
[0m12:35:56.452501 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381: ROLLBACK
[0m12:35:56.452961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b)
[0m12:35:56.453299 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_id"
    
      
    ) dbt_internal_test
[0m12:35:56.454043 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b
[0m12:35:56.458639 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"
[0m12:35:56.459030 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381: Close
[0m12:35:56.459331 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.005 seconds
[0m12:35:56.461632 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181: ROLLBACK
[0m12:35:56.461976 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:35:56.460338 [info ] [Thread-4  ]: 35 of 66 PASS source_not_null_ecommerce_raw_customers_name ..................... [[32mPASS[0m in 0.17s]
[0m12:35:56.463037 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_item_id"
[0m12:35:56.463562 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381
[0m12:35:56.464077 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181: Close
[0m12:35:56.465555 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:35:56.466323 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b
[0m12:35:56.466710 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564
[0m12:35:56.467242 [info ] [Thread-3  ]: 36 of 66 PASS source_not_null_ecommerce_raw_order_items_order_id ............... [[32mPASS[0m in 0.09s]
[0m12:35:56.467952 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: BEGIN
[0m12:35:56.473296 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_product_id"
[0m12:35:56.474076 [info ] [Thread-4  ]: 39 of 66 START test source_not_null_ecommerce_raw_order_items_quantity ......... [RUN]
[0m12:35:56.474545 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181
[0m12:35:56.475107 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"
[0m12:35:56.475422 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564)
[0m12:35:56.475680 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.475967 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59
[0m12:35:56.476272 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_product_id" cascade
[0m12:35:56.476525 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564
[0m12:35:56.476766 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:35:56.477023 [info ] [Thread-3  ]: 40 of 66 START test source_not_null_ecommerce_raw_order_items_unit_price ....... [RUN]
[0m12:35:56.477286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:56.482736 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"
[0m12:35:56.483122 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_item_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."order_items"
where order_item_id is null



  );
  
    
[0m12:35:56.484201 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59)
[0m12:35:56.484787 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59
[0m12:35:56.488894 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"
[0m12:35:56.489337 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:56.490013 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: COMMIT
[0m12:35:56.490353 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:35:56.490618 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564
[0m12:35:56.490846 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: COMMIT
[0m12:35:56.491090 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59
[0m12:35:56.498216 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_quantity"
[0m12:35:56.640085 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.163 seconds
[0m12:35:56.641129 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_unit_price"
[0m12:35:56.641378 [debug] [Thread-2  ]: SQL status: COMMIT in 0.143 seconds
[0m12:35:56.641734 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"
[0m12:35:56.642394 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_product_id"
[0m12:35:56.642801 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"
[0m12:35:56.643157 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:35:56.643395 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_quantity" cascade
[0m12:35:56.643802 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"
[0m12:35:56.644036 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_unit_price" cascade
[0m12:35:56.644348 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:56.644637 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b: BEGIN
[0m12:35:56.644872 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:56.645323 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:35:56.645667 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: BEGIN
[0m12:35:56.646102 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.646343 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"
[0m12:35:56.646589 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."order_items"
where product_id is null



  );
  
    
[0m12:35:56.646867 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.647121 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:35:56.647372 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m12:35:56.648608 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:56.649601 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: ROLLBACK
[0m12:35:56.650201 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: Close
[0m12:35:56.650829 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m12:35:56.650611 [info ] [Thread-2  ]: 37 of 66 PASS source_not_null_ecommerce_raw_order_items_order_item_id .......... [[32mPASS[0m in 0.22s]
[0m12:35:56.651535 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b: COMMIT
[0m12:35:56.651891 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:35:56.652489 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"
[0m12:35:56.654873 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8
[0m12:35:56.657428 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b: COMMIT
[0m12:35:56.659040 [info ] [Thread-2  ]: 41 of 66 START test source_not_null_ecommerce_raw_orders_customer_id ........... [RUN]
[0m12:35:56.660314 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8)
[0m12:35:56.661804 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8
[0m12:35:56.669677 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"
[0m12:35:56.671125 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8
[0m12:35:56.671877 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.027 seconds
[0m12:35:56.672483 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m12:35:56.672863 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.029 seconds
[0m12:35:56.679423 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_customer_id"
[0m12:35:56.681339 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_unit_price"
[0m12:35:56.681881 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"
[0m12:35:56.682601 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_quantity"
[0m12:35:56.683088 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"
[0m12:35:56.683694 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"
[0m12:35:56.685281 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"
[0m12:35:56.686111 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_customer_id" cascade
[0m12:35:56.686599 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59: BEGIN
[0m12:35:56.687128 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"
[0m12:35:56.687416 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564: BEGIN
[0m12:35:56.687819 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:56.688203 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b: BEGIN
[0m12:35:56.689000 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.689584 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.690176 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.690459 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"
[0m12:35:56.690866 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"
[0m12:35:56.691225 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"
[0m12:35:56.691644 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_unit_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."order_items"
where unit_price is null



  );
  
    
[0m12:35:56.692740 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_quantity"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."order_items"
where quantity is null



  );
  
    
[0m12:35:56.693333 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_product_id"
    
      
    ) dbt_internal_test
[0m12:35:56.695276 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:56.697479 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b: ROLLBACK
[0m12:35:56.698537 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:56.699482 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59: COMMIT
[0m12:35:56.699840 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"
[0m12:35:56.700107 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b: Close
[0m12:35:56.700395 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59: COMMIT
[0m12:35:56.700687 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:35:56.702334 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564: COMMIT
[0m12:35:56.702715 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"
[0m12:35:56.703102 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564: COMMIT
[0m12:35:56.701566 [info ] [Thread-1  ]: 38 of 66 PASS source_not_null_ecommerce_raw_order_items_product_id ............. [[32mPASS[0m in 0.25s]
[0m12:35:56.703730 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:35:56.704375 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b
[0m12:35:56.704784 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m12:35:56.705895 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_customer_id"
[0m12:35:56.706488 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m12:35:56.706858 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67
[0m12:35:56.707581 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"
[0m12:35:56.708700 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"
[0m12:35:56.709198 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"
[0m12:35:56.709612 [info ] [Thread-1  ]: 42 of 66 START test source_not_null_ecommerce_raw_orders_order_date ............ [RUN]
[0m12:35:56.710396 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8: BEGIN
[0m12:35:56.710921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b, now test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67)
[0m12:35:56.711504 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67
[0m12:35:56.717367 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"
[0m12:35:56.717887 [debug] [Thread-2  ]: SQL status: BEGIN in 0.006 seconds
[0m12:35:56.718191 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"
[0m12:35:56.718440 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"
[0m12:35:56.719163 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"
[0m12:35:56.719877 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67
[0m12:35:56.720270 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564: BEGIN
[0m12:35:56.720864 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59: BEGIN
[0m12:35:56.721231 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."orders"
where customer_id is null



  );
  
    
[0m12:35:56.727132 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_date"
[0m12:35:56.727831 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"
[0m12:35:56.728112 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_date" cascade
[0m12:35:56.728355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:56.728793 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.729249 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:56.729688 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"
[0m12:35:56.730001 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"
[0m12:35:56.730960 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_unit_price"
    
      
    ) dbt_internal_test
[0m12:35:56.731359 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_order_items_quantity"
    
      
    ) dbt_internal_test
[0m12:35:56.733204 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:56.733645 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:56.733931 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:56.734908 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8: COMMIT
[0m12:35:56.736757 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564: ROLLBACK
[0m12:35:56.737768 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59: ROLLBACK
[0m12:35:56.738070 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"
[0m12:35:56.738884 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8: COMMIT
[0m12:35:56.739278 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59: Close
[0m12:35:56.739805 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564: Close
[0m12:35:56.741002 [info ] [Thread-4  ]: 39 of 66 PASS source_not_null_ecommerce_raw_order_items_quantity ............... [[32mPASS[0m in 0.27s]
[0m12:35:56.742020 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564
[0m12:35:56.743047 [info ] [Thread-3  ]: 40 of 66 PASS source_not_null_ecommerce_raw_order_items_unit_price ............. [[32mPASS[0m in 0.26s]
[0m12:35:56.743533 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:35:56.743795 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m12:35:56.744562 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59
[0m12:35:56.745226 [info ] [Thread-4  ]: 43 of 66 START test source_not_null_ecommerce_raw_orders_order_id .............. [RUN]
[0m12:35:56.746104 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"
[0m12:35:56.746465 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.018 seconds
[0m12:35:56.746808 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc
[0m12:35:56.747840 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564, now test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf)
[0m12:35:56.749931 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_date"
[0m12:35:56.750498 [info ] [Thread-3  ]: 44 of 66 START test source_not_null_ecommerce_raw_orders_status ................ [RUN]
[0m12:35:56.750951 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"
[0m12:35:56.751224 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:35:56.751896 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"
[0m12:35:56.752867 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59, now test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc)
[0m12:35:56.753792 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8: BEGIN
[0m12:35:56.761005 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:35:56.761390 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67: BEGIN
[0m12:35:56.761835 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc
[0m12:35:56.768291 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:35:56.768678 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m12:35:56.774299 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_id"
[0m12:35:56.774687 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"
[0m12:35:56.775140 [debug] [Thread-2  ]: SQL status: BEGIN in 0.013 seconds
[0m12:35:56.775541 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"
[0m12:35:56.776292 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:35:56.777063 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"
[0m12:35:56.777520 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."orders"
where order_date is null



  );
  
    
[0m12:35:56.777906 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_id" cascade
[0m12:35:56.778356 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_customer_id"
    
      
    ) dbt_internal_test
[0m12:35:56.778675 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc
[0m12:35:56.779036 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:56.784769 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.005 seconds
[0m12:35:56.787321 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_status"
[0m12:35:56.788198 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:35:56.790070 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8: ROLLBACK
[0m12:35:56.790733 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"
[0m12:35:56.792738 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_status" cascade
[0m12:35:56.793157 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:56.791735 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67: COMMIT
[0m12:35:56.793624 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8: Close
[0m12:35:56.794055 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"
[0m12:35:56.795359 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67: COMMIT
[0m12:35:56.794739 [info ] [Thread-2  ]: 41 of 66 PASS source_not_null_ecommerce_raw_orders_customer_id ................. [[32mPASS[0m in 0.13s]
[0m12:35:56.796379 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8
[0m12:35:56.797329 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b
[0m12:35:56.798470 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:56.799284 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"
[0m12:35:56.798063 [info ] [Thread-2  ]: 45 of 66 START test source_not_null_ecommerce_raw_products_name ................ [RUN]
[0m12:35:56.800282 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8, now test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b)
[0m12:35:56.801071 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b
[0m12:35:56.805924 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"
[0m12:35:56.806317 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"
[0m12:35:56.806668 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67: BEGIN
[0m12:35:56.807049 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b
[0m12:35:56.807303 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:56.811955 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_name"
[0m12:35:56.812281 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.033 seconds
[0m12:35:56.812542 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.019 seconds
[0m12:35:56.812805 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"
[0m12:35:56.813309 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"
[0m12:35:56.814020 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_id"
[0m12:35:56.814630 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_status"
[0m12:35:56.814892 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_date"
    
      
    ) dbt_internal_test
[0m12:35:56.815148 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_name" cascade
[0m12:35:56.815589 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:35:56.816082 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"
[0m12:35:56.816354 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:56.816588 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: BEGIN
[0m12:35:56.816823 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc: BEGIN
[0m12:35:56.817157 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:56.818231 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67: ROLLBACK
[0m12:35:56.818532 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.818790 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.819027 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67: Close
[0m12:35:56.819262 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:35:56.819529 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"
[0m12:35:56.820184 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."orders"
where order_id is null



  );
  
    
[0m12:35:56.819964 [info ] [Thread-1  ]: 42 of 66 PASS source_not_null_ecommerce_raw_orders_order_date .................. [[32mPASS[0m in 0.11s]
[0m12:35:56.820526 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."orders"
where status is null



  );
  
    
[0m12:35:56.820909 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67
[0m12:35:56.821210 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2
[0m12:35:56.821468 [info ] [Thread-1  ]: 46 of 66 START test source_not_null_ecommerce_raw_products_price ............... [RUN]
[0m12:35:56.821769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67, now test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2)
[0m12:35:56.822035 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2
[0m12:35:56.825937 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"
[0m12:35:56.826543 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:56.826854 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:35:56.827490 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc: COMMIT
[0m12:35:56.828122 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: COMMIT
[0m12:35:56.828397 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"
[0m12:35:56.828658 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2
[0m12:35:56.828898 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:35:56.829126 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.013 seconds
[0m12:35:56.829353 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc: COMMIT
[0m12:35:56.834672 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_price"
[0m12:35:56.834990 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: COMMIT
[0m12:35:56.835696 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_name"
[0m12:35:56.836103 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"
[0m12:35:56.836612 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"
[0m12:35:56.836877 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_price" cascade
[0m12:35:56.837117 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b: BEGIN
[0m12:35:56.837363 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:56.837579 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:56.837789 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:56.838196 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"
[0m12:35:56.838427 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:56.838949 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:35:56.839373 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"
[0m12:35:56.839848 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."products"
where name is null



  );
  
    
[0m12:35:56.840531 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:35:56.840807 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: BEGIN
[0m12:35:56.841207 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"
[0m12:35:56.841453 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc: BEGIN
[0m12:35:56.841747 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.841979 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:35:56.842242 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.842548 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:35:56.842836 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"
[0m12:35:56.843480 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_orders_status"
    
      
    ) dbt_internal_test
[0m12:35:56.843795 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.004 seconds
[0m12:35:56.844060 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:56.844709 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b: COMMIT
[0m12:35:56.844943 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:56.845840 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: ROLLBACK
[0m12:35:56.846110 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"
[0m12:35:56.846953 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc: ROLLBACK
[0m12:35:56.847275 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b: COMMIT
[0m12:35:56.847522 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: Close
[0m12:35:56.848003 [info ] [Thread-4  ]: 43 of 66 PASS source_not_null_ecommerce_raw_orders_order_id .................... [[32mPASS[0m in 0.10s]
[0m12:35:56.848371 [debug] [Thread-3  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc: Close
[0m12:35:56.848772 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:35:56.849410 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:35:56.849640 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:56.850290 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:35:56.850047 [info ] [Thread-3  ]: 44 of 66 PASS source_not_null_ecommerce_raw_orders_status ...................... [[32mPASS[0m in 0.10s]
[0m12:35:56.851135 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_price"
[0m12:35:56.851558 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"
[0m12:35:56.851827 [info ] [Thread-4  ]: 47 of 66 START test source_not_null_ecommerce_raw_products_product_id .......... [RUN]
[0m12:35:56.852185 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc
[0m12:35:56.852724 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"
[0m12:35:56.853223 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea)
[0m12:35:56.853555 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:35:56.853855 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2: BEGIN
[0m12:35:56.854121 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:35:56.854380 [info ] [Thread-3  ]: 48 of 66 START test source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [RUN]
[0m12:35:56.854697 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"
[0m12:35:56.858882 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:35:56.859201 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m12:35:56.859478 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc, now test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m12:35:56.859725 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b: BEGIN
[0m12:35:56.860002 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"
[0m12:35:56.860252 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:35:56.860653 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."products"
where price is null



  );
  
    
[0m12:35:56.865006 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:35:56.865362 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m12:35:56.865685 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:35:56.866173 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"
[0m12:35:56.871812 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_product_id"
[0m12:35:56.872096 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:35:56.872352 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_name"
    
      
    ) dbt_internal_test
[0m12:35:56.872769 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:35:56.873463 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2: COMMIT
[0m12:35:56.873728 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:35:56.873991 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_product_id" cascade
[0m12:35:56.874250 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"
[0m12:35:56.878531 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_1b1eafb1421db7bcbb7d839e23dfd63f"
[0m12:35:56.878780 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:56.879086 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.005 seconds
[0m12:35:56.881117 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2: COMMIT
[0m12:35:56.881632 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:35:56.882708 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b: ROLLBACK
[0m12:35:56.885391 [debug] [Thread-3  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_1b1eafb1421db7bcbb7d839e23dfd63f" cascade
[0m12:35:56.885722 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:56.885987 [debug] [Thread-2  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b: Close
[0m12:35:56.886711 [info ] [Thread-2  ]: 45 of 66 PASS source_not_null_ecommerce_raw_products_name ...................... [[32mPASS[0m in 0.09s]
[0m12:35:56.887123 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b
[0m12:35:56.887403 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:35:56.887667 [info ] [Thread-2  ]: 49 of 66 START test source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [RUN]
[0m12:35:56.888068 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b, now test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m12:35:56.888348 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:35:56.888620 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m12:35:56.893375 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:35:56.894719 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"
[0m12:35:56.895011 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:35:56.895253 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:35:56.896023 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_product_id"
[0m12:35:56.896609 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_1b1eafb1421db7bcbb7d839e23dfd63f"
[0m12:35:56.897197 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:35:56.897557 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:35:56.898099 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:35:56.898342 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"
[0m12:35:56.898605 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: BEGIN
[0m12:35:56.902961 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_883851ed8d3dc6f067be11941dea55a0"
[0m12:35:56.903220 [debug] [Thread-3  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: BEGIN
[0m12:35:56.903466 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2: BEGIN
[0m12:35:56.903875 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:35:56.904197 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:56.904466 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:56.904737 [debug] [Thread-2  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_883851ed8d3dc6f067be11941dea55a0" cascade
[0m12:35:56.904980 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.905226 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:35:56.905485 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:35:56.905743 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:56.906023 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"
[0m12:35:56.906285 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."products"
where product_id is null



  );
  
    
[0m12:35:56.906564 [debug] [Thread-3  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_1b1eafb1421db7bcbb7d839e23dfd63f"
  
  
    as
  
  (
    
    
    

with child as (
    select order_id as from_field
    from "dbt_db_ex2"."public"."order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "dbt_db_ex2"."public"."orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m12:35:56.906915 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_price"
    
      
    ) dbt_internal_test
[0m12:35:56.908254 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:56.909419 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2: ROLLBACK
[0m12:35:56.909953 [debug] [Thread-1  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2: Close
[0m12:35:56.910448 [info ] [Thread-1  ]: 46 of 66 PASS source_not_null_ecommerce_raw_products_price ..................... [[32mPASS[0m in 0.09s]
[0m12:35:56.910912 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2
[0m12:35:56.911224 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:35:56.911503 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.004 seconds
[0m12:35:56.911752 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:35:56.912004 [info ] [Thread-1  ]: 50 of 66 START test source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [RUN]
[0m12:35:56.912661 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: COMMIT
[0m12:35:56.913258 [debug] [Thread-3  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: COMMIT
[0m12:35:56.913558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2, now test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m12:35:56.913851 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:35:56.914125 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:35:56.914364 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:35:56.914642 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: COMMIT
[0m12:35:56.914928 [debug] [Thread-3  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: COMMIT
[0m12:35:56.920116 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:35:56.920469 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:35:56.921317 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_883851ed8d3dc6f067be11941dea55a0"
[0m12:35:56.921946 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:35:56.922203 [debug] [Thread-2  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: BEGIN
[0m12:35:56.922486 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:56.922870 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:35:56.923153 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:56.923493 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:35:56.923845 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:35:56.924147 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:56.929098 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_56cc1bf331d077fe1869291fe3950a2e"
[0m12:35:56.929416 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:35:56.929716 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:35:56.929958 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:35:56.930318 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:35:56.930561 [debug] [Thread-3  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: BEGIN
[0m12:35:56.930799 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: BEGIN
[0m12:35:56.931060 [debug] [Thread-2  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_883851ed8d3dc6f067be11941dea55a0"
  
  
    as
  
  (
    
    
    

with child as (
    select product_id as from_field
    from "dbt_db_ex2"."public"."order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "dbt_db_ex2"."public"."products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m12:35:56.931322 [debug] [Thread-1  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_56cc1bf331d077fe1869291fe3950a2e" cascade
[0m12:35:56.931634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:56.932294 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.932884 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:35:56.933373 [debug] [Thread-3  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_1b1eafb1421db7bcbb7d839e23dfd63f"
    
      
    ) dbt_internal_test
[0m12:35:56.933911 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:56.934215 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:35:56.934462 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_not_null_ecommerce_raw_products_product_id"
    
      
    ) dbt_internal_test
[0m12:35:56.934830 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:56.935929 [debug] [Thread-3  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: ROLLBACK
[0m12:35:56.936443 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:56.937473 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: ROLLBACK
[0m12:35:56.937752 [debug] [Thread-3  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: Close
[0m12:35:56.938009 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:35:56.939049 [debug] [Thread-2  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: COMMIT
[0m12:35:56.939312 [debug] [Thread-4  ]: On test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: Close
[0m12:35:56.939589 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:35:56.938438 [info ] [Thread-3  ]: 48 of 66 PASS source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [[32mPASS[0m in 0.08s]
[0m12:35:56.939963 [debug] [Thread-2  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: COMMIT
[0m12:35:56.940362 [info ] [Thread-4  ]: 47 of 66 PASS source_not_null_ecommerce_raw_products_product_id ................ [[32mPASS[0m in 0.09s]
[0m12:35:56.940788 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:35:56.941190 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:35:56.941498 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:35:56.941797 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:35:56.942302 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:56.942057 [info ] [Thread-3  ]: 51 of 66 START test source_unique_ecommerce_raw_customers_customer_id .......... [RUN]
[0m12:35:56.942622 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.011 seconds
[0m12:35:56.943269 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:35:56.942866 [info ] [Thread-4  ]: 52 of 66 START test source_unique_ecommerce_raw_customers_email ................ [RUN]
[0m12:35:56.943626 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m12:35:56.944314 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_56cc1bf331d077fe1869291fe3950a2e"
[0m12:35:56.944831 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m12:35:56.945105 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:35:56.945720 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:35:56.946048 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:35:56.951661 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:35:56.952183 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:35:56.952453 [debug] [Thread-1  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: BEGIN
[0m12:35:56.955734 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:35:56.955991 [debug] [Thread-2  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: BEGIN
[0m12:35:56.956517 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:35:56.961854 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_customer_id"
[0m12:35:56.962192 [debug] [Thread-2  ]: SQL status: BEGIN in 0.006 seconds
[0m12:35:56.962570 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:35:56.962804 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m12:35:56.963056 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:35:56.963280 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:35:56.963519 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_customer_id" cascade
[0m12:35:56.963752 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:35:56.967745 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_email"
[0m12:35:56.968010 [debug] [Thread-2  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_883851ed8d3dc6f067be11941dea55a0"
    
      
    ) dbt_internal_test
[0m12:35:56.968266 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:56.968526 [debug] [Thread-1  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_56cc1bf331d077fe1869291fe3950a2e"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex2"."public"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex2"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m12:35:56.968894 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:35:56.969285 [debug] [Thread-4  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_email" cascade
[0m12:35:56.969543 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:56.969995 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:56.970974 [debug] [Thread-2  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: ROLLBACK
[0m12:35:56.972218 [debug] [Thread-2  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: Close
[0m12:35:56.972590 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:35:56.973317 [debug] [Thread-1  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: COMMIT
[0m12:35:56.974011 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:35:56.973775 [info ] [Thread-2  ]: 49 of 66 PASS source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [[32mPASS[0m in 0.09s]
[0m12:35:56.974400 [debug] [Thread-1  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: COMMIT
[0m12:35:56.974810 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:35:56.975118 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:35:56.975376 [info ] [Thread-2  ]: 53 of 66 START test source_unique_ecommerce_raw_order_items_order_item_id ...... [RUN]
[0m12:35:56.975760 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m12:35:56.976015 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:35:56.980948 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:35:56.981286 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m12:35:56.981915 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:35:56.982421 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:35:56.982685 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:35:56.982930 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.013 seconds
[0m12:35:56.983171 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:35:56.983399 [debug] [Thread-1  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: BEGIN
[0m12:35:56.984091 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_customer_id"
[0m12:35:56.984732 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_email"
[0m12:35:56.990304 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_order_items_order_item_id"
[0m12:35:56.990878 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:35:56.991150 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:56.991562 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:35:56.991922 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:35:56.992154 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: BEGIN
[0m12:35:56.992389 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:35:56.992618 [debug] [Thread-4  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548: BEGIN
[0m12:35:56.992851 [debug] [Thread-2  ]: On test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_order_items_order_item_id" cascade
[0m12:35:56.993122 [debug] [Thread-1  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_relationships_ecommerce_56cc1bf331d077fe1869291fe3950a2e"
    
      
    ) dbt_internal_test
[0m12:35:56.993377 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:56.993650 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:56.993888 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:56.994169 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:35:56.994524 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:35:56.994843 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m12:35:56.995093 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:56.995340 [debug] [Thread-4  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m12:35:56.996436 [debug] [Thread-1  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: ROLLBACK
[0m12:35:56.997055 [debug] [Thread-1  ]: On test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: Close
[0m12:35:56.997530 [info ] [Thread-1  ]: 50 of 66 PASS source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [[32mPASS[0m in 0.08s]
[0m12:35:56.998003 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:35:56.998290 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:35:56.998587 [info ] [Thread-1  ]: 54 of 66 START test source_unique_ecommerce_raw_orders_order_id ................ [RUN]
[0m12:35:56.998955 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m12:35:56.999320 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:35:57.003445 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:35:57.003770 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:57.004085 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:35:57.004904 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: COMMIT
[0m12:35:57.005544 [debug] [Thread-4  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548: COMMIT
[0m12:35:57.005798 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:35:57.006040 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:35:57.006299 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:35:57.006537 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:35:57.006764 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: COMMIT
[0m12:35:57.007367 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_order_items_order_item_id"
[0m12:35:57.007591 [debug] [Thread-4  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548: COMMIT
[0m12:35:57.012254 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_orders_order_id"
[0m12:35:57.013912 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:35:57.014264 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:57.014692 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:35:57.014953 [debug] [Thread-2  ]: On test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: BEGIN
[0m12:35:57.015367 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:35:57.015610 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:57.015845 [debug] [Thread-1  ]: On test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_orders_order_id" cascade
[0m12:35:57.016478 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:35:57.016772 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.017016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:57.017346 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:35:57.017626 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:35:57.017991 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:35:57.018240 [debug] [Thread-2  ]: On test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_order_items_order_item_id"
  
  
    as
  
  (
    
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



  );
  
    
[0m12:35:57.018531 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: BEGIN
[0m12:35:57.018786 [debug] [Thread-4  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548: BEGIN
[0m12:35:57.019386 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:35:57.019632 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:35:57.019868 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.020112 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:35:57.020368 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:35:57.020660 [debug] [Thread-4  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_customers_email"
    
      
    ) dbt_internal_test
[0m12:35:57.021046 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.000 seconds
[0m12:35:57.021979 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: ROLLBACK
[0m12:35:57.022263 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:57.022519 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:35:57.023291 [debug] [Thread-4  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548: ROLLBACK
[0m12:35:57.023517 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: Close
[0m12:35:57.024113 [debug] [Thread-2  ]: On test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: COMMIT
[0m12:35:57.024583 [info ] [Thread-3  ]: 51 of 66 PASS source_unique_ecommerce_raw_customers_customer_id ................ [[32mPASS[0m in 0.08s]
[0m12:35:57.025259 [debug] [Thread-4  ]: On test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548: Close
[0m12:35:57.025930 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:35:57.026559 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:35:57.027002 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:35:57.027647 [debug] [Thread-2  ]: On test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: COMMIT
[0m12:35:57.027437 [info ] [Thread-4  ]: 52 of 66 PASS source_unique_ecommerce_raw_customers_email ...................... [[32mPASS[0m in 0.08s]
[0m12:35:57.028432 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_orders_order_id"
[0m12:35:57.028718 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:35:57.029119 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:35:57.029644 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:35:57.030147 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:35:57.030728 [debug] [Thread-4  ]: Began running node test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927
[0m12:35:57.029931 [info ] [Thread-3  ]: 55 of 66 START test source_unique_ecommerce_raw_products_product_id ............ [RUN]
[0m12:35:57.031118 [debug] [Thread-1  ]: On test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: BEGIN
[0m12:35:57.031557 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:35:57.032084 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m12:35:57.031825 [info ] [Thread-4  ]: 56 of 66 START test test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01  [RUN]
[0m12:35:57.032485 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:35:57.032771 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548, now test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927)
[0m12:35:57.033046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.036630 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:35:57.036936 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927
[0m12:35:57.037189 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:35:57.037466 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:35:57.042250 [debug] [Thread-1  ]: On test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m12:35:57.042692 [debug] [Thread-2  ]: On test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: BEGIN
[0m12:35:57.045274 [debug] [Thread-4  ]: Compilation Error in test test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01 (models/core/schema.yml)
  'test_test_date_in_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.045625 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:35:57.045886 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:35:57.046117 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.050804 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_products_product_id"
[0m12:35:57.046436 [error] [Thread-4  ]: 56 of 66 ERROR test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01  [[31mERROR[0m in 0.01s]
[0m12:35:57.051537 [debug] [Thread-1  ]: On test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: COMMIT
[0m12:35:57.051846 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:35:57.052311 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:35:57.052770 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927
[0m12:35:57.053027 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:35:57.053419 [debug] [Thread-2  ]: On test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m12:35:57.053698 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_products_product_id" cascade
[0m12:35:57.053971 [debug] [Thread-4  ]: Began running node test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31
[0m12:35:57.054245 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927' to be skipped because of status 'error'.  Reason: Compilation Error in test test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01 (models/core/schema.yml)
  'test_test_date_in_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:57.054474 [debug] [Thread-1  ]: On test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: COMMIT
[0m12:35:57.054730 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:57.054989 [info ] [Thread-4  ]: 57 of 66 START test test_not_negative_dim_customers_lifetime_orders ............ [RUN]
[0m12:35:57.055367 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:57.055737 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927, now test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31)
[0m12:35:57.056713 [debug] [Thread-2  ]: On test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: ROLLBACK
[0m12:35:57.056991 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:35:57.057237 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31
[0m12:35:57.057691 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:35:57.057932 [debug] [Thread-2  ]: On test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: Close
[0m12:35:57.104324 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.050 seconds
[0m12:35:57.107259 [debug] [Thread-4  ]: Compilation Error in test test_not_negative_dim_customers_lifetime_orders (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.107814 [info ] [Thread-2  ]: 53 of 66 PASS source_unique_ecommerce_raw_order_items_order_item_id ............ [[32mPASS[0m in 0.13s]
[0m12:35:57.108565 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_products_product_id"
[0m12:35:57.109182 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:35:57.108918 [error] [Thread-4  ]: 57 of 66 ERROR test_not_negative_dim_customers_lifetime_orders ................. [[31mERROR[0m in 0.05s]
[0m12:35:57.109606 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:35:57.110088 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:35:57.110331 [debug] [Thread-1  ]: On test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: BEGIN
[0m12:35:57.110632 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31
[0m12:35:57.110883 [debug] [Thread-2  ]: Began running node test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4
[0m12:35:57.111155 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: BEGIN
[0m12:35:57.111434 [debug] [Thread-4  ]: Began running node test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42
[0m12:35:57.111762 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_dim_customers_lifetime_orders (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:57.112019 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.112256 [info ] [Thread-2  ]: 58 of 66 START test test_not_negative_dim_products_price ....................... [RUN]
[0m12:35:57.112718 [info ] [Thread-4  ]: 59 of 66 START test test_not_negative_dim_products_total_quantity_sold ......... [RUN]
[0m12:35:57.113115 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:35:57.113369 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.113682 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559, now test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4)
[0m12:35:57.113960 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31, now test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42)
[0m12:35:57.114219 [debug] [Thread-1  ]: On test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:35:57.114469 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:35:57.114707 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4
[0m12:35:57.114946 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42
[0m12:35:57.115226 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m12:35:57.119854 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m12:35:57.124483 [debug] [Thread-1  ]: On test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: ROLLBACK
[0m12:35:57.126970 [debug] [Thread-2  ]: Compilation Error in test test_not_negative_dim_products_price (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.127658 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.004 seconds
[0m12:35:57.128288 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: COMMIT
[0m12:35:57.128543 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:35:57.128770 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: COMMIT
[0m12:35:57.129006 [debug] [Thread-1  ]: On test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: Close
[0m12:35:57.127357 [error] [Thread-2  ]: 58 of 66 ERROR test_not_negative_dim_products_price ............................ [[31mERROR[0m in 0.01s]
[0m12:35:57.129495 [info ] [Thread-1  ]: 54 of 66 PASS source_unique_ecommerce_raw_orders_order_id ...................... [[32mPASS[0m in 0.13s]
[0m12:35:57.129825 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4
[0m12:35:57.130185 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:35:57.132482 [debug] [Thread-4  ]: Compilation Error in test test_not_negative_dim_products_total_quantity_sold (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.132819 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m12:35:57.133123 [debug] [Thread-2  ]: Began running node test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c
[0m12:35:57.133399 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_dim_products_price (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:57.133655 [debug] [Thread-1  ]: Began running node test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9
[0m12:35:57.134062 [error] [Thread-4  ]: 59 of 66 ERROR test_not_negative_dim_products_total_quantity_sold .............. [[31mERROR[0m in 0.02s]
[0m12:35:57.134510 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:35:57.134770 [info ] [Thread-2  ]: 60 of 66 START test test_not_negative_dim_products_total_revenue ............... [RUN]
[0m12:35:57.135120 [info ] [Thread-1  ]: 61 of 66 START test test_not_negative_fct_orders_total_amount .................. [RUN]
[0m12:35:57.135452 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42
[0m12:35:57.135780 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4, now test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c)
[0m12:35:57.136048 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65, now test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9)
[0m12:35:57.136323 [debug] [Thread-4  ]: Began running node test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd
[0m12:35:57.136584 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c
[0m12:35:57.136876 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9
[0m12:35:57.137137 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:35:57.137590 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_dim_products_total_quantity_sold (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:57.137380 [info ] [Thread-4  ]: 62 of 66 START test test_not_negative_fct_orders_total_items ................... [RUN]
[0m12:35:57.146340 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: BEGIN
[0m12:35:57.148740 [debug] [Thread-2  ]: Compilation Error in test test_not_negative_dim_products_total_revenue (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.150389 [debug] [Thread-1  ]: Compilation Error in test test_not_negative_fct_orders_total_amount (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.150728 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42, now test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd)
[0m12:35:57.151119 [error] [Thread-2  ]: 60 of 66 ERROR test_not_negative_dim_products_total_revenue .................... [[31mERROR[0m in 0.02s]
[0m12:35:57.151487 [error] [Thread-1  ]: 61 of 66 ERROR test_not_negative_fct_orders_total_amount ....................... [[31mERROR[0m in 0.02s]
[0m12:35:57.151762 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd
[0m12:35:57.151994 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.152276 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c
[0m12:35:57.152545 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9
[0m12:35:57.156049 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:35:57.157852 [debug] [Thread-4  ]: Compilation Error in test test_not_negative_fct_orders_total_items (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.158367 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:35:57.158975 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:35:57.159280 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_dim_products_total_revenue (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:57.159559 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."source_unique_ecommerce_raw_products_product_id"
    
      
    ) dbt_internal_test
[0m12:35:57.159878 [error] [Thread-4  ]: 62 of 66 ERROR test_not_negative_fct_orders_total_items ........................ [[31mERROR[0m in 0.01s]
[0m12:35:57.160181 [info ] [Thread-2  ]: 63 of 66 START test unique_dim_customers_customer_id ........................... [RUN]
[0m12:35:57.160431 [info ] [Thread-1  ]: 64 of 66 START test unique_dim_customers_email ................................. [RUN]
[0m12:35:57.160739 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_fct_orders_total_amount (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:57.161070 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd
[0m12:35:57.161342 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:35:57.161579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:35:57.161868 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:35:57.162085 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:35:57.162315 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_fct_orders_total_items (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:35:57.162534 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:35:57.162750 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:57.162964 [info ] [Thread-4  ]: 65 of 66 START test unique_dim_products_product_id ............................. [RUN]
[0m12:35:57.166566 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:35:57.169868 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:35:57.170777 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: ROLLBACK
[0m12:35:57.171051 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:35:57.171455 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:35:57.175106 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:35:57.175526 [debug] [Thread-3  ]: On test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: Close
[0m12:35:57.175940 [info ] [Thread-3  ]: 55 of 66 PASS source_unique_ecommerce_raw_products_product_id .................. [[32mPASS[0m in 0.14s]
[0m12:35:57.176285 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:35:57.176527 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:35:57.176751 [info ] [Thread-3  ]: 66 of 66 START test unique_fct_orders_order_id ................................. [RUN]
[0m12:35:57.178085 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:35:57.178309 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:35:57.181492 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:35:57.181867 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:35:57.182138 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:35:57.186800 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:35:57.187132 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:35:57.192483 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:35:57.192798 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:35:57.193225 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:35:57.202082 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:35:57.202958 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:35:57.213563 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:35:57.214180 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m12:35:57.214728 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:35:57.215017 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m12:35:57.215585 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:35:57.215848 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:35:57.216097 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m12:35:57.216330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:57.216566 [debug] [Thread-3  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m12:35:57.216923 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:35:57.217357 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:35:57.238651 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.022 seconds
[0m12:35:57.239395 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.023 seconds
[0m12:35:57.239701 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.022 seconds
[0m12:35:57.239968 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.023 seconds
[0m12:35:57.240991 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:35:57.241708 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:35:57.242792 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:35:57.243468 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:35:57.244012 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:35:57.244475 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:35:57.244901 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:35:57.245320 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:35:57.245598 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:35:57.246014 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:35:57.246308 [debug] [Thread-3  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:35:57.246917 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:35:57.248076 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.248548 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.248965 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:35:57.249451 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:57.249893 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m12:35:57.250125 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:35:57.250389 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m12:35:57.250650 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:35:57.250884 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:35:57.251132 [debug] [Thread-3  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m12:35:57.251469 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m12:35:57.251894 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m12:35:57.259985 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:57.260434 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:57.262307 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.011 seconds
[0m12:35:57.261760 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:35:57.263432 [debug] [Thread-3  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:35:57.264063 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:35:57.260697 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:35:57.264353 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:35:57.264598 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:35:57.264920 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:35:57.266370 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:35:57.266882 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:35:57.267152 [debug] [Thread-3  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:35:57.267499 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:35:57.268211 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:35:57.269439 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:35:57.271794 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m12:35:57.273160 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:35:57.274334 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m12:35:57.275035 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:35:57.275429 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m12:35:57.276003 [debug] [Thread-3  ]: SQL status: COMMIT in 0.007 seconds
[0m12:35:57.277488 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:35:57.278473 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:35:57.279176 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:35:57.279758 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:35:57.280697 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:35:57.281175 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:35:57.281794 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:35:57.282081 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:35:57.282926 [debug] [Thread-3  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:35:57.283744 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:35:57.284103 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:57.284614 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:35:57.284881 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:35:57.285304 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:35:57.285589 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:35:57.285841 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:35:57.286605 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:35:57.286870 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m12:35:57.287231 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m12:35:57.288559 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m12:35:57.289070 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:35:57.289490 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:35:57.289758 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:35:57.292372 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m12:35:57.293184 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m12:35:57.293623 [debug] [Thread-3  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:35:57.294414 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:35:57.295210 [info ] [Thread-2  ]: 63 of 66 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.13s]
[0m12:35:57.295800 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:35:57.296724 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:35:57.298327 [info ] [Thread-4  ]: 65 of 66 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.13s]
[0m12:35:57.299009 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:35:57.299406 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:35:57.299856 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:35:57.300991 [debug] [Thread-3  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m12:35:57.302623 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m12:35:57.303741 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: Close
[0m12:35:57.304050 [debug] [Thread-3  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m12:35:57.304616 [info ] [Thread-1  ]: 64 of 66 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.14s]
[0m12:35:57.305015 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:35:57.305587 [info ] [Thread-3  ]: 66 of 66 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.13s]
[0m12:35:57.306159 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:35:57.308511 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:57.308816 [debug] [MainThread]: On master: BEGIN
[0m12:35:57.309009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:35:57.320573 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:35:57.321296 [debug] [MainThread]: On master: COMMIT
[0m12:35:57.321573 [debug] [MainThread]: Using postgres connection "master"
[0m12:35:57.321784 [debug] [MainThread]: On master: COMMIT
[0m12:35:57.322763 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:35:57.323081 [debug] [MainThread]: On master: Close
[0m12:35:57.323435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:57.323668 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m12:35:57.323863 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m12:35:57.324048 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m12:35:57.324226 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m12:35:57.324530 [info ] [MainThread]: 
[0m12:35:57.325012 [info ] [MainThread]: Finished running 66 data tests in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m12:35:57.332091 [debug] [MainThread]: Command end result
[0m12:35:57.376646 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:35:57.377825 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:35:57.383716 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:35:57.383974 [info ] [MainThread]: 
[0m12:35:57.384223 [info ] [MainThread]: [31mCompleted with 13 errors, 0 partial successes, and 0 warnings:[0m
[0m12:35:57.384426 [info ] [MainThread]: 
[0m12:35:57.384668 [error] [MainThread]: [31mFailure in test assert_no_duplicate_orders (tests/assert_no_duplicate_orders.sql)[0m
[0m12:35:57.384901 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m12:35:57.385141 [info ] [MainThread]: 
[0m12:35:57.385366 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/tests/assert_no_duplicate_orders.sql
[0m12:35:57.385551 [info ] [MainThread]: 
[0m12:35:57.385770 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  --------------------------------------------------------------------------------
[0m12:35:57.385967 [info ] [MainThread]: 
[0m12:35:57.386197 [error] [MainThread]:   Compilation Error in test dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d (models/sources/source.yml)
  'dict object' has no attribute 'test_is_date'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.386391 [info ] [MainThread]: 
[0m12:35:57.386625 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True (models/core/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than_or_equal_to'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.386822 [info ] [MainThread]: 
[0m12:35:57.387045 [error] [MainThread]:   Compilation Error in test assert_total_amount_equals_sum_of_items_fct_orders_ (models/core/schema.yml)
  'test_assert_total_amount_equals_sum_of_items' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.387235 [info ] [MainThread]: 
[0m12:35:57.387467 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp (models/core/schema.yml)[0m
[0m12:35:57.387693 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:35:57.387861 [info ] [MainThread]: 
[0m12:35:57.388076 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/models/core/schema.yml/dbt_expectations_expect_column_0d21460a155f0cff109b3eca59430181.sql
[0m12:35:57.388269 [info ] [MainThread]: 
[0m12:35:57.388730 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_0d21460a155f0cff109b3eca59430181"
  ---------------------------------------------------------------------------------------------------------------------
[0m12:35:57.388935 [info ] [MainThread]: 
[0m12:35:57.389168 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp (models/core/schema.yml)[0m
[0m12:35:57.389542 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m12:35:57.389730 [info ] [MainThread]: 
[0m12:35:57.389955 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/models/core/schema.yml/dbt_expectations_expect_column_e42e386f1f5fcb00fca61dbc25a22a13.sql
[0m12:35:57.390128 [info ] [MainThread]: 
[0m12:35:57.390340 [info ] [MainThread]:   See test failures:
  ---------------------------------------------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_e42e386f1f5fcb00fca61dbc25a22a13"
  ---------------------------------------------------------------------------------------------------------------------
[0m12:35:57.390526 [info ] [MainThread]: 
[0m12:35:57.390744 [error] [MainThread]:   Compilation Error in test test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01 (models/core/schema.yml)
  'test_test_date_in_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.390926 [info ] [MainThread]: 
[0m12:35:57.391138 [error] [MainThread]:   Compilation Error in test test_not_negative_dim_customers_lifetime_orders (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.391317 [info ] [MainThread]: 
[0m12:35:57.391541 [error] [MainThread]:   Compilation Error in test test_not_negative_dim_products_price (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.391725 [info ] [MainThread]: 
[0m12:35:57.391936 [error] [MainThread]:   Compilation Error in test test_not_negative_dim_products_total_quantity_sold (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.392120 [info ] [MainThread]: 
[0m12:35:57.392333 [error] [MainThread]:   Compilation Error in test test_not_negative_dim_products_total_revenue (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.392513 [info ] [MainThread]: 
[0m12:35:57.392725 [error] [MainThread]:   Compilation Error in test test_not_negative_fct_orders_total_amount (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.392905 [info ] [MainThread]: 
[0m12:35:57.393124 [error] [MainThread]:   Compilation Error in test test_not_negative_fct_orders_total_items (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:35:57.393371 [info ] [MainThread]: 
[0m12:35:57.393758 [info ] [MainThread]: Done. PASS=53 WARN=0 ERROR=13 SKIP=0 TOTAL=66
[0m12:35:57.395463 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.5473914, "process_in_blocks": "0", "process_kernel_time": 0.38026, "process_mem_max_rss": "140443648", "process_out_blocks": "0", "process_user_time": 4.796783}
[0m12:35:57.395794 [debug] [MainThread]: Command `dbt test` failed at 12:35:57.395743 after 4.55 seconds
[0m12:35:57.396044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d02730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf9220>]}
[0m12:35:57.396295 [debug] [MainThread]: Flushing usage events
[0m12:35:58.631759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:13.161667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108502280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085020a0>]}


============================== 12:36:13.164724 | e977b6bd-aad8-44d2-8e04-35f82fe7eaef ==============================
[0m12:36:13.164724 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:36:13.165259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m12:36:13.306900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e977b6bd-aad8-44d2-8e04-35f82fe7eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088618b0>]}
[0m12:36:13.354044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e977b6bd-aad8-44d2-8e04-35f82fe7eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108824ca0>]}
[0m12:36:13.355409 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:36:13.443148 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:36:13.613486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:36:13.613787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:36:13.620198 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:36:13.659326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e977b6bd-aad8-44d2-8e04-35f82fe7eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10935f130>]}
[0m12:36:13.674458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e977b6bd-aad8-44d2-8e04-35f82fe7eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa9310>]}
[0m12:36:13.674850 [info ] [MainThread]: Found 7 models, 66 data tests, 4 sources, 810 macros
[0m12:36:13.675079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e977b6bd-aad8-44d2-8e04-35f82fe7eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa9280>]}
[0m12:36:13.677756 [info ] [MainThread]: 
[0m12:36:13.677994 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:36:13.678190 [info ] [MainThread]: 
[0m12:36:13.678497 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:36:13.684997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:36:13.685563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:36:13.724436 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:36:13.724784 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:36:13.725013 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:36:13.725271 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:36:13.725615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:13.725991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:13.765911 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m12:36:13.766310 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m12:36:13.766568 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:36:13.766835 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:36:13.767129 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:36:13.767418 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:36:13.774538 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m12:36:13.774863 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.007 seconds
[0m12:36:13.775906 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:36:13.777463 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:36:13.777971 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:36:13.778196 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:36:13.791603 [debug] [MainThread]: Using postgres connection "master"
[0m12:36:13.792180 [debug] [MainThread]: On master: BEGIN
[0m12:36:13.792482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:36:13.800877 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:36:13.801211 [debug] [MainThread]: Using postgres connection "master"
[0m12:36:13.801485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:36:13.841337 [debug] [MainThread]: SQL status: SELECT 4 in 0.040 seconds
[0m12:36:13.842875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e977b6bd-aad8-44d2-8e04-35f82fe7eaef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa9af0>]}
[0m12:36:13.843221 [debug] [MainThread]: On master: ROLLBACK
[0m12:36:13.843748 [debug] [MainThread]: On master: Close
[0m12:36:13.848256 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:36:13.848600 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:36:13.848898 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:36:13.849155 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:36:13.849472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_customers)
[0m12:36:13.849768 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_order_items)
[0m12:36:13.850106 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:36:13.850427 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:36:13.850690 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:36:13.850942 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:36:13.851233 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:36:13.851535 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:36:13.860058 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:36:13.861936 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:36:13.864642 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:36:13.867322 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:36:13.867994 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:36:13.868240 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:36:13.868677 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:36:13.868889 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:36:13.869107 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:36:13.869496 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:36:13.869753 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8
[0m12:36:13.870192 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:36:13.870587 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:36:13.870840 [debug] [Thread-3  ]: Began running node test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07
[0m12:36:13.871139 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8)
[0m12:36:13.871454 [debug] [Thread-4  ]: Began running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2
[0m12:36:13.871747 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f
[0m12:36:13.872113 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07)
[0m12:36:13.872460 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8
[0m12:36:13.872841 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2)
[0m12:36:13.873104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f)
[0m12:36:13.873350 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07
[0m12:36:13.879177 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2
[0m12:36:13.880304 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f
[0m12:36:13.891578 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07"
[0m12:36:13.900790 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2"
[0m12:36:13.904762 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f"
[0m12:36:13.905349 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2
[0m12:36:13.905683 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07
[0m12:36:13.906258 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2
[0m12:36:13.906566 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f
[0m12:36:13.907112 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07
[0m12:36:13.909324 [debug] [Thread-4  ]: Began running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890
[0m12:36:13.909821 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f
[0m12:36:13.910153 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc
[0m12:36:13.910509 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_quantity___0.84cbae91d2, now test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890)
[0m12:36:13.912189 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d
[0m12:36:13.912529 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_source_expect_column_values_to_match_regex_ecommerce_raw_customers_email___a_zA_Z0_9___a_zA_Z0_9_a_zA_Z_2_.c5460f0e07, now test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc)
[0m12:36:13.912857 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890
[0m12:36:13.913194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_order_items_unit_price___0.42202df36f, now test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d)
[0m12:36:13.913479 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc
[0m12:36:13.918061 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890"
[0m12:36:13.919697 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d
[0m12:36:13.926707 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc"
[0m12:36:13.931956 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d"
[0m12:36:13.932383 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890
[0m12:36:13.932870 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890
[0m12:36:13.933143 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:36:13.933722 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_utils_source_expression_is_true_ecommerce_raw_products_price___0.247f2f4890, now test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m12:36:13.933995 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d
[0m12:36:13.934234 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:36:13.934457 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc
[0m12:36:13.934897 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d
[0m12:36:13.940375 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:36:13.940941 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc
[0m12:36:13.941203 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d
[0m12:36:13.941559 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381
[0m12:36:13.941886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_accepted_values_ecommerce_raw_products_category__Electronics__Clothing__Footwear__Accessories.33e5ac2c7d, now test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d)
[0m12:36:13.942182 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_accepted_values_ecommerce_raw_orders_status__completed__processing__cancelled__refunded.6eeef283fc, now test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381)
[0m12:36:13.942463 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d
[0m12:36:13.942714 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:36:13.942936 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381
[0m12:36:13.948949 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d"
[0m12:36:13.949394 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:36:13.949820 [debug] [Thread-2  ]: Compilation Error in test dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d (models/sources/source.yml)
  'dict object' has no attribute 'test_is_date'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:36:13.953062 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381"
[0m12:36:13.953430 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181
[0m12:36:13.953831 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8
[0m12:36:13.954171 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181)
[0m12:36:13.954428 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d
[0m12:36:13.954715 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:36:13.954978 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d (models/sources/source.yml)
  'dict object' has no attribute 'test_is_date'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:36:13.955244 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181
[0m12:36:13.955482 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381
[0m12:36:13.955858 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d
[0m12:36:13.956111 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d.d2546648c8, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0)
[0m12:36:13.959341 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181"
[0m12:36:13.959755 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381
[0m12:36:13.960004 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b
[0m12:36:13.960267 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:36:13.960557 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564
[0m12:36:13.960849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_customers_email.ccc3c07b4d, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b)
[0m12:36:13.963961 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:36:13.964235 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_customers_name.152d42c381, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564)
[0m12:36:13.964469 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181
[0m12:36:13.964701 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b
[0m12:36:13.964970 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564
[0m12:36:13.965457 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181
[0m12:36:13.969391 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b"
[0m12:36:13.972529 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564"
[0m12:36:13.972810 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:36:13.973201 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59
[0m12:36:13.973762 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:36:13.977166 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_id.0bbf574181, now test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59)
[0m12:36:13.977426 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b
[0m12:36:13.977644 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564
[0m12:36:13.977876 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8
[0m12:36:13.978136 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59
[0m12:36:13.978588 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b
[0m12:36:13.979028 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564
[0m12:36:13.979286 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8)
[0m12:36:13.982782 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59"
[0m12:36:13.983099 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67
[0m12:36:13.983405 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:36:13.983667 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8
[0m12:36:13.983995 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_product_id.6a0cc8ec7b, now test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67)
[0m12:36:13.984263 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_quantity.a9287d7564, now test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf)
[0m12:36:13.987581 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8"
[0m12:36:13.987853 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67
[0m12:36:13.988097 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59
[0m12:36:13.988315 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:36:13.991488 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67"
[0m12:36:13.992030 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59
[0m12:36:13.996590 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:36:13.996919 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8
[0m12:36:13.997247 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc
[0m12:36:13.997799 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8
[0m12:36:13.998080 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_order_items_unit_price.5723510e59, now test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc)
[0m12:36:13.998378 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b
[0m12:36:13.998627 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:36:13.998864 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67
[0m12:36:13.999076 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc
[0m12:36:13.999322 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_orders_customer_id.2c23176ba8, now test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b)
[0m12:36:13.999711 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:36:14.000080 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67
[0m12:36:14.003273 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc"
[0m12:36:14.003532 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b
[0m12:36:14.003785 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2
[0m12:36:14.004052 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:36:14.007528 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b"
[0m12:36:14.007901 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2)
[0m12:36:14.008185 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_orders_order_date.f924c09d67, now test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea)
[0m12:36:14.008441 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc
[0m12:36:14.008721 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2
[0m12:36:14.008960 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:36:14.009398 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc
[0m12:36:14.012900 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2"
[0m12:36:14.017625 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:36:14.018072 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b
[0m12:36:14.018388 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:36:14.019092 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b
[0m12:36:14.019441 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_orders_status.e01b9717fc, now test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m12:36:14.019719 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2
[0m12:36:14.019980 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:36:14.020207 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:36:14.020463 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:36:14.020858 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2
[0m12:36:14.021106 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_products_name.c19bff309b, now test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m12:36:14.021514 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:36:14.027598 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:36:14.027907 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:36:14.028197 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:36:14.028462 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:36:14.028802 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_products_price.5aad2a90c2, now test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m12:36:14.033266 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:36:14.033680 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m12:36:14.033979 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:36:14.034214 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:36:14.034559 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:36:14.038695 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:36:14.038943 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:36:14.039368 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:36:14.044542 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:36:14.045062 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:36:14.045378 [debug] [Thread-4  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:36:14.045878 [debug] [Thread-2  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:36:14.046173 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m12:36:14.046422 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:36:14.046701 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m12:36:14.046942 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:36:14.047163 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:36:14.047543 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:36:14.047765 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:36:14.048127 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:36:14.051234 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:36:14.051500 [debug] [Thread-3  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:36:14.054507 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:36:14.054773 [debug] [Thread-1  ]: Began running node test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:36:14.055096 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m12:36:14.055419 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m12:36:14.055719 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:36:14.055967 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:36:14.056185 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:36:14.056409 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:36:14.059756 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:36:14.060236 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:36:14.060622 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:36:14.064488 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:36:14.064823 [debug] [Thread-4  ]: Began running node model.ecommerce_test.fct_orders
[0m12:36:14.065074 [debug] [Thread-2  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:36:14.065447 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_customers_email.10ef1ae548, now model.ecommerce_test.fct_orders)
[0m12:36:14.065741 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:36:14.065980 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559, now test.ecommerce_test.assert_no_duplicate_orders)
[0m12:36:14.066238 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:36:14.066459 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:36:14.066834 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:36:14.067052 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:36:14.070013 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:36:14.070503 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:36:14.070760 [debug] [Thread-3  ]: Began running node model.ecommerce_test.dim_products
[0m12:36:14.073962 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:36:14.074344 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_customers
[0m12:36:14.074683 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65, now model.ecommerce_test.dim_products)
[0m12:36:14.075002 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9, now model.ecommerce_test.dim_customers)
[0m12:36:14.075310 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:36:14.075600 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:36:14.075850 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:36:14.076075 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:36:14.079166 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:36:14.082059 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:36:14.082522 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:36:14.082939 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:36:14.083373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:14.083642 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_customers' was properly closed.
[0m12:36:14.083892 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.dim_products
[0m12:36:14.084104 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:36:14.084282 [debug] [MainThread]: Connection 'test.ecommerce_test.assert_no_duplicate_orders' was properly closed.
[0m12:36:14.084535 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_products' was properly closed.
[0m12:36:14.084711 [debug] [MainThread]: Connection 'model.ecommerce_test.fct_orders' was properly closed.
[0m12:36:14.084994 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_date_source_is_date_ecommerce_raw_orders_order_date___Y_m_d (models/sources/source.yml)
    'dict object' has no attribute 'test_is_date'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:36:14.085588 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.dim_products
[0m12:36:14.085970 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:36:14.087558 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.9794632, "process_in_blocks": "0", "process_kernel_time": 0.195949, "process_mem_max_rss": "126828544", "process_out_blocks": "0", "process_user_time": 1.608282}
[0m12:36:14.087959 [debug] [MainThread]: Command `dbt docs generate` failed at 12:36:14.087895 after 0.98 seconds
[0m12:36:14.088239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10975d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c9d30>]}
[0m12:36:14.088537 [debug] [MainThread]: Flushing usage events
[0m12:36:15.154963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:37.329465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084887f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972bd60>]}


============================== 12:36:37.332607 | 6010f82d-6215-45e3-b9c7-f1621b32f232 ==============================
[0m12:36:37.332607 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:36:37.333003 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:36:37.485875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6010f82d-6215-45e3-b9c7-f1621b32f232', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac9550>]}
[0m12:36:37.532463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6010f82d-6215-45e3-b9c7-f1621b32f232', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a23c070>]}
[0m12:36:37.533274 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:36:37.621500 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:36:37.792804 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m12:36:38.219917 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecommerce_test.stg_customers' (models/staging/stg_customers.sql) depends on a source named 'ecommerce_raw.customers' which was not found
[0m12:36:38.221079 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.9449761, "process_in_blocks": "0", "process_kernel_time": 0.166347, "process_mem_max_rss": "122503168", "process_out_blocks": "0", "process_user_time": 1.647068}
[0m12:36:38.221367 [debug] [MainThread]: Command `dbt docs generate` failed at 12:36:38.221315 after 0.95 seconds
[0m12:36:38.221604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084887f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1567c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2e0b20>]}
[0m12:36:38.221844 [debug] [MainThread]: Flushing usage events
[0m12:36:39.254108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:02.540825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712b280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712b0a0>]}


============================== 12:37:02.544105 | ae281493-a0db-428f-8c6f-e5bd21118af5 ==============================
[0m12:37:02.544105 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:37:02.544521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m12:37:02.695246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae281493-a0db-428f-8c6f-e5bd21118af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f89580>]}
[0m12:37:02.743116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae281493-a0db-428f-8c6f-e5bd21118af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063943d0>]}
[0m12:37:02.744647 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:37:02.834546 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:37:03.004335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:03.005386 [debug] [MainThread]: Partial parsing: updated file: ecommerce_test://models/sources/source.yml
[0m12:37:03.538656 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:37:03.548274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae281493-a0db-428f-8c6f-e5bd21118af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188c9130>]}
[0m12:37:03.563923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae281493-a0db-428f-8c6f-e5bd21118af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118385910>]}
[0m12:37:03.564376 [info ] [MainThread]: Found 7 models, 36 data tests, 4 sources, 810 macros
[0m12:37:03.564646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae281493-a0db-428f-8c6f-e5bd21118af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118385970>]}
[0m12:37:03.566449 [info ] [MainThread]: 
[0m12:37:03.566841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:03.567207 [info ] [MainThread]: 
[0m12:37:03.579942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:37:03.647010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:37:03.647619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:37:03.730292 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:37:03.730622 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:37:03.730891 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:37:03.731115 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:37:03.731352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:03.731551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:03.767419 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m12:37:03.767761 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m12:37:03.768032 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:37:03.768266 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:37:03.768513 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:37:03.768780 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:37:03.776033 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m12:37:03.777242 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:37:03.777510 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.008 seconds
[0m12:37:03.779222 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:37:03.779481 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:37:03.779735 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:37:03.792091 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:03.792386 [debug] [MainThread]: On master: BEGIN
[0m12:37:03.792600 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:03.800438 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:37:03.800750 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:03.801034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:03.844608 [debug] [MainThread]: SQL status: SELECT 4 in 0.043 seconds
[0m12:37:03.846407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae281493-a0db-428f-8c6f-e5bd21118af5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118637af0>]}
[0m12:37:03.846805 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:03.847438 [debug] [MainThread]: On master: Close
[0m12:37:03.849807 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:37:03.850306 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:37:03.850628 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:37:03.851100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m12:37:03.851400 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:37:03.851727 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m12:37:03.852120 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:37:03.852430 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:37:03.852798 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:37:03.853088 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:37:03.853366 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:37:03.860966 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:37:03.861250 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:37:03.864441 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:37:03.868736 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:37:03.871654 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:37:03.872342 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:37:03.872933 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:37:03.873193 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:37:03.873484 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:37:03.873910 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:37:03.874138 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:37:03.874584 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:37:03.875133 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:37:03.875387 [debug] [Thread-2  ]: Began running node model.ecommerce_test.fct_orders
[0m12:37:03.875636 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:37:03.875984 [debug] [Thread-4  ]: Began running node model.ecommerce_test.dim_products
[0m12:37:03.876227 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.fct_orders)
[0m12:37:03.876489 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_customers
[0m12:37:03.876790 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now test.ecommerce_test.assert_no_duplicate_orders)
[0m12:37:03.877058 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.dim_products)
[0m12:37:03.877307 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:37:03.877563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.dim_customers)
[0m12:37:03.877795 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:37:03.878014 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:37:03.881070 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:37:03.881327 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:37:03.884137 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:37:03.887853 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:37:03.891017 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:37:03.891544 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:37:03.891979 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:37:03.892289 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.dim_products
[0m12:37:03.892821 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.dim_products
[0m12:37:03.893138 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:37:03.893556 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:37:03.893804 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.fct_orders, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:37:03.894044 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:37:03.894439 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:37:03.894651 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:37:03.894882 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:37:03.895124 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_products, now test.ecommerce_test.assert_total_amount_equals_sum_of_items)
[0m12:37:03.895363 [debug] [Thread-1  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57
[0m12:37:03.895894 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:37:03.899197 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:37:03.899455 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:37:03.899720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_customers, now test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57)
[0m12:37:03.899970 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:37:03.902679 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:37:03.902994 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57
[0m12:37:03.903325 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:37:03.903674 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:37:03.906860 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:37:03.907326 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:37:03.907538 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:37:03.916173 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:37:03.918749 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:37:03.919231 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:37:03.919610 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:37:03.919957 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:37:03.920240 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:37:03.921791 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:37:03.922084 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:37:03.926666 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:37:03.927105 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:37:03.927386 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:37:03.928725 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:37:03.932116 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:37:03.933185 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:37:03.933487 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:37:03.934025 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:37:03.934296 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:37:03.934780 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:37:03.935022 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:37:03.938204 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:37:03.938692 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:37:03.939413 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:37:03.939769 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:37:03.940085 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:37:03.940318 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:37:03.940570 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:37:03.944686 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:37:03.947352 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:37:03.947636 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:37:03.948045 [debug] [Thread-1  ]: Compilation Error in test assert_total_amount_equals_sum_of_items_fct_orders_ (models/core/schema.yml)
  'test_assert_total_amount_equals_sum_of_items' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:03.948345 [debug] [Thread-3  ]: Began running node test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927
[0m12:37:03.951502 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:37:03.951884 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57
[0m12:37:03.952182 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927)
[0m12:37:03.952410 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:37:03.952733 [debug] [Thread-1  ]: Began running node test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9
[0m12:37:03.953017 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57' to be skipped because of status 'error'.  Reason: Compilation Error in test assert_total_amount_equals_sum_of_items_fct_orders_ (models/core/schema.yml)
  'test_assert_total_amount_equals_sum_of_items' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:37:03.953276 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927
[0m12:37:03.953692 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:37:03.953931 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items_fct_orders_.c3ae366a57, now test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9)
[0m12:37:03.954153 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:37:03.957715 [debug] [Thread-2  ]: Began running node test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd
[0m12:37:03.958011 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9
[0m12:37:03.958436 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:37:03.960351 [debug] [Thread-3  ]: Compilation Error in test test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01 (models/core/schema.yml)
  'test_test_date_in_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:03.960615 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd)
[0m12:37:03.963938 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:37:03.964277 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927
[0m12:37:03.965983 [debug] [Thread-1  ]: Compilation Error in test test_not_negative_fct_orders_total_amount (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:03.966219 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd
[0m12:37:03.966482 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:37:03.966785 [debug] [Thread-3  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:37:03.967038 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927' to be skipped because of status 'error'.  Reason: Compilation Error in test test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01 (models/core/schema.yml)
  'test_test_date_in_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:37:03.967338 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9
[0m12:37:03.973961 [debug] [Thread-2  ]: Compilation Error in test test_not_negative_fct_orders_total_items (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:03.974249 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:37:03.974523 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_date_in_range_fct_orders_order_date__2030_12_31__2020_01_01.47ee1a3927, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:37:03.974878 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:37:03.975184 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd
[0m12:37:03.975416 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_fct_orders_total_amount (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:37:03.979967 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:37:03.980226 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:37:03.980480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_fct_orders_total_amount.11e2e698c9, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:37:03.980760 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:37:03.981034 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_fct_orders_total_items (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:37:03.984449 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:37:03.984771 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:37:03.985074 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_fct_orders_total_items.b9fb3840bd, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:37:03.985326 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:37:03.988507 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:37:03.988760 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:37:03.989204 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:37:03.989460 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:37:03.993171 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:37:03.993439 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:37:03.993901 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:37:03.994167 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:37:03.994534 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:37:03.994817 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:37:03.995236 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:37:03.995450 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:37:03.995661 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:37:03.995908 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:37:03.996220 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:37:03.996658 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:37:04.000442 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:37:04.000901 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:37:04.001266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:37:04.001552 [debug] [Thread-2  ]: Began running node test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4
[0m12:37:04.004887 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:37:04.005174 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:37:04.005464 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4)
[0m12:37:04.008705 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:37:04.009022 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:37:04.009229 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:37:04.009433 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4
[0m12:37:04.010007 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:37:04.010450 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:37:04.010668 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:37:04.014044 [debug] [Thread-4  ]: Began running node test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42
[0m12:37:04.014338 [debug] [Thread-3  ]: Began running node test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c
[0m12:37:04.014776 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:37:04.015042 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42)
[0m12:37:04.017103 [debug] [Thread-2  ]: Compilation Error in test test_not_negative_dim_products_price (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:04.017348 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c)
[0m12:37:04.017623 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:37:04.017934 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42
[0m12:37:04.018274 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4
[0m12:37:04.018503 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c
[0m12:37:04.018750 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:37:04.023434 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4
[0m12:37:04.025531 [debug] [Thread-4  ]: Compilation Error in test test_not_negative_dim_products_total_quantity_sold (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:04.028973 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_dim_products_price (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:37:04.029226 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:37:04.029511 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_dim_products_price.a6027e62e4, now test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4)
[0m12:37:04.031177 [debug] [Thread-3  ]: Compilation Error in test test_not_negative_dim_products_total_revenue (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:04.031512 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42
[0m12:37:04.034537 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:37:04.034793 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4
[0m12:37:04.035100 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c
[0m12:37:04.035378 [debug] [Thread-4  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586
[0m12:37:04.039366 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_dim_products_total_quantity_sold (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:37:04.039756 [debug] [Thread-3  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044
[0m12:37:04.040142 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_dim_products_total_quantity_sold.4840f49e42, now test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586)
[0m12:37:04.042192 [debug] [Thread-2  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True (models/core/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than_or_equal_to'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:04.042518 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_dim_products_total_revenue (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:37:04.042752 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:37:04.043013 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_dim_products_total_revenue.0c4d74e77c, now test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044)
[0m12:37:04.043277 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586
[0m12:37:04.043620 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4
[0m12:37:04.044029 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:37:04.044253 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044
[0m12:37:04.057616 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:37:04.057990 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:37:04.058281 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True (models/core/schema.yml)
  'dict object' has no attribute 'test_expect_column_values_to_be_greater_than_or_equal_to'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:37:04.060501 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:37:04.066039 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:37:04.066376 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: BEGIN
[0m12:37:04.066663 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_be_greater_than_or_equal_to_dim_customers_most_recent_order_date__first_order_date__True.036b24f3e4, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:37:04.066993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:37:04.067234 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: BEGIN
[0m12:37:04.067459 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:37:04.067693 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:37:04.067913 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:37:04.068128 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:37:04.072303 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:37:04.075564 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:37:04.076244 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:37:04.076955 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:37:04.077300 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:37:04.077618 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:37:04.077872 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:37:04.081417 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:37:04.081927 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:37:04.082445 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:37:04.082720 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:37:04.083033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:37:04.083266 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:37:04.083509 [debug] [Thread-4  ]: SQL status: BEGIN in 0.016 seconds
[0m12:37:04.086910 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:37:04.087170 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:37:04.087431 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:37:04.087667 [debug] [Thread-3  ]: SQL status: BEGIN in 0.020 seconds
[0m12:37:04.088157 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:37:04.088411 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex2".INFORMATION_SCHEMA.columns
      where table_name = 'dim_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:37:04.088736 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:37:04.088987 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:37:04.089261 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:37:04.089724 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:37:04.090017 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex2".INFORMATION_SCHEMA.columns
      where table_name = 'dim_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:37:04.090422 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:37:04.090703 [debug] [Thread-1  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:37:04.091003 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:37:04.091281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:37:04.095650 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:37:04.096012 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:37:04.100312 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:37:04.100724 [debug] [Thread-3  ]: SQL status: SELECT 8 in 0.010 seconds
[0m12:37:04.107391 [debug] [Thread-4  ]: SQL status: SELECT 8 in 0.018 seconds
[0m12:37:04.109519 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586"
[0m12:37:04.107036 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044"
[0m12:37:04.110049 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:37:04.110540 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:37:04.110791 [debug] [Thread-1  ]: Began running node test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31
[0m12:37:04.111040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31)
[0m12:37:04.111267 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31
[0m12:37:04.114696 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:37:04.115123 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:37:04.115365 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:37:04.115597 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044
[0m12:37:04.115854 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586
[0m12:37:04.116202 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:37:04.116474 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: ROLLBACK
[0m12:37:04.116753 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: ROLLBACK
[0m12:37:04.117016 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:37:04.119212 [debug] [Thread-1  ]: Compilation Error in test test_not_negative_dim_customers_lifetime_orders (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:04.122638 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:37:04.122923 [debug] [Thread-4  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586: Close
[0m12:37:04.123153 [debug] [Thread-3  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044: Close
[0m12:37:04.123488 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31
[0m12:37:04.123991 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586
[0m12:37:04.124344 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:37:04.124757 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044
[0m12:37:04.125071 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31' to be skipped because of status 'error'.  Reason: Compilation Error in test test_not_negative_dim_customers_lifetime_orders (models/core/schema.yml)
  'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:37:04.125316 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:37:04.125593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.test_not_negative_dim_customers_lifetime_orders.ddf805bb31, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:37:04.126111 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:37:04.126344 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:37:04.130487 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:37:04.131011 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:37:04.131431 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:37:04.131684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:04.131916 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m12:37:04.132153 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m12:37:04.132357 [debug] [MainThread]: Connection 'test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_most_recent_order_date__timestamp.e9485a2044' was properly closed.
[0m12:37:04.132532 [debug] [MainThread]: Connection 'test.ecommerce_test.dbt_expectations_expect_column_values_to_be_of_type_dim_customers_first_order_date__timestamp.625eebf586' was properly closed.
[0m12:37:04.132819 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test test_not_negative_dim_customers_lifetime_orders (models/core/schema.yml)
    'test_test_not_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:37:04.133839 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 1.6489685, "process_in_blocks": "0", "process_kernel_time": 0.213773, "process_mem_max_rss": "138706944", "process_out_blocks": "0", "process_user_time": 2.187619}
[0m12:37:04.134100 [debug] [MainThread]: Command `dbt docs generate` failed at 12:37:04.134051 after 1.65 seconds
[0m12:37:04.134319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c3760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1184fe790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e2e280>]}
[0m12:37:04.134561 [debug] [MainThread]: Flushing usage events
[0m12:37:05.106073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:45.255416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104803220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104803040>]}


============================== 12:37:45.259001 | 42b9683c-ba8a-4683-9883-f9300df34179 ==============================
[0m12:37:45.259001 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:37:45.259519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m12:37:45.414459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42b9683c-ba8a-4683-9883-f9300df34179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021a5580>]}
[0m12:37:45.462378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42b9683c-ba8a-4683-9883-f9300df34179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c34f0>]}
[0m12:37:45.463208 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:37:45.554488 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:37:45.697805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:45.698652 [debug] [MainThread]: Partial parsing: updated file: ecommerce_test://models/core/schema.yml
[0m12:37:46.107213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:37:46.117401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42b9683c-ba8a-4683-9883-f9300df34179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0d130>]}
[0m12:37:46.132895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42b9683c-ba8a-4683-9883-f9300df34179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1fdc0>]}
[0m12:37:46.133385 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:37:46.133643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42b9683c-ba8a-4683-9883-f9300df34179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1fd60>]}
[0m12:37:46.135263 [info ] [MainThread]: 
[0m12:37:46.135554 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:46.135755 [info ] [MainThread]: 
[0m12:37:46.136162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:37:46.141450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:37:46.150072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:37:46.176302 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:37:46.176618 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:37:46.176834 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:37:46.177043 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:37:46.177364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:46.177594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:46.214374 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m12:37:46.214731 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m12:37:46.215043 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:37:46.215310 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:37:46.215566 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:37:46.215846 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:37:46.221820 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.006 seconds
[0m12:37:46.222135 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m12:37:46.224940 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:37:46.225947 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:37:46.226586 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:37:46.226815 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:37:46.239020 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:46.239382 [debug] [MainThread]: On master: BEGIN
[0m12:37:46.239597 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:46.246936 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:37:46.247215 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:46.247497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:46.291450 [debug] [MainThread]: SQL status: SELECT 4 in 0.044 seconds
[0m12:37:46.293202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42b9683c-ba8a-4683-9883-f9300df34179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10564a8e0>]}
[0m12:37:46.293587 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:46.294214 [debug] [MainThread]: On master: Close
[0m12:37:46.297127 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:37:46.297492 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:37:46.297873 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m12:37:46.298292 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:37:46.298646 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:37:46.299027 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m12:37:46.299376 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:37:46.299783 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:37:46.300175 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:37:46.300499 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:37:46.308640 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:37:46.308977 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:37:46.309298 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:37:46.312417 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:37:46.315614 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:37:46.319094 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:37:46.319590 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:37:46.319912 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:37:46.320406 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:37:46.320881 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:37:46.321123 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:37:46.321363 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:37:46.321906 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:37:46.322313 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:37:46.322711 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_products
[0m12:37:46.323041 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.dim_products)
[0m12:37:46.323307 [debug] [Thread-4  ]: Began running node model.ecommerce_test.dim_customers
[0m12:37:46.323537 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:37:46.323775 [debug] [Thread-3  ]: Began running node model.ecommerce_test.fct_orders
[0m12:37:46.324008 [debug] [Thread-2  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:37:46.324264 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.dim_customers)
[0m12:37:46.327519 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:37:46.327811 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.fct_orders)
[0m12:37:46.328081 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now test.ecommerce_test.assert_no_duplicate_orders)
[0m12:37:46.328325 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:37:46.328592 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:37:46.328840 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:37:46.331922 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:37:46.332180 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_products
[0m12:37:46.335271 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:37:46.338142 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:37:46.338645 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_products
[0m12:37:46.338994 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:37:46.339332 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:37:46.339845 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:37:46.340269 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:37:46.340495 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:37:46.340745 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:37:46.340970 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:37:46.341230 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:37:46.341739 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_products, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:37:46.341991 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_customers, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:37:46.342378 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:37:46.342777 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.fct_orders, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:37:46.343017 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:37:46.343238 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:37:46.343469 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:37:46.343702 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:37:46.382423 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:37:46.388759 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:37:46.389188 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:37:46.392395 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:37:46.392799 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:37:46.395975 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:37:46.396318 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:37:46.396735 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:37:46.396981 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:37:46.397221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:37:46.397444 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:37:46.401448 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:37:46.401979 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:37:46.402391 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:37:46.402632 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:37:46.402870 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:37:46.403185 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:37:46.403408 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:37:46.403631 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:37:46.403851 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:37:46.404222 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:37:46.404586 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:37:46.404954 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:37:46.408019 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:37:46.408297 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:37:46.408574 [debug] [Thread-3  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:37:46.408839 [debug] [Thread-1  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:37:46.409153 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:37:46.409419 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:37:46.409674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.assert_total_amount_equals_sum_of_items)
[0m12:37:46.409918 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:37:46.410152 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:37:46.410367 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:37:46.410584 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:37:46.415164 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:37:46.418361 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:37:46.418805 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:37:46.422124 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:37:46.422585 [debug] [Thread-4  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:37:46.422980 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:37:46.423248 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:37:46.423524 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:37:46.423746 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:37:46.424126 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:37:46.424356 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:37:46.424745 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:37:46.425113 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:37:46.425401 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:37:46.428995 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:37:46.429280 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:37:46.429551 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:37:46.429829 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:37:46.430119 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:37:46.430373 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:37:46.430628 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:37:46.430889 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:37:46.431117 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:37:46.431337 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:37:46.434262 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:37:46.437250 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:37:46.437707 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:37:46.441110 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:37:46.441584 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:37:46.442061 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:37:46.442354 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:37:46.442601 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:37:46.442838 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:37:46.446988 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:37:46.447432 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:37:46.447857 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:37:46.448073 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:37:46.448366 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:37:46.448657 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:37:46.449077 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:37:46.449290 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:37:46.449562 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:37:46.449845 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:37:46.450132 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:37:46.450598 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:37:46.450835 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:37:46.451069 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:37:46.451323 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:37:46.451569 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:37:46.455512 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:37:46.458571 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:37:46.458840 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:37:46.459127 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:37:46.462322 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:37:46.462594 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:37:46.463046 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:37:46.468150 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:37:46.468501 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:37:46.469019 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:37:46.469521 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:37:46.469805 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:37:46.470031 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:37:46.470357 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:37:46.470635 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:37:46.470928 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:37:46.471348 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:37:46.471617 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:37:46.472028 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:37:46.472264 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:37:46.472532 [debug] [Thread-2  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:37:46.472772 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:37:46.473047 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:37:46.476991 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:37:46.477453 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:37:46.483234 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:37:46.483844 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:37:46.484223 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:37:46.484815 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:37:46.489253 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:37:46.494812 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:37:46.495146 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:37:46.495507 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:37:46.495965 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:37:46.496479 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:37:46.496752 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:37:46.497077 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:37:46.497346 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:37:46.497628 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:37:46.497851 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:37:46.498253 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:37:46.498488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:37:46.498720 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:37:46.499108 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:37:46.499377 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:37:46.502762 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:37:46.506091 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:37:46.506676 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:37:46.507122 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:37:46.507397 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:37:46.507777 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:37:46.508304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:46.508500 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m12:37:46.508677 [debug] [MainThread]: Connection 'test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m12:37:46.508840 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m12:37:46.508998 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m12:37:46.511442 [debug] [MainThread]: Command end result
[0m12:37:46.598935 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:37:46.602553 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:37:46.607696 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:37:46.609621 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:37:46.609831 [info ] [MainThread]: Building catalog
[0m12:37:46.619732 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db_ex2.information_schema'
[0m12:37:46.625585 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:37:46.625936 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: BEGIN
[0m12:37:46.626151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:46.640325 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m12:37:46.640667 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:37:46.641059 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "dbt_db_ex2.information_schema"} */

    
    

    select
        'dbt_db_ex2' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_customer_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_date')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_revenue')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_amount')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_lifetime_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_status')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_price')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_quantity_sold')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_name')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_no_duplicate_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_email')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_total_amount_equals_sum_of_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:37:46.649950 [debug] [ThreadPool]: SQL status: SELECT 214 in 0.008 seconds
[0m12:37:46.666080 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: ROLLBACK
[0m12:37:46.666935 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: Close
[0m12:37:46.682874 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:37:46.711213 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:37:46.712383 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:37:46.712600 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:37:46.713846 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.5146809, "process_in_blocks": "0", "process_kernel_time": 0.211911, "process_mem_max_rss": "135315456", "process_out_blocks": "0", "process_user_time": 2.082726}
[0m12:37:46.714148 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:37:46.714095 after 1.52 seconds
[0m12:37:46.714359 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:37:46.714527 [debug] [MainThread]: Connection 'dbt_db_ex2.information_schema' was properly closed.
[0m12:37:46.714726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d8040>]}
[0m12:37:46.714971 [debug] [MainThread]: Flushing usage events
[0m12:37:48.748944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:09.081240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c02790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6c220>]}


============================== 12:39:09.084470 | 0220f699-32cc-494e-b27a-8abf24d5c190 ==============================
[0m12:39:09.084470 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:39:09.084866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:39:09.235778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0220f699-32cc-494e-b27a-8abf24d5c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5c8e0>]}
[0m12:39:09.282208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0220f699-32cc-494e-b27a-8abf24d5c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e82940>]}
[0m12:39:36.712922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103546730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043afb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043afd00>]}


============================== 12:39:36.716090 | 01bf6a4e-ef8f-4f3c-83cf-75fac1b9c3ae ==============================
[0m12:39:36.716090 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:39:36.716523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:36.809252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01bf6a4e-ef8f-4f3c-83cf-75fac1b9c3ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a99a0>]}
[0m12:39:36.858737 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-q31kng_r'
[0m12:39:36.859118 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:39:37.082359 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:39:37.085681 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:39:37.114995 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:39:37.123710 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m12:39:37.147530 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m12:39:37.150094 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m12:39:37.150614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '01bf6a4e-ef8f-4f3c-83cf-75fac1b9c3ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104578550>]}
[0m12:39:37.153615 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m12:39:37.172381 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m12:39:37.175113 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:39:37.832549 [info ] [MainThread]: Installed from version 1.1.1
[0m12:39:37.832902 [info ] [MainThread]: Updated version available: 1.3.0
[0m12:39:37.833169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '01bf6a4e-ef8f-4f3c-83cf-75fac1b9c3ae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10369d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045788b0>]}
[0m12:39:37.833455 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m12:39:41.134344 [info ] [MainThread]: Installed from version 0.10.0
[0m12:39:41.134669 [info ] [MainThread]: Updated version available: 0.10.4
[0m12:39:41.134920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '01bf6a4e-ef8f-4f3c-83cf-75fac1b9c3ae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104578ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104578c40>]}
[0m12:39:41.135186 [info ] [MainThread]: Installing calogica/dbt_date
[0m12:39:42.361398 [info ] [MainThread]: Installed from version 0.10.0
[0m12:39:42.361917 [info ] [MainThread]: Updated version available: 0.10.1
[0m12:39:42.362286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '01bf6a4e-ef8f-4f3c-83cf-75fac1b9c3ae', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104578ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045783a0>]}
[0m12:39:42.362639 [info ] [MainThread]: 
[0m12:39:42.362934 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m12:39:42.365646 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.7073627, "process_in_blocks": "0", "process_kernel_time": 0.272011, "process_mem_max_rss": "104890368", "process_out_blocks": "0", "process_user_time": 1.20554}
[0m12:39:42.366087 [debug] [MainThread]: Command `dbt deps` succeeded at 12:39:42.365998 after 5.71 seconds
[0m12:39:42.366429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103546730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a99a0>]}
[0m12:39:42.366717 [debug] [MainThread]: Flushing usage events
[0m12:39:43.359135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:44.766271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e2bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e2d90>]}


============================== 12:39:44.771512 | aaf3b23c-4f93-44bd-a28c-e376fb0ba9a2 ==============================
[0m12:39:44.771512 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:39:44.771978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:39:44.783492 [info ] [MainThread]: dbt version: 1.9.4
[0m12:39:44.783814 [info ] [MainThread]: python version: 3.9.6
[0m12:39:44.784019 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m12:39:44.784214 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m12:39:44.825353 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m12:39:44.825682 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m12:39:44.825901 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/dbt_project.yml
[0m12:39:44.826466 [info ] [MainThread]: adapter type: postgres
[0m12:39:44.826661 [info ] [MainThread]: adapter version: 1.9.0
[0m12:39:45.021597 [info ] [MainThread]: Configuration:
[0m12:39:45.022210 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:39:45.022541 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:39:45.022756 [info ] [MainThread]: Required dependencies:
[0m12:39:45.023049 [debug] [MainThread]: Executing "git --help"
[0m12:39:45.046143 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:39:45.046898 [debug] [MainThread]: STDERR: "b''"
[0m12:39:45.047245 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:39:45.047633 [info ] [MainThread]: Connection:
[0m12:39:45.047898 [info ] [MainThread]:   host: localhost
[0m12:39:45.048088 [info ] [MainThread]:   port: 5433
[0m12:39:45.048270 [info ] [MainThread]:   user: dbt_user
[0m12:39:45.048450 [info ] [MainThread]:   database: dbt_db_ex2
[0m12:39:45.048627 [info ] [MainThread]:   schema: public
[0m12:39:45.048886 [info ] [MainThread]:   connect_timeout: 10
[0m12:39:45.049074 [info ] [MainThread]:   role: None
[0m12:39:45.049326 [info ] [MainThread]:   search_path: None
[0m12:39:45.049555 [info ] [MainThread]:   keepalives_idle: 0
[0m12:39:45.049779 [info ] [MainThread]:   sslmode: None
[0m12:39:45.049997 [info ] [MainThread]:   sslcert: None
[0m12:39:45.050227 [info ] [MainThread]:   sslkey: None
[0m12:39:45.050476 [info ] [MainThread]:   sslrootcert: None
[0m12:39:45.050671 [info ] [MainThread]:   application_name: dbt
[0m12:39:45.051034 [info ] [MainThread]:   retries: 1
[0m12:39:45.051652 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:39:45.131838 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:39:45.160637 [debug] [MainThread]: Using postgres connection "debug"
[0m12:39:45.160954 [debug] [MainThread]: On debug: select 1 as id
[0m12:39:45.161171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:45.204640 [debug] [MainThread]: SQL status: SELECT 1 in 0.043 seconds
[0m12:39:45.205354 [debug] [MainThread]: On debug: Close
[0m12:39:45.205613 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:39:45.205839 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:39:45.206925 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.499427, "process_in_blocks": "0", "process_kernel_time": 0.176963, "process_mem_max_rss": "114671616", "process_out_blocks": "0", "process_user_time": 1.116731}
[0m12:39:45.207250 [debug] [MainThread]: Command `dbt debug` succeeded at 12:39:45.207187 after 0.50 seconds
[0m12:39:45.207469 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:39:45.207704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce6490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c35160>]}
[0m12:39:45.207983 [debug] [MainThread]: Flushing usage events
[0m12:39:46.150675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:47.173752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1ac40>]}


============================== 12:39:47.176224 | b6c0733f-29d6-476e-9ccf-e9b10aa0dc03 ==============================
[0m12:39:47.176224 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:39:47.176596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:39:47.314807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107062880>]}
[0m12:39:47.360856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d1d60>]}
[0m12:39:47.361391 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:39:47.443406 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:39:47.575184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:47.575472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:47.580524 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:39:47.644062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b06130>]}
[0m12:39:47.730018 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:39:47.732862 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:39:47.741340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107948190>]}
[0m12:39:47.741669 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:39:47.741887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae6df0>]}
[0m12:39:47.743062 [info ] [MainThread]: 
[0m12:39:47.743291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:47.743480 [info ] [MainThread]: 
[0m12:39:47.743776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:47.746668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m12:39:47.773870 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m12:39:47.774161 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m12:39:47.774349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:47.796106 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m12:39:47.796950 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m12:39:47.799225 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public_dbt_test__audit)
[0m12:39:47.804014 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:39:47.804346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:39:47.804558 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:39:47.807481 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:39:47.807833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:47.808068 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:39:47.808391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:47.819252 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:39:47.819564 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:39:47.819785 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:39:47.819992 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:39:47.820209 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:39:47.820442 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:39:47.824728 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.004 seconds
[0m12:39:47.826639 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:39:47.826916 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m12:39:47.827935 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:39:47.828187 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:39:47.833156 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:39:47.840438 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:47.840714 [debug] [MainThread]: On master: BEGIN
[0m12:39:47.840934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:47.848521 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:39:47.848797 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:47.849080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:47.901220 [debug] [MainThread]: SQL status: SELECT 4 in 0.052 seconds
[0m12:39:47.903180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d9be0>]}
[0m12:39:47.903626 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:47.904262 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:47.904557 [debug] [MainThread]: On master: BEGIN
[0m12:39:47.905460 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:39:47.905797 [debug] [MainThread]: On master: COMMIT
[0m12:39:47.906092 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:47.906371 [debug] [MainThread]: On master: COMMIT
[0m12:39:47.906916 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:47.907233 [debug] [MainThread]: On master: Close
[0m12:39:47.910195 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:39:47.910549 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:39:47.910877 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:39:47.911546 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:39:47.911288 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m12:39:47.912025 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m12:39:47.912459 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m12:39:47.912880 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m12:39:47.913373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_customers)
[0m12:39:47.913720 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_order_items)
[0m12:39:47.914107 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:39:47.914487 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:39:47.914791 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:39:47.915088 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:39:47.915383 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:39:47.915671 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:39:47.924450 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:39:47.927515 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:39:47.930498 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:39:47.934045 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:39:47.934743 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:39:47.935009 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:39:47.940848 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:39:47.947409 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:39:47.969770 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.stg_order_items"
[0m12:39:47.971043 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.stg_orders"
[0m12:39:47.972705 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.stg_products"
[0m12:39:47.975626 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_test.stg_customers"
[0m12:39:47.976312 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:39:47.976539 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: BEGIN
[0m12:39:47.976744 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:39:47.977072 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:39:47.977311 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: BEGIN
[0m12:39:47.977521 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:39:47.977818 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:39:47.978081 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:39:47.978326 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: BEGIN
[0m12:39:47.978552 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: BEGIN
[0m12:39:47.978772 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:47.978991 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:39:47.988114 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m12:39:47.988521 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m12:39:47.988789 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:39:47.989071 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m12:39:47.989328 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:39:47.989545 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m12:39:47.989789 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */

  create view "dbt_db_ex2"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at,
        -- Add tracking for data lineage
        'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03' as _invocation_id
    from source
)

select * from staged
  );
[0m12:39:47.990021 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:39:47.990240 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */

  create view "dbt_db_ex2"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email, -- Normalize email
        created_at
    from source
)

select * from staged
  );
[0m12:39:47.990457 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:39:47.990731 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */

  create view "dbt_db_ex2"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity, -- Ensure minimum quantity is 1
        coalesce(unit_price, 0) as unit_price, -- Ensure no NULL prices
        created_at
    from source
)

select * from staged
  );
[0m12:39:47.991062 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */

  create view "dbt_db_ex2"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price, -- Ensure no NULL values
        category,
        created_at
    from source
)

select * from staged
  );
[0m12:39:47.995468 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:39:48.001121 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:39:48.001406 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.010 seconds
[0m12:39:48.001646 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:39:48.001865 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.011 seconds
[0m12:39:48.002091 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.011 seconds
[0m12:39:48.004941 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:39:48.008284 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:39:48.008541 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:39:48.011251 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:39:48.011495 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m12:39:48.011719 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:39:48.014272 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:39:48.014521 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m12:39:48.014831 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:39:48.015220 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:39:48.015468 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:48.018098 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:39:48.018321 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:39:48.018540 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:39:48.021082 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:39:48.021326 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:39:48.032162 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m12:39:48.034601 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:39:48.034843 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:39:48.035101 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:39:48.035344 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m12:39:48.035599 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:48.035866 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m12:39:48.036681 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m12:39:48.036895 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:48.037141 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:48.037394 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:39:48.038184 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m12:39:48.038928 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m12:39:48.039140 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:39:48.039371 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m12:39:48.039623 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:39:48.039866 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:39:48.044490 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_customers__dbt_backup"
[0m12:39:48.044783 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m12:39:48.045029 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m12:39:48.047641 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:39:48.047901 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m12:39:48.048182 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
drop view if exists "dbt_db_ex2"."public"."stg_customers__dbt_backup" cascade
[0m12:39:48.048427 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m12:39:48.048650 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:39:48.050865 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_orders__dbt_backup"
[0m12:39:48.053584 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_products__dbt_backup"
[0m12:39:48.053832 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m12:39:48.056021 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_order_items__dbt_backup"
[0m12:39:48.056380 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:39:48.056722 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:39:48.058260 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: Close
[0m12:39:48.058612 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:39:48.058839 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
drop view if exists "dbt_db_ex2"."public"."stg_orders__dbt_backup" cascade
[0m12:39:48.059059 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
drop view if exists "dbt_db_ex2"."public"."stg_products__dbt_backup" cascade
[0m12:39:48.059315 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
drop view if exists "dbt_db_ex2"."public"."stg_order_items__dbt_backup" cascade
[0m12:39:48.060864 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e81970>]}
[0m12:39:48.061344 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m12:39:48.061730 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:39:48.062031 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m12:39:48.062290 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.002 seconds
[0m12:39:48.062511 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.002 seconds
[0m12:39:48.063331 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: Close
[0m12:39:48.064115 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: Close
[0m12:39:48.064824 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: Close
[0m12:39:48.065172 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080510d0>]}
[0m12:39:48.065545 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e4dc0>]}
[0m12:39:48.065951 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108077ee0>]}
[0m12:39:48.066503 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m12:39:48.067371 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m12:39:48.067876 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.15s]
[0m12:39:48.068324 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:39:48.068664 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:39:48.068981 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:39:48.069427 [debug] [Thread-3  ]: Began running node model.ecommerce_test.dim_products
[0m12:39:48.069772 [info ] [Thread-3  ]: 5 of 7 START sql table model public.dim_products ............................... [RUN]
[0m12:39:48.070085 [debug] [Thread-4  ]: Began running node model.ecommerce_test.dim_customers
[0m12:39:48.070305 [debug] [Thread-2  ]: Began running node model.ecommerce_test.fct_orders
[0m12:39:48.070630 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.dim_products)
[0m12:39:48.070951 [info ] [Thread-4  ]: 6 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m12:39:48.071268 [info ] [Thread-2  ]: 7 of 7 START sql table model public.fct_orders ................................. [RUN]
[0m12:39:48.071803 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:39:48.072123 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.dim_customers)
[0m12:39:48.072397 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.fct_orders)
[0m12:39:48.076276 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:39:48.076636 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:39:48.076915 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:39:48.080284 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:39:48.084755 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:39:48.085202 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.dim_products
[0m12:39:48.133126 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.dim_products"
[0m12:39:48.133602 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:39:48.136595 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.fct_orders"
[0m12:39:48.136872 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:39:48.139756 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.dim_customers"
[0m12:39:48.140156 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:39:48.140437 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: BEGIN
[0m12:39:48.140710 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:39:48.141048 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:39:48.141304 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:39:48.141523 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: BEGIN
[0m12:39:48.141746 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: BEGIN
[0m12:39:48.141974 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:39:48.142207 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:39:48.155954 [debug] [Thread-3  ]: SQL status: BEGIN in 0.015 seconds
[0m12:39:48.156296 [debug] [Thread-4  ]: SQL status: BEGIN in 0.014 seconds
[0m12:39:48.156588 [debug] [Thread-2  ]: SQL status: BEGIN in 0.015 seconds
[0m12:39:48.156837 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:39:48.157095 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:39:48.157341 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:39:48.157614 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex2"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(quantity * unit_price) as total_revenue
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

final as (
    select
        p.product_id,
        p.name,
        p.price,
        p.category,
        p.created_at,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_revenue, 0) as total_revenue,
        current_timestamp as updated_at
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
  );
  
[0m12:39:48.157915 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex2"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as lifetime_orders,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1
),

final as (
    select
        c.customer_id,
        c.name,
        c.email,
        c.created_at,
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        current_timestamp as updated_at
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
  );
  
[0m12:39:48.158206 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */

  
    

  create  table "dbt_db_ex2"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

with orders as (
    select * from "dbt_db_ex2"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db_ex2"."public"."stg_order_items"
),

order_totals as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(quantity * unit_price) as total_amount
    from order_items
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        coalesce(ot.total_items, 0) as total_items,
        coalesce(ot.total_amount, 0) as total_amount,
        o.created_at,
        current_timestamp as updated_at,
        o._invocation_id
    from orders o
    left join order_totals ot on o.order_id = ot.order_id
)

select * from final
  );
  
[0m12:39:48.168347 [debug] [Thread-4  ]: SQL status: SELECT 3 in 0.010 seconds
[0m12:39:48.168732 [debug] [Thread-2  ]: SQL status: SELECT 3 in 0.010 seconds
[0m12:39:48.169027 [debug] [Thread-3  ]: SQL status: SELECT 4 in 0.011 seconds
[0m12:39:48.175957 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:39:48.179079 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:39:48.182049 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:39:48.182330 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m12:39:48.182586 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders" rename to "fct_orders__dbt_backup"
[0m12:39:48.182835 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m12:39:48.183772 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:48.184039 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:48.187016 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:39:48.187278 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:39:48.189910 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:39:48.190160 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m12:39:48.193358 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:39:48.193605 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m12:39:48.193878 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m12:39:48.194642 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:39:48.195497 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m12:39:48.195757 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:39:48.195977 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:39:48.196224 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:39:48.197107 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m12:39:48.197907 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: COMMIT
[0m12:39:48.198175 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m12:39:48.198431 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:39:48.198672 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:39:48.198942 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m12:39:48.199194 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: COMMIT
[0m12:39:48.199533 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:39:48.201912 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."fct_orders__dbt_backup"
[0m12:39:48.203539 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:39:48.203795 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m12:39:48.204020 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
drop table if exists "dbt_db_ex2"."public"."fct_orders__dbt_backup" cascade
[0m12:39:48.204243 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m12:39:48.206409 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_products__dbt_backup"
[0m12:39:48.208741 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_customers__dbt_backup"
[0m12:39:48.209714 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:39:48.210139 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.003 seconds
[0m12:39:48.210503 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:39:48.210751 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
drop table if exists "dbt_db_ex2"."public"."dim_products__dbt_backup" cascade
[0m12:39:48.211596 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: Close
[0m12:39:48.211849 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
drop table if exists "dbt_db_ex2"."public"."dim_customers__dbt_backup" cascade
[0m12:39:48.212301 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bbfa0>]}
[0m12:39:48.212760 [info ] [Thread-2  ]: 7 of 7 OK created sql table model public.fct_orders ............................ [[32mSELECT 3[0m in 0.14s]
[0m12:39:48.213164 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:39:48.215144 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.003 seconds
[0m12:39:48.216072 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: Close
[0m12:39:48.216314 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.004 seconds
[0m12:39:48.216685 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a1970>]}
[0m12:39:48.217514 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: Close
[0m12:39:48.218276 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6c0733f-29d6-476e-9ccf-e9b10aa0dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108103ac0>]}
[0m12:39:48.217964 [info ] [Thread-3  ]: 5 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.15s]
[0m12:39:48.220967 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.dim_products
[0m12:39:48.222984 [info ] [Thread-4  ]: 6 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.15s]
[0m12:39:48.223589 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:39:48.226353 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:48.227130 [debug] [MainThread]: On master: BEGIN
[0m12:39:48.227355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:48.316440 [debug] [MainThread]: SQL status: BEGIN in 0.088 seconds
[0m12:39:48.318611 [debug] [MainThread]: On master: COMMIT
[0m12:39:48.319237 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:48.320039 [debug] [MainThread]: On master: COMMIT
[0m12:39:48.321999 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:39:48.322686 [debug] [MainThread]: On master: Close
[0m12:39:48.323840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:48.333366 [debug] [MainThread]: Connection 'model.ecommerce_test.stg_customers' was properly closed.
[0m12:39:48.333602 [debug] [MainThread]: Connection 'model.ecommerce_test.fct_orders' was properly closed.
[0m12:39:48.333784 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_products' was properly closed.
[0m12:39:48.333961 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_customers' was properly closed.
[0m12:39:48.334289 [info ] [MainThread]: 
[0m12:39:48.335591 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m12:39:48.338810 [debug] [MainThread]: Command end result
[0m12:39:48.475095 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:39:48.478970 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:39:48.487519 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:39:48.487853 [info ] [MainThread]: 
[0m12:39:48.488179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:39:48.488422 [info ] [MainThread]: 
[0m12:39:48.488649 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:39:48.491194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3690816, "process_in_blocks": "0", "process_kernel_time": 0.160981, "process_mem_max_rss": "127205376", "process_out_blocks": "0", "process_user_time": 1.759605}
[0m12:39:48.491867 [debug] [MainThread]: Command `dbt run` succeeded at 12:39:48.491626 after 1.37 seconds
[0m12:39:48.492561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108062880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107062880>]}
[0m12:39:48.493430 [debug] [MainThread]: Flushing usage events
[0m12:39:49.724363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:51.053493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11873ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11873af40>]}


============================== 12:39:51.056457 | cdb92d2f-89aa-4150-9ccf-7b9fa6c06639 ==============================
[0m12:39:51.056457 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:39:51.057130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --store-failures', 'send_anonymous_usage_stats': 'True'}
[0m12:39:51.188746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdb92d2f-89aa-4150-9ccf-7b9fa6c06639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a44970>]}
[0m12:39:51.234554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdb92d2f-89aa-4150-9ccf-7b9fa6c06639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118701220>]}
[0m12:39:51.235888 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:39:51.314441 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:39:51.430927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:51.431230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:51.436490 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:39:51.499956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdb92d2f-89aa-4150-9ccf-7b9fa6c06639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1194bb310>]}
[0m12:39:51.586721 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:39:51.589266 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:39:51.602199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdb92d2f-89aa-4150-9ccf-7b9fa6c06639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11962f5b0>]}
[0m12:39:51.602564 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:39:51.602786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb92d2f-89aa-4150-9ccf-7b9fa6c06639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195be490>]}
[0m12:39:51.604408 [info ] [MainThread]: 
[0m12:39:51.604629 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:51.604816 [info ] [MainThread]: 
[0m12:39:51.605106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:51.608716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m12:39:51.635810 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m12:39:51.636138 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m12:39:51.636341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:51.658825 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m12:39:51.659705 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m12:39:51.661991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m12:39:51.662332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:39:51.668634 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:39:51.670749 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:39:51.670987 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:39:51.671180 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:39:51.671367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:39:51.671545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:51.682043 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:39:51.682360 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:39:51.682574 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:39:51.682778 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:39:51.682989 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:39:51.683214 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:39:51.686403 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m12:39:51.686693 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.003 seconds
[0m12:39:51.687640 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:39:51.689147 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:39:51.689908 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:39:51.690171 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:39:51.701682 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:51.701953 [debug] [MainThread]: On master: BEGIN
[0m12:39:51.702145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:51.709938 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:39:51.710238 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:51.710489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:51.715372 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m12:39:51.716728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb92d2f-89aa-4150-9ccf-7b9fa6c06639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196699d0>]}
[0m12:39:51.717059 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:51.717537 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:51.717746 [debug] [MainThread]: On master: BEGIN
[0m12:39:51.718431 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:39:51.718674 [debug] [MainThread]: On master: COMMIT
[0m12:39:51.718889 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:51.719091 [debug] [MainThread]: On master: COMMIT
[0m12:39:51.719512 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:51.719721 [debug] [MainThread]: On master: Close
[0m12:39:51.721858 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:39:51.722307 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:39:51.722830 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:39:51.722598 [info ] [Thread-1  ]: 1 of 25 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m12:39:51.723196 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:39:51.723455 [info ] [Thread-2  ]: 2 of 25 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m12:39:51.723738 [info ] [Thread-3  ]: 3 of 25 START test assert_no_duplicate_orders .................................. [RUN]
[0m12:39:51.724081 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:39:51.724344 [info ] [Thread-4  ]: 4 of 25 START test assert_total_amount_equals_sum_of_items ..................... [RUN]
[0m12:39:51.724620 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:39:51.724933 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_no_duplicate_orders'
[0m12:39:51.725179 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:39:51.725460 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_total_amount_equals_sum_of_items'
[0m12:39:51.725683 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:39:51.725894 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:39:51.738409 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:39:51.740088 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:39:51.744698 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:39:51.747417 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:39:51.751741 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:39:51.752509 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:39:51.765004 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:39:51.767988 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:39:51.768257 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:39:51.772474 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:39:51.775428 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:39:51.775753 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:39:51.780749 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:39:51.781160 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:39:51.781411 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m12:39:51.785579 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:39:51.785933 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:39:51.786168 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items" cascade
[0m12:39:51.786398 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:39:51.786718 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:39:51.786946 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m12:39:51.787159 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:39:51.787518 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders" cascade
[0m12:39:51.787860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:51.788269 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:39:51.803023 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:39:51.804837 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:39:51.805115 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.017 seconds
[0m12:39:51.811476 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.024 seconds
[0m12:39:51.811758 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.025 seconds
[0m12:39:51.812408 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:39:51.814306 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:39:51.815050 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:39:51.815706 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:39:51.816173 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:39:51.816413 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:39:51.816820 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:39:51.817319 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:39:51.817557 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:39:51.817814 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:39:51.818057 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:39:51.818438 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:51.818652 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:39:51.818897 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  
  
    as
  
  (
    /*
  Custom test to ensure there are no duplicate orders in the core table.
  This test checks for duplicates based on customer_id and order_date within 15 minutes
*/

with orders as (
    select 
        customer_id,
        order_date,
        count(*) as order_count
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1, 2
),

potential_duplicates as (
    select
        o1.customer_id,
        o1.order_date as order_date_1,
        o2.order_date as order_date_2,
        abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) as minutes_difference
    from "dbt_db_ex2"."public"."stg_orders" o1
    join "dbt_db_ex2"."public"."stg_orders" o2
        on o1.customer_id = o2.customer_id
        and o1.order_id <> o2.order_id
        and abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) < 15  -- Orders less than 15 minutes apart
)

select * from potential_duplicates
  );
  
    
[0m12:39:51.819173 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:51.819404 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:51.819659 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:39:51.819870 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m12:39:51.820082 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:39:51.820316 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m12:39:51.820552 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:39:51.820793 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
  
  
    as
  
  (
    /*
  Custom test to check if the total amount in orders table
  matches the sum of the item amounts in order_items.
  
  If there are differences, this test will return the records with discrepancies.
*/

with orders as (
    select 
        order_id,
        total_amount as order_total
    from "dbt_db_ex2"."public"."fct_orders"
),

order_items_grouped as (
    select
        order_id,
        sum(quantity * unit_price) as items_total
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

joined as (
    select
        o.order_id,
        o.order_total,
        coalesce(oi.items_total, 0) as items_total,
        abs(o.order_total - coalesce(oi.items_total, 0)) as difference
    from orders o
    left join order_items_grouped oi on o.order_id = oi.order_id
)

select * from joined where difference > 0.01  -- Allow small rounding differences
  );
  
    
[0m12:39:51.821091 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m12:39:51.826271 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:39:51.826971 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:39:51.827218 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:39:51.827431 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:39:51.828158 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:39:51.828824 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:39:51.829092 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:39:51.829328 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:39:51.829883 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m12:39:51.832522 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:39:51.832851 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m12:39:51.833107 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.012 seconds
[0m12:39:51.833474 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:39:51.833702 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.014 seconds
[0m12:39:51.834329 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:39:51.834687 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:39:51.835290 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:39:51.835731 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:39:51.836037 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:39:51.836318 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:39:51.836712 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:39:51.837082 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:39:51.837333 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:39:51.837611 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:39:51.837958 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:51.838185 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:51.838415 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:39:51.838687 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:39:51.838955 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m12:39:51.839230 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m12:39:51.840117 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:51.840370 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m12:39:51.843269 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m12:39:51.843538 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:39:51.843770 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m12:39:51.844196 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:39:51.845055 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m12:39:51.845297 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m12:39:51.845666 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:39:51.846161 [info ] [Thread-1  ]: 1 of 25 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.12s]
[0m12:39:51.846603 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:39:51.846850 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m12:39:51.847148 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:39:51.847687 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:39:51.848211 [info ] [Thread-2  ]: 2 of 25 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.12s]
[0m12:39:51.848566 [info ] [Thread-1  ]: 5 of 25 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m12:39:51.848963 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:39:51.849243 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:39:51.849588 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:39:51.849872 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:39:51.850147 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:39:51.850398 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:39:51.850657 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:39:51.850898 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:51.851372 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:51.851174 [info ] [Thread-2  ]: 6 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m12:39:51.863381 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:39:51.865634 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:39:51.866001 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:39:51.866329 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:39:51.866597 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
    
      
    ) dbt_internal_test
[0m12:39:51.866946 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
    
      
    ) dbt_internal_test
[0m12:39:51.867259 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:39:51.873115 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:39:51.873520 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.006 seconds
[0m12:39:51.873946 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.006 seconds
[0m12:39:51.874255 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:39:51.875279 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: ROLLBACK
[0m12:39:51.876206 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: ROLLBACK
[0m12:39:51.881551 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m12:39:51.881915 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:39:51.882396 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:39:51.888005 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:39:51.888347 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: Close
[0m12:39:51.888590 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: Close
[0m12:39:51.888851 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3" cascade
[0m12:39:51.889311 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:39:51.890495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:51.889838 [info ] [Thread-4  ]: 4 of 25 PASS assert_total_amount_equals_sum_of_items ........................... [[32mPASS[0m in 0.16s]
[0m12:39:51.890263 [error] [Thread-3  ]: 3 of 25 FAIL 2 assert_no_duplicate_orders ...................................... [[31mFAIL 2[0m in 0.17s]
[0m12:39:51.890952 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m12:39:51.891466 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:39:51.891801 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:39:51.892062 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:39:51.892388 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:39:51.892935 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:39:51.893641 [info ] [Thread-4  ]: 7 of 25 START test not_null_dim_customers_email ................................ [RUN]
[0m12:39:51.894629 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:39:51.893990 [info ] [Thread-3  ]: 8 of 25 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m12:39:51.895080 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:39:51.895394 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:39:51.899321 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:39:51.899692 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:39:51.904243 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:39:51.905520 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:39:51.950910 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.059 seconds
[0m12:39:51.952753 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:39:51.953620 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:39:51.953918 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:39:51.954194 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.064 seconds
[0m12:39:51.954641 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:39:51.955137 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:39:51.960148 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:39:51.961169 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m12:39:51.961506 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m12:39:51.961845 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:39:51.962284 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:39:51.962770 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:39:51.963043 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:39:51.963374 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m12:39:51.963651 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:39:51.964013 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:39:51.964371 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:51.964750 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:39:51.965038 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:51.965291 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m12:39:51.965588 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:39:51.965951 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
  
  
    as
  
  (
    




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(email, '^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$', '')), 1), 0)


 > 0
 as expression


    from "dbt_db_ex2"."public"."dim_customers"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  );
  
    
[0m12:39:51.972434 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:39:51.973308 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:39:51.973652 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:39:51.974127 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:39:51.976148 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.010 seconds
[0m12:39:51.977152 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:39:51.977565 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:39:51.977860 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:39:51.978119 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m12:39:51.978357 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:39:51.979149 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:39:51.979474 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:39:51.979942 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:39:51.981029 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:39:51.981731 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:39:51.982417 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:39:51.982805 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:39:51.983098 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:39:51.983462 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:39:51.983888 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:39:51.984265 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:51.984521 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:39:51.984793 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:51.985060 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m12:39:51.985320 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:51.985562 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m12:39:51.985822 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:39:51.986108 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:39:51.986594 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:39:51.986867 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where email is null



  );
  
    
[0m12:39:51.987154 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
    
      
    ) dbt_internal_test
[0m12:39:51.987823 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:39:51.988093 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:39:51.988512 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:51.988810 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:51.989891 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: ROLLBACK
[0m12:39:51.990262 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:39:51.990568 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:39:51.991137 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: Close
[0m12:39:51.991997 [info ] [Thread-1  ]: 5 of 25 PASS dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[32mPASS[0m in 0.14s]
[0m12:39:51.992461 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:39:51.992820 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:39:51.993345 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:51.994851 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m12:39:51.993110 [info ] [Thread-1  ]: 9 of 25 START test not_null_dim_customers_name ................................. [RUN]
[0m12:39:51.996395 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:39:51.996688 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.011 seconds
[0m12:39:51.997027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:39:51.997266 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m12:39:51.997933 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:39:51.998509 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:39:51.998780 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:39:51.999079 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:39:51.999691 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:39:51.999482 [info ] [Thread-2  ]: 6 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.13s]
[0m12:39:52.004553 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:39:52.004998 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:39:52.005822 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:39:52.006557 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:39:52.007086 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:39:52.007391 [info ] [Thread-2  ]: 10 of 25 START test not_null_dim_products_name ................................. [RUN]
[0m12:39:52.007776 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:39:52.008200 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:39:52.013763 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:39:52.014268 [debug] [Thread-3  ]: SQL status: COMMIT in 0.007 seconds
[0m12:39:52.014621 [debug] [Thread-4  ]: SQL status: COMMIT in 0.008 seconds
[0m12:39:52.015213 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:39:52.015574 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:39:52.016030 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:39:52.022802 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:39:52.023307 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:39:52.029356 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:39:52.029923 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:39:52.030247 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:39:52.030685 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:39:52.030969 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m12:39:52.031250 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:39:52.031478 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:39:52.031723 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m12:39:52.031963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:52.032196 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:39:52.032485 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:39:52.033018 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.033325 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.033725 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:39:52.034033 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:39:52.034388 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m12:39:52.034760 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:39:52.036159 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.036702 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:52.037814 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m12:39:52.038921 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m12:39:52.041024 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m12:39:52.041857 [info ] [Thread-3  ]: 8 of 25 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.15s]
[0m12:39:52.042231 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: Close
[0m12:39:52.042608 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:39:52.043034 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:39:52.043572 [info ] [Thread-4  ]: 7 of 25 PASS not_null_dim_customers_email ...................................... [[32mPASS[0m in 0.15s]
[0m12:39:52.044307 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:39:52.043854 [info ] [Thread-3  ]: 11 of 25 START test not_null_dim_products_price ................................ [RUN]
[0m12:39:52.044755 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:39:52.045091 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:39:52.045485 [info ] [Thread-4  ]: 12 of 25 START test not_null_dim_products_product_id ........................... [RUN]
[0m12:39:52.045836 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:39:52.046180 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:39:52.050537 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:39:52.050948 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:39:52.051220 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.019 seconds
[0m12:39:52.055814 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:39:52.056674 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:39:52.056950 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.024 seconds
[0m12:39:52.057578 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:39:52.058330 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:39:52.058693 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:39:52.058974 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:39:52.059227 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:39:52.059738 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:39:52.065716 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:39:52.066066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m12:39:52.071221 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:39:52.071586 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:39:52.071994 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:39:52.072266 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:39:52.072647 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:39:52.072993 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m12:39:52.073265 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where name is null



  );
  
    
[0m12:39:52.073593 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m12:39:52.073844 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.074069 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:39:52.074335 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:39:52.074578 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:39:52.075034 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where name is null



  );
  
    
[0m12:39:52.084205 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:39:52.084577 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.010 seconds
[0m12:39:52.085404 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:39:52.086156 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:39:52.086476 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:39:52.086759 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:39:52.087381 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.013 seconds
[0m12:39:52.088455 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:39:52.089036 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:39:52.089423 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:39:52.090326 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:39:52.091075 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:39:52.091838 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:39:52.092436 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:39:52.093810 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:39:52.094485 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:39:52.098776 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m12:39:52.099257 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:39:52.099525 [debug] [Thread-2  ]: SQL status: COMMIT in 0.008 seconds
[0m12:39:52.099773 [debug] [Thread-1  ]: SQL status: COMMIT in 0.008 seconds
[0m12:39:52.100043 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where product_id is null



  );
  
    
[0m12:39:52.100310 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m12:39:52.100953 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:39:52.101460 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:39:52.101785 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:39:52.102181 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where price is null



  );
  
    
[0m12:39:52.102644 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:39:52.103000 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:39:52.103697 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:39:52.104420 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:39:52.105704 [debug] [Thread-2  ]: SQL status: BEGIN in 0.002 seconds
[0m12:39:52.106285 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.106725 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:39:52.106983 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:39:52.107258 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m12:39:52.107558 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m12:39:52.109609 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.109983 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:52.111209 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m12:39:52.111590 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:39:52.112643 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m12:39:52.112971 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.011 seconds
[0m12:39:52.114274 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:39:52.114685 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: Close
[0m12:39:52.116516 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:39:52.116893 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: Close
[0m12:39:52.117281 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:39:52.117615 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:39:52.120421 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:39:52.119572 [info ] [Thread-2  ]: 10 of 25 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.11s]
[0m12:39:52.120116 [info ] [Thread-1  ]: 9 of 25 PASS not_null_dim_customers_name ....................................... [[32mPASS[0m in 0.12s]
[0m12:39:52.121291 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:39:52.122119 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:39:52.122495 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:39:52.122941 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:39:52.123484 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:39:52.123850 [info ] [Thread-2  ]: 13 of 25 START test not_null_dim_products_total_quantity_sold .................. [RUN]
[0m12:39:52.124349 [info ] [Thread-1  ]: 14 of 25 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m12:39:52.124848 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:39:52.125235 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:39:52.125530 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:39:52.126064 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:39:52.132556 [debug] [Thread-3  ]: SQL status: COMMIT in 0.011 seconds
[0m12:39:52.133137 [debug] [Thread-4  ]: SQL status: COMMIT in 0.010 seconds
[0m12:39:52.134250 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:39:52.139796 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:39:52.140514 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:39:52.141185 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:39:52.142109 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:39:52.142383 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:39:52.142712 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:39:52.148148 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m12:39:52.148885 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:39:52.149257 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:39:52.149520 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:39:52.149957 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:39:52.150234 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:39:52.150481 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:39:52.150945 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m12:39:52.151216 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue" cascade
[0m12:39:52.156563 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:39:52.156953 [debug] [Thread-4  ]: SQL status: BEGIN in 0.005 seconds
[0m12:39:52.157306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:52.157849 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:39:52.158151 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:39:52.158454 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.158794 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold" cascade
[0m12:39:52.164839 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:39:52.275647 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m12:39:52.276394 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.077 seconds
[0m12:39:52.203540 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:39:52.277853 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m12:39:52.278259 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: Close
[0m12:39:52.278937 [info ] [Thread-3  ]: 11 of 25 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.23s]
[0m12:39:52.279351 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: Close
[0m12:39:52.279827 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:39:52.280485 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:39:52.281492 [info ] [Thread-3  ]: 15 of 25 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m12:39:52.281876 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:39:52.282132 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:39:52.290219 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:39:52.291304 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.133 seconds
[0m12:39:52.289207 [info ] [Thread-4  ]: 12 of 25 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.24s]
[0m12:39:52.294846 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:39:52.305638 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:39:52.306470 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:39:52.311858 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:39:52.312256 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.123 seconds
[0m12:39:52.312861 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:39:52.313216 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:39:52.313589 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:39:52.314390 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:39:52.314725 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:39:52.315014 [info ] [Thread-4  ]: 16 of 25 START test not_null_fct_orders_order_date ............................. [RUN]
[0m12:39:52.315278 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m12:39:52.315877 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:39:52.316285 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:39:52.316608 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:39:52.316907 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:39:52.317153 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.317430 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:39:52.317842 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:39:52.322031 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:39:52.322439 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m12:39:52.322703 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_revenue is null



  );
  
    
[0m12:39:52.323053 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:39:52.323413 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_quantity_sold is null



  );
  
    
[0m12:39:52.323881 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:39:52.329985 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:39:52.330354 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:39:52.330865 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:39:52.331155 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:39:52.331813 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:39:52.332073 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:39:52.332405 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m12:39:52.333079 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:39:52.333420 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:39:52.334118 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:39:52.334388 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:39:52.334641 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:39:52.334879 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:39:52.335471 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:39:52.336106 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:39:52.337410 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:39:52.338856 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.339348 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:39:52.339676 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m12:39:52.342945 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m12:39:52.343942 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:39:52.344314 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m12:39:52.344782 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:39:52.345332 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:39:52.345633 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:39:52.345921 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:39:52.346187 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:39:52.346825 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.347110 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.347615 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:39:52.347899 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:39:52.348201 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:39:52.348469 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:39:52.348775 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
    
      
    ) dbt_internal_test
[0m12:39:52.349531 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:39:52.349970 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
    
      
    ) dbt_internal_test
[0m12:39:52.350951 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:39:52.351330 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:39:52.352579 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:39:52.353286 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.354031 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.003 seconds
[0m12:39:52.354525 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:39:52.354818 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:39:52.356111 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m12:39:52.359170 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: ROLLBACK
[0m12:39:52.361815 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m12:39:52.362770 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m12:39:52.363176 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: Close
[0m12:39:52.363567 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:39:52.364328 [info ] [Thread-1  ]: 14 of 25 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.24s]
[0m12:39:52.365022 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m12:39:52.366185 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_date is null



  );
  
    
[0m12:39:52.365814 [info ] [Thread-2  ]: 13 of 25 PASS not_null_dim_products_total_quantity_sold ........................ [[32mPASS[0m in 0.24s]
[0m12:39:52.366878 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:39:52.367501 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:39:52.368072 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:39:52.369159 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:39:52.370297 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:39:52.370812 [info ] [Thread-1  ]: 17 of 25 START test not_null_fct_orders_order_id ............................... [RUN]
[0m12:39:52.371370 [info ] [Thread-2  ]: 18 of 25 START test not_null_fct_orders_status ................................. [RUN]
[0m12:39:52.372595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:39:52.373108 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:39:52.373673 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:39:52.374012 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:39:52.374734 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:39:52.376133 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:39:52.380677 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:39:52.384968 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:39:52.385404 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:39:52.386155 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:39:52.387012 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:39:52.387349 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:39:52.387633 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:39:52.387894 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:39:52.388174 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.393863 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:39:52.399075 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:39:52.399469 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:39:52.399749 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m12:39:52.400253 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:39:52.400633 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:39:52.400899 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m12:39:52.401334 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:39:52.401599 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m12:39:52.401852 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m12:39:52.402203 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:39:52.402464 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:52.403150 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:39:52.403448 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.403804 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:39:52.405056 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m12:39:52.405976 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m12:39:52.406339 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.406637 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:39:52.407619 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m12:39:52.407183 [info ] [Thread-3  ]: 15 of 25 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.13s]
[0m12:39:52.408298 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:39:52.408599 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:39:52.408942 [info ] [Thread-3  ]: 19 of 25 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m12:39:52.409303 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:39:52.409558 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:39:52.409901 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:52.414647 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:39:52.415952 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m12:39:52.416666 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:39:52.417019 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: Close
[0m12:39:52.417784 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:39:52.418137 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:39:52.418430 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:39:52.418982 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:39:52.419400 [info ] [Thread-4  ]: 16 of 25 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.10s]
[0m12:39:52.420329 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:39:52.425486 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:39:52.425855 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:39:52.426244 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:39:52.426794 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:39:52.427223 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:39:52.427574 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:39:52.428498 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.428872 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:39:52.429190 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m12:39:52.429492 [info ] [Thread-4  ]: 20 of 25 START test not_null_fct_orders_total_items ............................ [RUN]
[0m12:39:52.429793 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:39:52.430083 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:39:52.430429 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:39:52.430792 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.431029 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where status is null



  );
  
    
[0m12:39:52.431389 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:39:52.431645 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:39:52.436355 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:39:52.436753 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_id is null



  );
  
    
[0m12:39:52.437535 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:39:52.445014 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:39:52.445385 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.013 seconds
[0m12:39:52.445678 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:39:52.446957 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:39:52.447697 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:39:52.447987 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.018 seconds
[0m12:39:52.448599 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:39:52.448892 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items" cascade
[0m12:39:52.449185 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:39:52.449989 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:39:52.450302 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:39:52.450555 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:39:52.450812 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:39:52.451339 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:39:52.451615 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:39:52.452017 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:39:52.452937 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.453414 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:39:52.453697 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m12:39:52.457674 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m12:39:52.458336 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:39:52.458667 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m12:39:52.459227 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:39:52.459727 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:39:52.460057 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:39:52.460322 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:39:52.460623 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:39:52.460923 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:39:52.461703 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:39:52.462020 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.462269 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.462519 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:39:52.462768 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:39:52.463029 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:39:52.463273 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:39:52.464005 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:39:52.464295 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:39:52.464572 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:39:52.464845 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m12:39:52.465381 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:39:52.465826 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:39:52.467270 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.468728 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m12:39:52.469042 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m12:39:52.469279 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m12:39:52.469507 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:39:52.469803 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:39:52.470276 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:39:52.470502 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m12:39:52.471482 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: ROLLBACK
[0m12:39:52.471872 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_items is null



  );
  
    
[0m12:39:52.472663 [info ] [Thread-1  ]: 17 of 25 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.10s]
[0m12:39:52.473257 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:39:52.473795 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:39:52.474049 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: Close
[0m12:39:52.474337 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:39:52.474647 [debug] [Thread-1  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:39:52.475583 [info ] [Thread-2  ]: 18 of 25 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.10s]
[0m12:39:52.476296 [info ] [Thread-1  ]: 21 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m12:39:52.476881 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.477250 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:39:52.477657 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:39:52.477931 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:39:52.478285 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:39:52.480185 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:39:52.481378 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m12:39:52.482097 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:39:52.482402 [info ] [Thread-2  ]: 22 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m12:39:52.491303 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:39:52.492249 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:39:52.492802 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:39:52.493365 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:39:52.494352 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:39:52.495466 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:39:52.496983 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m12:39:52.497452 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:39:52.498104 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:39:52.504062 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:39:52.510229 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:39:52.510538 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m12:39:52.510815 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m12:39:52.511274 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:39:52.511737 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:39:52.512132 [info ] [Thread-3  ]: 19 of 25 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.10s]
[0m12:39:52.512415 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m12:39:52.512890 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:39:52.513182 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:39:52.513424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:52.513701 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:39:52.514000 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:39:52.518633 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:39:52.519024 [info ] [Thread-3  ]: 23 of 25 START test unique_dim_customers_email ................................. [RUN]
[0m12:39:52.519303 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:39:52.519699 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:39:52.519999 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:39:52.520322 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m12:39:52.520795 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:39:52.521059 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.521297 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:39:52.524903 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:39:52.525211 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:39:52.525673 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
    
      
    ) dbt_internal_test
[0m12:39:52.526059 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:39:52.566836 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.053 seconds
[0m12:39:52.567181 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.041 seconds
[0m12:39:52.567856 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:39:52.569616 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:39:52.570540 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: ROLLBACK
[0m12:39:52.571051 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:39:52.571469 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:39:52.571686 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.050 seconds
[0m12:39:52.571941 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:39:52.572239 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m12:39:52.572447 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: Close
[0m12:39:52.573030 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:39:52.573274 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:39:52.573575 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.574038 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:39:52.574414 [info ] [Thread-4  ]: 20 of 25 PASS not_null_fct_orders_total_items .................................. [[32mPASS[0m in 0.14s]
[0m12:39:52.574926 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:39:52.575275 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:39:52.575664 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:39:52.575969 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex2"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex2"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m12:39:52.576537 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:39:52.576856 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.577208 [info ] [Thread-4  ]: 24 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m12:39:52.577495 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:39:52.577803 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:39:52.578073 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m12:39:52.578340 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:39:52.582075 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:39:52.582417 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:39:52.582734 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.004 seconds
[0m12:39:52.583437 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:39:52.583709 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:39:52.584246 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:39:52.584527 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:39:52.584783 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:39:52.585355 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:39:52.585589 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:39:52.585829 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:39:52.590601 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:39:52.591162 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:39:52.591409 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:39:52.591789 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:39:52.592044 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:39:52.592332 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m12:39:52.592615 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:39:52.592981 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.593235 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:39:52.593477 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:39:52.593737 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:39:52.594182 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:39:52.594494 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m12:39:52.595651 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:39:52.596220 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:39:52.596483 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:39:52.596730 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:39:52.596976 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:39:52.597473 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.597714 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:39:52.597968 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m12:39:52.598210 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.598469 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:39:52.598699 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:39:52.598962 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.599914 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m12:39:52.600193 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.601256 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m12:39:52.601548 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.009 seconds
[0m12:39:52.601894 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:39:52.602203 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m12:39:52.602469 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m12:39:52.603153 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:39:52.603751 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:39:52.604509 [info ] [Thread-1  ]: 21 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.13s]
[0m12:39:52.606385 [info ] [Thread-2  ]: 22 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.11s]
[0m12:39:52.607641 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:39:52.607953 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:39:52.608377 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:39:52.608874 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:39:52.609153 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:39:52.609733 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:39:52.610036 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:39:52.610492 [info ] [Thread-1  ]: 25 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m12:39:52.610870 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:39:52.611212 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:39:52.611473 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:39:52.611795 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:39:52.616023 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:39:52.616381 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m12:39:52.616674 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m12:39:52.617211 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:39:52.617950 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:39:52.623079 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:39:52.623434 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:39:52.623837 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:39:52.624105 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:39:52.624765 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:39:52.625045 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m12:39:52.625303 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:39:52.625553 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:39:52.625795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:39:52.626057 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:39:52.626511 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.626755 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:39:52.627010 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:39:52.628170 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.628455 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:39:52.629647 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m12:39:52.630535 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:39:52.631122 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: Close
[0m12:39:52.631426 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:39:52.631897 [info ] [Thread-3  ]: 23 of 25 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.11s]
[0m12:39:52.632177 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:39:52.632519 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:39:52.633170 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.633424 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:39:52.633703 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:39:52.634840 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.635805 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m12:39:52.636258 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:39:52.636678 [info ] [Thread-4  ]: 24 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.06s]
[0m12:39:52.637075 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:39:52.637318 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:39:52.638074 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:39:52.638546 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:39:52.638770 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:39:52.639234 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.639453 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:39:52.639682 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m12:39:52.641535 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m12:39:52.642157 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:39:52.642413 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:39:52.642638 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:39:52.644050 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m12:39:52.644475 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:39:52.644950 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:39:52.645177 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:39:52.645634 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:39:52.645881 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:39:52.646112 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:39:52.646845 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:39:52.647755 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m12:39:52.648179 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m12:39:52.648599 [info ] [Thread-1  ]: 25 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m12:39:52.648963 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:39:52.649855 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:52.650069 [debug] [MainThread]: On master: BEGIN
[0m12:39:52.650249 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:52.657338 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:39:52.657638 [debug] [MainThread]: On master: COMMIT
[0m12:39:52.657837 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:52.658019 [debug] [MainThread]: On master: COMMIT
[0m12:39:52.658504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:39:52.658726 [debug] [MainThread]: On master: Close
[0m12:39:52.659015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:52.659206 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m12:39:52.659384 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m12:39:52.659557 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m12:39:52.659729 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m12:39:52.659980 [info ] [MainThread]: 
[0m12:39:52.660204 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m12:39:52.662358 [debug] [MainThread]: Command end result
[0m12:39:52.693040 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:39:52.694659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:39:52.704670 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:39:52.705043 [info ] [MainThread]: 
[0m12:39:52.705386 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:39:52.705609 [info ] [MainThread]: 
[0m12:39:52.706106 [error] [MainThread]: [31mFailure in test assert_no_duplicate_orders (tests/assert_no_duplicate_orders.sql)[0m
[0m12:39:52.706347 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m12:39:52.706536 [info ] [MainThread]: 
[0m12:39:52.706779 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/tests/assert_no_duplicate_orders.sql
[0m12:39:52.707013 [info ] [MainThread]: 
[0m12:39:52.707252 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  --------------------------------------------------------------------------------
[0m12:39:52.707478 [info ] [MainThread]: 
[0m12:39:52.707912 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=1 SKIP=0 TOTAL=25
[0m12:39:52.709055 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.7137818, "process_in_blocks": "0", "process_kernel_time": 0.232673, "process_mem_max_rss": "132186112", "process_out_blocks": "0", "process_user_time": 2.347381}
[0m12:39:52.709417 [debug] [MainThread]: Command `dbt test` failed at 12:39:52.709352 after 1.71 seconds
[0m12:39:52.709821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119633dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119633df0>]}
[0m12:39:52.710192 [debug] [MainThread]: Flushing usage events
[0m12:39:53.726111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:54.859077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129cb760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a6b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a6b040>]}


============================== 12:39:54.861919 | 403a4aa0-5f83-491e-b72b-d041cdd95f4e ==============================
[0m12:39:54.861919 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:39:54.862315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:54.986588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '403a4aa0-5f83-491e-b72b-d041cdd95f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb1580>]}
[0m12:39:55.032633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '403a4aa0-5f83-491e-b72b-d041cdd95f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a2b4f0>]}
[0m12:39:55.033209 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:39:55.112926 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:39:55.226669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:55.226953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:55.232080 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:39:55.293839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '403a4aa0-5f83-491e-b72b-d041cdd95f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114940e20>]}
[0m12:39:55.302535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '403a4aa0-5f83-491e-b72b-d041cdd95f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144eda00>]}
[0m12:39:55.302881 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:39:55.303111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '403a4aa0-5f83-491e-b72b-d041cdd95f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144ed9a0>]}
[0m12:39:55.304517 [info ] [MainThread]: 
[0m12:39:55.304743 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:55.304934 [info ] [MainThread]: 
[0m12:39:55.305224 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:55.309329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:39:55.309738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:39:55.343674 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:39:55.344030 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:39:55.344255 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:39:55.344462 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:39:55.344661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:55.344848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:55.373090 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m12:39:55.373390 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:39:55.373605 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:39:55.374988 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m12:39:55.375246 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:39:55.375514 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:39:55.377632 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m12:39:55.378695 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:39:55.378943 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.003 seconds
[0m12:39:55.380468 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:39:55.380720 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:39:55.380938 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:39:55.392975 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:55.393269 [debug] [MainThread]: On master: BEGIN
[0m12:39:55.393459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:55.400980 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:39:55.401300 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:55.401571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:55.406852 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m12:39:55.408198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '403a4aa0-5f83-491e-b72b-d041cdd95f4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d77dc0>]}
[0m12:39:55.408488 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:55.408993 [debug] [MainThread]: On master: Close
[0m12:39:55.410423 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:39:55.410831 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:39:55.411209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_customers)
[0m12:39:55.411434 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:39:55.411676 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:39:55.411924 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_order_items)
[0m12:39:55.412170 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:39:55.412464 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:39:55.412743 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:39:55.412959 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:39:55.418630 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:39:55.418917 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:39:55.419906 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:39:55.422485 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:39:55.425190 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:39:55.428412 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:39:55.429201 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:39:55.429497 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:39:55.429754 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:39:55.429986 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:39:55.430475 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:39:55.430967 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:39:55.431374 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:39:55.431840 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:39:55.432296 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:39:55.432747 [debug] [Thread-3  ]: Began running node model.ecommerce_test.dim_products
[0m12:39:55.432982 [debug] [Thread-2  ]: Began running node model.ecommerce_test.fct_orders
[0m12:39:55.433247 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now test.ecommerce_test.assert_no_duplicate_orders)
[0m12:39:55.433490 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_customers
[0m12:39:55.433795 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.dim_products)
[0m12:39:55.434044 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.fct_orders)
[0m12:39:55.434364 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:39:55.434618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.dim_customers)
[0m12:39:55.434861 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:39:55.435106 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:39:55.438388 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:39:55.438725 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:39:55.441982 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:39:55.445364 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:39:55.448663 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:39:55.449318 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:39:55.449585 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:39:55.450065 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:39:55.450293 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.dim_products
[0m12:39:55.450505 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:39:55.450983 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:39:55.451546 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.dim_products
[0m12:39:55.452126 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:39:55.452454 [debug] [Thread-4  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:39:55.452682 [debug] [Thread-2  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:39:55.452941 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:39:55.453394 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:39:55.453841 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:39:55.454124 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.fct_orders, now test.ecommerce_test.assert_total_amount_equals_sum_of_items)
[0m12:39:55.454397 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_products, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:39:55.454658 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_customers, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:39:55.454909 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:39:55.455151 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:39:55.455460 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:39:55.455695 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:39:55.466546 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:39:55.469620 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:39:55.476260 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:39:55.479807 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:39:55.480465 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:39:55.480738 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:39:55.481408 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:39:55.481644 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:39:55.481859 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:39:55.482288 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:39:55.482550 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:39:55.482935 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:39:55.483342 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:39:55.483606 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:39:55.483896 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:39:55.484164 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:39:55.484397 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:39:55.484681 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:39:55.484923 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:39:55.485176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:39:55.485427 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:39:55.485662 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:39:55.490025 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:39:55.490372 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:39:55.490623 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:39:55.494232 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:39:55.497927 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:39:55.501446 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:39:55.501909 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:39:55.503456 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:39:55.503702 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:39:55.503934 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:39:55.507773 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:39:55.510475 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:39:55.510768 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:39:55.511231 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:39:55.511524 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:39:55.511886 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:39:55.512381 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:39:55.512668 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:39:55.512950 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:39:55.513238 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:39:55.513521 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:39:55.513822 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:39:55.520060 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:39:55.520400 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:39:55.520720 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:39:55.520991 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:39:55.526278 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:39:55.526658 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:39:55.530305 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:39:55.530721 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:39:55.534400 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:39:55.535075 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:39:55.535414 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:39:55.535723 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:39:55.535948 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:39:55.536391 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:39:55.536683 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:39:55.537196 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:39:55.537415 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:39:55.537682 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:39:55.537915 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:39:55.538199 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:39:55.538627 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:39:55.539174 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:39:55.543713 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:39:55.544136 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:39:55.544447 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:39:55.544746 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:39:55.545052 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:39:55.545351 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:39:55.549174 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:39:55.553000 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:39:55.553342 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:39:55.553605 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:39:55.554192 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:39:55.557777 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:39:55.558225 [debug] [Thread-4  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:39:55.558495 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:39:55.558802 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:39:55.559173 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:39:55.559622 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:39:55.560014 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:39:55.560279 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:39:55.560555 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:39:55.560828 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:39:55.561065 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:39:55.574586 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:39:55.574964 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:39:55.575269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:39:55.575757 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:39:55.576088 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:39:55.576336 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:39:55.576631 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:39:55.580275 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:39:55.580591 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:39:55.584064 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:39:55.584438 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:39:55.584954 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:39:55.585323 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:39:55.585550 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:39:55.585879 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:39:55.586143 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:39:55.586625 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:39:55.590401 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:39:55.590967 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:39:55.591352 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:39:55.591653 [debug] [Thread-2  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:39:55.592024 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:39:55.592299 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:39:55.592603 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:39:55.592874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:39:55.596595 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:39:55.596950 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:39:55.597231 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:39:55.597485 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:39:55.598015 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:39:55.605586 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:39:55.609258 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:39:55.609689 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:39:55.610012 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:39:55.610444 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:39:55.610896 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:39:55.611235 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:39:55.611529 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:39:55.611763 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:39:55.615456 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:39:55.616018 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:39:55.616461 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:39:55.617068 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:39:55.617522 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:39:55.618158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:55.618370 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m12:39:55.618555 [debug] [MainThread]: Connection 'test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m12:39:55.618732 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m12:39:55.618902 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_dim_customers_name.e0448e04f1' was properly closed.
[0m12:39:55.621577 [debug] [MainThread]: Command end result
[0m12:39:55.748018 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:39:55.750583 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:39:55.755808 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:39:55.757568 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:39:55.757804 [info ] [MainThread]: Building catalog
[0m12:39:55.768077 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db_ex2.information_schema'
[0m12:39:55.774216 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:39:55.774467 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: BEGIN
[0m12:39:55.774653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:55.787392 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:39:55.787730 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:39:55.788114 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "dbt_db_ex2.information_schema"} */

    
    

    select
        'dbt_db_ex2' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_lifetime_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_total_amount_equals_sum_of_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_amount')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_products_product_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_product_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_no_duplicate_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_email')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_quantity_sold')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_price')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_email')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_revenue')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_date')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:39:55.801583 [debug] [ThreadPool]: SQL status: SELECT 214 in 0.013 seconds
[0m12:39:55.812199 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: ROLLBACK
[0m12:39:55.813195 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: Close
[0m12:39:55.839560 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:39:55.868865 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:39:55.870188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:39:55.870437 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:39:55.871594 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.0686473, "process_in_blocks": "0", "process_kernel_time": 0.156932, "process_mem_max_rss": "129646592", "process_out_blocks": "0", "process_user_time": 1.745225}
[0m12:39:55.871908 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:39:55.871854 after 1.07 seconds
[0m12:39:55.872121 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:39:55.872301 [debug] [MainThread]: Connection 'dbt_db_ex2.information_schema' was properly closed.
[0m12:39:55.872519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129cb760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128af430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11492b6d0>]}
[0m12:39:55.872770 [debug] [MainThread]: Flushing usage events
[0m12:39:58.157826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:26.972138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111989700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11462bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11462bd30>]}


============================== 12:42:26.975274 | 208b808a-9690-4c8d-abaa-3a04de7bf317 ==============================
[0m12:42:26.975274 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:42:26.975674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': "dbt run-operation log_test_evidence --args {output_path: '../logs/test_evidence.log'}", 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:42:27.129663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '208b808a-9690-4c8d-abaa-3a04de7bf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106592ca0>]}
[0m12:42:27.177980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '208b808a-9690-4c8d-abaa-3a04de7bf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115029c10>]}
[0m12:42:27.179016 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:27.274140 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:42:27.419590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:42:27.419917 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:42:27.425861 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:42:27.501006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '208b808a-9690-4c8d-abaa-3a04de7bf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115dfc100>]}
[0m12:42:27.592478 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:42:27.595547 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:42:27.606605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '208b808a-9690-4c8d-abaa-3a04de7bf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ddd790>]}
[0m12:42:27.606992 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:42:27.607222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '208b808a-9690-4c8d-abaa-3a04de7bf317', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c292e0>]}
[0m12:42:27.607584 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_test_evidence'
[0m12:42:27.607799 [debug] [MainThread]: Using postgres connection "macro_log_test_evidence"
[0m12:42:27.607973 [debug] [MainThread]: On macro_log_test_evidence: BEGIN
[0m12:42:27.608142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:42:27.642175 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m12:42:27.642510 [debug] [MainThread]: On macro_log_test_evidence: COMMIT
[0m12:42:27.642721 [debug] [MainThread]: Using postgres connection "macro_log_test_evidence"
[0m12:42:27.642909 [debug] [MainThread]: On macro_log_test_evidence: COMMIT
[0m12:42:27.643531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:42:27.643839 [debug] [MainThread]: On macro_log_test_evidence: Close
[0m12:42:27.644189 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "log_test_evidence" in any package
[0m12:42:27.646800 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/adapters/base/impl.py", line 1260, in execute_macro
    raise DbtRuntimeError(
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "log_test_evidence" in any package

[0m12:42:27.647178 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'log_test_evidence' in any package
[0m12:42:27.648288 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.73077214, "process_in_blocks": "0", "process_kernel_time": 0.196873, "process_mem_max_rss": "119062528", "process_out_blocks": "0", "process_user_time": 1.406913}
[0m12:42:27.648559 [debug] [MainThread]: Command `dbt run-operation` failed at 12:42:27.648507 after 0.73 seconds
[0m12:42:27.648774 [debug] [MainThread]: Connection 'macro_log_test_evidence' was properly closed.
[0m12:42:27.648986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111989700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115aa6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115aa61c0>]}
[0m12:42:27.649226 [debug] [MainThread]: Flushing usage events
[0m12:42:29.708127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:43:30.800018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096876a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b03ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b03ae50>]}


============================== 12:43:30.803467 | 7e8e3810-a2f3-47ac-94dc-bcf66c2af780 ==============================
[0m12:43:30.803467 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:43:30.803869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --store-failures', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:43:31.005564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e8e3810-a2f3-47ac-94dc-bcf66c2af780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7f0d90>]}
[0m12:43:31.059577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e8e3810-a2f3-47ac-94dc-bcf66c2af780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3e1df0>]}
[0m12:43:31.060496 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:43:31.156816 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:43:31.325364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:43:31.325688 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:43:31.331397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:43:31.401368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e8e3810-a2f3-47ac-94dc-bcf66c2af780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bee6100>]}
[0m12:43:31.516145 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:43:31.520188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:43:31.539873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e8e3810-a2f3-47ac-94dc-bcf66c2af780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf34820>]}
[0m12:43:31.540276 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:43:31.540497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e8e3810-a2f3-47ac-94dc-bcf66c2af780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bec8520>]}
[0m12:43:31.542243 [info ] [MainThread]: 
[0m12:43:31.542471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:31.542653 [info ] [MainThread]: 
[0m12:43:31.542950 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:31.546823 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m12:43:31.580791 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m12:43:31.581106 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m12:43:31.581301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:31.613147 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.032 seconds
[0m12:43:31.614148 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m12:43:31.616525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m12:43:31.616879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:43:31.622170 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:43:31.624388 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:43:31.624617 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:43:31.624811 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:43:31.624998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:31.625178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:31.638042 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:43:31.638365 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m12:43:31.638633 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:43:31.638892 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:43:31.639159 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:43:31.639499 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:43:31.645777 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.006 seconds
[0m12:43:31.646112 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m12:43:31.647845 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:43:31.648743 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:43:31.649276 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:43:31.649518 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:43:31.660916 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:31.661219 [debug] [MainThread]: On master: BEGIN
[0m12:43:31.661449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:31.669268 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:43:31.669584 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:31.669864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:31.717590 [debug] [MainThread]: SQL status: SELECT 4 in 0.047 seconds
[0m12:43:31.720099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e8e3810-a2f3-47ac-94dc-bcf66c2af780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c379730>]}
[0m12:43:31.720533 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:31.721266 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:31.721509 [debug] [MainThread]: On master: BEGIN
[0m12:43:31.722203 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:43:31.722416 [debug] [MainThread]: On master: COMMIT
[0m12:43:31.722605 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:31.722788 [debug] [MainThread]: On master: COMMIT
[0m12:43:31.723259 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:31.723475 [debug] [MainThread]: On master: Close
[0m12:43:31.726487 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:43:31.726845 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:43:31.727103 [info ] [Thread-1  ]: 1 of 25 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m12:43:31.727375 [info ] [Thread-2  ]: 2 of 25 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m12:43:31.727698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:43:31.727925 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:43:31.728173 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:43:31.728389 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:43:31.728630 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:43:31.728867 [info ] [Thread-3  ]: 3 of 25 START test assert_no_duplicate_orders .................................. [RUN]
[0m12:43:31.729127 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:43:31.729375 [info ] [Thread-4  ]: 4 of 25 START test assert_total_amount_equals_sum_of_items ..................... [RUN]
[0m12:43:31.742411 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_no_duplicate_orders'
[0m12:43:31.743957 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:43:31.749904 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:43:31.750567 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_total_amount_equals_sum_of_items'
[0m12:43:31.750868 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:43:31.751266 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:43:31.754415 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:43:31.757384 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:43:31.757701 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:43:31.757946 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:43:31.774436 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:43:31.780179 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:43:31.782598 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:43:31.785850 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:43:31.786159 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:43:31.791906 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:43:31.792423 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:43:31.792730 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m12:43:31.797675 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:43:31.798135 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:43:31.798397 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m12:43:31.798642 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:43:31.798990 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:43:31.799222 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders" cascade
[0m12:43:31.799443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:31.800008 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items" cascade
[0m12:43:31.800403 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:43:31.801193 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:43:31.816751 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.017 seconds
[0m12:43:31.817123 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.017 seconds
[0m12:43:31.817423 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:43:31.819266 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:43:31.819610 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.021 seconds
[0m12:43:31.820253 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:43:31.820873 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:43:31.829811 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:43:31.830582 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:43:31.831091 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:43:31.831518 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:43:31.831760 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:43:31.832188 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:43:31.832432 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:43:31.832658 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:43:31.832957 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:43:31.836187 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m12:43:31.836547 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m12:43:31.836790 [debug] [Thread-2  ]: SQL status: BEGIN in 0.003 seconds
[0m12:43:31.837005 [debug] [Thread-4  ]: SQL status: BEGIN in 0.004 seconds
[0m12:43:31.837238 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:43:31.837550 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:43:31.837854 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:43:31.838130 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:43:31.838447 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m12:43:31.838748 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  
  
    as
  
  (
    /*
  Custom test to ensure there are no duplicate orders in the core table.
  This test checks for duplicates based on customer_id and order_date within 15 minutes
*/

with orders as (
    select 
        customer_id,
        order_date,
        count(*) as order_count
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1, 2
),

potential_duplicates as (
    select
        o1.customer_id,
        o1.order_date as order_date_1,
        o2.order_date as order_date_2,
        abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) as minutes_difference
    from "dbt_db_ex2"."public"."stg_orders" o1
    join "dbt_db_ex2"."public"."stg_orders" o2
        on o1.customer_id = o2.customer_id
        and o1.order_id <> o2.order_id
        and abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) < 15  -- Orders less than 15 minutes apart
)

select * from potential_duplicates
  );
  
    
[0m12:43:31.839196 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m12:43:31.839619 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
  
  
    as
  
  (
    /*
  Custom test to check if the total amount in orders table
  matches the sum of the item amounts in order_items.
  
  If there are differences, this test will return the records with discrepancies.
*/

with orders as (
    select 
        order_id,
        total_amount as order_total
    from "dbt_db_ex2"."public"."fct_orders"
),

order_items_grouped as (
    select
        order_id,
        sum(quantity * unit_price) as items_total
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

joined as (
    select
        o.order_id,
        o.order_total,
        coalesce(oi.items_total, 0) as items_total,
        abs(o.order_total - coalesce(oi.items_total, 0)) as difference
    from orders o
    left join order_items_grouped oi on o.order_id = oi.order_id
)

select * from joined where difference > 0.01  -- Allow small rounding differences
  );
  
    
[0m12:43:31.853612 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.013 seconds
[0m12:43:31.854069 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.014 seconds
[0m12:43:31.855366 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:43:31.856018 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:43:31.860334 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:43:31.860841 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:43:31.861229 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:43:31.861507 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:43:31.862185 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.022 seconds
[0m12:43:31.862884 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:43:31.863146 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.023 seconds
[0m12:43:31.863420 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:43:31.864034 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:43:31.864292 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:43:31.864515 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m12:43:31.864738 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:43:31.864978 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:43:31.867925 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:43:31.868401 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:43:31.868696 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:43:31.869329 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:43:31.869604 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:43:31.869893 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:43:31.870173 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:43:31.870462 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:31.870730 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:43:31.871013 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:31.871290 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m12:43:31.871554 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m12:43:31.871817 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:43:31.872949 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:43:31.873427 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:31.873657 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m12:43:31.873925 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m12:43:31.876807 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m12:43:31.877286 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:43:31.877740 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:43:31.877998 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:43:31.878260 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m12:43:31.878531 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:31.880456 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m12:43:31.881568 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m12:43:31.881303 [info ] [Thread-1  ]: 1 of 25 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.15s]
[0m12:43:31.881991 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m12:43:31.882400 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:43:31.882965 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:43:31.883377 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:43:31.883777 [info ] [Thread-2  ]: 2 of 25 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.16s]
[0m12:43:31.884081 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
    
      
    ) dbt_internal_test
[0m12:43:31.884390 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:43:31.884695 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:43:31.885042 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:43:31.885387 [info ] [Thread-1  ]: 5 of 25 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m12:43:31.885755 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:43:31.886114 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:31.886413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:43:31.886648 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:31.886936 [info ] [Thread-2  ]: 6 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m12:43:31.887923 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: ROLLBACK
[0m12:43:31.888242 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:43:31.888502 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:43:31.888805 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:43:31.894866 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: Close
[0m12:43:31.901473 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
    
      
    ) dbt_internal_test
[0m12:43:31.902544 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:43:31.902823 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:43:31.903250 [error] [Thread-3  ]: 3 of 25 FAIL 2 assert_no_duplicate_orders ...................................... [[31mFAIL 2[0m in 0.16s]
[0m12:43:31.909142 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:43:31.909632 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:43:31.909887 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.007 seconds
[0m12:43:31.910255 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:43:31.910504 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:43:31.911448 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: ROLLBACK
[0m12:43:31.911719 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:43:31.911950 [info ] [Thread-3  ]: 7 of 25 START test not_null_dim_customers_email ................................ [RUN]
[0m12:43:31.916618 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m12:43:31.921973 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:43:31.922300 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: Close
[0m12:43:31.922594 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:43:31.922996 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:43:31.923355 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:43:31.923760 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:43:31.924484 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3" cascade
[0m12:43:31.924163 [info ] [Thread-4  ]: 4 of 25 PASS assert_total_amount_equals_sum_of_items ........................... [[32mPASS[0m in 0.17s]
[0m12:43:31.924876 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m12:43:31.929122 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:43:31.929474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:31.929799 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:43:31.930018 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:43:31.930480 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:43:31.930908 [info ] [Thread-4  ]: 8 of 25 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m12:43:31.931343 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:43:31.931601 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:43:31.936174 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:43:31.936517 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:43:31.975762 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:43:31.976155 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.046 seconds
[0m12:43:31.976681 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:43:31.976983 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:43:31.977636 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:43:31.977866 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.048 seconds
[0m12:43:31.978104 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m12:43:31.982746 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:43:31.983273 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:43:31.983959 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m12:43:31.984207 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:43:31.984565 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:43:31.984795 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:43:31.985214 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:43:31.985541 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m12:43:31.985822 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:43:31.986047 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:43:31.986574 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:31.987279 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:43:31.987600 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:31.987914 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m12:43:31.988421 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:43:31.988780 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
  
  
    as
  
  (
    




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(email, '^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$', '')), 1), 0)


 > 0
 as expression


    from "dbt_db_ex2"."public"."dim_customers"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  );
  
    
[0m12:43:31.992442 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:43:31.993153 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:43:31.993425 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:43:31.993674 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:43:31.994611 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:43:31.995218 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:43:31.995466 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:43:31.995743 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:43:31.996012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:43:31.996483 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:43:31.996978 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:43:31.997234 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:43:31.997491 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.011 seconds
[0m12:43:31.997739 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:43:31.998442 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:43:31.999047 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:43:31.999260 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m12:43:31.999582 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m12:43:32.000159 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:43:32.000625 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:43:32.001026 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:43:32.001316 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:43:32.001581 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:43:32.001855 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:43:32.002193 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
    
      
    ) dbt_internal_test
[0m12:43:32.002635 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:43:32.002925 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.003153 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.003382 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.003592 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:43:32.003818 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:43:32.004046 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:43:32.004949 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: ROLLBACK
[0m12:43:32.005224 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m12:43:32.005467 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.005701 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where email is null



  );
  
    
[0m12:43:32.005994 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:43:32.006241 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: Close
[0m12:43:32.006526 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:43:32.007001 [info ] [Thread-1  ]: 5 of 25 PASS dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[32mPASS[0m in 0.12s]
[0m12:43:32.007424 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:43:32.007693 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:43:32.007943 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.008260 [info ] [Thread-1  ]: 9 of 25 START test not_null_dim_customers_name ................................. [RUN]
[0m12:43:32.009316 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m12:43:32.009653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:43:32.009964 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:43:32.010215 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m12:43:32.014568 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:43:32.014932 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:43:32.015191 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:43:32.016413 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:43:32.015674 [info ] [Thread-2  ]: 6 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.13s]
[0m12:43:32.017140 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:43:32.017440 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:43:32.017716 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:43:32.018047 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:43:32.018285 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:43:32.018533 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:43:32.023716 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:43:32.023990 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:43:32.024251 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:43:32.024648 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:43:32.024912 [info ] [Thread-2  ]: 10 of 25 START test not_null_dim_products_name ................................. [RUN]
[0m12:43:32.025223 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m12:43:32.025655 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:43:32.026012 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:32.026391 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:43:32.030771 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:43:32.031109 [debug] [Thread-4  ]: SQL status: COMMIT in 0.006 seconds
[0m12:43:32.031394 [debug] [Thread-3  ]: SQL status: COMMIT in 0.007 seconds
[0m12:43:32.031807 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:43:32.032195 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:43:32.032515 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:43:32.037737 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:43:32.038210 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:43:32.038509 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m12:43:32.038761 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:43:32.039014 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:43:32.039359 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.013 seconds
[0m12:43:32.039652 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:43:32.039951 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:43:32.040663 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:43:32.040941 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:43:32.041499 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:43:32.041759 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.042448 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:43:32.042856 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:43:32.043088 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.043486 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m12:43:32.043855 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.044113 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:43:32.044396 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:43:32.044647 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:43:32.044918 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where name is null



  );
  
    
[0m12:43:32.045178 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.046358 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m12:43:32.046632 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.047562 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m12:43:32.047895 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m12:43:32.048320 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: Close
[0m12:43:32.048769 [info ] [Thread-4  ]: 8 of 25 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.12s]
[0m12:43:32.049986 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:43:32.050560 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:43:32.049540 [info ] [Thread-3  ]: 7 of 25 PASS not_null_dim_customers_email ...................................... [[32mPASS[0m in 0.13s]
[0m12:43:32.051104 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:43:32.051641 [info ] [Thread-4  ]: 11 of 25 START test not_null_dim_products_price ................................ [RUN]
[0m12:43:32.052026 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:43:32.052288 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.013 seconds
[0m12:43:32.053006 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:43:32.053348 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:43:32.053679 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:43:32.054455 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:43:32.054760 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:43:32.055036 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:43:32.055300 [info ] [Thread-3  ]: 12 of 25 START test not_null_dim_products_product_id ........................... [RUN]
[0m12:43:32.055838 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:43:32.056070 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:43:32.059509 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:43:32.059814 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:43:32.060059 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:43:32.060367 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:43:32.064690 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:43:32.065015 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m12:43:32.065243 [debug] [Thread-2  ]: SQL status: BEGIN in 0.005 seconds
[0m12:43:32.065681 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:43:32.065934 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:43:32.066400 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:43:32.066671 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:43:32.071974 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:43:32.076712 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:43:32.077178 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where name is null



  );
  
    
[0m12:43:32.077646 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:43:32.078008 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:43:32.078402 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m12:43:32.078694 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:43:32.079152 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m12:43:32.079463 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:43:32.079782 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:43:32.080067 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:43:32.080971 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.081247 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:43:32.081490 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m12:43:32.082660 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.084583 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m12:43:32.084967 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:43:32.085974 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:43:32.086383 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: Close
[0m12:43:32.086649 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:43:32.090074 [info ] [Thread-1  ]: 9 of 25 PASS not_null_dim_customers_name ....................................... [[32mPASS[0m in 0.08s]
[0m12:43:32.090632 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:43:32.091009 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:43:32.091371 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:43:32.091701 [info ] [Thread-1  ]: 13 of 25 START test not_null_dim_products_total_quantity_sold .................. [RUN]
[0m12:43:32.092067 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:43:32.092320 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:43:32.097249 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:43:32.097603 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m12:43:32.098137 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:43:32.098622 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:43:32.105228 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.025 seconds
[0m12:43:32.105631 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:43:32.105869 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.026 seconds
[0m12:43:32.106148 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:43:32.107062 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:43:32.107560 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:43:32.108233 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:43:32.108504 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:43:32.108981 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:43:32.109229 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold" cascade
[0m12:43:32.109677 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:43:32.109938 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:43:32.110169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:32.110405 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.110618 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:43:32.110960 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:43:32.111376 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.111667 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m12:43:32.112047 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:43:32.112289 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.112566 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where price is null



  );
  
    
[0m12:43:32.112811 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:43:32.113170 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.113451 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where product_id is null



  );
  
    
[0m12:43:32.114529 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m12:43:32.115041 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: Close
[0m12:43:32.115549 [info ] [Thread-2  ]: 10 of 25 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.09s]
[0m12:43:32.116952 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:43:32.117391 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:43:32.117853 [info ] [Thread-2  ]: 14 of 25 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m12:43:32.118305 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:43:32.118589 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:43:32.118939 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:43:32.123353 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:43:32.123693 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:43:32.124368 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:43:32.125000 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:43:32.125267 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:43:32.125512 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:43:32.125804 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:43:32.126062 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:43:32.126678 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:43:32.126909 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:43:32.127137 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:43:32.131957 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:43:32.132471 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:43:32.133090 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:43:32.133383 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:43:32.133679 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue" cascade
[0m12:43:32.134109 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:43:32.134548 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.134917 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:43:32.135288 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m12:43:32.135683 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_quantity_sold is null



  );
  
    
[0m12:43:32.136253 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:43:32.136587 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m12:43:32.137176 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:43:32.137710 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:43:32.137982 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:43:32.138223 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:43:32.138466 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:43:32.139037 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.139279 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.139534 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:43:32.139789 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:43:32.140044 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:43:32.140317 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m12:43:32.141999 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.142250 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:43:32.143297 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m12:43:32.143581 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:43:32.144435 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m12:43:32.145676 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:43:32.146747 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.013 seconds
[0m12:43:32.147005 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: Close
[0m12:43:32.147422 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:43:32.148157 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:43:32.148439 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: Close
[0m12:43:32.148849 [info ] [Thread-4  ]: 11 of 25 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.10s]
[0m12:43:32.149122 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:43:32.149628 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:43:32.150319 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:43:32.150020 [info ] [Thread-3  ]: 12 of 25 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m12:43:32.150673 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:43:32.150977 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:43:32.151345 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:43:32.151968 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:43:32.151620 [info ] [Thread-4  ]: 15 of 25 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m12:43:32.152332 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.152588 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:43:32.152815 [info ] [Thread-3  ]: 16 of 25 START test not_null_fct_orders_order_date ............................. [RUN]
[0m12:43:32.153121 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:43:32.153355 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:43:32.153747 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:43:32.153995 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:43:32.154232 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:43:32.154476 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_revenue is null



  );
  
    
[0m12:43:32.154753 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:43:32.158740 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:43:32.163767 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:43:32.164145 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:43:32.164470 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:43:32.165158 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:43:32.165418 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:43:32.165708 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:43:32.165966 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:43:32.166189 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:43:32.166436 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:43:32.170842 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:43:32.171101 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m12:43:32.176639 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:43:32.177168 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:43:32.177446 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:43:32.177815 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:43:32.178077 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m12:43:32.178412 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
    
      
    ) dbt_internal_test
[0m12:43:32.178669 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m12:43:32.178926 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m12:43:32.179131 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:43:32.179387 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:43:32.179853 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:43:32.180111 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.181276 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: ROLLBACK
[0m12:43:32.181781 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: Close
[0m12:43:32.182341 [info ] [Thread-1  ]: 13 of 25 PASS not_null_dim_products_total_quantity_sold ........................ [[32mPASS[0m in 0.09s]
[0m12:43:32.182759 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:43:32.183066 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:43:32.183405 [info ] [Thread-1  ]: 17 of 25 START test not_null_fct_orders_order_id ............................... [RUN]
[0m12:43:32.183764 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:43:32.184083 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:43:32.184325 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:43:32.184636 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:43:32.189417 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:43:32.190114 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.190410 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:43:32.190669 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:43:32.195736 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:43:32.196032 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.017 seconds
[0m12:43:32.196291 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
    
      
    ) dbt_internal_test
[0m12:43:32.196533 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.017 seconds
[0m12:43:32.196950 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:43:32.197648 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:43:32.198319 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:43:32.198577 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.198806 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m12:43:32.199261 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:43:32.199712 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:43:32.200701 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m12:43:32.200954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:32.201196 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:43:32.201436 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:43:32.202364 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m12:43:32.202650 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.202928 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.203881 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:43:32.203634 [info ] [Thread-2  ]: 14 of 25 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.09s]
[0m12:43:32.204198 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:43:32.204458 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m12:43:32.204826 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:43:32.205110 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_date is null



  );
  
    
[0m12:43:32.205455 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:43:32.205842 [info ] [Thread-2  ]: 18 of 25 START test not_null_fct_orders_status ................................. [RUN]
[0m12:43:32.206233 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:43:32.206489 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:43:32.210467 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:43:32.211171 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:43:32.211793 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:43:32.212651 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:43:32.213023 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:43:32.213669 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:43:32.213973 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:43:32.214681 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:43:32.214997 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:43:32.215238 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:43:32.215486 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:43:32.215947 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:43:32.220398 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:43:32.220654 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:43:32.220942 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:43:32.221385 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:43:32.221699 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m12:43:32.221961 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:43:32.222354 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.222598 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:43:32.222833 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_id is null



  );
  
    
[0m12:43:32.224674 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m12:43:32.225181 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:43:32.225735 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:43:32.226419 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:43:32.225995 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m12:43:32.227501 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:43:32.227866 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.228205 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:43:32.228505 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m12:43:32.229152 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:43:32.229418 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:43:32.229705 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.230856 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m12:43:32.231144 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:43:32.231417 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.232066 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:43:32.232337 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m12:43:32.232578 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:43:32.232843 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:43:32.233085 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.011 seconds
[0m12:43:32.233541 [info ] [Thread-4  ]: 15 of 25 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.08s]
[0m12:43:32.234044 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m12:43:32.234907 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:43:32.235688 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:43:32.236066 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:43:32.236627 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:43:32.236931 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:43:32.237241 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.237460 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:43:32.237716 [info ] [Thread-4  ]: 19 of 25 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m12:43:32.238646 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m12:43:32.238908 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m12:43:32.239287 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.239611 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:43:32.240143 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:43:32.240418 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:43:32.240638 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: Close
[0m12:43:32.240907 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:43:32.241238 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where status is null



  );
  
    
[0m12:43:32.245683 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:43:32.246111 [info ] [Thread-3  ]: 16 of 25 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.09s]
[0m12:43:32.246689 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:43:32.247072 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:43:32.247856 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:43:32.252670 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:43:32.253142 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:43:32.253422 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:43:32.253674 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m12:43:32.247628 [info ] [Thread-3  ]: 20 of 25 START test not_null_fct_orders_total_items ............................ [RUN]
[0m12:43:32.254041 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:43:32.254725 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:43:32.255039 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:43:32.255364 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:43:32.255615 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:43:32.255844 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:43:32.256161 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:43:32.256423 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:43:32.260531 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:43:32.260879 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m12:43:32.261237 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:43:32.261583 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:43:32.261949 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:43:32.267260 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:43:32.267698 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m12:43:32.268196 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:43:32.268505 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.007 seconds
[0m12:43:32.268993 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:43:32.269286 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items" cascade
[0m12:43:32.270283 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m12:43:32.270563 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:43:32.270872 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:43:32.271601 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:43:32.271962 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:43:32.272185 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m12:43:32.272838 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:43:32.273120 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:43:32.273617 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:43:32.274353 [info ] [Thread-1  ]: 17 of 25 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.09s]
[0m12:43:32.274894 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.275322 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:43:32.275717 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.275949 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:43:32.276263 [debug] [Thread-1  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:43:32.276553 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:43:32.276801 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m12:43:32.277070 [info ] [Thread-1  ]: 21 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m12:43:32.277339 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m12:43:32.277671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:43:32.277960 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:43:32.278216 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.285285 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: ROLLBACK
[0m12:43:32.285653 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:43:32.286366 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:43:32.288123 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:43:32.288641 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:43:32.288877 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: Close
[0m12:43:32.289144 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.011 seconds
[0m12:43:32.289432 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:43:32.290088 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:43:32.290474 [info ] [Thread-2  ]: 18 of 25 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.08s]
[0m12:43:32.290838 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:43:32.291234 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:43:32.291472 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:43:32.291720 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.291943 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:43:32.292215 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:43:32.297072 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:43:32.297413 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:43:32.297707 [info ] [Thread-2  ]: 22 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m12:43:32.298134 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:43:32.298396 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_items is null



  );
  
    
[0m12:43:32.298716 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:43:32.298981 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m12:43:32.299271 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:43:32.299538 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:43:32.299769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:32.305371 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:43:32.305857 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:43:32.306264 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:43:32.307202 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:43:32.307843 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:43:32.308154 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:43:32.308603 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:43:32.308862 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:43:32.309244 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:43:32.314607 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:43:32.314953 [debug] [Thread-4  ]: SQL status: BEGIN in 0.006 seconds
[0m12:43:32.315401 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:43:32.315644 [debug] [Thread-3  ]: SQL status: COMMIT in 0.007 seconds
[0m12:43:32.315912 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:43:32.316166 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m12:43:32.316570 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:43:32.316826 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m12:43:32.317080 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.017 seconds
[0m12:43:32.317285 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:43:32.318083 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:43:32.318350 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.318903 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:43:32.320103 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m12:43:32.320432 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:43:32.320701 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:43:32.320968 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:43:32.321253 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m12:43:32.321983 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.322263 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.322515 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:43:32.321737 [info ] [Thread-4  ]: 19 of 25 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.08s]
[0m12:43:32.322823 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:43:32.323101 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex2"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex2"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m12:43:32.323621 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:43:32.323864 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
    
      
    ) dbt_internal_test
[0m12:43:32.324161 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:43:32.324477 [info ] [Thread-4  ]: 23 of 25 START test unique_dim_customers_email ................................. [RUN]
[0m12:43:32.324795 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:43:32.325072 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.325347 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:43:32.326368 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: ROLLBACK
[0m12:43:32.330048 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:43:32.330450 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:43:32.330769 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: Close
[0m12:43:32.331430 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:43:32.331799 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:43:32.332738 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:43:32.332377 [info ] [Thread-3  ]: 20 of 25 PASS not_null_fct_orders_total_items .................................. [[32mPASS[0m in 0.08s]
[0m12:43:32.333958 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:43:32.334290 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:43:32.334652 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:43:32.335156 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:43:32.335398 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:43:32.335714 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:43:32.336037 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:43:32.383260 [debug] [Thread-1  ]: SQL status: COMMIT in 0.048 seconds
[0m12:43:32.385175 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:43:32.385470 [info ] [Thread-3  ]: 24 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m12:43:32.385951 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:43:32.386545 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:43:32.386866 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:43:32.387148 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.387483 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m12:43:32.387732 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:43:32.387984 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:43:32.388228 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:43:32.388460 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:43:32.391541 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:43:32.391798 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m12:43:32.392118 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:43:32.392510 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:43:32.397255 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:43:32.397555 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m12:43:32.397801 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:43:32.398192 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:43:32.398452 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:43:32.399852 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:43:32.400215 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m12:43:32.400501 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m12:43:32.400792 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:43:32.401039 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:43:32.401299 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.013 seconds
[0m12:43:32.401549 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:43:32.402315 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:43:32.402572 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.403117 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:43:32.404075 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m12:43:32.404352 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m12:43:32.404594 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:43:32.405034 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:43:32.405275 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m12:43:32.405764 [info ] [Thread-1  ]: 21 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.13s]
[0m12:43:32.406065 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.406445 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:43:32.406701 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:43:32.406979 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:43:32.407241 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:43:32.407538 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m12:43:32.407798 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:43:32.408070 [info ] [Thread-1  ]: 25 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m12:43:32.408464 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:43:32.408710 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.408942 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:43:32.409186 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.008 seconds
[0m12:43:32.409413 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:43:32.413550 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:43:32.413864 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:43:32.414573 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:43:32.416282 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:43:32.419272 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:43:32.422377 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:43:32.423524 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:43:32.423781 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:43:32.424046 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:43:32.424272 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:43:32.424507 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.429225 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:43:32.429517 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m12:43:32.430573 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m12:43:32.430997 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:43:32.431246 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:43:32.431520 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:43:32.431748 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m12:43:32.431962 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m12:43:32.432196 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m12:43:32.432577 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:43:32.432812 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:32.433356 [info ] [Thread-2  ]: 22 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.13s]
[0m12:43:32.433952 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:43:32.434520 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:43:32.434812 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:43:32.435648 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.435920 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:43:32.436239 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:43:32.436524 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:43:32.437195 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:43:32.437439 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.437666 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:43:32.438530 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m12:43:32.438768 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:43:32.439351 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: Close
[0m12:43:32.439978 [info ] [Thread-4  ]: 23 of 25 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.12s]
[0m12:43:32.440401 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:43:32.441041 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m12:43:32.441544 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:43:32.442339 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:43:32.442810 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:43:32.443553 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.443795 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:43:32.444017 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.011 seconds
[0m12:43:32.444280 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:43:32.444984 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:43:32.445490 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:43:32.445724 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:43:32.445950 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:43:32.446813 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m12:43:32.447334 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:43:32.447576 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:43:32.448319 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:43:32.448049 [info ] [Thread-3  ]: 24 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.06s]
[0m12:43:32.448667 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m12:43:32.449041 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:43:32.451551 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m12:43:32.452207 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:43:32.452538 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:43:32.452797 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:43:32.454911 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:43:32.455410 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:43:32.455852 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:43:32.456066 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:43:32.456513 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:43:32.456727 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:43:32.456934 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:43:32.457644 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m12:43:32.458532 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m12:43:32.458982 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m12:43:32.459409 [info ] [Thread-1  ]: 25 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.05s]
[0m12:43:32.459766 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:43:32.460559 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:32.460783 [debug] [MainThread]: On master: BEGIN
[0m12:43:32.460969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:32.468542 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:43:32.468837 [debug] [MainThread]: On master: COMMIT
[0m12:43:32.469037 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:32.469223 [debug] [MainThread]: On master: COMMIT
[0m12:43:32.469627 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:43:32.469846 [debug] [MainThread]: On master: Close
[0m12:43:32.470137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:32.470415 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m12:43:32.470603 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m12:43:32.470842 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m12:43:32.471053 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m12:43:32.471308 [info ] [MainThread]: 
[0m12:43:32.471534 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m12:43:32.473885 [debug] [MainThread]: Command end result
[0m12:43:32.529583 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:43:32.530804 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:43:32.536280 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:43:32.536554 [info ] [MainThread]: 
[0m12:43:32.536786 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:43:32.536979 [info ] [MainThread]: 
[0m12:43:32.537207 [error] [MainThread]: [31mFailure in test assert_no_duplicate_orders (tests/assert_no_duplicate_orders.sql)[0m
[0m12:43:32.537422 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m12:43:32.537591 [info ] [MainThread]: 
[0m12:43:32.537792 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/tests/assert_no_duplicate_orders.sql
[0m12:43:32.537961 [info ] [MainThread]: 
[0m12:43:32.538160 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  --------------------------------------------------------------------------------
[0m12:43:32.538363 [info ] [MainThread]: 
[0m12:43:32.538555 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=1 SKIP=0 TOTAL=25
[0m12:43:32.539597 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8157983, "process_in_blocks": "0", "process_kernel_time": 0.272854, "process_mem_max_rss": "126533632", "process_out_blocks": "0", "process_user_time": 2.276091}
[0m12:43:32.539836 [debug] [MainThread]: Command `dbt test` failed at 12:43:32.539792 after 1.82 seconds
[0m12:43:32.540061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096876a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf363a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf36c40>]}
[0m12:43:32.540285 [debug] [MainThread]: Flushing usage events
[0m12:43:33.661317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:31.844001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105747730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065af250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065af070>]}


============================== 12:44:31.847726 | b5fc4956-f4da-4bf4-8552-df85b02945b6 ==============================
[0m12:44:31.847726 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:44:31.848339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:44:31.999000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5fc4956-f4da-4bf4-8552-df85b02945b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069338b0>]}
[0m12:44:32.045537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5fc4956-f4da-4bf4-8552-df85b02945b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d0cd0>]}
[0m12:44:32.046374 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:44:32.130278 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:44:32.280984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:44:32.281285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:44:32.286585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:44:32.349968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5fc4956-f4da-4bf4-8552-df85b02945b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b0e20>]}
[0m12:44:32.363480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5fc4956-f4da-4bf4-8552-df85b02945b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705e9d0>]}
[0m12:44:32.363853 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:44:32.364069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5fc4956-f4da-4bf4-8552-df85b02945b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705e970>]}
[0m12:44:32.365456 [info ] [MainThread]: 
[0m12:44:32.365674 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:44:32.365856 [info ] [MainThread]: 
[0m12:44:32.366138 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:44:32.370252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:44:32.370674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:44:32.408346 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:44:32.408657 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:44:32.408916 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:44:32.409144 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:44:32.409364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:32.409552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:32.448552 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m12:44:32.448899 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:44:32.449150 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:44:32.449430 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m12:44:32.449654 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:44:32.449888 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:44:32.455754 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.006 seconds
[0m12:44:32.456095 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m12:44:32.457918 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:44:32.458896 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:44:32.459407 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:44:32.459650 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:44:32.471700 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:32.471989 [debug] [MainThread]: On master: BEGIN
[0m12:44:32.472185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:44:32.480384 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:44:32.480687 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:32.480967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:44:32.534060 [debug] [MainThread]: SQL status: SELECT 4 in 0.053 seconds
[0m12:44:32.535701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5fc4956-f4da-4bf4-8552-df85b02945b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705eac0>]}
[0m12:44:32.536074 [debug] [MainThread]: On master: ROLLBACK
[0m12:44:32.536733 [debug] [MainThread]: On master: Close
[0m12:44:32.539685 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:44:32.540019 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:44:32.540457 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_customers)
[0m12:44:32.540744 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:44:32.541036 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:44:32.541545 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_order_items)
[0m12:44:32.541862 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:44:32.542243 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:44:32.542595 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:44:32.542883 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:44:32.550586 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:44:32.550867 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:44:32.551132 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:44:32.554091 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:44:32.557024 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:44:32.560380 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:44:32.560780 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:44:32.561371 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:44:32.561721 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:44:32.561966 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:44:32.562391 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:44:32.562629 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:44:32.563062 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:44:32.563535 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:44:32.564038 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_customers
[0m12:44:32.564293 [debug] [Thread-2  ]: Began running node model.ecommerce_test.dim_products
[0m12:44:32.564549 [debug] [Thread-3  ]: Began running node model.ecommerce_test.fct_orders
[0m12:44:32.564804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.dim_customers)
[0m12:44:32.565041 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:44:32.565293 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.dim_products)
[0m12:44:32.565557 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.fct_orders)
[0m12:44:32.565802 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:44:32.566050 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now test.ecommerce_test.assert_no_duplicate_orders)
[0m12:44:32.566299 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:44:32.566545 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:44:32.569828 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:44:32.570129 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:44:32.573100 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:44:32.576092 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:44:32.579002 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:44:32.579380 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:44:32.579900 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:44:32.580131 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.dim_products
[0m12:44:32.580441 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:44:32.580923 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.dim_products
[0m12:44:32.581134 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:44:32.581621 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:44:32.582051 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:44:32.582320 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:44:32.582794 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:44:32.583140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_customers, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:44:32.583388 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:44:32.583681 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_products, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:44:32.584041 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:44:32.584284 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:44:32.584521 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.fct_orders, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:44:32.584739 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:44:32.584967 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:44:32.599868 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:44:32.600157 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:44:32.605923 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:44:32.606187 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:44:32.609441 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:44:32.613180 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:44:32.613604 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:44:32.613886 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:44:32.614332 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:44:32.614595 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:44:32.615011 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:44:32.615268 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:44:32.615485 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:44:32.615894 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:44:32.616138 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:44:32.616411 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:44:32.616796 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:44:32.617024 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:44:32.617260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:44:32.617510 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:44:32.617757 [debug] [Thread-4  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:44:32.618017 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:44:32.618235 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:44:32.621211 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:44:32.621548 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:44:32.621873 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:44:32.626555 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:44:32.626885 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:44:32.629836 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:44:32.636542 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:44:32.637326 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:44:32.637890 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:44:32.638154 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:44:32.638479 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:44:32.638703 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:44:32.639182 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:44:32.639443 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:44:32.639846 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:44:32.640085 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:44:32.640304 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:44:32.640548 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:44:32.640785 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:44:32.641038 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:44:32.641425 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:44:32.645344 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:44:32.645672 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_email.0472f7c2e8, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:44:32.645952 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:44:32.646224 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:44:32.646538 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:44:32.651226 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:44:32.651644 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:44:32.654908 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:44:32.655227 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:44:32.655503 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:44:32.656015 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:44:32.659041 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:44:32.659328 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:44:32.659580 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:44:32.659805 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:44:32.660275 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:44:32.660564 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:44:32.660977 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:44:32.661219 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:44:32.661521 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:44:32.661803 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:44:32.662086 [debug] [Thread-3  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:44:32.662405 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:44:32.662831 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:44:32.666990 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:44:32.667333 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:44:32.667585 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:44:32.667853 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:44:32.668188 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:44:32.671296 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:44:32.671576 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.assert_total_amount_equals_sum_of_items)
[0m12:44:32.676328 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:44:32.676744 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:44:32.677005 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:44:32.677334 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:44:32.677785 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:44:32.680464 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:44:32.680892 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:44:32.681121 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:44:32.681377 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:44:32.681690 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:44:32.682105 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:44:32.682349 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:44:32.682617 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:44:32.682874 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:44:32.683133 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:44:32.683339 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:44:32.683557 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:44:32.683800 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:44:32.684183 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:44:32.687969 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:44:32.691642 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:44:32.691979 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:44:32.692257 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:44:32.695546 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:44:32.695852 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:44:32.696179 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:44:32.696421 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:44:32.696635 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:44:32.697057 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:44:32.697412 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:44:32.697642 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:44:32.700550 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:44:32.700815 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:44:32.701063 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:44:32.701592 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:44:32.701916 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:44:32.702202 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:44:32.702536 [debug] [Thread-3  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:44:32.702787 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:44:32.703069 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:44:32.703306 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:44:32.703564 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:44:32.703964 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:44:32.708023 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:44:32.711036 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:44:32.711297 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:44:32.711555 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:44:32.717434 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:44:32.717830 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:44:32.718170 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:44:32.718396 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:44:32.718631 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:44:32.719048 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:44:32.719450 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:44:32.722577 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:44:32.722905 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:44:32.723405 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:44:32.723695 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:44:32.724075 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:44:32.724586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:32.724773 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6' was properly closed.
[0m12:44:32.724944 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38' was properly closed.
[0m12:44:32.725108 [debug] [MainThread]: Connection 'test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m12:44:32.725265 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m12:44:32.727642 [debug] [MainThread]: Command end result
[0m12:44:32.857777 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:44:32.861001 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:44:32.867138 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:44:32.869816 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:44:32.870515 [info ] [MainThread]: Building catalog
[0m12:44:32.882801 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db_ex2.information_schema'
[0m12:44:32.888553 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:44:32.888882 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: BEGIN
[0m12:44:32.889095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:32.899461 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:44:32.899728 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:44:32.900097 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "dbt_db_ex2.information_schema"} */

    
    

    select
        'dbt_db_ex2' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_total_amount_equals_sum_of_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_price')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_revenue')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_quantity_sold')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_date')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_no_duplicate_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_lifetime_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_email')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_amount')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_name')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_email')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:44:32.907780 [debug] [ThreadPool]: SQL status: SELECT 214 in 0.007 seconds
[0m12:44:32.919463 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: ROLLBACK
[0m12:44:32.920145 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: Close
[0m12:44:32.936518 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:44:32.964458 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:44:32.965582 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:44:32.965788 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:44:32.966902 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1796465, "process_in_blocks": "0", "process_kernel_time": 0.216231, "process_mem_max_rss": "127221760", "process_out_blocks": "0", "process_user_time": 1.730828}
[0m12:44:32.967174 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:44:32.967124 after 1.18 seconds
[0m12:44:32.967375 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:44:32.967544 [debug] [MainThread]: Connection 'dbt_db_ex2.information_schema' was properly closed.
[0m12:44:32.967739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105747730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bbbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107181e80>]}
[0m12:44:32.967971 [debug] [MainThread]: Flushing usage events
[0m12:44:34.002952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:49.413732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be2bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be2bd90>]}


============================== 12:45:49.416967 | 85c03e10-2343-4408-8872-fa636394e4fa ==============================
[0m12:45:49.416967 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:45:49.417360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:49.523500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85c03e10-2343-4408-8872-fa636394e4fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526d640>]}
[0m12:45:49.575166 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-p1ikeq26'
[0m12:45:49.575508 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:45:49.694731 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:45:49.696488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:45:49.720253 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:45:49.725707 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m12:45:49.819456 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m12:45:49.822255 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m12:45:49.822779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '85c03e10-2343-4408-8872-fa636394e4fa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f4df0>]}
[0m12:45:49.826535 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m12:45:49.850400 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m12:45:49.854870 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:45:50.468081 [info ] [MainThread]: Installed from version 1.1.1
[0m12:45:50.468441 [info ] [MainThread]: Updated version available: 1.3.0
[0m12:45:50.468697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '85c03e10-2343-4408-8872-fa636394e4fa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a97d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f46a0>]}
[0m12:45:50.468986 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m12:45:51.615837 [info ] [MainThread]: Installed from version 0.10.0
[0m12:45:51.616364 [info ] [MainThread]: Updated version available: 0.10.4
[0m12:45:51.616677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '85c03e10-2343-4408-8872-fa636394e4fa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f4d30>]}
[0m12:45:51.616985 [info ] [MainThread]: Installing calogica/dbt_date
[0m12:45:52.162594 [info ] [MainThread]: Installed from version 0.10.0
[0m12:45:52.162998 [info ] [MainThread]: Updated version available: 0.10.1
[0m12:45:52.163866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '85c03e10-2343-4408-8872-fa636394e4fa', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f4e50>]}
[0m12:45:52.164877 [info ] [MainThread]: 
[0m12:45:52.165408 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m12:45:52.167876 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.8081968, "process_in_blocks": "0", "process_kernel_time": 0.279561, "process_mem_max_rss": "110821376", "process_out_blocks": "0", "process_user_time": 1.198347}
[0m12:45:52.168582 [debug] [MainThread]: Command `dbt deps` succeeded at 12:45:52.168398 after 2.81 seconds
[0m12:45:52.169526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be25b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a97f250>]}
[0m12:45:52.170328 [debug] [MainThread]: Flushing usage events
[0m12:45:53.263113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:54.490882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b3e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104baab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104baad30>]}


============================== 12:45:54.494426 | a4cc1da7-9d09-4b97-8442-3b83e7c718fa ==============================
[0m12:45:54.494426 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:45:54.494819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:54.501470 [info ] [MainThread]: dbt version: 1.9.4
[0m12:45:54.501787 [info ] [MainThread]: python version: 3.9.6
[0m12:45:54.501989 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m12:45:54.502182 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m12:45:54.550709 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m12:45:54.551088 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m12:45:54.551293 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/dbt_project.yml
[0m12:45:54.551815 [info ] [MainThread]: adapter type: postgres
[0m12:45:54.552042 [info ] [MainThread]: adapter version: 1.9.0
[0m12:45:54.633481 [info ] [MainThread]: Configuration:
[0m12:45:54.633809 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:45:54.634007 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:45:54.634194 [info ] [MainThread]: Required dependencies:
[0m12:45:54.634477 [debug] [MainThread]: Executing "git --help"
[0m12:45:54.651980 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:45:54.652570 [debug] [MainThread]: STDERR: "b''"
[0m12:45:54.652802 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:45:54.653028 [info ] [MainThread]: Connection:
[0m12:45:54.653297 [info ] [MainThread]:   host: localhost
[0m12:45:54.653490 [info ] [MainThread]:   port: 5433
[0m12:45:54.653672 [info ] [MainThread]:   user: dbt_user
[0m12:45:54.653852 [info ] [MainThread]:   database: dbt_db_ex2
[0m12:45:54.654120 [info ] [MainThread]:   schema: public
[0m12:45:54.654356 [info ] [MainThread]:   connect_timeout: 10
[0m12:45:54.654548 [info ] [MainThread]:   role: None
[0m12:45:54.654735 [info ] [MainThread]:   search_path: None
[0m12:45:54.654917 [info ] [MainThread]:   keepalives_idle: 0
[0m12:45:54.655094 [info ] [MainThread]:   sslmode: None
[0m12:45:54.655269 [info ] [MainThread]:   sslcert: None
[0m12:45:54.655439 [info ] [MainThread]:   sslkey: None
[0m12:45:54.655606 [info ] [MainThread]:   sslrootcert: None
[0m12:45:54.655773 [info ] [MainThread]:   application_name: dbt
[0m12:45:54.655941 [info ] [MainThread]:   retries: 1
[0m12:45:54.656352 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:45:54.737714 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:45:54.764736 [debug] [MainThread]: Using postgres connection "debug"
[0m12:45:54.765037 [debug] [MainThread]: On debug: select 1 as id
[0m12:45:54.765235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:54.792647 [debug] [MainThread]: SQL status: SELECT 1 in 0.027 seconds
[0m12:45:54.793322 [debug] [MainThread]: On debug: Close
[0m12:45:54.793565 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:45:54.793799 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:45:54.794925 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.36061317, "process_in_blocks": "0", "process_kernel_time": 0.144514, "process_mem_max_rss": "114704384", "process_out_blocks": "0", "process_user_time": 1.040455}
[0m12:45:54.795259 [debug] [MainThread]: Command `dbt debug` succeeded at 12:45:54.795193 after 0.36 seconds
[0m12:45:54.795480 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:45:54.795703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b3e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051132b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105092d60>]}
[0m12:45:54.795974 [debug] [MainThread]: Flushing usage events
[0m12:45:56.785044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:57.912664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864ae80>]}


============================== 12:45:57.915161 | da628802-9c35-441a-bcc6-ec0fb8cd5282 ==============================
[0m12:45:57.915161 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:45:57.915516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:58.039340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108974ac0>]}
[0m12:45:58.085599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848b880>]}
[0m12:45:58.086213 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:45:58.168297 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:45:58.303677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:58.303980 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:58.309431 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:45:58.373429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109436100>]}
[0m12:45:58.461598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:45:58.464592 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:45:58.473954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb5b50>]}
[0m12:45:58.474484 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:45:58.474761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109416310>]}
[0m12:45:58.476097 [info ] [MainThread]: 
[0m12:45:58.476325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:58.476516 [info ] [MainThread]: 
[0m12:45:58.476846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:58.480110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m12:45:58.510691 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m12:45:58.510985 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m12:45:58.511183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:58.534540 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m12:45:58.536957 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m12:45:58.540261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m12:45:58.541238 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:45:58.546617 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:45:58.549038 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:45:58.549280 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:45:58.549487 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:45:58.549675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:45:58.549853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:58.560445 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:45:58.560800 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m12:45:58.561063 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:45:58.561292 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:45:58.561528 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:45:58.561778 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:45:58.565948 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m12:45:58.566258 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.004 seconds
[0m12:45:58.567296 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:45:58.568917 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:45:58.569505 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:45:58.569719 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:45:58.581975 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:58.582231 [debug] [MainThread]: On master: BEGIN
[0m12:45:58.582420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:58.590321 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:45:58.590676 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:58.590977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:58.644432 [debug] [MainThread]: SQL status: SELECT 4 in 0.053 seconds
[0m12:45:58.646262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106099cd0>]}
[0m12:45:58.646669 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:58.647336 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:58.647602 [debug] [MainThread]: On master: BEGIN
[0m12:45:58.648432 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:45:58.648753 [debug] [MainThread]: On master: COMMIT
[0m12:45:58.649037 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:58.649290 [debug] [MainThread]: On master: COMMIT
[0m12:45:58.649813 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:45:58.650084 [debug] [MainThread]: On master: Close
[0m12:45:58.653136 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:45:58.653508 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:45:58.653816 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:45:58.654453 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:45:58.654216 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m12:45:58.654894 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m12:45:58.655318 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m12:45:58.655739 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m12:45:58.656136 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m12:45:58.656579 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m12:45:58.656960 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:45:58.657305 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:45:58.657587 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:45:58.657860 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:45:58.658129 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:45:58.658390 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:45:58.666057 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:45:58.669183 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:45:58.672023 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:45:58.675390 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:45:58.676020 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:45:58.676291 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:45:58.682210 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:45:58.688457 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:45:58.709829 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.stg_orders"
[0m12:45:58.711738 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.stg_order_items"
[0m12:45:58.712444 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_test.stg_customers"
[0m12:45:58.715505 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.stg_products"
[0m12:45:58.716384 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:45:58.716630 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: BEGIN
[0m12:45:58.716886 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:45:58.717138 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:45:58.717377 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:45:58.717609 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:45:58.717832 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: BEGIN
[0m12:45:58.718045 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: BEGIN
[0m12:45:58.718330 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: BEGIN
[0m12:45:58.718545 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:45:58.718774 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:45:58.719130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:45:58.728561 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m12:45:58.728908 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:45:58.729227 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */

  create view "dbt_db_ex2"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity, -- Ensure minimum quantity is 1
        coalesce(unit_price, 0) as unit_price, -- Ensure no NULL prices
        created_at
    from source
)

select * from staged
  );
[0m12:45:58.729775 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m12:45:58.730061 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:45:58.730313 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:45:58.730543 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m12:45:58.730807 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:45:58.731090 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */

  create view "dbt_db_ex2"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at,
        -- Add tracking for data lineage
        'da628802-9c35-441a-bcc6-ec0fb8cd5282' as _invocation_id
    from source
)

select * from staged
  );
[0m12:45:58.731352 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:45:58.731610 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */

  create view "dbt_db_ex2"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email, -- Normalize email
        created_at
    from source
)

select * from staged
  );
[0m12:45:58.731969 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */

  create view "dbt_db_ex2"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price, -- Ensure no NULL values
        category,
        created_at
    from source
)

select * from staged
  );
[0m12:45:58.733312 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:45:58.738855 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:45:58.739220 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:45:58.739470 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m12:45:58.739693 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:45:58.742513 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:45:58.742734 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.010 seconds
[0m12:45:58.746029 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:45:58.746315 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:45:58.746537 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:45:58.749323 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:45:58.749560 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m12:45:58.752001 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:45:58.752296 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:45:58.752596 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m12:45:58.752951 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:58.753201 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:58.755626 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:45:58.755844 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:45:58.758249 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:45:58.758458 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:45:58.758675 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:45:58.765289 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:45:58.769901 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m12:45:58.772554 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:45:58.772927 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:45:58.773196 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:45:58.773427 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m12:45:58.773676 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:58.773918 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:58.774185 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:58.775049 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m12:45:58.775883 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m12:45:58.776091 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m12:45:58.776851 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m12:45:58.777087 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:45:58.777319 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:45:58.781988 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_order_items__dbt_backup"
[0m12:45:58.782252 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:45:58.782470 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m12:45:58.782681 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m12:45:58.785209 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:45:58.785599 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m12:45:58.785988 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
drop view if exists "dbt_db_ex2"."public"."stg_order_items__dbt_backup" cascade
[0m12:45:58.787077 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m12:45:58.789760 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_products__dbt_backup"
[0m12:45:58.790054 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m12:45:58.790432 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:45:58.790645 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m12:45:58.790863 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.005 seconds
[0m12:45:58.796552 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_orders__dbt_backup"
[0m12:45:58.796807 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
drop view if exists "dbt_db_ex2"."public"."stg_products__dbt_backup" cascade
[0m12:45:58.799161 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_customers__dbt_backup"
[0m12:45:58.800849 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: Close
[0m12:45:58.804213 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:45:58.804622 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:45:58.804945 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
drop view if exists "dbt_db_ex2"."public"."stg_orders__dbt_backup" cascade
[0m12:45:58.805695 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
drop view if exists "dbt_db_ex2"."public"."stg_customers__dbt_backup" cascade
[0m12:45:58.806544 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.002 seconds
[0m12:45:58.807641 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: Close
[0m12:45:58.807903 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m12:45:58.808163 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m12:45:58.808455 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109442af0>]}
[0m12:45:58.808817 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a55670>]}
[0m12:45:58.809627 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: Close
[0m12:45:58.810407 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: Close
[0m12:45:58.810958 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m12:45:58.811749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a178e0>]}
[0m12:45:58.812161 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m12:45:58.812641 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:45:58.813129 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099dfeb0>]}
[0m12:45:58.813832 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:45:58.813526 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m12:45:58.814383 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m12:45:58.814786 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:45:58.815079 [debug] [Thread-2  ]: Began running node model.ecommerce_test.dim_products
[0m12:45:58.815393 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:45:58.815759 [info ] [Thread-2  ]: 5 of 7 START sql table model public.dim_products ............................... [RUN]
[0m12:45:58.816144 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.dim_products)
[0m12:45:58.816419 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:45:58.816652 [debug] [Thread-4  ]: Began running node model.ecommerce_test.dim_customers
[0m12:45:58.820134 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:45:58.820398 [debug] [Thread-1  ]: Began running node model.ecommerce_test.fct_orders
[0m12:45:58.820717 [info ] [Thread-4  ]: 6 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m12:45:58.821325 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.dim_customers)
[0m12:45:58.821083 [info ] [Thread-1  ]: 7 of 7 START sql table model public.fct_orders ................................. [RUN]
[0m12:45:58.821643 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:45:58.821901 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.fct_orders)
[0m12:45:58.825152 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:45:58.825567 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:45:58.825802 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.dim_products
[0m12:45:58.829333 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:45:58.879847 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.dim_products"
[0m12:45:58.880198 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:45:58.883334 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.dim_customers"
[0m12:45:58.883704 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:45:58.886690 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_test.fct_orders"
[0m12:45:58.887018 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:45:58.887259 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: BEGIN
[0m12:45:58.887511 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:45:58.887750 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:45:58.887987 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: BEGIN
[0m12:45:58.888225 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:45:58.888516 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:45:58.888734 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: BEGIN
[0m12:45:58.889012 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:45:58.901251 [debug] [Thread-4  ]: SQL status: BEGIN in 0.013 seconds
[0m12:45:58.901595 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:45:58.901935 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex2"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as lifetime_orders,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1
),

final as (
    select
        c.customer_id,
        c.name,
        c.email,
        c.created_at,
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        current_timestamp as updated_at
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
  );
  
[0m12:45:58.902377 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m12:45:58.902654 [debug] [Thread-2  ]: SQL status: BEGIN in 0.014 seconds
[0m12:45:58.902877 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:45:58.903105 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:45:58.903357 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */

  
    

  create  table "dbt_db_ex2"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

with orders as (
    select * from "dbt_db_ex2"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db_ex2"."public"."stg_order_items"
),

order_totals as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(quantity * unit_price) as total_amount
    from order_items
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        coalesce(ot.total_items, 0) as total_items,
        coalesce(ot.total_amount, 0) as total_amount,
        o.created_at,
        current_timestamp as updated_at,
        o._invocation_id
    from orders o
    left join order_totals ot on o.order_id = ot.order_id
)

select * from final
  );
  
[0m12:45:58.903633 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex2"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(quantity * unit_price) as total_revenue
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

final as (
    select
        p.product_id,
        p.name,
        p.price,
        p.category,
        p.created_at,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_revenue, 0) as total_revenue,
        current_timestamp as updated_at
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
  );
  
[0m12:45:58.911035 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.007 seconds
[0m12:45:58.916792 [debug] [Thread-4  ]: SQL status: SELECT 3 in 0.015 seconds
[0m12:45:58.917505 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:45:58.917787 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.014 seconds
[0m12:45:58.921826 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:45:58.922166 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m12:45:58.925248 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:45:58.925524 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m12:45:58.925844 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders" rename to "fct_orders__dbt_backup"
[0m12:45:58.926462 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:58.929485 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:45:58.929755 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:45:58.929985 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:45:58.930212 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m12:45:58.932961 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:45:58.936375 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:45:58.936722 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m12:45:58.936988 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m12:45:58.937493 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:58.938467 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: COMMIT
[0m12:45:58.938729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:45:58.938958 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:45:58.939168 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:45:58.939937 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m12:45:58.940170 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: COMMIT
[0m12:45:58.940916 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m12:45:58.941148 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:45:58.941411 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:45:58.941652 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m12:45:58.941896 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m12:45:58.942129 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:45:58.944623 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_products__dbt_backup"
[0m12:45:58.944872 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m12:45:58.946659 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:45:58.946928 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m12:45:58.949374 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public"."fct_orders__dbt_backup"
[0m12:45:58.949666 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
drop table if exists "dbt_db_ex2"."public"."dim_products__dbt_backup" cascade
[0m12:45:58.951977 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_customers__dbt_backup"
[0m12:45:58.952348 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:45:58.952734 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:45:58.952994 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
drop table if exists "dbt_db_ex2"."public"."fct_orders__dbt_backup" cascade
[0m12:45:58.953256 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
drop table if exists "dbt_db_ex2"."public"."dim_customers__dbt_backup" cascade
[0m12:45:58.956254 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.004 seconds
[0m12:45:58.957231 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: Close
[0m12:45:58.957485 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.004 seconds
[0m12:45:58.957723 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m12:45:58.958647 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: Close
[0m12:45:58.959134 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c2340>]}
[0m12:45:58.960210 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: Close
[0m12:45:58.960990 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e7cd0>]}
[0m12:45:58.963183 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da628802-9c35-441a-bcc6-ec0fb8cd5282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c16be0>]}
[0m12:45:58.962526 [info ] [Thread-2  ]: 5 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.14s]
[0m12:45:58.963734 [info ] [Thread-4  ]: 6 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.14s]
[0m12:45:58.964555 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.dim_products
[0m12:45:58.964151 [info ] [Thread-1  ]: 7 of 7 OK created sql table model public.fct_orders ............................ [[32mSELECT 3[0m in 0.14s]
[0m12:45:58.965025 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:45:58.965934 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:45:58.967876 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:58.968168 [debug] [MainThread]: On master: BEGIN
[0m12:45:58.968525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:58.983371 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m12:45:58.983859 [debug] [MainThread]: On master: COMMIT
[0m12:45:58.984331 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:58.984610 [debug] [MainThread]: On master: COMMIT
[0m12:45:58.986010 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:45:58.986720 [debug] [MainThread]: On master: Close
[0m12:45:58.987372 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:58.987692 [debug] [MainThread]: Connection 'model.ecommerce_test.fct_orders' was properly closed.
[0m12:45:58.988026 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_products' was properly closed.
[0m12:45:58.988234 [debug] [MainThread]: Connection 'model.ecommerce_test.stg_orders' was properly closed.
[0m12:45:58.988474 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_customers' was properly closed.
[0m12:45:58.988788 [info ] [MainThread]: 
[0m12:45:58.989164 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m12:45:58.990835 [debug] [MainThread]: Command end result
[0m12:45:59.035855 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:45:59.037259 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:45:59.046121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:45:59.046499 [info ] [MainThread]: 
[0m12:45:59.046808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:59.047032 [info ] [MainThread]: 
[0m12:45:59.047873 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:45:59.049388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1875374, "process_in_blocks": "0", "process_kernel_time": 0.176445, "process_mem_max_rss": "127713280", "process_out_blocks": "0", "process_user_time": 1.762019}
[0m12:45:59.049723 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:59.049666 after 1.19 seconds
[0m12:45:59.049984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd1e50>]}
[0m12:45:59.050263 [debug] [MainThread]: Flushing usage events
[0m12:46:02.106551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:03.194043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b17790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498ef10>]}


============================== 12:46:03.196649 | 0aa1b4a7-0127-4dec-b1b8-dbd27f4803bd ==============================
[0m12:46:03.196649 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:46:03.197000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --store-failures', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:46:03.320647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0aa1b4a7-0127-4dec-b1b8-dbd27f4803bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102321ee0>]}
[0m12:46:03.367229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0aa1b4a7-0127-4dec-b1b8-dbd27f4803bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104965a90>]}
[0m12:46:03.367839 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:46:03.447737 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:46:03.562726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:03.563023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:03.568162 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:46:03.631176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aa1b4a7-0127-4dec-b1b8-dbd27f4803bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105780dc0>]}
[0m12:46:03.718041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:46:03.720460 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:46:03.734354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0aa1b4a7-0127-4dec-b1b8-dbd27f4803bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c5d90>]}
[0m12:46:03.734722 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:46:03.734936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa1b4a7-0127-4dec-b1b8-dbd27f4803bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ad640>]}
[0m12:46:03.736559 [info ] [MainThread]: 
[0m12:46:03.736778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:46:03.736955 [info ] [MainThread]: 
[0m12:46:03.737247 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:46:03.740865 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m12:46:03.766643 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m12:46:03.766922 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m12:46:03.767108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:03.792725 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m12:46:03.793915 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m12:46:03.796641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public_dbt_test__audit)
[0m12:46:03.797087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:46:03.803136 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:46:03.805535 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:46:03.805783 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:46:03.805989 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:46:03.806183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:03.806390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:03.815569 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:46:03.815897 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:46:03.816137 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:46:03.816359 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:46:03.816588 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:46:03.816839 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:46:03.819861 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.003 seconds
[0m12:46:03.820125 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m12:46:03.821760 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:46:03.822619 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:46:03.823099 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:46:03.823328 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:46:03.834590 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:03.836047 [debug] [MainThread]: On master: BEGIN
[0m12:46:03.836255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:03.844173 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:46:03.844475 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:03.844753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:46:03.899010 [debug] [MainThread]: SQL status: SELECT 4 in 0.054 seconds
[0m12:46:03.900822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aa1b4a7-0127-4dec-b1b8-dbd27f4803bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cabb0>]}
[0m12:46:03.901262 [debug] [MainThread]: On master: ROLLBACK
[0m12:46:03.901965 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:03.902287 [debug] [MainThread]: On master: BEGIN
[0m12:46:03.903209 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:46:03.903559 [debug] [MainThread]: On master: COMMIT
[0m12:46:03.903837 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:03.904100 [debug] [MainThread]: On master: COMMIT
[0m12:46:03.904624 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:46:03.904898 [debug] [MainThread]: On master: Close
[0m12:46:03.907673 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:46:03.908127 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:46:03.908450 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:46:03.909030 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:46:03.908781 [info ] [Thread-1  ]: 1 of 25 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m12:46:03.909418 [info ] [Thread-2  ]: 2 of 25 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m12:46:03.909730 [info ] [Thread-3  ]: 3 of 25 START test assert_no_duplicate_orders .................................. [RUN]
[0m12:46:03.910037 [info ] [Thread-4  ]: 4 of 25 START test assert_total_amount_equals_sum_of_items ..................... [RUN]
[0m12:46:03.910423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:46:03.910738 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:46:03.911103 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_no_duplicate_orders'
[0m12:46:03.911451 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_total_amount_equals_sum_of_items'
[0m12:46:03.911745 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:46:03.912036 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:46:03.912309 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:46:03.912580 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:46:03.929074 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:46:03.938338 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:46:03.934674 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:46:03.941598 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:46:03.942539 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:46:03.948536 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:46:03.948874 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:46:03.949152 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:46:03.959968 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:46:03.964942 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:46:03.969476 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:46:03.973573 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:46:03.976431 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:46:03.976796 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:46:03.977118 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:46:03.977451 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:46:03.977687 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m12:46:03.977916 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items" cascade
[0m12:46:03.978134 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders" cascade
[0m12:46:03.978362 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m12:46:03.978580 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:46:03.978782 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:46:03.978976 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:46:03.979179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:03.992394 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:46:03.992753 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:46:03.993000 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:46:03.993236 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:46:03.995060 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:46:03.995705 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:46:03.996378 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:46:03.997007 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:46:04.005455 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:46:04.005900 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:46:04.006331 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:46:04.006750 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:46:04.006983 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:46:04.007195 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:46:04.007406 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:46:04.007619 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:46:04.008465 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.008739 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.008952 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:46:04.009199 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.009441 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:46:04.009654 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m12:46:04.009905 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
  
  
    as
  
  (
    /*
  Custom test to check if the total amount in orders table
  matches the sum of the item amounts in order_items.
  
  If there are differences, this test will return the records with discrepancies.
*/

with orders as (
    select 
        order_id,
        total_amount as order_total
    from "dbt_db_ex2"."public"."fct_orders"
),

order_items_grouped as (
    select
        order_id,
        sum(quantity * unit_price) as items_total
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

joined as (
    select
        o.order_id,
        o.order_total,
        coalesce(oi.items_total, 0) as items_total,
        abs(o.order_total - coalesce(oi.items_total, 0)) as difference
    from orders o
    left join order_items_grouped oi on o.order_id = oi.order_id
)

select * from joined where difference > 0.01  -- Allow small rounding differences
  );
  
    
[0m12:46:04.010158 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:46:04.010393 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m12:46:04.010621 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:46:04.010889 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m12:46:04.011215 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  
  
    as
  
  (
    /*
  Custom test to ensure there are no duplicate orders in the core table.
  This test checks for duplicates based on customer_id and order_date within 15 minutes
*/

with orders as (
    select 
        customer_id,
        order_date,
        count(*) as order_count
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1, 2
),

potential_duplicates as (
    select
        o1.customer_id,
        o1.order_date as order_date_1,
        o2.order_date as order_date_2,
        abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) as minutes_difference
    from "dbt_db_ex2"."public"."stg_orders" o1
    join "dbt_db_ex2"."public"."stg_orders" o2
        on o1.customer_id = o2.customer_id
        and o1.order_id <> o2.order_id
        and abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) < 15  -- Orders less than 15 minutes apart
)

select * from potential_duplicates
  );
  
    
[0m12:46:04.014904 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:46:04.015236 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m12:46:04.015925 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:46:04.016498 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:46:04.016767 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:46:04.017011 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:46:04.017264 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:46:04.017538 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:46:04.019748 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:46:04.022458 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:46:04.022743 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.012 seconds
[0m12:46:04.023023 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m12:46:04.023258 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.012 seconds
[0m12:46:04.023889 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:46:04.024357 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:46:04.025046 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:46:04.025461 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:46:04.025773 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:46:04.026037 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:46:04.026275 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:46:04.026546 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:46:04.026810 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:46:04.027071 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:46:04.027433 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:46:04.027744 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.028045 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.028304 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:46:04.028555 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:46:04.028813 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m12:46:04.029084 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m12:46:04.029903 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.030151 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.030381 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m12:46:04.030611 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m12:46:04.033378 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m12:46:04.034227 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m12:46:04.034642 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:46:04.035006 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:46:04.035636 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:46:04.035908 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m12:46:04.036161 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:46:04.036387 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m12:46:04.036729 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:46:04.037320 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.037108 [info ] [Thread-2  ]: 2 of 25 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.13s]
[0m12:46:04.037769 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:46:04.038197 [info ] [Thread-1  ]: 1 of 25 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.13s]
[0m12:46:04.038488 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:46:04.038886 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:46:04.039322 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:46:04.039573 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
    
      
    ) dbt_internal_test
[0m12:46:04.039837 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.040104 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:46:04.040412 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:46:04.040759 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:46:04.041045 [info ] [Thread-2  ]: 5 of 25 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m12:46:04.041593 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.041833 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
    
      
    ) dbt_internal_test
[0m12:46:04.041351 [info ] [Thread-1  ]: 6 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m12:46:04.042246 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:46:04.043212 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: ROLLBACK
[0m12:46:04.043537 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:46:04.043831 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:46:04.044192 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:46:04.044574 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: Close
[0m12:46:04.044833 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.059524 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:46:04.064484 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:46:04.065642 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: ROLLBACK
[0m12:46:04.066049 [info ] [Thread-4  ]: 4 of 25 PASS assert_total_amount_equals_sum_of_items ........................... [[32mPASS[0m in 0.15s]
[0m12:46:04.066793 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:46:04.067173 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:46:04.067435 [info ] [Thread-4  ]: 7 of 25 START test not_null_dim_customers_email ................................ [RUN]
[0m12:46:04.067757 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:46:04.067983 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:46:04.068205 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: Close
[0m12:46:04.071494 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:46:04.071861 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:46:04.072109 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:46:04.077589 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m12:46:04.072471 [error] [Thread-3  ]: 3 of 25 FAIL 2 assert_no_duplicate_orders ...................................... [[31mFAIL 2[0m in 0.16s]
[0m12:46:04.082333 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:46:04.082828 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:46:04.083221 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:46:04.083628 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:46:04.084587 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:46:04.084943 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3" cascade
[0m12:46:04.085266 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:46:04.090286 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:46:04.090578 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m12:46:04.090842 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:46:04.091089 [info ] [Thread-3  ]: 8 of 25 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m12:46:04.091481 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:46:04.091706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:04.092054 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:46:04.092293 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m12:46:04.092610 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:46:04.092843 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:46:04.133092 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:46:04.133671 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.042 seconds
[0m12:46:04.134698 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:46:04.135478 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:46:04.140161 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:46:04.140462 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.050 seconds
[0m12:46:04.140998 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:46:04.141385 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:46:04.142109 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m12:46:04.142380 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:46:04.142640 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.050 seconds
[0m12:46:04.142873 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m12:46:04.143329 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:46:04.144078 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:46:04.144318 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.144547 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:46:04.144780 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:46:04.145188 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:46:04.145415 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:46:04.145753 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:46:04.146074 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.146351 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m12:46:04.147179 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:46:04.147547 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.147853 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
  
  
    as
  
  (
    




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(email, '^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$', '')), 1), 0)


 > 0
 as expression


    from "dbt_db_ex2"."public"."dim_customers"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  );
  
    
[0m12:46:04.148369 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:46:04.148682 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where email is null



  );
  
    
[0m12:46:04.151999 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:46:04.152909 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:46:04.153234 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:46:04.153504 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:46:04.155233 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:46:04.156025 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:46:04.156322 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:46:04.156585 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:46:04.156870 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:46:04.157119 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.013 seconds
[0m12:46:04.157739 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:46:04.157985 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m12:46:04.158720 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:46:04.159014 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:46:04.159278 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:46:04.159710 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:46:04.160549 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:46:04.161654 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:46:04.161997 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:46:04.162343 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:46:04.162898 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:46:04.163214 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:46:04.163450 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:46:04.163681 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.163919 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:46:04.164195 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:46:04.164499 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m12:46:04.164755 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.164995 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.165197 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m12:46:04.165416 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:46:04.165661 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:46:04.166120 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:46:04.166386 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:46:04.166663 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
    
      
    ) dbt_internal_test
[0m12:46:04.167213 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:46:04.167449 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:46:04.167821 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.168165 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.169183 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m12:46:04.169446 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m12:46:04.169666 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:46:04.170642 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: ROLLBACK
[0m12:46:04.170957 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:46:04.171576 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:46:04.171846 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m12:46:04.172119 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: Close
[0m12:46:04.172360 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:46:04.172635 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:46:04.173499 [info ] [Thread-1  ]: 6 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.13s]
[0m12:46:04.173999 [info ] [Thread-2  ]: 5 of 25 PASS dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[32mPASS[0m in 0.13s]
[0m12:46:04.174584 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:46:04.175605 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:46:04.175939 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:46:04.176287 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:46:04.176608 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:46:04.177683 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m12:46:04.178050 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:46:04.178338 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m12:46:04.178589 [info ] [Thread-1  ]: 9 of 25 START test not_null_dim_customers_name ................................. [RUN]
[0m12:46:04.178879 [info ] [Thread-2  ]: 10 of 25 START test not_null_dim_products_name ................................. [RUN]
[0m12:46:04.179153 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: Close
[0m12:46:04.179600 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:46:04.179898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:46:04.180174 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:46:04.180527 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:46:04.180881 [info ] [Thread-4  ]: 7 of 25 PASS not_null_dim_customers_email ...................................... [[32mPASS[0m in 0.11s]
[0m12:46:04.181254 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:46:04.185244 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:46:04.185650 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:46:04.186004 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:46:04.190593 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:46:04.191018 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:46:04.191307 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:46:04.191955 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:46:04.192232 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.196715 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:46:04.191726 [info ] [Thread-4  ]: 11 of 25 START test not_null_dim_products_price ................................ [RUN]
[0m12:46:04.197013 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:46:04.197249 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:46:04.197689 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:46:04.197958 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:46:04.202932 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:46:04.203255 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m12:46:04.203544 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m12:46:04.203815 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:46:04.204238 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:46:04.204562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:04.208440 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:46:04.208763 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:46:04.209019 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m12:46:04.210130 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m12:46:04.210423 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:46:04.210815 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:46:04.216467 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:46:04.216814 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m12:46:04.217225 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:46:04.217954 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m12:46:04.218219 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:46:04.217716 [info ] [Thread-3  ]: 8 of 25 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.13s]
[0m12:46:04.218791 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:46:04.219074 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:46:04.219369 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:46:04.220219 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:46:04.221369 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:46:04.220652 [info ] [Thread-3  ]: 12 of 25 START test not_null_dim_products_product_id ........................... [RUN]
[0m12:46:04.221717 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:46:04.221995 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:46:04.222659 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:46:04.223443 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:46:04.223747 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:46:04.224293 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:46:04.224527 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m12:46:04.232150 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:46:04.232683 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:46:04.233272 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:46:04.233751 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where name is null



  );
  
    
[0m12:46:04.234528 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.235025 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:46:04.235571 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where name is null



  );
  
    
[0m12:46:04.236015 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.018 seconds
[0m12:46:04.236413 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:46:04.237526 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:46:04.243290 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:46:04.243601 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.010 seconds
[0m12:46:04.243849 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.008 seconds
[0m12:46:04.244317 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:46:04.244686 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:46:04.245429 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:46:04.246031 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:46:04.246366 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:46:04.246617 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m12:46:04.246870 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:46:04.247094 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:46:04.247365 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:46:04.247661 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:46:04.247888 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:46:04.248099 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.248521 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:46:04.248760 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where price is null



  );
  
    
[0m12:46:04.252599 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m12:46:04.253208 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:46:04.253744 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m12:46:04.254250 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:46:04.254658 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:46:04.254922 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:46:04.255224 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:46:04.255453 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:46:04.255679 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.255905 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:46:04.256193 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:46:04.256465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.257128 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:46:04.257442 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m12:46:04.257707 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:46:04.257954 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:46:04.258230 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m12:46:04.258503 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.011 seconds
[0m12:46:04.258734 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:46:04.258960 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.259694 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:46:04.259948 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.260914 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m12:46:04.261578 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:46:04.262514 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m12:46:04.262773 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m12:46:04.263059 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:46:04.263301 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: Close
[0m12:46:04.263708 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:46:04.263938 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: Close
[0m12:46:04.264392 [info ] [Thread-2  ]: 10 of 25 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.08s]
[0m12:46:04.264668 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.265063 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:46:04.265368 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:46:04.265635 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:46:04.266215 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:46:04.265977 [info ] [Thread-1  ]: 9 of 25 PASS not_null_dim_customers_name ....................................... [[32mPASS[0m in 0.09s]
[0m12:46:04.266567 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where product_id is null



  );
  
    
[0m12:46:04.266811 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:46:04.267055 [info ] [Thread-2  ]: 13 of 25 START test not_null_dim_products_total_quantity_sold .................. [RUN]
[0m12:46:04.267417 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:46:04.267810 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:46:04.268077 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:46:04.268325 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.268592 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:46:04.268857 [info ] [Thread-1  ]: 14 of 25 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m12:46:04.269124 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:46:04.273017 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:46:04.273473 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:46:04.273742 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:46:04.274010 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m12:46:04.274335 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:46:04.274982 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:46:04.279216 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:46:04.279528 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:46:04.279770 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:46:04.280005 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.005 seconds
[0m12:46:04.284863 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:46:04.285233 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:46:04.286172 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m12:46:04.286581 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:46:04.286826 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:46:04.287133 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold" cascade
[0m12:46:04.291705 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:46:04.291991 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m12:46:04.292218 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:46:04.292432 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: Close
[0m12:46:04.292803 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:46:04.293190 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:46:04.293557 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue" cascade
[0m12:46:04.294336 [info ] [Thread-4  ]: 11 of 25 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.10s]
[0m12:46:04.294697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:04.295175 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:46:04.295574 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:46:04.295933 [info ] [Thread-4  ]: 15 of 25 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m12:46:04.296273 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:46:04.296520 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:46:04.300640 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:46:04.301126 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:46:04.301374 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:46:04.301692 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:46:04.301974 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.306499 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:46:04.306799 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:46:04.307408 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:46:04.307706 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:46:04.307983 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m12:46:04.308343 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:46:04.308587 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:46:04.309318 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:46:04.309562 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:46:04.309889 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:46:04.310458 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:46:04.311147 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:46:04.312047 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m12:46:04.312332 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:46:04.312793 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:46:04.313079 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:46:04.313349 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.313621 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: Close
[0m12:46:04.313851 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:46:04.314063 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.314319 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_quantity_sold is null



  );
  
    
[0m12:46:04.314691 [info ] [Thread-3  ]: 12 of 25 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m12:46:04.314997 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:46:04.315375 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:46:04.315669 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_revenue is null



  );
  
    
[0m12:46:04.315953 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:46:04.316381 [info ] [Thread-3  ]: 16 of 25 START test not_null_fct_orders_order_date ............................. [RUN]
[0m12:46:04.316749 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:46:04.316990 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:46:04.320580 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:46:04.321082 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:46:04.321342 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:46:04.322026 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:46:04.322365 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:46:04.322969 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:46:04.323427 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:46:04.323702 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:46:04.324240 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:46:04.324474 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:46:04.324707 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:46:04.329832 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:46:04.330104 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:46:04.330346 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:46:04.330762 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:46:04.331014 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.331244 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:46:04.331509 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m12:46:04.331742 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:46:04.331999 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:46:04.332241 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m12:46:04.334636 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m12:46:04.335160 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:46:04.335428 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m12:46:04.335894 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:46:04.336387 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:46:04.336639 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:46:04.337065 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:46:04.337325 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:46:04.337565 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.337794 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:46:04.338066 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:46:04.338314 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.338960 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:46:04.339236 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
    
      
    ) dbt_internal_test
[0m12:46:04.339512 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:46:04.339767 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:46:04.340050 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
    
      
    ) dbt_internal_test
[0m12:46:04.340299 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:46:04.340566 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.009 seconds
[0m12:46:04.340798 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.341489 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:46:04.341745 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.342662 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: ROLLBACK
[0m12:46:04.342942 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:46:04.343444 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:46:04.344304 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m12:46:04.344750 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:46:04.344994 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: Close
[0m12:46:04.345218 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:46:04.345880 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m12:46:04.345683 [info ] [Thread-2  ]: 13 of 25 PASS not_null_dim_products_total_quantity_sold ........................ [[32mPASS[0m in 0.08s]
[0m12:46:04.346345 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:46:04.346787 [info ] [Thread-1  ]: 14 of 25 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.07s]
[0m12:46:04.347067 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.347540 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:46:04.347842 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:46:04.348176 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:46:04.348410 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:46:04.348670 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:46:04.348974 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:46:04.349263 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_date is null



  );
  
    
[0m12:46:04.349502 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.349743 [info ] [Thread-2  ]: 17 of 25 START test not_null_fct_orders_order_id ............................... [RUN]
[0m12:46:04.349997 [info ] [Thread-1  ]: 18 of 25 START test not_null_fct_orders_status ................................. [RUN]
[0m12:46:04.350261 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:46:04.350578 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:46:04.350850 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:46:04.351108 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m12:46:04.351361 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:46:04.351592 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:46:04.355323 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:46:04.355654 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:46:04.359197 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:46:04.359474 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:46:04.360487 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m12:46:04.361237 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:46:04.361615 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:46:04.361873 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:46:04.362123 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:46:04.362349 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m12:46:04.362570 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:46:04.367559 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:46:04.372638 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:46:04.373812 [info ] [Thread-4  ]: 15 of 25 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.08s]
[0m12:46:04.374421 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:46:04.374774 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:46:04.375135 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:46:04.375401 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m12:46:04.375661 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m12:46:04.375946 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:46:04.376237 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:04.376482 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:46:04.376743 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m12:46:04.376980 [info ] [Thread-4  ]: 19 of 25 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m12:46:04.377569 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:46:04.377845 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:46:04.378137 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:46:04.382472 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:46:04.383040 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:46:04.383322 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:46:04.383564 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:46:04.389399 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:46:04.390003 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:46:04.390286 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.390558 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m12:46:04.391026 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:46:04.391283 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:46:04.391536 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m12:46:04.391762 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:46:04.392086 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:46:04.392933 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:46:04.393213 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.393869 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:46:04.394507 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:46:04.395477 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m12:46:04.395942 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:46:04.396176 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:46:04.396442 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:46:04.396716 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: Close
[0m12:46:04.397096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.397816 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:46:04.398060 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.398302 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where status is null



  );
  
    
[0m12:46:04.397600 [info ] [Thread-3  ]: 16 of 25 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.08s]
[0m12:46:04.398629 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:46:04.398996 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:46:04.399261 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_id is null



  );
  
    
[0m12:46:04.399614 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:46:04.399993 [info ] [Thread-3  ]: 20 of 25 START test not_null_fct_orders_total_items ............................ [RUN]
[0m12:46:04.400689 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:46:04.401016 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:46:04.404659 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:46:04.404977 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:46:04.405227 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:46:04.405450 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:46:04.406099 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:46:04.406707 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:46:04.407278 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:46:04.407719 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:46:04.407937 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:46:04.408166 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:46:04.408394 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:46:04.408614 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:46:04.413791 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:46:04.414127 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:46:04.414373 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:46:04.414799 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:46:04.415273 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.415514 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items" cascade
[0m12:46:04.415757 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:46:04.416001 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:46:04.416258 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m12:46:04.418828 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m12:46:04.419125 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m12:46:04.419575 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:46:04.419940 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:46:04.420422 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:46:04.420711 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:46:04.420948 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:46:04.421185 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:46:04.421604 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:46:04.421838 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.422073 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.422706 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:46:04.422981 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:46:04.423231 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:46:04.423477 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:46:04.423715 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.008 seconds
[0m12:46:04.423948 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:46:04.424213 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m12:46:04.424455 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:46:04.425115 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:46:04.425667 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:46:04.425921 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.426146 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.426361 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:46:04.427387 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: ROLLBACK
[0m12:46:04.427653 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:46:04.428457 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m12:46:04.429262 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:46:04.429521 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: Close
[0m12:46:04.429765 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.429990 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m12:46:04.430653 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:46:04.430455 [info ] [Thread-1  ]: 18 of 25 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.08s]
[0m12:46:04.431025 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_items is null



  );
  
    
[0m12:46:04.431382 [info ] [Thread-2  ]: 17 of 25 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m12:46:04.431776 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:46:04.432062 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:46:04.432437 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:46:04.432710 [debug] [Thread-1  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:46:04.433001 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:46:04.433250 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:46:04.433552 [info ] [Thread-1  ]: 21 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m12:46:04.433843 [info ] [Thread-2  ]: 22 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m12:46:04.434165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:46:04.434411 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.434671 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:46:04.434927 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:46:04.435163 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:46:04.435393 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:46:04.440933 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:46:04.442239 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:46:04.442512 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m12:46:04.447378 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:46:04.448032 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:46:04.448422 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:46:04.448692 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:46:04.449001 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:46:04.449276 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.454403 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:46:04.454671 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:46:04.454944 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m12:46:04.455944 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m12:46:04.456381 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:46:04.461148 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:46:04.461581 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:46:04.461875 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m12:46:04.462297 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:46:04.462581 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m12:46:04.462814 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:04.463076 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m12:46:04.463348 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:46:04.463710 [info ] [Thread-4  ]: 19 of 25 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.09s]
[0m12:46:04.464093 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:46:04.464333 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:46:04.464682 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:46:04.465089 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:46:04.465354 [info ] [Thread-4  ]: 23 of 25 START test unique_dim_customers_email ................................. [RUN]
[0m12:46:04.465712 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.466097 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:46:04.466377 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:46:04.466717 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:46:04.467092 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
    
      
    ) dbt_internal_test
[0m12:46:04.470610 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:46:04.471373 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:46:04.512936 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.049 seconds
[0m12:46:04.513279 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.042 seconds
[0m12:46:04.513953 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:46:04.515743 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:46:04.516684 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: ROLLBACK
[0m12:46:04.517253 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:46:04.517592 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:46:04.517808 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.055 seconds
[0m12:46:04.518062 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:46:04.518328 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: Close
[0m12:46:04.518537 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m12:46:04.519127 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:46:04.519404 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:46:04.519762 [info ] [Thread-3  ]: 20 of 25 PASS not_null_fct_orders_total_items .................................. [[32mPASS[0m in 0.12s]
[0m12:46:04.520013 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.520650 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:46:04.521153 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:46:04.521459 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:46:04.521719 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:46:04.521991 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:46:04.522240 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m12:46:04.522668 [info ] [Thread-3  ]: 24 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m12:46:04.523021 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.523325 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:46:04.523571 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:46:04.523846 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:46:04.524106 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex2"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex2"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m12:46:04.527695 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:46:04.528006 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:46:04.528753 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:46:04.529019 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:46:04.529249 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:46:04.529514 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:46:04.530224 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:46:04.530726 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:46:04.530963 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:46:04.531233 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:46:04.531462 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m12:46:04.532023 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:46:04.532244 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.532616 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:46:04.532902 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:46:04.533177 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:46:04.533515 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:46:04.533833 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:46:04.534204 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m12:46:04.538754 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:46:04.539072 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:46:04.539482 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:46:04.539731 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:46:04.539987 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m12:46:04.540250 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m12:46:04.540497 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:46:04.540724 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.541114 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:46:04.541447 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:46:04.541811 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:46:04.542345 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:46:04.542731 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:46:04.543025 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.545257 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m12:46:04.545559 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m12:46:04.545782 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:46:04.546029 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:46:04.546266 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m12:46:04.546853 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:46:04.547099 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m12:46:04.547473 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:46:04.547954 [info ] [Thread-2  ]: 22 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.11s]
[0m12:46:04.548284 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:46:04.548645 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:46:04.548961 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:46:04.549287 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.549544 [info ] [Thread-2  ]: 25 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m12:46:04.550572 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m12:46:04.550837 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:46:04.551059 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:46:04.551343 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:46:04.552010 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:46:04.552264 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m12:46:04.552633 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:46:04.552867 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:46:04.553314 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:46:04.553812 [info ] [Thread-1  ]: 21 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.12s]
[0m12:46:04.557734 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:46:04.558068 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:46:04.558432 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:46:04.558712 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:46:04.559102 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:46:04.559431 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.559678 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:46:04.559891 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.560101 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:46:04.565017 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:46:04.565302 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:46:04.565560 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m12:46:04.565945 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:46:04.566178 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:46:04.566447 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m12:46:04.566717 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:46:04.567434 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:46:04.568480 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m12:46:04.569065 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: Close
[0m12:46:04.569717 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:46:04.569507 [info ] [Thread-4  ]: 23 of 25 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.10s]
[0m12:46:04.570404 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:46:04.570773 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:46:04.571040 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:46:04.571378 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:46:04.572465 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m12:46:04.572869 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:46:04.573451 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:46:04.573869 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:46:04.574387 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.574621 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:46:04.574875 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:46:04.575588 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.000 seconds
[0m12:46:04.575825 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.009 seconds
[0m12:46:04.576764 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m12:46:04.577399 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:46:04.577899 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:46:04.578119 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:46:04.578342 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:46:04.578800 [info ] [Thread-3  ]: 24 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.06s]
[0m12:46:04.579104 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:46:04.579601 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:46:04.579956 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:46:04.580378 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m12:46:04.582277 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.002 seconds
[0m12:46:04.582892 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:46:04.583116 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:46:04.583322 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:46:04.584288 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:46:04.584683 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:46:04.585148 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:46:04.585362 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:46:04.585728 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:46:04.585944 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:46:04.586159 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:46:04.586676 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.000 seconds
[0m12:46:04.587509 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m12:46:04.588015 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m12:46:04.588398 [info ] [Thread-2  ]: 25 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m12:46:04.588742 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:46:04.589487 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:04.589700 [debug] [MainThread]: On master: BEGIN
[0m12:46:04.589880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:46:04.596359 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:46:04.596650 [debug] [MainThread]: On master: COMMIT
[0m12:46:04.596847 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:04.597027 [debug] [MainThread]: On master: COMMIT
[0m12:46:04.597465 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:46:04.597685 [debug] [MainThread]: On master: Close
[0m12:46:04.597966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:04.598154 [debug] [MainThread]: Connection 'test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m12:46:04.598325 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m12:46:04.598493 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m12:46:04.598654 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m12:46:04.598902 [info ] [MainThread]: 
[0m12:46:04.599109 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m12:46:04.601319 [debug] [MainThread]: Command end result
[0m12:46:04.757434 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:46:04.760487 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:46:04.773843 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:46:04.774552 [info ] [MainThread]: 
[0m12:46:04.775246 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:46:04.775907 [info ] [MainThread]: 
[0m12:46:04.776937 [error] [MainThread]: [31mFailure in test assert_no_duplicate_orders (tests/assert_no_duplicate_orders.sql)[0m
[0m12:46:04.777654 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m12:46:04.778275 [info ] [MainThread]: 
[0m12:46:04.779005 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/tests/assert_no_duplicate_orders.sql
[0m12:46:04.779801 [info ] [MainThread]: 
[0m12:46:04.780318 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  --------------------------------------------------------------------------------
[0m12:46:04.781083 [info ] [MainThread]: 
[0m12:46:04.781689 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=1 SKIP=0 TOTAL=25
[0m12:46:04.784375 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.6413174, "process_in_blocks": "0", "process_kernel_time": 0.207359, "process_mem_max_rss": "133398528", "process_out_blocks": "0", "process_user_time": 2.152544}
[0m12:46:04.784920 [debug] [MainThread]: Command `dbt test` failed at 12:46:04.784844 after 1.64 seconds
[0m12:46:04.785210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b17790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ca6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057caa90>]}
[0m12:46:04.785509 [debug] [MainThread]: Flushing usage events
[0m12:46:05.733479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:06.978099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501b070>]}


============================== 12:46:06.980588 | e8e83cc4-fe91-4964-b4f4-7b9b385e07df ==============================
[0m12:46:06.980588 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:46:06.980967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:46:07.105305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8e83cc4-fe91-4964-b4f4-7b9b385e07df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10539d3a0>]}
[0m12:46:07.152782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8e83cc4-fe91-4964-b4f4-7b9b385e07df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10533ccd0>]}
[0m12:46:07.153414 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:46:07.242120 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:46:07.359938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:07.360247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:07.365786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:46:07.429442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8e83cc4-fe91-4964-b4f4-7b9b385e07df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1ce20>]}
[0m12:46:07.438330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8e83cc4-fe91-4964-b4f4-7b9b385e07df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa49d0>]}
[0m12:46:07.438652 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:46:07.438874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e83cc4-fe91-4964-b4f4-7b9b385e07df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa4970>]}
[0m12:46:07.440275 [info ] [MainThread]: 
[0m12:46:07.440502 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:46:07.440696 [info ] [MainThread]: 
[0m12:46:07.441050 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:46:07.445645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:46:07.446114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:46:07.480170 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:46:07.480477 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:46:07.480685 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:46:07.480890 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:46:07.481082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:07.481258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:07.502131 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m12:46:07.502440 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m12:46:07.502676 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:46:07.502887 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:46:07.503105 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:46:07.503325 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:46:07.508400 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m12:46:07.508649 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.005 seconds
[0m12:46:07.509603 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:46:07.511088 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:46:07.511578 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:46:07.511780 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:46:07.522494 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:07.522767 [debug] [MainThread]: On master: BEGIN
[0m12:46:07.522966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:46:07.532794 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:46:07.533126 [debug] [MainThread]: Using postgres connection "master"
[0m12:46:07.533421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:46:07.580661 [debug] [MainThread]: SQL status: SELECT 4 in 0.047 seconds
[0m12:46:07.582425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e83cc4-fe91-4964-b4f4-7b9b385e07df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e1e220>]}
[0m12:46:07.582820 [debug] [MainThread]: On master: ROLLBACK
[0m12:46:07.583439 [debug] [MainThread]: On master: Close
[0m12:46:07.585159 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:46:07.585564 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:46:07.585908 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:46:07.586384 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m12:46:07.586697 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:46:07.587052 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m12:46:07.587452 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:46:07.587771 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:46:07.588158 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:46:07.588697 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:46:07.589021 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:46:07.597100 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:46:07.597406 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:46:07.600339 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:46:07.603417 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:46:07.606952 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:46:07.607566 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:46:07.607821 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:46:07.608270 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:46:07.608492 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:46:07.608704 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:46:07.609108 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:46:07.609597 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:46:07.610002 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:46:07.610511 [debug] [Thread-2  ]: Began running node model.ecommerce_test.dim_products
[0m12:46:07.610792 [debug] [Thread-4  ]: Began running node model.ecommerce_test.dim_customers
[0m12:46:07.611060 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.dim_products)
[0m12:46:07.611296 [debug] [Thread-3  ]: Began running node model.ecommerce_test.fct_orders
[0m12:46:07.611542 [debug] [Thread-1  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:46:07.611783 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.dim_customers)
[0m12:46:07.612021 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:46:07.612275 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.fct_orders)
[0m12:46:07.612525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now test.ecommerce_test.assert_no_duplicate_orders)
[0m12:46:07.612761 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:46:07.616070 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:46:07.616391 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:46:07.616641 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:46:07.619812 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:46:07.623153 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:46:07.626083 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:46:07.626390 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.dim_products
[0m12:46:07.626952 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.dim_products
[0m12:46:07.627301 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:46:07.627540 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:46:07.627914 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:46:07.628433 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:46:07.628667 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:46:07.628935 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:46:07.629187 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:46:07.629466 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:46:07.629955 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:46:07.630210 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_products, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:46:07.630470 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:46:07.630707 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_customers, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:46:07.630939 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:46:07.631203 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:46:07.631541 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:46:07.631754 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:46:07.631983 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.fct_orders, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:46:07.641588 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:46:07.647335 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:46:07.650240 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:46:07.650502 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:46:07.653605 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:46:07.654034 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:46:07.654448 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:46:07.654689 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:46:07.654929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:46:07.655146 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:46:07.658952 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:46:07.659296 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:46:07.659777 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:46:07.660041 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:46:07.660326 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:46:07.660560 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:46:07.660824 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:46:07.661250 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:46:07.661461 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:46:07.661868 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:46:07.662094 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:46:07.662339 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:46:07.662743 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:46:07.662988 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:46:07.666148 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:46:07.666444 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:46:07.666703 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:46:07.666968 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:46:07.667234 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:46:07.667476 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:46:07.667730 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:46:07.672297 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:46:07.672571 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:46:07.672791 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:46:07.683754 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:46:07.684282 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:46:07.687847 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:46:07.688169 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:46:07.688413 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:46:07.688662 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:46:07.689135 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:46:07.689374 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:46:07.689602 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:46:07.689979 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:46:07.690216 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:46:07.690573 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:46:07.690803 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:46:07.691024 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:46:07.691255 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:46:07.691513 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:46:07.694471 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:46:07.694743 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:46:07.695024 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:46:07.695314 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:46:07.695596 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:46:07.698775 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:46:07.699059 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:46:07.699255 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:46:07.702118 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:46:07.705778 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:46:07.706242 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:46:07.706549 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:46:07.706867 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:46:07.707132 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:46:07.707397 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:46:07.707777 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:46:07.708021 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:46:07.708474 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:46:07.708881 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:46:07.709143 [debug] [Thread-3  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:46:07.709375 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:46:07.709652 [debug] [Thread-2  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:46:07.709930 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:46:07.710226 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:46:07.713617 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:46:07.713942 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.assert_total_amount_equals_sum_of_items)
[0m12:46:07.714199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:46:07.714452 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:46:07.714736 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:46:07.714966 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:46:07.719430 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:46:07.722250 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:46:07.722508 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:46:07.726326 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:46:07.726915 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:46:07.727280 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:46:07.727543 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_email.0472f7c2e8, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:46:07.727862 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:46:07.728091 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:46:07.728319 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:46:07.728530 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:46:07.731583 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:46:07.732006 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:46:07.732442 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:46:07.732844 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:46:07.733137 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:46:07.733403 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:46:07.733683 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:46:07.733900 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:46:07.734170 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:46:07.734428 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:46:07.734676 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:46:07.735059 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:46:07.735275 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:46:07.735568 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:46:07.735801 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:46:07.736048 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:46:07.739312 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:46:07.742288 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:46:07.745177 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:46:07.745456 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:46:07.745852 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:46:07.749645 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:46:07.750185 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:46:07.750621 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:46:07.750867 [debug] [Thread-2  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:46:07.751117 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:46:07.751346 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:46:07.757125 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:46:07.757482 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:46:07.757721 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:46:07.757992 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:46:07.758992 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:46:07.759409 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:46:07.760459 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:46:07.760738 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:46:07.761143 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:46:07.761434 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:46:07.761849 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:46:07.762173 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:46:07.765887 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:46:07.766429 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:46:07.766865 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:46:07.767448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:07.767649 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38' was properly closed.
[0m12:46:07.767825 [debug] [MainThread]: Connection 'test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m12:46:07.767996 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_fct_orders_status.1455048989' was properly closed.
[0m12:46:07.768160 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m12:46:07.770653 [debug] [MainThread]: Command end result
[0m12:46:07.888033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:46:07.890485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:46:07.895687 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:46:07.897677 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:46:07.897902 [info ] [MainThread]: Building catalog
[0m12:46:07.910018 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db_ex2.information_schema'
[0m12:46:07.918223 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:46:07.918576 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: BEGIN
[0m12:46:07.918777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:07.931054 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:46:07.931391 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:46:07.931767 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "dbt_db_ex2.information_schema"} */

    
    

    select
        'dbt_db_ex2' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_date')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_revenue')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_lifetime_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_price')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_name')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_no_duplicate_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_amount')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_total_amount_equals_sum_of_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_quantity_sold')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:46:07.940236 [debug] [ThreadPool]: SQL status: SELECT 214 in 0.008 seconds
[0m12:46:07.951070 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: ROLLBACK
[0m12:46:07.952391 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: Close
[0m12:46:07.969577 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:46:08.000172 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:46:08.001428 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:46:08.001656 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:46:08.003019 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.0753386, "process_in_blocks": "0", "process_kernel_time": 0.182359, "process_mem_max_rss": "127582208", "process_out_blocks": "0", "process_user_time": 1.781693}
[0m12:46:08.003361 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:46:08.003303 after 1.08 seconds
[0m12:46:08.003599 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:46:08.003777 [debug] [MainThread]: Connection 'dbt_db_ex2.information_schema' was properly closed.
[0m12:46:08.003989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d01cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d3fa0>]}
[0m12:46:08.004245 [debug] [MainThread]: Flushing usage events
[0m12:46:09.110330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:14.903190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110143760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112abaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112abcd0>]}


============================== 12:47:14.906389 | 1cc5a259-5cb7-4d13-ad23-3769b215f721 ==============================
[0m12:47:14.906389 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:47:14.906823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:15.100165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1cc5a259-5cb7-4d13-ad23-3769b215f721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112a57c0>]}
[0m12:47:15.169037 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-0aspazyf'
[0m12:47:15.169376 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:47:15.265304 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:47:15.266958 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:47:15.461286 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:47:15.468638 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m12:47:15.489887 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m12:47:15.492204 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m12:47:15.492618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1cc5a259-5cb7-4d13-ad23-3769b215f721', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111474340>]}
[0m12:47:15.495989 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m12:47:15.515987 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m12:47:15.519768 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:47:16.232191 [info ] [MainThread]: Installed from version 1.1.1
[0m12:47:16.232615 [info ] [MainThread]: Updated version available: 1.3.0
[0m12:47:16.232879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1cc5a259-5cb7-4d13-ad23-3769b215f721', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110294970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114743d0>]}
[0m12:47:16.233159 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m12:47:17.766960 [info ] [MainThread]: Installed from version 0.10.0
[0m12:47:17.767318 [info ] [MainThread]: Updated version available: 0.10.4
[0m12:47:17.767577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1cc5a259-5cb7-4d13-ad23-3769b215f721', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114743a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111474130>]}
[0m12:47:17.767851 [info ] [MainThread]: Installing calogica/dbt_date
[0m12:47:18.857509 [info ] [MainThread]: Installed from version 0.10.0
[0m12:47:18.858010 [info ] [MainThread]: Updated version available: 0.10.1
[0m12:47:18.858303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1cc5a259-5cb7-4d13-ad23-3769b215f721', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111474d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111474d60>]}
[0m12:47:18.858695 [info ] [MainThread]: 
[0m12:47:18.859214 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m12:47:18.862541 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.0134263, "process_in_blocks": "0", "process_kernel_time": 0.263663, "process_mem_max_rss": "113524736", "process_out_blocks": "0", "process_user_time": 1.207434}
[0m12:47:18.862978 [debug] [MainThread]: Command `dbt deps` succeeded at 12:47:18.862904 after 4.01 seconds
[0m12:47:18.863253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110143760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103c3e20>]}
[0m12:47:18.863518 [debug] [MainThread]: Flushing usage events
[0m12:47:19.832547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:21.142918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073be790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108226bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108226d90>]}


============================== 12:47:21.145906 | 29c7f67b-8d3e-4871-a427-15e86e9f0648 ==============================
[0m12:47:21.145906 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:47:21.146276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:21.156175 [info ] [MainThread]: dbt version: 1.9.4
[0m12:47:21.156482 [info ] [MainThread]: python version: 3.9.6
[0m12:47:21.156679 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m12:47:21.156872 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m12:47:21.206971 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m12:47:21.207308 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m12:47:21.207515 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/dbt_project.yml
[0m12:47:21.208055 [info ] [MainThread]: adapter type: postgres
[0m12:47:21.208307 [info ] [MainThread]: adapter version: 1.9.0
[0m12:47:21.291430 [info ] [MainThread]: Configuration:
[0m12:47:21.291802 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:47:21.292013 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:47:21.292205 [info ] [MainThread]: Required dependencies:
[0m12:47:21.292479 [debug] [MainThread]: Executing "git --help"
[0m12:47:21.309406 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:47:21.310071 [debug] [MainThread]: STDERR: "b''"
[0m12:47:21.310346 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:47:21.310591 [info ] [MainThread]: Connection:
[0m12:47:21.310860 [info ] [MainThread]:   host: localhost
[0m12:47:21.311053 [info ] [MainThread]:   port: 5433
[0m12:47:21.311236 [info ] [MainThread]:   user: dbt_user
[0m12:47:21.311418 [info ] [MainThread]:   database: dbt_db_ex2
[0m12:47:21.311600 [info ] [MainThread]:   schema: public
[0m12:47:21.311781 [info ] [MainThread]:   connect_timeout: 10
[0m12:47:21.311961 [info ] [MainThread]:   role: None
[0m12:47:21.312134 [info ] [MainThread]:   search_path: None
[0m12:47:21.312307 [info ] [MainThread]:   keepalives_idle: 0
[0m12:47:21.312480 [info ] [MainThread]:   sslmode: None
[0m12:47:21.312655 [info ] [MainThread]:   sslcert: None
[0m12:47:21.312829 [info ] [MainThread]:   sslkey: None
[0m12:47:21.313194 [info ] [MainThread]:   sslrootcert: None
[0m12:47:21.313428 [info ] [MainThread]:   application_name: dbt
[0m12:47:21.313624 [info ] [MainThread]:   retries: 1
[0m12:47:21.314085 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:21.384901 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:47:21.412572 [debug] [MainThread]: Using postgres connection "debug"
[0m12:47:21.412910 [debug] [MainThread]: On debug: select 1 as id
[0m12:47:21.413117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:21.453568 [debug] [MainThread]: SQL status: SELECT 1 in 0.040 seconds
[0m12:47:21.454257 [debug] [MainThread]: On debug: Close
[0m12:47:21.454507 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:47:21.454752 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:47:21.456188 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3683224, "process_in_blocks": "0", "process_kernel_time": 0.172413, "process_mem_max_rss": "114966528", "process_out_blocks": "0", "process_user_time": 1.092472}
[0m12:47:21.456585 [debug] [MainThread]: Command `dbt debug` succeeded at 12:47:21.456509 after 0.37 seconds
[0m12:47:21.456829 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:47:21.457077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073be790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107679160>]}
[0m12:47:21.457387 [debug] [MainThread]: Flushing usage events
[0m12:47:22.520390 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:23.699814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108303790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10927ae80>]}


============================== 12:47:23.702729 | c4b29c7c-2031-4fef-b85f-36393c946fc1 ==============================
[0m12:47:23.702729 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:47:23.703126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:47:23.846648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109554ac0>]}
[0m12:47:23.900908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bc880>]}
[0m12:47:23.901570 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:24.001896 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:47:24.166674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:24.167001 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:24.172780 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:47:24.246142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1fa100>]}
[0m12:47:24.341353 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:47:24.344446 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:47:24.354131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109795b50>]}
[0m12:47:24.354525 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:47:24.354750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1da310>]}
[0m12:47:24.355992 [info ] [MainThread]: 
[0m12:47:24.356225 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:47:24.356420 [info ] [MainThread]: 
[0m12:47:24.356741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:24.359729 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m12:47:24.387664 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m12:47:24.387963 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m12:47:24.388168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:24.410867 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.023 seconds
[0m12:47:24.411799 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m12:47:24.413941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m12:47:24.414278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:47:24.419593 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:47:24.421841 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:47:24.422068 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:47:24.422267 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:47:24.422456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:24.422639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:24.434547 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:47:24.434890 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:47:24.435136 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:47:24.435375 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:47:24.435633 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:47:24.435902 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:24.440145 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m12:47:24.440462 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.004 seconds
[0m12:47:24.441466 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:47:24.443064 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:47:24.443749 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:47:24.443994 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:47:24.455496 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:24.455785 [debug] [MainThread]: On master: BEGIN
[0m12:47:24.455976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:24.463620 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:47:24.463926 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:24.464198 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:24.511570 [debug] [MainThread]: SQL status: SELECT 4 in 0.047 seconds
[0m12:47:24.513244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105454cd0>]}
[0m12:47:24.513617 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:24.514210 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:24.514457 [debug] [MainThread]: On master: BEGIN
[0m12:47:24.515236 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:47:24.515482 [debug] [MainThread]: On master: COMMIT
[0m12:47:24.515716 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:24.515939 [debug] [MainThread]: On master: COMMIT
[0m12:47:24.516410 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:24.516738 [debug] [MainThread]: On master: Close
[0m12:47:24.519094 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:47:24.519432 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:47:24.520050 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:47:24.520346 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:47:24.519823 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m12:47:24.520780 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m12:47:24.521149 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m12:47:24.521514 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m12:47:24.521886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m12:47:24.522283 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m12:47:24.522638 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:47:24.523091 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:47:24.523379 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:47:24.523666 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:47:24.523943 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:47:24.524220 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:47:24.531383 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:47:24.534103 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:47:24.537154 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:47:24.540925 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:47:24.541621 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:47:24.547375 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:47:24.560201 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:47:24.566483 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:47:24.572991 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.stg_order_items"
[0m12:47:24.573770 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_test.stg_customers"
[0m12:47:24.577365 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.stg_products"
[0m12:47:24.580406 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.stg_orders"
[0m12:47:24.581076 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:47:24.581308 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: BEGIN
[0m12:47:24.581515 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:47:24.581850 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:47:24.582167 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:47:24.582425 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: BEGIN
[0m12:47:24.582678 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:47:24.582933 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: BEGIN
[0m12:47:24.583160 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:47:24.583385 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: BEGIN
[0m12:47:24.583627 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:24.584002 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:24.590759 [debug] [Thread-3  ]: SQL status: BEGIN in 0.009 seconds
[0m12:47:24.591369 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:47:24.591758 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */

  create view "dbt_db_ex2"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at,
        -- Add tracking for data lineage
        'c4b29c7c-2031-4fef-b85f-36393c946fc1' as _invocation_id
    from source
)

select * from staged
  );
[0m12:47:24.595020 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m12:47:24.595336 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m12:47:24.595622 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m12:47:24.595918 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:47:24.596194 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:47:24.596411 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:47:24.596639 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:47:24.596886 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */

  create view "dbt_db_ex2"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email, -- Normalize email
        created_at
    from source
)

select * from staged
  );
[0m12:47:24.602004 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:47:24.602284 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */

  create view "dbt_db_ex2"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price, -- Ensure no NULL values
        category,
        created_at
    from source
)

select * from staged
  );
[0m12:47:24.602540 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */

  create view "dbt_db_ex2"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity, -- Ensure minimum quantity is 1
        coalesce(unit_price, 0) as unit_price, -- Ensure no NULL prices
        created_at
    from source
)

select * from staged
  );
[0m12:47:24.603040 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:47:24.604772 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:47:24.608110 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:47:24.608462 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:47:24.608685 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:47:24.608896 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:47:24.609122 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:47:24.612711 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:47:24.615613 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:47:24.619102 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:47:24.619499 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m12:47:24.619777 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:47:24.620038 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m12:47:24.620311 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:47:24.627069 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m12:47:24.627457 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:47:24.634937 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m12:47:24.635747 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.015 seconds
[0m12:47:24.638935 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:47:24.642557 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:47:24.643405 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:47:24.649568 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:47:24.649965 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:47:24.650234 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:47:24.650476 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m12:47:24.650835 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m12:47:24.652489 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:47:24.653770 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:47:24.654217 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:47:24.655162 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m12:47:24.655481 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m12:47:24.656446 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m12:47:24.657340 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m12:47:24.657630 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:47:24.662832 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_orders__dbt_backup"
[0m12:47:24.663191 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:47:24.663429 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:47:24.663654 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m12:47:24.668132 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m12:47:24.670111 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m12:47:24.670899 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m12:47:24.671493 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
drop view if exists "dbt_db_ex2"."public"."stg_orders__dbt_backup" cascade
[0m12:47:24.673426 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:24.673833 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:24.676398 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_products__dbt_backup"
[0m12:47:24.676695 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.005 seconds
[0m12:47:24.676946 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m12:47:24.679929 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_order_items__dbt_backup"
[0m12:47:24.680526 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m12:47:24.682730 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: Close
[0m12:47:24.685435 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_customers__dbt_backup"
[0m12:47:24.685915 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m12:47:24.686163 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
drop view if exists "dbt_db_ex2"."public"."stg_products__dbt_backup" cascade
[0m12:47:24.686593 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m12:47:24.687719 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
drop view if exists "dbt_db_ex2"."public"."stg_order_items__dbt_backup" cascade
[0m12:47:24.688475 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
drop view if exists "dbt_db_ex2"."public"."stg_customers__dbt_backup" cascade
[0m12:47:24.688947 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a71f0>]}
[0m12:47:24.689483 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m12:47:24.689934 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:47:24.691577 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.003 seconds
[0m12:47:24.692107 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.003 seconds
[0m12:47:24.692341 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m12:47:24.693261 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: Close
[0m12:47:24.695239 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: Close
[0m12:47:24.696141 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: Close
[0m12:47:24.697027 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8cbca0>]}
[0m12:47:24.697606 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a82f130>]}
[0m12:47:24.698098 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a88dd00>]}
[0m12:47:24.699725 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m12:47:24.700175 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.18s]
[0m12:47:24.700780 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m12:47:24.701167 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:47:24.701516 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:47:24.701843 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:47:24.702455 [debug] [Thread-3  ]: Began running node model.ecommerce_test.dim_customers
[0m12:47:24.703026 [debug] [Thread-4  ]: Began running node model.ecommerce_test.dim_products
[0m12:47:24.704490 [debug] [Thread-2  ]: Began running node model.ecommerce_test.fct_orders
[0m12:47:24.704251 [info ] [Thread-3  ]: 5 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m12:47:24.704998 [info ] [Thread-4  ]: 6 of 7 START sql table model public.dim_products ............................... [RUN]
[0m12:47:24.705335 [info ] [Thread-2  ]: 7 of 7 START sql table model public.fct_orders ................................. [RUN]
[0m12:47:24.705677 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.dim_customers)
[0m12:47:24.705935 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.dim_products)
[0m12:47:24.706180 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.fct_orders)
[0m12:47:24.706423 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:47:24.706640 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:47:24.706859 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:47:24.710315 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:47:24.713651 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:47:24.716746 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:47:24.717450 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.dim_products
[0m12:47:24.775591 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:47:24.840345 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:47:24.931832 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.dim_products"
[0m12:47:24.932642 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.dim_customers"
[0m12:47:24.933719 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.fct_orders"
[0m12:47:24.934284 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:47:24.934525 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: BEGIN
[0m12:47:24.934742 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:47:24.935087 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:47:24.935341 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: BEGIN
[0m12:47:24.935752 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:47:24.936264 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:47:24.936572 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: BEGIN
[0m12:47:24.936943 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:24.943970 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m12:47:24.944347 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:47:24.944635 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex2"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(quantity * unit_price) as total_revenue
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

final as (
    select
        p.product_id,
        p.name,
        p.price,
        p.category,
        p.created_at,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_revenue, 0) as total_revenue,
        current_timestamp as updated_at
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
  );
  
[0m12:47:24.946440 [debug] [Thread-3  ]: SQL status: BEGIN in 0.010 seconds
[0m12:47:24.946924 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m12:47:24.947192 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:47:24.947441 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:47:24.947724 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex2"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as lifetime_orders,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1
),

final as (
    select
        c.customer_id,
        c.name,
        c.email,
        c.created_at,
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        current_timestamp as updated_at
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
  );
  
[0m12:47:24.948038 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */

  
    

  create  table "dbt_db_ex2"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

with orders as (
    select * from "dbt_db_ex2"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db_ex2"."public"."stg_order_items"
),

order_totals as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(quantity * unit_price) as total_amount
    from order_items
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        coalesce(ot.total_items, 0) as total_items,
        coalesce(ot.total_amount, 0) as total_amount,
        o.created_at,
        current_timestamp as updated_at,
        o._invocation_id
    from orders o
    left join order_totals ot on o.order_id = ot.order_id
)

select * from final
  );
  
[0m12:47:24.954164 [debug] [Thread-4  ]: SQL status: SELECT 4 in 0.009 seconds
[0m12:47:24.960479 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:47:24.960792 [debug] [Thread-2  ]: SQL status: SELECT 3 in 0.012 seconds
[0m12:47:24.961050 [debug] [Thread-3  ]: SQL status: SELECT 3 in 0.013 seconds
[0m12:47:24.961295 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m12:47:24.964262 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:47:24.967060 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:47:24.967359 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders" rename to "fct_orders__dbt_backup"
[0m12:47:24.967639 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m12:47:24.967980 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:47:24.970625 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:47:24.970871 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:47:24.971086 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m12:47:24.971293 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:47:24.973703 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:47:24.977003 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:47:24.977299 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:47:24.977535 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m12:47:24.977773 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m12:47:24.978588 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: COMMIT
[0m12:47:24.978885 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:47:24.979109 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: COMMIT
[0m12:47:24.980116 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:47:24.980368 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m12:47:24.980593 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:47:24.981342 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m12:47:24.983642 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_products__dbt_backup"
[0m12:47:24.984415 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m12:47:24.984658 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:47:24.986167 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m12:47:24.986415 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:47:24.986649 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m12:47:24.986900 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
drop table if exists "dbt_db_ex2"."public"."dim_products__dbt_backup" cascade
[0m12:47:24.987164 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m12:47:24.988447 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:47:24.988742 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m12:47:24.991739 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."fct_orders__dbt_backup"
[0m12:47:24.992089 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.005 seconds
[0m12:47:24.994374 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_customers__dbt_backup"
[0m12:47:24.994763 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m12:47:24.995600 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: Close
[0m12:47:24.995964 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m12:47:24.996201 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
drop table if exists "dbt_db_ex2"."public"."fct_orders__dbt_backup" cascade
[0m12:47:24.996467 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
drop table if exists "dbt_db_ex2"."public"."dim_customers__dbt_backup" cascade
[0m12:47:24.996851 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa2a400>]}
[0m12:47:24.997361 [info ] [Thread-4  ]: 6 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.29s]
[0m12:47:24.997829 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.dim_products
[0m12:47:24.999778 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.003 seconds
[0m12:47:25.000024 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.003 seconds
[0m12:47:25.000884 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: Close
[0m12:47:25.001726 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: Close
[0m12:47:25.002249 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b2f10>]}
[0m12:47:25.002655 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4b29c7c-2031-4fef-b85f-36393c946fc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a85aa60>]}
[0m12:47:25.003240 [info ] [Thread-3  ]: 5 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.30s]
[0m12:47:25.004552 [info ] [Thread-2  ]: 7 of 7 OK created sql table model public.fct_orders ............................ [[32mSELECT 3[0m in 0.30s]
[0m12:47:25.005209 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:47:25.005624 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:47:25.006713 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:25.006951 [debug] [MainThread]: On master: BEGIN
[0m12:47:25.007149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:25.014788 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:47:25.015109 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.015313 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:25.015500 [debug] [MainThread]: On master: COMMIT
[0m12:47:25.016116 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:25.016439 [debug] [MainThread]: On master: Close
[0m12:47:25.016877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:25.017094 [debug] [MainThread]: Connection 'model.ecommerce_test.stg_customers' was properly closed.
[0m12:47:25.017281 [debug] [MainThread]: Connection 'model.ecommerce_test.fct_orders' was properly closed.
[0m12:47:25.017458 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_customers' was properly closed.
[0m12:47:25.017630 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_products' was properly closed.
[0m12:47:25.017903 [info ] [MainThread]: 
[0m12:47:25.018164 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m12:47:25.019259 [debug] [MainThread]: Command end result
[0m12:47:25.052090 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:47:25.053248 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:47:25.057723 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:47:25.057990 [info ] [MainThread]: 
[0m12:47:25.058249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:25.058461 [info ] [MainThread]: 
[0m12:47:25.058762 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:47:25.059866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4213651, "process_in_blocks": "0", "process_kernel_time": 0.203518, "process_mem_max_rss": "128237568", "process_out_blocks": "0", "process_user_time": 1.93876}
[0m12:47:25.060128 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:25.060080 after 1.42 seconds
[0m12:47:25.060357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108303790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090bc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b1e50>]}
[0m12:47:25.060593 [debug] [MainThread]: Flushing usage events
[0m12:47:28.327494 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:29.709285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c2d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c2f70>]}


============================== 12:47:29.712214 | c3e7aed1-06ff-4187-a533-f779e4454ecd ==============================
[0m12:47:29.712214 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:47:29.712603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --store-failures', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:47:29.840603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3e7aed1-06ff-4187-a533-f779e4454ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1ceb0>]}
[0m12:47:29.887791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3e7aed1-06ff-4187-a533-f779e4454ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d5d90>]}
[0m12:47:29.888438 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:29.969841 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:47:30.101336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:30.101648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:30.106859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:47:30.174650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3e7aed1-06ff-4187-a533-f779e4454ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b4e80>]}
[0m12:47:30.264850 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:47:30.267348 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:47:30.281925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3e7aed1-06ff-4187-a533-f779e4454ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fd250>]}
[0m12:47:30.282300 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:47:30.282516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3e7aed1-06ff-4187-a533-f779e4454ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730c280>]}
[0m12:47:30.284143 [info ] [MainThread]: 
[0m12:47:30.284367 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:47:30.284562 [info ] [MainThread]: 
[0m12:47:30.284931 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:30.288781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m12:47:30.314707 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m12:47:30.314999 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m12:47:30.315202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:30.341806 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.026 seconds
[0m12:47:30.343127 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m12:47:30.346858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public_dbt_test__audit)
[0m12:47:30.353095 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:47:30.353526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:47:30.353749 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:47:30.355993 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:47:30.356257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:30.356527 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:47:30.356853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:30.366298 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:47:30.366640 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m12:47:30.366910 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:47:30.367136 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:47:30.367389 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:30.367786 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:47:30.371272 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m12:47:30.371713 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.003 seconds
[0m12:47:30.372815 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:47:30.374282 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:47:30.375047 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:47:30.375304 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:47:30.386076 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:30.386361 [debug] [MainThread]: On master: BEGIN
[0m12:47:30.386554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:30.394153 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:47:30.394448 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:30.394747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:30.437895 [debug] [MainThread]: SQL status: SELECT 4 in 0.043 seconds
[0m12:47:30.439464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3e7aed1-06ff-4187-a533-f779e4454ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fdfd0>]}
[0m12:47:30.439837 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:30.440412 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:30.440646 [debug] [MainThread]: On master: BEGIN
[0m12:47:30.441412 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.441691 [debug] [MainThread]: On master: COMMIT
[0m12:47:30.441928 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:30.442147 [debug] [MainThread]: On master: COMMIT
[0m12:47:30.442629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:30.442903 [debug] [MainThread]: On master: Close
[0m12:47:30.446496 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:47:30.446901 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:47:30.447192 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:47:30.447789 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:47:30.447530 [info ] [Thread-1  ]: 1 of 25 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m12:47:30.448193 [info ] [Thread-2  ]: 2 of 25 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m12:47:30.448486 [info ] [Thread-3  ]: 3 of 25 START test assert_no_duplicate_orders .................................. [RUN]
[0m12:47:30.448773 [info ] [Thread-4  ]: 4 of 25 START test assert_total_amount_equals_sum_of_items ..................... [RUN]
[0m12:47:30.449138 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:47:30.449437 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:47:30.449775 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_no_duplicate_orders'
[0m12:47:30.450098 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_total_amount_equals_sum_of_items'
[0m12:47:30.450399 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:47:30.450701 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:47:30.450967 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:47:30.451373 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:47:30.472152 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:47:30.473142 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:47:30.476106 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:47:30.478715 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:47:30.479422 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:47:30.485985 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:47:30.494618 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:47:30.499113 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:47:30.499475 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:47:30.499743 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:47:30.502834 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:47:30.503294 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:47:30.508137 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:47:30.512524 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:47:30.512840 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m12:47:30.513093 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m12:47:30.513481 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:47:30.513816 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:47:30.514038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:30.514259 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:30.514477 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items" cascade
[0m12:47:30.514700 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders" cascade
[0m12:47:30.515113 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:47:30.515386 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:47:30.527268 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:47:30.527618 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:47:30.527877 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:47:30.529649 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m12:47:30.529901 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.016 seconds
[0m12:47:30.530589 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m12:47:30.531237 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m12:47:30.539614 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:47:30.540354 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m12:47:30.540803 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:47:30.541230 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:47:30.541466 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:47:30.541870 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:47:30.542096 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:47:30.542315 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:47:30.542586 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:47:30.543069 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.543364 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.543598 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.543803 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.544009 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:47:30.544235 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:47:30.544459 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:47:30.544667 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:47:30.544911 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
  
  
    as
  
  (
    /*
  Custom test to check if the total amount in orders table
  matches the sum of the item amounts in order_items.
  
  If there are differences, this test will return the records with discrepancies.
*/

with orders as (
    select 
        order_id,
        total_amount as order_total
    from "dbt_db_ex2"."public"."fct_orders"
),

order_items_grouped as (
    select
        order_id,
        sum(quantity * unit_price) as items_total
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

joined as (
    select
        o.order_id,
        o.order_total,
        coalesce(oi.items_total, 0) as items_total,
        abs(o.order_total - coalesce(oi.items_total, 0)) as difference
    from orders o
    left join order_items_grouped oi on o.order_id = oi.order_id
)

select * from joined where difference > 0.01  -- Allow small rounding differences
  );
  
    
[0m12:47:30.545177 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m12:47:30.545456 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m12:47:30.545727 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  
  
    as
  
  (
    /*
  Custom test to ensure there are no duplicate orders in the core table.
  This test checks for duplicates based on customer_id and order_date within 15 minutes
*/

with orders as (
    select 
        customer_id,
        order_date,
        count(*) as order_count
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1, 2
),

potential_duplicates as (
    select
        o1.customer_id,
        o1.order_date as order_date_1,
        o2.order_date as order_date_2,
        abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) as minutes_difference
    from "dbt_db_ex2"."public"."stg_orders" o1
    join "dbt_db_ex2"."public"."stg_orders" o2
        on o1.customer_id = o2.customer_id
        and o1.order_id <> o2.order_id
        and abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) < 15  -- Orders less than 15 minutes apart
)

select * from potential_duplicates
  );
  
    
[0m12:47:30.549438 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:47:30.549824 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m12:47:30.550506 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:47:30.551133 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:47:30.551414 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:47:30.551782 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:47:30.552116 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m12:47:30.552389 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m12:47:30.553302 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:47:30.553950 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:47:30.554234 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:30.554493 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:30.554730 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:47:30.554940 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.009 seconds
[0m12:47:30.557588 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:47:30.557987 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:47:30.558236 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m12:47:30.558946 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:47:30.559618 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:47:30.559883 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m12:47:30.560239 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:47:30.560499 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m12:47:30.560779 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:47:30.561081 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m12:47:30.561391 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.561654 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:47:30.561900 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.562143 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m12:47:30.562382 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m12:47:30.562633 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:47:30.563084 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:47:30.563352 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m12:47:30.563627 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m12:47:30.563886 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.564291 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:47:30.567297 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m12:47:30.567593 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:47:30.567842 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m12:47:30.568172 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m12:47:30.568432 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m12:47:30.569281 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m12:47:30.569635 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:47:30.570014 [info ] [Thread-2  ]: 2 of 25 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.12s]
[0m12:47:30.570294 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.570541 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m12:47:30.570770 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m12:47:30.571145 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:47:30.571435 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:47:30.571849 [info ] [Thread-1  ]: 1 of 25 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.12s]
[0m12:47:30.572619 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:47:30.572940 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
    
      
    ) dbt_internal_test
[0m12:47:30.573213 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.573541 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:47:30.573803 [info ] [Thread-2  ]: 5 of 25 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m12:47:30.574112 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:47:30.574386 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:47:30.574660 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.574937 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:47:30.575187 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
    
      
    ) dbt_internal_test
[0m12:47:30.575433 [info ] [Thread-1  ]: 6 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m12:47:30.576353 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: ROLLBACK
[0m12:47:30.576596 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:47:30.576894 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:47:30.583431 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: Close
[0m12:47:30.589662 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:47:30.589945 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:47:30.590215 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.013 seconds
[0m12:47:30.590624 [info ] [Thread-4  ]: 4 of 25 PASS assert_total_amount_equals_sum_of_items ........................... [[32mPASS[0m in 0.14s]
[0m12:47:30.596228 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:47:30.597253 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: ROLLBACK
[0m12:47:30.597612 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:47:30.597929 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:47:30.598232 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:47:30.602837 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m12:47:30.603109 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: Close
[0m12:47:30.603363 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:47:30.603595 [info ] [Thread-4  ]: 7 of 25 START test not_null_dim_customers_email ................................ [RUN]
[0m12:47:30.604009 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:47:30.609592 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:47:30.610272 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:47:30.610041 [error] [Thread-3  ]: 3 of 25 FAIL 2 assert_no_duplicate_orders ...................................... [[31mFAIL 2[0m in 0.16s]
[0m12:47:30.610600 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3" cascade
[0m12:47:30.610991 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:47:30.611222 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:47:30.611550 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:47:30.611783 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:30.612019 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m12:47:30.615297 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:47:30.615628 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:47:30.615982 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:30.616305 [info ] [Thread-3  ]: 8 of 25 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m12:47:30.616728 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:47:30.617050 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:47:30.622076 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:47:30.622410 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:47:30.622823 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:47:30.660591 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:47:30.660987 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m12:47:30.661297 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.045 seconds
[0m12:47:30.661645 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:47:30.662359 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m12:47:30.662719 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.051 seconds
[0m12:47:30.662966 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:47:30.663542 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:47:30.664221 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m12:47:30.669172 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:47:30.669527 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:47:30.670080 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:47:30.670478 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:47:30.670758 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.009 seconds
[0m12:47:30.671198 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.671473 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:47:30.671788 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m12:47:30.672542 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m12:47:30.672821 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:47:30.673103 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:47:30.673911 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:47:30.674216 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.674448 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m12:47:30.674799 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:47:30.675054 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:47:30.675407 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
  
  
    as
  
  (
    




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(email, '^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$', '')), 1), 0)


 > 0
 as expression


    from "dbt_db_ex2"."public"."dim_customers"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  );
  
    
[0m12:47:30.678517 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m12:47:30.680786 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:47:30.681184 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where email is null



  );
  
    
[0m12:47:30.682689 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:47:30.683491 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:47:30.683823 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:47:30.684079 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m12:47:30.686512 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:30.687019 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:47:30.687506 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.012 seconds
[0m12:47:30.688183 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:47:30.688458 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:47:30.688715 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:47:30.689344 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:47:30.689764 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m12:47:30.690031 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.017 seconds
[0m12:47:30.690311 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:47:30.690606 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:47:30.691315 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m12:47:30.691593 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m12:47:30.691855 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m12:47:30.692354 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:47:30.692614 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:30.692896 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:47:30.693166 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.693564 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:47:30.693861 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:47:30.694126 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.694388 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:30.694656 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
    
      
    ) dbt_internal_test
[0m12:47:30.694933 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:47:30.695322 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:47:30.695583 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:47:30.695847 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m12:47:30.696137 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m12:47:30.696448 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.696705 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.697703 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: ROLLBACK
[0m12:47:30.698042 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:47:30.698451 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:47:30.698974 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:47:30.699286 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: Close
[0m12:47:30.699546 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m12:47:30.699817 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.700306 [info ] [Thread-2  ]: 5 of 25 PASS dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[32mPASS[0m in 0.13s]
[0m12:47:30.701850 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m12:47:30.702270 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m12:47:30.702737 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:47:30.702982 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.007 seconds
[0m12:47:30.703281 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:47:30.703518 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m12:47:30.703788 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:47:30.704439 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:47:30.704684 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:47:30.704970 [info ] [Thread-2  ]: 9 of 25 START test not_null_dim_customers_name ................................. [RUN]
[0m12:47:30.705588 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:47:30.705296 [info ] [Thread-1  ]: 6 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.13s]
[0m12:47:30.705975 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:47:30.706250 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m12:47:30.706632 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:47:30.706884 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.707109 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:47:30.707415 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:47:30.708410 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m12:47:30.712187 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:47:30.712524 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m12:47:30.712817 [info ] [Thread-1  ]: 10 of 25 START test not_null_dim_products_name ................................. [RUN]
[0m12:47:30.713335 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:47:30.713588 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: Close
[0m12:47:30.713896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:47:30.714339 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:47:30.715154 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:47:30.714926 [info ] [Thread-4  ]: 7 of 25 PASS not_null_dim_customers_email ...................................... [[32mPASS[0m in 0.10s]
[0m12:47:30.720658 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:47:30.720985 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:47:30.724237 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:47:30.724650 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:47:30.725214 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:47:30.725792 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m12:47:30.726184 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:47:30.726433 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m12:47:30.727061 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:30.726833 [info ] [Thread-4  ]: 11 of 25 START test not_null_dim_products_price ................................ [RUN]
[0m12:47:30.727541 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:47:30.727784 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:47:30.728035 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:47:30.731742 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:47:30.732045 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m12:47:30.737336 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:47:30.737748 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:47:30.738541 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:47:30.738890 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m12:47:30.739203 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m12:47:30.739435 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.012 seconds
[0m12:47:30.739646 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:47:30.739899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:30.740608 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m12:47:30.740862 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.745171 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:47:30.745782 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:47:30.746769 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m12:47:30.747220 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:47:30.747499 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:47:30.747810 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m12:47:30.748090 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m12:47:30.748371 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:47:30.748696 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.749159 [info ] [Thread-3  ]: 8 of 25 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.13s]
[0m12:47:30.749543 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:47:30.749888 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:47:30.750240 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where name is null



  );
  
    
[0m12:47:30.750525 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:47:30.750973 [info ] [Thread-3  ]: 12 of 25 START test not_null_dim_products_product_id ........................... [RUN]
[0m12:47:30.751679 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:47:30.751991 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:47:30.756144 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:47:30.756490 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:47:30.757243 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:47:30.757508 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.018 seconds
[0m12:47:30.757780 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:47:30.758507 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m12:47:30.758781 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:47:30.759007 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m12:47:30.759247 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:47:30.759713 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:47:30.760332 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m12:47:30.765263 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:47:30.765568 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m12:47:30.765830 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:47:30.766326 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:47:30.766683 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:47:30.767130 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:47:30.767401 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:47:30.767663 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m12:47:30.767933 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.768275 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:47:30.768551 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.768808 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:47:30.769181 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:47:30.769404 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:47:30.769655 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where name is null



  );
  
    
[0m12:47:30.769920 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m12:47:30.770169 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where price is null



  );
  
    
[0m12:47:30.770797 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.771066 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:47:30.771301 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m12:47:30.772217 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.773273 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m12:47:30.773883 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: Close
[0m12:47:30.774329 [info ] [Thread-2  ]: 9 of 25 PASS not_null_dim_customers_name ....................................... [[32mPASS[0m in 0.07s]
[0m12:47:30.774719 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:47:30.774996 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:47:30.775251 [info ] [Thread-2  ]: 13 of 25 START test not_null_dim_products_total_quantity_sold .................. [RUN]
[0m12:47:30.775562 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:47:30.775807 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:47:30.779485 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:47:30.779909 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.009 seconds
[0m12:47:30.780268 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.010 seconds
[0m12:47:30.781413 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:47:30.782071 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:47:30.782352 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:47:30.782623 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:47:30.782885 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:47:30.783147 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:47:30.783814 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m12:47:30.784062 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m12:47:30.789329 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:47:30.789603 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m12:47:30.790082 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:47:30.790486 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:47:30.790770 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:47:30.791028 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold" cascade
[0m12:47:30.791330 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:30.791926 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.792339 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:47:30.792767 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where product_id is null



  );
  
    
[0m12:47:30.794298 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m12:47:30.794785 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:47:30.795048 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m12:47:30.795512 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:47:30.795910 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:47:30.796150 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m12:47:30.796463 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:47:30.796712 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m12:47:30.796978 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.797226 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:47:30.797463 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m12:47:30.797710 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.797948 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:47:30.798185 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:47:30.798844 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:47:30.799101 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.799357 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m12:47:30.799649 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:47:30.800866 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m12:47:30.801316 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m12:47:30.801552 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:47:30.801794 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.802642 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m12:47:30.802895 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: Close
[0m12:47:30.803756 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m12:47:30.804268 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:47:30.804501 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:30.804893 [info ] [Thread-4  ]: 11 of 25 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.08s]
[0m12:47:30.805441 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:47:30.805909 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:47:30.806166 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: Close
[0m12:47:30.806503 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:47:30.806900 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:47:30.807733 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.808021 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:47:30.807167 [info ] [Thread-4  ]: 14 of 25 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m12:47:30.808444 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:47:30.807495 [info ] [Thread-1  ]: 10 of 25 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.09s]
[0m12:47:30.808800 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_quantity_sold is null



  );
  
    
[0m12:47:30.809116 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:47:30.809369 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m12:47:30.809726 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:47:30.810009 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:47:30.810307 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:47:30.814727 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:47:30.815109 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m12:47:30.815375 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:47:30.815659 [info ] [Thread-1  ]: 15 of 25 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m12:47:30.816018 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:47:30.816696 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:47:30.817002 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:47:30.817257 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:47:30.817483 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:47:30.817759 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:47:30.818024 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:47:30.823053 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:47:30.823430 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m12:47:30.827787 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:47:30.828115 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.005 seconds
[0m12:47:30.831821 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:47:30.834071 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m12:47:30.834374 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue" cascade
[0m12:47:30.834796 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:47:30.835066 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:47:30.840626 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: Close
[0m12:47:30.841154 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:47:30.841426 [debug] [Thread-2  ]: SQL status: COMMIT in 0.009 seconds
[0m12:47:30.842024 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:47:30.842445 [info ] [Thread-3  ]: 12 of 25 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m12:47:30.842977 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:47:30.843245 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m12:47:30.843618 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:47:30.843983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:30.844624 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:47:30.845090 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:47:30.845367 [info ] [Thread-3  ]: 16 of 25 START test not_null_fct_orders_order_date ............................. [RUN]
[0m12:47:30.845680 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m12:47:30.846015 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:47:30.846359 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:47:30.850029 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:47:30.850352 [debug] [Thread-2  ]: SQL status: BEGIN in 0.004 seconds
[0m12:47:30.850702 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:47:30.851027 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
    
      
    ) dbt_internal_test
[0m12:47:30.851560 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:47:30.856776 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:47:30.857183 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:47:30.857432 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m12:47:30.857673 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:47:30.857894 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.023 seconds
[0m12:47:30.858111 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.007 seconds
[0m12:47:30.858343 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:47:30.859152 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m12:47:30.859862 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m12:47:30.860764 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: ROLLBACK
[0m12:47:30.861372 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:47:30.861838 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:47:30.862440 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:47:30.862760 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:47:30.863000 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: Close
[0m12:47:30.863849 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.863631 [info ] [Thread-2  ]: 13 of 25 PASS not_null_dim_products_total_quantity_sold ........................ [[32mPASS[0m in 0.09s]
[0m12:47:30.864171 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.864411 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:47:30.864932 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:47:30.865189 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:47:30.865438 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m12:47:30.865711 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:47:30.865992 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_revenue is null



  );
  
    
[0m12:47:30.866276 [info ] [Thread-2  ]: 17 of 25 START test not_null_fct_orders_order_id ............................... [RUN]
[0m12:47:30.866627 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:47:30.866871 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:47:30.870583 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:47:30.871287 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:47:30.876115 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:47:30.876430 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.018 seconds
[0m12:47:30.876678 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.010 seconds
[0m12:47:30.877557 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:47:30.877798 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.012 seconds
[0m12:47:30.878468 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m12:47:30.879048 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:47:30.879298 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m12:47:30.879854 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:47:30.880299 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:47:30.880545 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:47:30.880796 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:30.881053 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:47:30.881286 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:47:30.881512 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m12:47:30.881825 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m12:47:30.882556 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.882806 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:47:30.883050 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_date is null



  );
  
    
[0m12:47:30.886548 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m12:47:30.886886 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m12:47:30.887347 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:47:30.887753 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:47:30.888414 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:47:30.888691 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:47:30.888931 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m12:47:30.889168 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:47:30.889415 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m12:47:30.890115 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:47:30.890371 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.890631 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:47:30.890868 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.891101 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:47:30.891312 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:47:30.891573 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m12:47:30.891833 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:47:30.892644 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m12:47:30.892922 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
    
      
    ) dbt_internal_test
[0m12:47:30.893222 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m12:47:30.893728 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:47:30.894037 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:47:30.894667 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.894972 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.895206 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.895424 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:30.896372 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m12:47:30.897147 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m12:47:30.897381 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:47:30.897786 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:47:30.898094 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_id is null



  );
  
    
[0m12:47:30.898334 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m12:47:30.898598 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m12:47:30.899180 [info ] [Thread-1  ]: 15 of 25 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.08s]
[0m12:47:30.899595 [info ] [Thread-4  ]: 14 of 25 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.09s]
[0m12:47:30.899989 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:47:30.900394 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:47:30.900751 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:47:30.901080 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:47:30.901395 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:47:30.901689 [info ] [Thread-1  ]: 18 of 25 START test not_null_fct_orders_status ................................. [RUN]
[0m12:47:30.901973 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m12:47:30.902222 [info ] [Thread-4  ]: 19 of 25 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m12:47:30.902560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:47:30.902874 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:47:30.903149 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.903383 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:47:30.903634 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:47:30.903855 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:47:30.904087 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:47:30.907861 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:47:30.908519 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:47:30.911744 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:47:30.912089 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m12:47:30.912429 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:47:30.912776 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m12:47:30.913163 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:47:30.913410 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:47:30.917958 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:47:30.918229 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.005 seconds
[0m12:47:30.918446 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m12:47:30.923297 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:47:30.923697 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:47:30.924629 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m12:47:30.925024 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:47:30.925472 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:47:30.925739 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m12:47:30.926103 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m12:47:30.926356 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: Close
[0m12:47:30.926584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:30.926812 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:47:30.927457 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:47:30.927216 [info ] [Thread-3  ]: 16 of 25 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.08s]
[0m12:47:30.927915 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m12:47:30.928271 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:47:30.928631 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:47:30.929143 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.929394 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:47:30.929635 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:47:30.928894 [info ] [Thread-3  ]: 20 of 25 START test not_null_fct_orders_total_items ............................ [RUN]
[0m12:47:30.930035 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:47:30.930279 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:47:30.933823 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:47:30.934128 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:47:30.935160 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m12:47:30.935651 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:47:30.935902 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m12:47:30.941416 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:47:30.941720 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:47:30.941948 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.015 seconds
[0m12:47:30.942369 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:47:30.943473 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m12:47:30.942789 [info ] [Thread-2  ]: 17 of 25 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m12:47:30.944266 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m12:47:30.944551 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items" cascade
[0m12:47:30.945074 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:47:30.945424 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:47:30.945874 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:47:30.946101 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:47:30.946337 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:47:30.946604 [debug] [Thread-2  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:47:30.946871 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:47:30.947276 [info ] [Thread-2  ]: 21 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m12:47:30.947666 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:47:30.947952 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.948190 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:47:30.948418 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.948653 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:47:30.955929 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:47:30.956372 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:47:30.956878 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where status is null



  );
  
    
[0m12:47:30.957346 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m12:47:30.957799 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:47:30.963010 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:47:30.963448 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:47:30.963713 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:47:30.963958 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:47:30.964200 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m12:47:30.964425 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.018 seconds
[0m12:47:30.965695 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:47:30.966404 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:47:30.966688 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:30.967356 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m12:47:30.967684 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:47:30.967929 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:47:30.968471 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:47:30.968709 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m12:47:30.968964 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m12:47:30.969206 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:47:30.969879 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:30.970129 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:47:30.970363 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_items is null



  );
  
    
[0m12:47:30.971978 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:47:30.972458 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:47:30.972933 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:47:30.973176 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m12:47:30.973431 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m12:47:30.973889 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:47:30.974140 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.974448 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:47:30.974689 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m12:47:30.975062 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:47:30.975288 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m12:47:30.975640 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m12:47:30.975879 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.976096 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.976738 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:47:30.976996 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:47:30.977906 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: ROLLBACK
[0m12:47:30.978219 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:47:30.978480 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:47:30.979186 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m12:47:30.979476 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m12:47:30.979744 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m12:47:30.979993 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: Close
[0m12:47:30.980459 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:47:30.980900 [info ] [Thread-1  ]: 18 of 25 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.08s]
[0m12:47:30.981181 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:47:30.981723 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:47:30.982063 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:30.982516 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:47:30.983198 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.984248 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m12:47:30.984520 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m12:47:30.984772 [info ] [Thread-1  ]: 22 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m12:47:30.985040 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:47:30.985483 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:47:30.985719 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m12:47:30.985970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:47:30.986231 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex2"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex2"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m12:47:30.986653 [info ] [Thread-4  ]: 19 of 25 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.08s]
[0m12:47:30.986933 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:47:30.987308 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:47:30.987622 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:47:30.993308 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:47:30.994157 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:47:30.994490 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:47:30.994798 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m12:47:30.995456 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:47:30.995781 [info ] [Thread-4  ]: 23 of 25 START test unique_dim_customers_email ................................. [RUN]
[0m12:47:30.996128 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:47:30.996463 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:47:30.996706 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:30.996945 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:47:30.997180 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m12:47:30.997405 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:47:30.997628 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:47:31.002009 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:47:31.005317 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:47:31.005690 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m12:47:31.005943 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
    
      
    ) dbt_internal_test
[0m12:47:31.006375 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:47:31.006813 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:47:31.007126 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m12:47:31.007463 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:31.008091 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:47:31.008399 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m12:47:31.008673 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:47:31.009701 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: ROLLBACK
[0m12:47:31.009986 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:31.010228 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:47:31.010494 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:47:31.010756 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: Close
[0m12:47:31.054640 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:47:31.054950 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m12:47:31.055189 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.048 seconds
[0m12:47:31.055598 [info ] [Thread-3  ]: 20 of 25 PASS not_null_fct_orders_total_items .................................. [[32mPASS[0m in 0.13s]
[0m12:47:31.056018 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:47:31.056787 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m12:47:31.057194 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:47:31.057491 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:31.057835 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m12:47:31.058389 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:47:31.058671 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:47:31.059587 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m12:47:31.059837 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:47:31.060061 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:47:31.060291 [info ] [Thread-3  ]: 24 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m12:47:31.060759 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:47:31.061011 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:47:31.064575 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:47:31.064948 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m12:47:31.065225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m12:47:31.065472 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:47:31.065861 [info ] [Thread-2  ]: 21 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.12s]
[0m12:47:31.066183 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m12:47:31.066593 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:47:31.066926 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:47:31.067219 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:47:31.072195 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:47:31.072536 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:47:31.072844 [info ] [Thread-2  ]: 25 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m12:47:31.073303 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:47:31.073966 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:47:31.074188 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.014 seconds
[0m12:47:31.074476 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:47:31.074739 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m12:47:31.074980 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:47:31.075578 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m12:47:31.075817 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:47:31.076032 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:47:31.076247 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m12:47:31.076744 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:47:31.080460 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:47:31.080878 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:47:31.081380 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:47:31.086153 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:47:31.086467 [debug] [Thread-4  ]: SQL status: BEGIN in 0.005 seconds
[0m12:47:31.086767 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m12:47:31.087138 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:47:31.087391 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:47:31.087820 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:47:31.088098 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m12:47:31.088372 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m12:47:31.088626 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.013 seconds
[0m12:47:31.088884 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:47:31.089602 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m12:47:31.090198 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:47:31.090500 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:47:31.090760 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:47:31.091081 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m12:47:31.091478 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:31.091804 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:31.092048 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:47:31.092319 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:47:31.092577 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m12:47:31.092840 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m12:47:31.093759 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:31.094733 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m12:47:31.095000 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m12:47:31.095644 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:47:31.095907 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m12:47:31.096140 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.003 seconds
[0m12:47:31.096382 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:47:31.097017 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:47:31.097421 [info ] [Thread-1  ]: 22 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.11s]
[0m12:47:31.097767 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m12:47:31.098090 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:47:31.098598 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:47:31.098926 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m12:47:31.099261 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.010 seconds
[0m12:47:31.100099 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m12:47:31.100628 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:47:31.100886 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m12:47:31.101125 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:47:31.101397 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m12:47:31.101789 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:47:31.102223 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:47:31.102475 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:31.102803 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:47:31.103126 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m12:47:31.103410 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:47:31.103657 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:47:31.103917 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m12:47:31.104158 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m12:47:31.104826 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:31.105062 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m12:47:31.105285 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:47:31.105525 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:47:31.105768 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m12:47:31.106022 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m12:47:31.106356 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.002 seconds
[0m12:47:31.106993 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:47:31.107235 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:47:31.107474 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:31.107688 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:31.107915 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m12:47:31.108776 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m12:47:31.109577 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m12:47:31.110157 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: Close
[0m12:47:31.110395 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: Close
[0m12:47:31.111267 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m12:47:31.112173 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:47:31.110828 [info ] [Thread-4  ]: 23 of 25 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.11s]
[0m12:47:31.111749 [info ] [Thread-3  ]: 24 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.05s]
[0m12:47:31.112888 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:47:31.113261 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:47:31.113712 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:47:31.113960 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m12:47:31.114519 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m12:47:31.114765 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:47:31.115005 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m12:47:31.115817 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:47:31.116744 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m12:47:31.117176 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m12:47:31.117561 [info ] [Thread-2  ]: 25 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m12:47:31.117919 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:47:31.118675 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:31.118902 [debug] [MainThread]: On master: BEGIN
[0m12:47:31.119092 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:31.126286 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:47:31.126637 [debug] [MainThread]: On master: COMMIT
[0m12:47:31.126845 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:31.127030 [debug] [MainThread]: On master: COMMIT
[0m12:47:31.127612 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:47:31.127847 [debug] [MainThread]: On master: Close
[0m12:47:31.128142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:31.128332 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m12:47:31.128511 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m12:47:31.128686 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m12:47:31.128855 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m12:47:31.129110 [info ] [MainThread]: 
[0m12:47:31.129383 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m12:47:31.131542 [debug] [MainThread]: Command end result
[0m12:47:31.176368 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:47:31.179056 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:47:31.186305 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:47:31.186656 [info ] [MainThread]: 
[0m12:47:31.186914 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:47:31.187118 [info ] [MainThread]: 
[0m12:47:31.187354 [error] [MainThread]: [31mFailure in test assert_no_duplicate_orders (tests/assert_no_duplicate_orders.sql)[0m
[0m12:47:31.187577 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m12:47:31.187752 [info ] [MainThread]: 
[0m12:47:31.187957 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/tests/assert_no_duplicate_orders.sql
[0m12:47:31.188141 [info ] [MainThread]: 
[0m12:47:31.188364 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  --------------------------------------------------------------------------------
[0m12:47:31.188578 [info ] [MainThread]: 
[0m12:47:31.188783 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=1 SKIP=0 TOTAL=25
[0m12:47:31.189839 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.5427407, "process_in_blocks": "0", "process_kernel_time": 0.225424, "process_mem_max_rss": "132808704", "process_out_blocks": "0", "process_user_time": 2.299331}
[0m12:47:31.190084 [debug] [MainThread]: Command `dbt test` failed at 12:47:31.190039 after 1.54 seconds
[0m12:47:31.190317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058497f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f8c40>]}
[0m12:47:31.190554 [debug] [MainThread]: Flushing usage events
[0m12:47:32.191889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:33.283543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10330e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104177250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104177070>]}


============================== 12:47:33.286139 | e076e010-6710-454a-b2e4-42fea46b3ee8 ==============================
[0m12:47:33.286139 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:47:33.286636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:47:33.411703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e076e010-6710-454a-b2e4-42fea46b3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b25b0>]}
[0m12:47:33.458508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e076e010-6710-454a-b2e4-42fea46b3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c1e610>]}
[0m12:47:33.459127 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:33.544868 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:47:33.664043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:33.664368 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:33.669681 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m12:47:33.736805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e076e010-6710-454a-b2e4-42fea46b3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107981e80>]}
[0m12:47:33.747035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e076e010-6710-454a-b2e4-42fea46b3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769aa30>]}
[0m12:47:33.747406 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m12:47:33.747707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e076e010-6710-454a-b2e4-42fea46b3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769a9d0>]}
[0m12:47:33.749256 [info ] [MainThread]: 
[0m12:47:33.749499 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:47:33.749697 [info ] [MainThread]: 
[0m12:47:33.749997 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:33.754632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m12:47:33.764974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m12:47:33.787406 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:47:33.787732 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:47:33.787947 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m12:47:33.788146 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m12:47:33.788338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:33.788515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:33.807809 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m12:47:33.808282 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m12:47:33.808546 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m12:47:33.808893 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m12:47:33.809094 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m12:47:33.809301 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:33.812325 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.003 seconds
[0m12:47:33.812635 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m12:47:33.814621 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m12:47:33.815838 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m12:47:33.816568 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m12:47:33.816802 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m12:47:33.828992 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:33.829299 [debug] [MainThread]: On master: BEGIN
[0m12:47:33.829495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:33.849156 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m12:47:33.849510 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:33.849782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:33.891666 [debug] [MainThread]: SQL status: SELECT 4 in 0.042 seconds
[0m12:47:33.893117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e076e010-6710-454a-b2e4-42fea46b3ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101bd5cd0>]}
[0m12:47:33.893435 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:33.893987 [debug] [MainThread]: On master: Close
[0m12:47:33.895459 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m12:47:33.895784 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m12:47:33.896014 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m12:47:33.896376 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_customers)
[0m12:47:33.896602 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m12:47:33.896861 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_order_items)
[0m12:47:33.897146 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m12:47:33.897372 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m12:47:33.897651 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m12:47:33.897876 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m12:47:33.898084 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m12:47:33.904909 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m12:47:33.905352 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m12:47:33.908527 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m12:47:33.911497 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m12:47:33.915618 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m12:47:33.916301 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m12:47:33.916783 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m12:47:33.917144 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m12:47:33.917621 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m12:47:33.917893 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m12:47:33.918327 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m12:47:33.918682 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m12:47:33.919187 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m12:47:33.919460 [debug] [Thread-2  ]: Began running node model.ecommerce_test.dim_customers
[0m12:47:33.919729 [debug] [Thread-4  ]: Began running node model.ecommerce_test.fct_orders
[0m12:47:33.919990 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:47:33.920332 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.dim_customers)
[0m12:47:33.920729 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.fct_orders)
[0m12:47:33.921007 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now test.ecommerce_test.assert_no_duplicate_orders)
[0m12:47:33.921284 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_products
[0m12:47:33.921559 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.dim_customers
[0m12:47:33.921809 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.fct_orders
[0m12:47:33.922053 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m12:47:33.922322 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.dim_products)
[0m12:47:33.925783 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m12:47:33.929582 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m12:47:33.933160 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m12:47:33.933523 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_products
[0m12:47:33.937782 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m12:47:33.938289 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.dim_customers
[0m12:47:33.938553 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m12:47:33.938941 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.fct_orders
[0m12:47:33.939478 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.dim_customers
[0m12:47:33.939940 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m12:47:33.940181 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_products
[0m12:47:33.940612 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.fct_orders
[0m12:47:33.941276 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_products
[0m12:47:33.941537 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:47:33.941772 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:47:33.942000 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:47:33.942306 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:47:33.942724 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_customers, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m12:47:33.943044 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m12:47:33.943425 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.fct_orders, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m12:47:33.943699 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_products, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m12:47:33.943965 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:47:33.944204 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:47:33.944437 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:47:33.944692 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:47:33.965814 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m12:47:33.966244 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m12:47:33.970001 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m12:47:33.974497 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m12:47:33.975171 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:47:33.975671 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m12:47:33.975943 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:47:33.976215 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m12:47:33.976460 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:47:33.980212 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m12:47:33.980817 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:47:33.981108 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:47:33.981362 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:47:33.981837 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m12:47:33.982284 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m12:47:33.982698 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m12:47:33.982940 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:47:33.983188 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:47:33.983493 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:47:33.983782 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:47:33.984232 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m12:47:33.984503 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m12:47:33.984779 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m12:47:33.985048 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m12:47:33.985318 [debug] [Thread-2  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:47:33.985611 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:47:33.985855 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:47:33.986115 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:47:33.986389 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.assert_total_amount_equals_sum_of_items)
[0m12:47:33.995564 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m12:47:33.991529 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m12:47:34.003971 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m12:47:34.004344 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:47:34.008382 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m12:47:34.009274 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:47:34.009826 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m12:47:34.010131 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:47:34.010543 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:47:34.010847 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:47:34.011350 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m12:47:34.011646 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:47:34.012100 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m12:47:34.012375 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m12:47:34.012662 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:47:34.013116 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m12:47:34.013397 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:47:34.013658 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:47:34.013934 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_email.0472f7c2e8, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m12:47:34.014200 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:47:34.014588 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m12:47:34.018309 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m12:47:34.018643 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:47:34.019015 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m12:47:34.019390 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:47:34.023217 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m12:47:34.023635 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:47:34.027377 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m12:47:34.032017 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m12:47:34.032564 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:47:34.032848 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:47:34.033534 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m12:47:34.033929 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:47:34.034164 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:47:34.034568 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m12:47:34.034838 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:47:34.035318 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m12:47:34.036017 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m12:47:34.036279 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:47:34.036584 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m12:47:34.036867 [debug] [Thread-2  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:47:34.037164 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:47:34.037469 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m12:47:34.037735 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:47:34.038004 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m12:47:34.038280 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m12:47:34.038537 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:47:34.042343 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m12:47:34.042818 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:47:34.043098 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:47:34.047234 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m12:47:34.057189 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m12:47:34.058373 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m12:47:34.059236 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:47:34.059785 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m12:47:34.060073 [debug] [Thread-3  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:47:34.060545 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:47:34.060800 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:47:34.061095 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m12:47:34.061335 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:47:34.061771 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m12:47:34.062181 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m12:47:34.062427 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:47:34.062825 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m12:47:34.063080 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:47:34.063363 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:47:34.068695 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m12:47:34.069085 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:47:34.069436 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m12:47:34.069706 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m12:47:34.070013 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m12:47:34.070274 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:47:34.070527 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:47:34.070822 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:47:34.071204 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:47:34.075083 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m12:47:34.079112 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m12:47:34.083659 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m12:47:34.084226 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m12:47:34.084770 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:47:34.085133 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m12:47:34.085686 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:47:34.089732 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m12:47:34.090085 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:47:34.090374 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:47:34.090958 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m12:47:34.091397 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m12:47:34.091625 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:47:34.091907 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:47:34.092224 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:47:34.092485 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:47:34.092918 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m12:47:34.093195 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m12:47:34.093461 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m12:47:34.093865 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m12:47:34.094142 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:47:34.094403 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:47:34.098086 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m12:47:34.102383 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m12:47:34.103104 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:47:34.103395 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:47:34.103931 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m12:47:34.104361 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m12:47:34.105163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:34.105405 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m12:47:34.105595 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m12:47:34.105776 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a' was properly closed.
[0m12:47:34.105956 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a' was properly closed.
[0m12:47:34.108638 [debug] [MainThread]: Command end result
[0m12:47:34.237439 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:47:34.239992 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:47:34.245321 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m12:47:34.247585 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:47:34.247864 [info ] [MainThread]: Building catalog
[0m12:47:34.258273 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db_ex2.information_schema'
[0m12:47:34.264850 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:47:34.265159 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: BEGIN
[0m12:47:34.265342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:34.280405 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m12:47:34.280745 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m12:47:34.281135 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "dbt_db_ex2.information_schema"} */

    
    

    select
        'dbt_db_ex2' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_customer_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_lifetime_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_quantity_sold')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_product_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_date')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_revenue')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_no_duplicate_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_total_amount_equals_sum_of_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_fct_orders_order_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_amount')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_price')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:47:34.287335 [debug] [ThreadPool]: SQL status: SELECT 214 in 0.006 seconds
[0m12:47:34.298126 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: ROLLBACK
[0m12:47:34.298728 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: Close
[0m12:47:34.314905 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:47:34.354990 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m12:47:34.356486 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m12:47:34.356793 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m12:47:34.358413 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1259984, "process_in_blocks": "0", "process_kernel_time": 0.157697, "process_mem_max_rss": "129220608", "process_out_blocks": "0", "process_user_time": 1.728403}
[0m12:47:34.358776 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:47:34.358719 after 1.13 seconds
[0m12:47:34.359001 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:47:34.359183 [debug] [MainThread]: Connection 'dbt_db_ex2.information_schema' was properly closed.
[0m12:47:34.359395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10330e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102757760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc0b20>]}
[0m12:47:34.359649 [debug] [MainThread]: Flushing usage events
[0m12:47:35.573761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:06:38.766300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10683baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10683bcd0>]}


============================== 13:06:38.769659 | 1d492d44-21ba-409c-82bf-ac66aacf2023 ==============================
[0m13:06:38.769659 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:06:38.770052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:06:38.877067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d492d44-21ba-409c-82bf-ac66aacf2023', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068357c0>]}
[0m13:06:38.929433 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-icoy6qyg'
[0m13:06:38.929770 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:06:39.033853 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:06:39.035115 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:06:39.054838 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:06:39.058801 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:06:39.078705 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:06:39.080859 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m13:06:39.081363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1d492d44-21ba-409c-82bf-ac66aacf2023', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a04340>]}
[0m13:06:39.083923 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:06:39.166479 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:06:39.169463 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:06:40.078718 [info ] [MainThread]: Installed from version 1.1.1
[0m13:06:40.079256 [info ] [MainThread]: Updated version available: 1.3.0
[0m13:06:40.079626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1d492d44-21ba-409c-82bf-ac66aacf2023', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b24970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a04760>]}
[0m13:06:40.080331 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m13:06:41.621594 [info ] [MainThread]: Installed from version 0.10.0
[0m13:06:41.621965 [info ] [MainThread]: Updated version available: 0.10.4
[0m13:06:41.622227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1d492d44-21ba-409c-82bf-ac66aacf2023', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a043a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a04d00>]}
[0m13:06:41.622513 [info ] [MainThread]: Installing calogica/dbt_date
[0m13:06:42.079118 [info ] [MainThread]: Installed from version 0.10.0
[0m13:06:42.079507 [info ] [MainThread]: Updated version available: 0.10.1
[0m13:06:42.079783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1d492d44-21ba-409c-82bf-ac66aacf2023', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a041c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a04d60>]}
[0m13:06:42.080089 [info ] [MainThread]: 
[0m13:06:42.080326 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m13:06:42.082570 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.3676965, "process_in_blocks": "0", "process_kernel_time": 0.280269, "process_mem_max_rss": "106627072", "process_out_blocks": "0", "process_user_time": 1.167496}
[0m13:06:42.083103 [debug] [MainThread]: Command `dbt deps` succeeded at 13:06:42.083009 after 3.37 seconds
[0m13:06:42.083457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041dd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c53e20>]}
[0m13:06:42.083747 [debug] [MainThread]: Flushing usage events
[0m13:06:44.973452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:06:46.436838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f83790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2abb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2ad90>]}


============================== 13:06:46.440284 | 9b237e0c-307e-4749-bdbc-e468307a5c8a ==============================
[0m13:06:46.440284 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:06:46.440685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:06:46.454358 [info ] [MainThread]: dbt version: 1.9.4
[0m13:06:46.454673 [info ] [MainThread]: python version: 3.9.6
[0m13:06:46.454873 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m13:06:46.455067 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m13:06:46.509127 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m13:06:46.509470 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m13:06:46.509677 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/dbt_project.yml
[0m13:06:46.510222 [info ] [MainThread]: adapter type: postgres
[0m13:06:46.510470 [info ] [MainThread]: adapter version: 1.9.0
[0m13:06:46.598752 [info ] [MainThread]: Configuration:
[0m13:06:46.599137 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:06:46.599381 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:06:46.599583 [info ] [MainThread]: Required dependencies:
[0m13:06:46.599865 [debug] [MainThread]: Executing "git --help"
[0m13:06:46.617085 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:06:46.617677 [debug] [MainThread]: STDERR: "b''"
[0m13:06:46.617925 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:06:46.618164 [info ] [MainThread]: Connection:
[0m13:06:46.618408 [info ] [MainThread]:   host: localhost
[0m13:06:46.618590 [info ] [MainThread]:   port: 5433
[0m13:06:46.618767 [info ] [MainThread]:   user: dbt_user
[0m13:06:46.618942 [info ] [MainThread]:   database: dbt_db_ex2
[0m13:06:46.619114 [info ] [MainThread]:   schema: public
[0m13:06:46.619288 [info ] [MainThread]:   connect_timeout: 10
[0m13:06:46.619459 [info ] [MainThread]:   role: None
[0m13:06:46.619628 [info ] [MainThread]:   search_path: None
[0m13:06:46.619801 [info ] [MainThread]:   keepalives_idle: 0
[0m13:06:46.620017 [info ] [MainThread]:   sslmode: None
[0m13:06:46.620427 [info ] [MainThread]:   sslcert: None
[0m13:06:46.620751 [info ] [MainThread]:   sslkey: None
[0m13:06:46.620990 [info ] [MainThread]:   sslrootcert: None
[0m13:06:46.621185 [info ] [MainThread]:   application_name: dbt
[0m13:06:46.621373 [info ] [MainThread]:   retries: 1
[0m13:06:46.621849 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:06:46.696813 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:06:46.729093 [debug] [MainThread]: Using postgres connection "debug"
[0m13:06:46.729416 [debug] [MainThread]: On debug: select 1 as id
[0m13:06:46.729629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:46.833541 [debug] [MainThread]: SQL status: SELECT 1 in 0.104 seconds
[0m13:06:46.834245 [debug] [MainThread]: On debug: Close
[0m13:06:46.834499 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:06:46.834737 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:06:46.835841 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.45876628, "process_in_blocks": "0", "process_kernel_time": 0.17639, "process_mem_max_rss": "115081216", "process_out_blocks": "0", "process_user_time": 1.150565}
[0m13:06:46.836162 [debug] [MainThread]: Command `dbt debug` succeeded at 13:06:46.836094 after 0.46 seconds
[0m13:06:46.836381 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:06:46.836611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f83790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11002e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d61160>]}
[0m13:06:46.836901 [debug] [MainThread]: Flushing usage events
[0m13:06:47.867724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:06:48.935575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106286ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106286e80>]}


============================== 13:06:48.938228 | 0ae38369-be26-44d6-8cee-1d271592bd76 ==============================
[0m13:06:48.938228 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:06:48.938615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:06:49.067482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b0ac0>]}
[0m13:06:49.115352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c7880>]}
[0m13:06:49.116048 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:06:49.204294 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:06:49.343650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:06:49.343962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:06:49.349236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:06:49.413551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107072100>]}
[0m13:06:49.500200 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:06:49.503110 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:06:49.512264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f1b50>]}
[0m13:06:49.512645 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m13:06:49.512881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107052310>]}
[0m13:06:49.514012 [info ] [MainThread]: 
[0m13:06:49.514241 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:06:49.514432 [info ] [MainThread]: 
[0m13:06:49.514738 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:06:49.517743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m13:06:49.544240 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m13:06:49.544580 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m13:06:49.544787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:49.566179 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m13:06:49.567151 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m13:06:49.569599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m13:06:49.570031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m13:06:49.576215 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:06:49.578775 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:06:49.579066 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m13:06:49.579265 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m13:06:49.579452 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:49.579634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:49.591066 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:06:49.591426 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:06:49.591658 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:06:49.591877 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:06:49.592114 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:06:49.592363 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:06:49.596688 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.004 seconds
[0m13:06:49.597023 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m13:06:49.598781 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m13:06:49.599725 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m13:06:49.600298 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m13:06:49.600535 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m13:06:49.612348 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:49.612642 [debug] [MainThread]: On master: BEGIN
[0m13:06:49.612833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:49.620168 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:06:49.620446 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:49.620731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:06:49.679337 [debug] [MainThread]: SQL status: SELECT 4 in 0.058 seconds
[0m13:06:49.681139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cd5cd0>]}
[0m13:06:49.681544 [debug] [MainThread]: On master: ROLLBACK
[0m13:06:49.682182 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:49.682453 [debug] [MainThread]: On master: BEGIN
[0m13:06:49.683344 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:06:49.683666 [debug] [MainThread]: On master: COMMIT
[0m13:06:49.683962 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:49.684221 [debug] [MainThread]: On master: COMMIT
[0m13:06:49.684775 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:06:49.685046 [debug] [MainThread]: On master: Close
[0m13:06:49.687989 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m13:06:49.688365 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m13:06:49.688681 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m13:06:49.689085 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m13:06:49.689451 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m13:06:49.689929 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m13:06:49.690363 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m13:06:49.690771 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m13:06:49.691158 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m13:06:49.691659 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m13:06:49.692065 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m13:06:49.692373 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m13:06:49.692743 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m13:06:49.693029 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m13:06:49.693289 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m13:06:49.701387 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m13:06:49.701728 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m13:06:49.704871 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m13:06:49.707978 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m13:06:49.711584 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m13:06:49.712246 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m13:06:49.712516 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m13:06:49.719034 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m13:06:49.719283 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m13:06:49.742855 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.stg_products"
[0m13:06:49.743744 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.stg_orders"
[0m13:06:49.747041 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.stg_order_items"
[0m13:06:49.749904 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_test.stg_customers"
[0m13:06:49.750483 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:06:49.750722 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: BEGIN
[0m13:06:49.750935 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:06:49.751287 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:06:49.751503 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: BEGIN
[0m13:06:49.751734 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:06:49.752005 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:06:49.752397 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: BEGIN
[0m13:06:49.752625 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:06:49.753028 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:06:49.753294 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: BEGIN
[0m13:06:49.753517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:49.761951 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m13:06:49.762327 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m13:06:49.762626 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:06:49.763148 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:06:49.763402 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m13:06:49.763665 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m13:06:49.763947 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */

  create view "dbt_db_ex2"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at,
        -- Add tracking for data lineage
        '0ae38369-be26-44d6-8cee-1d271592bd76' as _invocation_id
    from source
)

select * from staged
  );
[0m13:06:49.764212 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */

  create view "dbt_db_ex2"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price, -- Ensure no NULL values
        category,
        created_at
    from source
)

select * from staged
  );
[0m13:06:49.764445 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:06:49.764663 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:06:49.764979 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */

  create view "dbt_db_ex2"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email, -- Normalize email
        created_at
    from source
)

select * from staged
  );
[0m13:06:49.765264 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */

  create view "dbt_db_ex2"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity, -- Ensure minimum quantity is 1
        coalesce(unit_price, 0) as unit_price, -- Ensure no NULL prices
        created_at
    from source
)

select * from staged
  );
[0m13:06:49.770587 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:06:49.770933 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:06:49.771204 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:06:49.771447 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:06:49.776860 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:06:49.780012 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:06:49.783249 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:06:49.786205 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:06:49.786502 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m13:06:49.786749 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:06:49.786973 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:06:49.787228 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:06:49.788359 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.788597 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.791256 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:06:49.791508 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:06:49.791742 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:06:49.794247 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:06:49.794491 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:06:49.797035 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:06:49.799943 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:06:49.800243 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m13:06:49.800515 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:06:49.800769 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:06:49.801016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.807911 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.007 seconds
[0m13:06:49.814477 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.013 seconds
[0m13:06:49.817081 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m13:06:49.817334 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:06:49.817549 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m13:06:49.817778 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.016 seconds
[0m13:06:49.818713 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m13:06:49.819547 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m13:06:49.820875 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m13:06:49.821124 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:06:49.821326 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m13:06:49.821548 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:06:49.821790 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:06:49.822028 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m13:06:49.826772 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_orders__dbt_backup"
[0m13:06:49.827037 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m13:06:49.827256 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m13:06:49.829932 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:06:49.830200 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m13:06:49.830469 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
drop view if exists "dbt_db_ex2"."public"."stg_orders__dbt_backup" cascade
[0m13:06:49.830718 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m13:06:49.830940 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:06:49.833270 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_order_items__dbt_backup"
[0m13:06:49.835920 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_products__dbt_backup"
[0m13:06:49.836260 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.003 seconds
[0m13:06:49.838596 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_customers__dbt_backup"
[0m13:06:49.839002 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:06:49.839340 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:06:49.840859 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: Close
[0m13:06:49.841227 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:06:49.841456 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
drop view if exists "dbt_db_ex2"."public"."stg_order_items__dbt_backup" cascade
[0m13:06:49.841702 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
drop view if exists "dbt_db_ex2"."public"."stg_products__dbt_backup" cascade
[0m13:06:49.842531 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
drop view if exists "dbt_db_ex2"."public"."stg_customers__dbt_backup" cascade
[0m13:06:49.843460 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107413910>]}
[0m13:06:49.844289 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.15s]
[0m13:06:49.844705 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m13:06:49.844941 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.002 seconds
[0m13:06:49.845181 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.002 seconds
[0m13:06:49.848432 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m13:06:49.849305 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: Close
[0m13:06:49.850053 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: Close
[0m13:06:49.851110 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: Close
[0m13:06:49.851642 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767ffa0>]}
[0m13:06:49.852062 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765ab20>]}
[0m13:06:49.852426 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b8040>]}
[0m13:06:49.853055 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m13:06:49.853829 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m13:06:49.853381 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m13:06:49.854170 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m13:06:49.854660 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m13:06:49.854950 [debug] [Thread-3  ]: Began running node model.ecommerce_test.dim_customers
[0m13:06:49.855248 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m13:06:49.855616 [info ] [Thread-3  ]: 5 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m13:06:49.855893 [debug] [Thread-1  ]: Began running node model.ecommerce_test.fct_orders
[0m13:06:49.856243 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.dim_customers)
[0m13:06:49.856482 [debug] [Thread-4  ]: Began running node model.ecommerce_test.dim_products
[0m13:06:49.856791 [info ] [Thread-1  ]: 6 of 7 START sql table model public.fct_orders ................................. [RUN]
[0m13:06:49.857045 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.dim_customers
[0m13:06:49.857330 [info ] [Thread-4  ]: 7 of 7 START sql table model public.dim_products ............................... [RUN]
[0m13:06:49.857641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.fct_orders)
[0m13:06:49.861279 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m13:06:49.861632 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.dim_products)
[0m13:06:49.861876 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.fct_orders
[0m13:06:49.862168 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.dim_products
[0m13:06:49.865269 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m13:06:49.868161 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m13:06:49.868477 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.dim_customers
[0m13:06:49.916347 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.fct_orders
[0m13:06:49.919216 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.dim_customers"
[0m13:06:49.919476 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.dim_products
[0m13:06:49.922521 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_test.fct_orders"
[0m13:06:49.925516 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.dim_products"
[0m13:06:49.926044 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:06:49.926328 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:06:49.926566 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:06:49.926781 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: BEGIN
[0m13:06:49.927019 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: BEGIN
[0m13:06:49.927236 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: BEGIN
[0m13:06:49.927451 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:06:49.927673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:49.927884 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:06:49.942887 [debug] [Thread-3  ]: SQL status: BEGIN in 0.015 seconds
[0m13:06:49.943255 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m13:06:49.943523 [debug] [Thread-4  ]: SQL status: BEGIN in 0.016 seconds
[0m13:06:49.943763 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:06:49.944012 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:06:49.944267 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:06:49.944548 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex2"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as lifetime_orders,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1
),

final as (
    select
        c.customer_id,
        c.name,
        c.email,
        c.created_at,
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        current_timestamp as updated_at
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
  );
  
[0m13:06:49.944853 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */

  
    

  create  table "dbt_db_ex2"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

with orders as (
    select * from "dbt_db_ex2"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db_ex2"."public"."stg_order_items"
),

order_totals as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(quantity * unit_price) as total_amount
    from order_items
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        coalesce(ot.total_items, 0) as total_items,
        coalesce(ot.total_amount, 0) as total_amount,
        o.created_at,
        current_timestamp as updated_at,
        o._invocation_id
    from orders o
    left join order_totals ot on o.order_id = ot.order_id
)

select * from final
  );
  
[0m13:06:49.945149 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex2"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(quantity * unit_price) as total_revenue
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

final as (
    select
        p.product_id,
        p.name,
        p.price,
        p.category,
        p.created_at,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_revenue, 0) as total_revenue,
        current_timestamp as updated_at
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
  );
  
[0m13:06:49.954761 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.009 seconds
[0m13:06:49.955154 [debug] [Thread-4  ]: SQL status: SELECT 4 in 0.010 seconds
[0m13:06:49.961170 [debug] [Thread-3  ]: SQL status: SELECT 3 in 0.016 seconds
[0m13:06:49.961837 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:06:49.965450 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:06:49.968486 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:06:49.968766 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:06:49.969024 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m13:06:49.969281 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:06:49.970387 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.970680 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.970930 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.974037 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:06:49.976732 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:06:49.979883 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:06:49.980140 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:06:49.980378 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:06:49.980612 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:06:49.982292 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.982549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:06:49.983390 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m13:06:49.983613 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:06:49.984399 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m13:06:49.984637 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:06:49.985437 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: COMMIT
[0m13:06:49.985694 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:06:49.985931 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m13:06:49.986162 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:06:49.986383 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m13:06:49.986624 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: COMMIT
[0m13:06:49.987416 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m13:06:49.989862 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_customers__dbt_backup"
[0m13:06:49.990111 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m13:06:49.991661 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:06:49.991894 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m13:06:49.994212 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_products__dbt_backup"
[0m13:06:49.994468 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
drop table if exists "dbt_db_ex2"."public"."dim_customers__dbt_backup" cascade
[0m13:06:49.996748 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public"."fct_orders__dbt_backup"
[0m13:06:49.997129 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:06:49.997501 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:06:49.997742 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
drop table if exists "dbt_db_ex2"."public"."dim_products__dbt_backup" cascade
[0m13:06:49.997990 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
drop table if exists "dbt_db_ex2"."public"."fct_orders__dbt_backup" cascade
[0m13:06:50.005694 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m13:06:50.006008 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.008 seconds
[0m13:06:50.007002 [debug] [Thread-1  ]: On model.ecommerce_test.fct_orders: Close
[0m13:06:50.007293 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.010 seconds
[0m13:06:50.008212 [debug] [Thread-4  ]: On model.ecommerce_test.dim_products: Close
[0m13:06:50.009083 [debug] [Thread-3  ]: On model.ecommerce_test.dim_customers: Close
[0m13:06:50.009491 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b81f850>]}
[0m13:06:50.009920 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107624c40>]}
[0m13:06:50.010373 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ae38369-be26-44d6-8cee-1d271592bd76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ce6340>]}
[0m13:06:50.010865 [info ] [Thread-1  ]: 6 of 7 OK created sql table model public.fct_orders ............................ [[32mSELECT 3[0m in 0.15s]
[0m13:06:50.011435 [info ] [Thread-3  ]: 5 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.15s]
[0m13:06:50.011843 [info ] [Thread-4  ]: 7 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.15s]
[0m13:06:50.012318 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.fct_orders
[0m13:06:50.012687 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.dim_customers
[0m13:06:50.013035 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.dim_products
[0m13:06:50.014065 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:50.014338 [debug] [MainThread]: On master: BEGIN
[0m13:06:50.014552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:06:50.023847 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:06:50.024213 [debug] [MainThread]: On master: COMMIT
[0m13:06:50.024453 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:50.024663 [debug] [MainThread]: On master: COMMIT
[0m13:06:50.025187 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:06:50.025415 [debug] [MainThread]: On master: Close
[0m13:06:50.025753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:50.025971 [debug] [MainThread]: Connection 'model.ecommerce_test.fct_orders' was properly closed.
[0m13:06:50.026173 [debug] [MainThread]: Connection 'model.ecommerce_test.stg_order_items' was properly closed.
[0m13:06:50.026366 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_customers' was properly closed.
[0m13:06:50.026556 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_products' was properly closed.
[0m13:06:50.026870 [info ] [MainThread]: 
[0m13:06:50.027109 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m13:06:50.028080 [debug] [MainThread]: Command end result
[0m13:06:50.058149 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:06:50.059328 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:06:50.063501 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:06:50.063741 [info ] [MainThread]: 
[0m13:06:50.064036 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:06:50.064255 [info ] [MainThread]: 
[0m13:06:50.064473 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:06:50.065579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.184419, "process_in_blocks": "0", "process_kernel_time": 0.165666, "process_mem_max_rss": "129908736", "process_out_blocks": "0", "process_user_time": 1.759109}
[0m13:06:50.065850 [debug] [MainThread]: Command `dbt run` succeeded at 13:06:50.065800 after 1.18 seconds
[0m13:06:50.066102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c7880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680de50>]}
[0m13:06:50.066352 [debug] [MainThread]: Flushing usage events
[0m13:06:51.275241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:06:52.532164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f2fa0>]}


============================== 13:06:52.535817 | 723dc0a1-d45e-4e33-99db-f960fc2d8845 ==============================
[0m13:06:52.535817 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:06:52.536218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --store-failures', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:06:52.678936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '723dc0a1-d45e-4e33-99db-f960fc2d8845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f85ee0>]}
[0m13:06:52.731186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '723dc0a1-d45e-4e33-99db-f960fc2d8845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c3af0>]}
[0m13:06:52.731852 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:06:52.905705 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:06:53.022838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:06:53.023140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:06:53.028354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:06:53.089478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '723dc0a1-d45e-4e33-99db-f960fc2d8845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e4e50>]}
[0m13:06:53.176386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:06:53.178960 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:06:53.192036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '723dc0a1-d45e-4e33-99db-f960fc2d8845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107428b50>]}
[0m13:06:53.192405 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m13:06:53.192618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '723dc0a1-d45e-4e33-99db-f960fc2d8845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072067c0>]}
[0m13:06:53.194254 [info ] [MainThread]: 
[0m13:06:53.194472 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:06:53.194661 [info ] [MainThread]: 
[0m13:06:53.194948 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:06:53.198676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m13:06:53.225092 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m13:06:53.226181 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m13:06:53.226434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:53.246005 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m13:06:53.246979 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m13:06:53.249250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m13:06:53.254304 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:06:53.254734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m13:06:53.254990 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m13:06:53.257217 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:06:53.257486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:53.257744 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m13:06:53.258075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:53.268447 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:06:53.268781 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:06:53.269008 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:06:53.269229 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:06:53.269480 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:06:53.269742 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:06:53.273093 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m13:06:53.273427 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.003 seconds
[0m13:06:53.274378 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m13:06:53.275763 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m13:06:53.276475 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m13:06:53.276709 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m13:06:53.287186 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:53.287494 [debug] [MainThread]: On master: BEGIN
[0m13:06:53.287689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:53.295379 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:06:53.295705 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:53.295973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:06:53.354864 [debug] [MainThread]: SQL status: SELECT 4 in 0.059 seconds
[0m13:06:53.356722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '723dc0a1-d45e-4e33-99db-f960fc2d8845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787c9a0>]}
[0m13:06:53.357127 [debug] [MainThread]: On master: ROLLBACK
[0m13:06:53.357769 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:53.358072 [debug] [MainThread]: On master: BEGIN
[0m13:06:53.358936 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.359236 [debug] [MainThread]: On master: COMMIT
[0m13:06:53.359928 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:53.360349 [debug] [MainThread]: On master: COMMIT
[0m13:06:53.361248 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:06:53.361561 [debug] [MainThread]: On master: Close
[0m13:06:53.363857 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:06:53.364254 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:06:53.364571 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:06:53.365142 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:06:53.364882 [info ] [Thread-1  ]: 1 of 25 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m13:06:53.365556 [info ] [Thread-2  ]: 2 of 25 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m13:06:53.365876 [info ] [Thread-3  ]: 3 of 25 START test assert_no_duplicate_orders .................................. [RUN]
[0m13:06:53.366192 [info ] [Thread-4  ]: 4 of 25 START test assert_total_amount_equals_sum_of_items ..................... [RUN]
[0m13:06:53.366558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:06:53.366875 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:06:53.367225 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_no_duplicate_orders'
[0m13:06:53.367553 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_total_amount_equals_sum_of_items'
[0m13:06:53.367821 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:06:53.368128 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:06:53.368405 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m13:06:53.368687 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:06:53.384123 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:06:53.389349 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:06:53.392456 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:06:53.395595 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:06:53.396580 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:06:53.411878 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:06:53.412186 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:06:53.414850 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:06:53.415126 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:06:53.419443 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m13:06:53.419667 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m13:06:53.419926 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m13:06:53.424481 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:06:53.424850 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:06:53.429149 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m13:06:53.429410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:53.429762 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:06:53.430001 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items" cascade
[0m13:06:53.430323 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:06:53.430680 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m13:06:53.430922 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:06:53.431153 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders" cascade
[0m13:06:53.431414 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:06:53.431770 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:06:53.440322 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:06:53.442218 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:06:53.450388 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:06:53.450701 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.019 seconds
[0m13:06:53.450945 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:06:53.451160 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.020 seconds
[0m13:06:53.451410 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.020 seconds
[0m13:06:53.452030 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m13:06:53.452814 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m13:06:53.453426 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:06:53.453647 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.454063 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:06:53.454461 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:06:53.454942 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:06:53.455172 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:06:53.455384 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m13:06:53.455592 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m13:06:53.455805 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:06:53.456037 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m13:06:53.456560 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.456839 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.457089 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.457305 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:06:53.457556 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:06:53.457824 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:06:53.458097 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
  
  
    as
  
  (
    /*
  Custom test to check if the total amount in orders table
  matches the sum of the item amounts in order_items.
  
  If there are differences, this test will return the records with discrepancies.
*/

with orders as (
    select 
        order_id,
        total_amount as order_total
    from "dbt_db_ex2"."public"."fct_orders"
),

order_items_grouped as (
    select
        order_id,
        sum(quantity * unit_price) as items_total
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

joined as (
    select
        o.order_id,
        o.order_total,
        coalesce(oi.items_total, 0) as items_total,
        abs(o.order_total - coalesce(oi.items_total, 0)) as difference
    from orders o
    left join order_items_grouped oi on o.order_id = oi.order_id
)

select * from joined where difference > 0.01  -- Allow small rounding differences
  );
  
    
[0m13:06:53.458393 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  
  
    as
  
  (
    /*
  Custom test to ensure there are no duplicate orders in the core table.
  This test checks for duplicates based on customer_id and order_date within 15 minutes
*/

with orders as (
    select 
        customer_id,
        order_date,
        count(*) as order_count
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1, 2
),

potential_duplicates as (
    select
        o1.customer_id,
        o1.order_date as order_date_1,
        o2.order_date as order_date_2,
        abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) as minutes_difference
    from "dbt_db_ex2"."public"."stg_orders" o1
    join "dbt_db_ex2"."public"."stg_orders" o2
        on o1.customer_id = o2.customer_id
        and o1.order_id <> o2.order_id
        and abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) < 15  -- Orders less than 15 minutes apart
)

select * from potential_duplicates
  );
  
    
[0m13:06:53.458679 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m13:06:53.459364 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:06:53.460021 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:06:53.460289 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:06:53.460528 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:06:53.462183 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:06:53.462912 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:06:53.463249 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:06:53.463513 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:06:53.466138 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:06:53.466415 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:06:53.466655 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:06:53.466876 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.008 seconds
[0m13:06:53.467535 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m13:06:53.468159 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m13:06:53.468436 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:06:53.468714 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:06:53.468996 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:06:53.469229 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m13:06:53.469446 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m13:06:53.469690 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m13:06:53.469953 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:06:53.470432 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:06:53.471859 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:06:53.472159 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.472405 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:06:53.472687 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:06:53.473020 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m13:06:53.473376 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.473607 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:06:53.473853 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m13:06:53.474194 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:53.474464 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m13:06:53.477224 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m13:06:53.477478 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.003 seconds
[0m13:06:53.477711 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m13:06:53.478093 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:06:53.478955 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m13:06:53.479326 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:06:53.479554 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m13:06:53.480111 [info ] [Thread-1  ]: 1 of 25 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.11s]
[0m13:06:53.480548 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:06:53.480834 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:06:53.481053 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m13:06:53.481305 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:06:53.481614 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:06:53.481867 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m13:06:53.482199 [info ] [Thread-1  ]: 5 of 25 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m13:06:53.482863 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m13:06:53.482531 [info ] [Thread-2  ]: 2 of 25 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.12s]
[0m13:06:53.483541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:06:53.484007 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.484371 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:06:53.484784 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:06:53.485040 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.485268 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:06:53.485544 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:06:53.497455 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:06:53.499025 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:06:53.499343 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
    
      
    ) dbt_internal_test
[0m13:06:53.499633 [info ] [Thread-2  ]: 6 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m13:06:53.499907 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
    
      
    ) dbt_internal_test
[0m13:06:53.500341 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:06:53.500675 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:06:53.500963 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:06:53.506251 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:06:53.506614 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.006 seconds
[0m13:06:53.506856 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.006 seconds
[0m13:06:53.511652 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m13:06:53.512767 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: ROLLBACK
[0m13:06:53.513677 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: ROLLBACK
[0m13:06:53.514167 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:06:53.514516 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:06:53.514809 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3" cascade
[0m13:06:53.519672 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:06:53.519935 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: Close
[0m13:06:53.520150 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: Close
[0m13:06:53.520387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:53.520752 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:06:53.521151 [info ] [Thread-4  ]: 4 of 25 PASS assert_total_amount_equals_sum_of_items ........................... [[32mPASS[0m in 0.15s]
[0m13:06:53.521526 [error] [Thread-3  ]: 3 of 25 FAIL 2 assert_no_duplicate_orders ...................................... [[31mFAIL 2[0m in 0.15s]
[0m13:06:53.521923 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m13:06:53.522267 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:06:53.522583 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:06:53.522821 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:06:53.523109 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:06:53.523436 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:06:53.523852 [info ] [Thread-4  ]: 7 of 25 START test not_null_dim_customers_email ................................ [RUN]
[0m13:06:53.524402 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m13:06:53.524660 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:06:53.524135 [info ] [Thread-3  ]: 8 of 25 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m13:06:53.528685 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:06:53.529080 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:06:53.529481 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:06:53.532773 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:06:53.533208 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.013 seconds
[0m13:06:53.533866 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m13:06:53.534411 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:06:53.534715 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m13:06:53.535130 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:06:53.572786 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:06:53.573172 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.050 seconds
[0m13:06:53.577661 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:06:53.577910 [debug] [Thread-1  ]: SQL status: BEGIN in 0.043 seconds
[0m13:06:53.579411 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:06:53.580056 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:06:53.580441 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:06:53.580684 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:06:53.581133 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:06:53.581593 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:06:53.581837 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m13:06:53.582094 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
  
  
    as
  
  (
    




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(email, '^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$', '')), 1), 0)


 > 0
 as expression


    from "dbt_db_ex2"."public"."dim_customers"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  );
  
    
[0m13:06:53.582339 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m13:06:53.582556 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:06:53.582762 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:06:53.583038 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:06:53.583626 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.583874 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:06:53.584110 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m13:06:53.587543 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:06:53.588651 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m13:06:53.588937 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:06:53.589178 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m13:06:53.592486 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:06:53.593083 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:06:53.593428 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.009 seconds
[0m13:06:53.594151 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:06:53.594447 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:06:53.594738 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:06:53.594976 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:06:53.595655 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:06:53.595936 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:06:53.596225 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:06:53.596865 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:06:53.597386 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:06:53.597803 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m13:06:53.598279 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:06:53.598533 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:06:53.598818 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:06:53.599108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.599499 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.599744 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m13:06:53.600012 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:06:53.600242 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.600519 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:06:53.600951 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:06:53.601215 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
    
      
    ) dbt_internal_test
[0m13:06:53.601477 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:06:53.601750 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m13:06:53.602109 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where email is null



  );
  
    
[0m13:06:53.602518 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:06:53.602753 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:06:53.603027 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:53.603270 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.604339 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: ROLLBACK
[0m13:06:53.604630 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:06:53.604939 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:06:53.605201 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: Close
[0m13:06:53.605716 [info ] [Thread-1  ]: 5 of 25 PASS dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[32mPASS[0m in 0.12s]
[0m13:06:53.606433 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:06:53.606721 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:06:53.607058 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:06:53.607377 [info ] [Thread-1  ]: 9 of 25 START test not_null_dim_customers_name ................................. [RUN]
[0m13:06:53.608347 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:06:53.608604 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:06:53.609545 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:06:53.609862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m13:06:53.610430 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:06:53.611007 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:06:53.611274 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:06:53.611507 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:06:53.611740 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:06:53.611978 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:06:53.615684 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:06:53.616081 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:06:53.616742 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:06:53.616502 [info ] [Thread-2  ]: 6 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.12s]
[0m13:06:53.617622 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:06:53.618044 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:06:53.618382 [info ] [Thread-2  ]: 10 of 25 START test not_null_dim_products_name ................................. [RUN]
[0m13:06:53.618946 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m13:06:53.619580 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:06:53.619828 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:06:53.625446 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:06:53.625757 [debug] [Thread-3  ]: SQL status: COMMIT in 0.008 seconds
[0m13:06:53.625998 [debug] [Thread-4  ]: SQL status: COMMIT in 0.009 seconds
[0m13:06:53.629722 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:06:53.630322 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:06:53.630783 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:06:53.631201 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:06:53.631666 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m13:06:53.632149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:53.632398 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:06:53.632714 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:06:53.638396 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:06:53.638742 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:06:53.638985 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:06:53.639462 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:06:53.639740 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:06:53.640049 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m13:06:53.640312 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.640576 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m13:06:53.640860 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:06:53.641089 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.641316 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:06:53.642028 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:06:53.642358 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:06:53.642616 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:06:53.643428 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:06:53.643880 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m13:06:53.644206 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:06:53.644988 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.645301 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:53.645541 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:53.645779 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:06:53.646744 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m13:06:53.647541 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m13:06:53.647806 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where name is null



  );
  
    
[0m13:06:53.648346 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m13:06:53.648783 [info ] [Thread-3  ]: 8 of 25 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.12s]
[0m13:06:53.649162 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:06:53.649424 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:06:53.649669 [info ] [Thread-3  ]: 11 of 25 START test not_null_dim_products_price ................................ [RUN]
[0m13:06:53.650015 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m13:06:53.650293 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:06:53.654164 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:06:53.654560 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:06:53.654862 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:06:53.655512 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:06:53.655770 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: Close
[0m13:06:53.656448 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:06:53.656760 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:06:53.657063 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:06:53.657602 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:06:53.658210 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:06:53.663137 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:06:53.658006 [info ] [Thread-4  ]: 7 of 25 PASS not_null_dim_customers_email ...................................... [[32mPASS[0m in 0.13s]
[0m13:06:53.663508 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:06:53.663956 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:06:53.664324 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:06:53.664611 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m13:06:53.664996 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:06:53.665241 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.665534 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:06:53.665773 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:06:53.666017 [info ] [Thread-4  ]: 12 of 25 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:06:53.666290 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:06:53.666787 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:06:53.667100 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m13:06:53.667377 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where name is null



  );
  
    
[0m13:06:53.667879 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:06:53.672545 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:06:53.672923 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:06:53.673176 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:06:53.673642 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:06:53.674732 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:06:53.675933 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:06:53.678454 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:06:53.679404 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:06:53.680973 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.015 seconds
[0m13:06:53.681470 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:06:53.688212 [debug] [Thread-2  ]: SQL status: COMMIT in 0.008 seconds
[0m13:06:53.689375 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:06:53.690606 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:06:53.691075 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:06:53.692486 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:06:53.693004 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:06:53.693846 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:06:53.694465 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m13:06:53.695412 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m13:06:53.697945 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:06:53.699459 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:06:53.700311 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:06:53.700947 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:06:53.701477 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.702851 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m13:06:53.703670 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:06:53.704190 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:06:53.704917 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where price is null



  );
  
    
[0m13:06:53.705466 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: Close
[0m13:06:53.706310 [info ] [Thread-1  ]: 9 of 25 PASS not_null_dim_customers_name ....................................... [[32mPASS[0m in 0.10s]
[0m13:06:53.706758 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:06:53.707044 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:06:53.707862 [info ] [Thread-1  ]: 13 of 25 START test not_null_dim_products_total_quantity_sold .................. [RUN]
[0m13:06:53.708741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m13:06:53.709654 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:06:53.715130 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:06:53.715736 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m13:06:53.716208 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:06:53.716596 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.011 seconds
[0m13:06:53.716874 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m13:06:53.717904 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:06:53.718203 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:06:53.718783 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.019 seconds
[0m13:06:53.719104 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:06:53.730227 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m13:06:53.730614 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.012 seconds
[0m13:06:53.731774 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:06:53.732676 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:06:53.733432 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:06:53.735087 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m13:06:53.736995 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:06:53.737793 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold" cascade
[0m13:06:53.738441 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:06:53.738762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:53.739510 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: Close
[0m13:06:53.741473 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m13:06:53.742810 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:06:53.740766 [info ] [Thread-2  ]: 10 of 25 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.12s]
[0m13:06:53.743799 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m13:06:53.744225 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where product_id is null



  );
  
    
[0m13:06:53.744947 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:06:53.745557 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:06:53.746207 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:06:53.747223 [info ] [Thread-2  ]: 14 of 25 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m13:06:53.747949 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m13:06:53.748709 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:06:53.755287 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:06:53.755770 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.010 seconds
[0m13:06:53.756502 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:06:53.757304 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:06:53.758196 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:06:53.758479 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:06:53.758969 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:06:53.765327 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.026 seconds
[0m13:06:53.768242 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m13:06:53.768901 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:06:53.770224 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m13:06:53.770681 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m13:06:53.771229 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:06:53.771841 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:06:53.772392 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:06:53.772692 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue" cascade
[0m13:06:53.772938 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.773181 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m13:06:53.773542 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:06:53.774159 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:06:53.775025 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:06:53.775617 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m13:06:53.776049 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:06:53.776330 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m13:06:53.776890 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:06:53.777478 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_quantity_sold is null



  );
  
    
[0m13:06:53.778179 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.779082 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:06:53.779861 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:06:53.782249 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m13:06:53.782666 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:06:53.784277 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: Close
[0m13:06:53.784938 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:53.787197 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:06:53.785510 [info ] [Thread-3  ]: 11 of 25 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.14s]
[0m13:06:53.788212 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.009 seconds
[0m13:06:53.789592 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:06:53.789981 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:06:53.790857 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m13:06:53.791212 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.018 seconds
[0m13:06:53.791552 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:06:53.793479 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:06:53.792597 [info ] [Thread-4  ]: 12 of 25 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.13s]
[0m13:06:53.795418 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m13:06:53.795976 [info ] [Thread-3  ]: 15 of 25 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:06:53.796303 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m13:06:53.796739 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:06:53.797283 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:06:53.797752 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:06:53.798158 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:06:53.798632 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m13:06:53.798972 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:06:53.799351 [info ] [Thread-4  ]: 16 of 25 START test not_null_fct_orders_order_date ............................. [RUN]
[0m13:06:53.806582 [debug] [Thread-2  ]: SQL status: BEGIN in 0.006 seconds
[0m13:06:53.809501 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:06:53.810198 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m13:06:53.810627 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m13:06:53.811178 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:06:53.811973 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:06:53.812279 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:06:53.812688 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:06:53.812936 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_revenue is null



  );
  
    
[0m13:06:53.819067 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:06:53.819856 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:06:53.827320 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:06:53.828876 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m13:06:53.829678 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:06:53.830248 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:06:53.839693 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m13:06:53.838509 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:06:53.839438 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m13:06:53.843868 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:06:53.839155 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.011 seconds
[0m13:06:53.846372 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:06:53.847248 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:06:53.848971 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m13:06:53.849813 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m13:06:53.850821 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
    
      
    ) dbt_internal_test
[0m13:06:53.856046 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:06:53.852241 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:06:53.857907 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: ROLLBACK
[0m13:06:53.851756 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:06:53.859117 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m13:06:53.861437 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: Close
[0m13:06:53.863389 [info ] [Thread-1  ]: 13 of 25 PASS not_null_dim_products_total_quantity_sold ........................ [[32mPASS[0m in 0.15s]
[0m13:06:53.864789 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:06:53.865299 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:06:53.865583 [info ] [Thread-1  ]: 17 of 25 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:06:53.866085 [debug] [Thread-2  ]: SQL status: COMMIT in 0.006 seconds
[0m13:06:53.866616 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m13:06:53.869315 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:06:53.869908 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.030 seconds
[0m13:06:53.870782 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:06:53.873323 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:06:53.879337 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:06:53.879781 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:06:53.880667 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:06:53.881305 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m13:06:53.881644 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:06:53.881960 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.030 seconds
[0m13:06:53.882257 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:06:53.882507 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.883284 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:06:53.888642 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:06:53.888920 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m13:06:53.889199 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:06:53.889703 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:06:53.890076 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:06:53.890309 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:06:53.890561 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
    
      
    ) dbt_internal_test
[0m13:06:53.890804 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:06:53.891041 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m13:06:53.891278 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m13:06:53.891589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:53.892045 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.892282 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:06:53.892621 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:53.893223 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_date is null



  );
  
    
[0m13:06:53.894657 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m13:06:53.895660 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m13:06:53.896199 [info ] [Thread-2  ]: 14 of 25 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.15s]
[0m13:06:53.896610 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:06:53.896886 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:06:53.897476 [info ] [Thread-2  ]: 18 of 25 START test not_null_fct_orders_status ................................. [RUN]
[0m13:06:53.897847 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m13:06:53.898099 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:06:53.902154 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:06:53.902519 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.011 seconds
[0m13:06:53.902841 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.008 seconds
[0m13:06:53.903522 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:06:53.904127 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:06:53.904347 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.013 seconds
[0m13:06:53.904586 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:06:53.904836 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:06:53.905115 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:06:53.905838 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:06:53.911586 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:06:53.911944 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:06:53.912229 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:06:53.912779 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:06:53.913161 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:06:53.913463 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:06:53.913720 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m13:06:53.913999 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:06:53.914356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.914597 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:06:53.914945 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_id is null



  );
  
    
[0m13:06:53.917804 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m13:06:53.918355 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:06:53.918614 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m13:06:53.919058 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:06:53.919461 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:06:53.919929 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:06:53.920822 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:06:53.921174 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:06:53.921449 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:06:53.921689 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.922434 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:06:53.922755 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:06:53.923036 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.923277 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:06:53.923539 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m13:06:53.923791 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.010 seconds
[0m13:06:53.924016 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:06:53.924254 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:06:53.924999 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:06:53.925250 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:53.925497 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m13:06:53.926030 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:06:53.927397 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m13:06:53.928324 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m13:06:53.928670 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:06:53.928937 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:53.929176 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: Close
[0m13:06:53.929601 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:06:53.929836 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.930719 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:06:53.931405 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:06:53.931196 [info ] [Thread-4  ]: 16 of 25 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.12s]
[0m13:06:53.931764 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where status is null



  );
  
    
[0m13:06:53.932100 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:06:53.932325 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:06:53.932641 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:06:53.932902 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:06:53.933257 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:06:53.933974 [info ] [Thread-3  ]: 15 of 25 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.14s]
[0m13:06:53.935114 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.935454 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:06:53.934727 [info ] [Thread-4  ]: 19 of 25 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m13:06:53.935801 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:06:53.936083 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:06:53.936470 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:06:53.936792 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:06:53.937075 [info ] [Thread-3  ]: 20 of 25 START test not_null_fct_orders_total_items ............................ [RUN]
[0m13:06:53.937363 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:06:53.937795 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m13:06:53.942533 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:06:53.942880 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.010 seconds
[0m13:06:53.943121 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.006 seconds
[0m13:06:53.943353 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:06:53.944047 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m13:06:53.944960 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:06:53.948705 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:06:53.949114 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:06:53.949509 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:06:53.949795 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m13:06:53.950056 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:06:53.954792 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:06:53.955331 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:06:53.955612 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:06:53.956200 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m13:06:53.955982 [info ] [Thread-1  ]: 17 of 25 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.09s]
[0m13:06:53.961449 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m13:06:53.961790 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m13:06:53.962055 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:06:53.962450 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:06:53.962889 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:06:53.963299 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:06:53.963680 [debug] [Thread-1  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:06:53.963987 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items" cascade
[0m13:06:53.964388 [info ] [Thread-1  ]: 21 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m13:06:53.964687 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:06:53.965014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:06:53.965386 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:06:53.965657 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:06:53.965904 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m13:06:53.972403 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:06:53.972744 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:06:53.973706 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:06:53.973976 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.009 seconds
[0m13:06:53.974217 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.974788 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:06:53.975462 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m13:06:53.975705 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:06:53.975942 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:06:53.976195 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:06:53.976634 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:06:53.976886 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m13:06:53.981291 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:06:53.981568 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m13:06:53.982014 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:06:53.982286 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:53.982538 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:53.982772 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:53.983001 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m13:06:53.983253 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:06:53.984132 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: ROLLBACK
[0m13:06:53.984367 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:06:53.984604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:53.984836 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m13:06:53.985097 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_items is null



  );
  
    
[0m13:06:53.985323 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: Close
[0m13:06:53.985835 [info ] [Thread-2  ]: 18 of 25 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.09s]
[0m13:06:53.986199 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:06:53.986462 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:06:53.986704 [info ] [Thread-2  ]: 22 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:06:53.987467 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:06:53.987787 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:06:53.993492 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:06:53.993834 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.008 seconds
[0m13:06:53.994114 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.008 seconds
[0m13:06:53.994902 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:06:53.995515 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m13:06:53.995819 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:06:53.996059 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:06:53.996303 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:06:53.996553 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:06:53.997175 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:06:53.997411 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:06:54.003039 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:06:54.003395 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m13:06:54.003956 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:06:54.004376 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:06:54.004678 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:06:54.004967 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m13:06:54.005276 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:06:54.005722 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:54.005982 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:06:54.006271 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex2"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex2"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:06:54.007949 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m13:06:54.008622 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:06:54.008905 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m13:06:54.009428 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:06:54.009959 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:06:54.010211 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:06:54.010577 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:06:54.010908 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:06:54.011135 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m13:06:54.011351 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:54.011981 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:06:54.012298 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:06:54.012982 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:06:54.013489 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:54.013823 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m13:06:54.014243 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:06:54.014594 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:06:54.015019 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
    
      
    ) dbt_internal_test
[0m13:06:54.015917 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:54.017043 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m13:06:54.017355 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:06:54.017613 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:06:54.017835 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.003 seconds
[0m13:06:54.018249 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:06:54.018480 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m13:06:54.019209 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:06:54.020252 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: ROLLBACK
[0m13:06:54.020971 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:06:54.021920 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:06:54.021400 [info ] [Thread-4  ]: 19 of 25 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.08s]
[0m13:06:54.022343 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:06:54.022660 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:06:54.023038 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:06:54.023277 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: Close
[0m13:06:54.023652 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:06:54.024122 [info ] [Thread-3  ]: 20 of 25 PASS not_null_fct_orders_total_items .................................. [[32mPASS[0m in 0.09s]
[0m13:06:54.024483 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:54.024941 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:54.024739 [info ] [Thread-4  ]: 23 of 25 START test unique_dim_customers_email ................................. [RUN]
[0m13:06:54.025362 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:06:54.025702 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:06:54.025956 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:06:54.026255 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m13:06:54.026526 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:06:54.026848 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m13:06:54.027133 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m13:06:54.027398 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:06:54.027679 [info ] [Thread-3  ]: 24 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m13:06:54.032537 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:06:54.032973 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m13:06:54.033232 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:06:54.033597 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m13:06:54.033869 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:06:54.034561 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:06:54.035530 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m13:06:54.035805 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:06:54.039978 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:06:54.040383 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:06:54.082937 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m13:06:54.087317 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:06:54.087683 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:06:54.088223 [info ] [Thread-1  ]: 21 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.12s]
[0m13:06:54.088690 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:06:54.088926 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:06:54.089311 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:06:54.089582 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m13:06:54.094221 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:06:54.094557 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m13:06:54.094874 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:06:54.095174 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:06:54.095617 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:06:54.096043 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:06:54.096319 [info ] [Thread-1  ]: 25 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m13:06:54.096692 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m13:06:54.097066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m13:06:54.097399 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:06:54.097875 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:06:54.098172 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:06:54.098661 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:06:54.103858 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:06:54.104822 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:06:54.109997 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:06:54.110700 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:06:54.111053 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m13:06:54.111358 [debug] [Thread-2  ]: SQL status: BEGIN in 0.007 seconds
[0m13:06:54.111592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:06:54.111835 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:06:54.112065 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.017 seconds
[0m13:06:54.112443 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:06:54.112777 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.015 seconds
[0m13:06:54.113677 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:06:54.114529 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:06:54.114841 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:54.115606 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:06:54.116228 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:06:54.117307 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:06:54.117628 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:06:54.117896 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:06:54.118863 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:06:54.119182 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:54.119411 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:54.119914 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:06:54.120979 [info ] [Thread-2  ]: 22 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.13s]
[0m13:06:54.121406 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:06:54.121718 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m13:06:54.122119 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:06:54.122409 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m13:06:54.122727 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:06:54.123794 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:06:54.124394 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:06:54.124698 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:06:54.125415 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:06:54.125781 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:06:54.126055 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m13:06:54.126423 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:06:54.127156 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:06:54.127439 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:06:54.127680 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:06:54.129676 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:06:54.130071 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:06:54.130894 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:06:54.131139 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m13:06:54.131743 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:06:54.132026 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:06:54.132474 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:06:54.132734 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:06:54.132970 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:06:54.133536 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:06:54.134055 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:06:54.135240 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:06:54.137000 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:54.137403 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m13:06:54.137661 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m13:06:54.137898 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:06:54.138369 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:06:54.138770 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:06:54.139058 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:06:54.139744 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:06:54.140055 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:06:54.140307 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:06:54.140553 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:54.140814 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:06:54.142024 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:06:54.142318 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:54.142612 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:06:54.142941 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:06:54.143189 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:06:54.143408 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:06:54.143706 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:06:54.144013 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:06:54.144699 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:54.144480 [info ] [Thread-3  ]: 24 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.11s]
[0m13:06:54.145107 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:06:54.146118 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m13:06:54.146476 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:06:54.147668 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m13:06:54.148529 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: Close
[0m13:06:54.148800 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m13:06:54.149250 [info ] [Thread-4  ]: 23 of 25 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.12s]
[0m13:06:54.149673 [info ] [Thread-1  ]: 25 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.05s]
[0m13:06:54.150032 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:06:54.150356 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:06:54.151609 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:54.151873 [debug] [MainThread]: On master: BEGIN
[0m13:06:54.152062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:06:54.159820 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:06:54.160127 [debug] [MainThread]: On master: COMMIT
[0m13:06:54.160340 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:54.160569 [debug] [MainThread]: On master: COMMIT
[0m13:06:54.161158 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:06:54.161416 [debug] [MainThread]: On master: Close
[0m13:06:54.161744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:54.162156 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m13:06:54.162344 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m13:06:54.162524 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m13:06:54.162784 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m13:06:54.163052 [info ] [MainThread]: 
[0m13:06:54.163278 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m13:06:54.165524 [debug] [MainThread]: Command end result
[0m13:06:54.263691 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:06:54.265636 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:06:54.277319 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:06:54.277769 [info ] [MainThread]: 
[0m13:06:54.278149 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:06:54.278432 [info ] [MainThread]: 
[0m13:06:54.278733 [error] [MainThread]: [31mFailure in test assert_no_duplicate_orders (tests/assert_no_duplicate_orders.sql)[0m
[0m13:06:54.279389 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m13:06:54.279905 [info ] [MainThread]: 
[0m13:06:54.280314 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/tests/assert_no_duplicate_orders.sql
[0m13:06:54.280814 [info ] [MainThread]: 
[0m13:06:54.281200 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  --------------------------------------------------------------------------------
[0m13:06:54.281875 [info ] [MainThread]: 
[0m13:06:54.282310 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=1 SKIP=0 TOTAL=25
[0m13:06:54.284709 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.813018, "process_in_blocks": "0", "process_kernel_time": 0.24297, "process_mem_max_rss": "132481024", "process_out_blocks": "0", "process_user_time": 2.362276}
[0m13:06:54.285243 [debug] [MainThread]: Command `dbt test` failed at 13:06:54.285180 after 1.81 seconds
[0m13:06:54.285643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac0fd0>]}
[0m13:06:54.286192 [debug] [MainThread]: Flushing usage events
[0m13:06:55.243267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:06:56.342821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106be1040>]}


============================== 13:06:56.345602 | f649f3a8-3147-4abf-a574-03f81c5ad8bf ==============================
[0m13:06:56.345602 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:06:56.345989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:06:56.471235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f649f3a8-3147-4abf-a574-03f81c5ad8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104585580>]}
[0m13:06:56.519347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f649f3a8-3147-4abf-a574-03f81c5ad8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba34f0>]}
[0m13:06:56.519960 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:06:56.616770 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:06:56.752148 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:06:56.752561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:06:56.758756 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:06:56.838088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f649f3a8-3147-4abf-a574-03f81c5ad8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e4e20>]}
[0m13:06:56.848244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f649f3a8-3147-4abf-a574-03f81c5ad8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a5a00>]}
[0m13:06:56.848669 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m13:06:56.848908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f649f3a8-3147-4abf-a574-03f81c5ad8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a59a0>]}
[0m13:06:56.850518 [info ] [MainThread]: 
[0m13:06:56.850874 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:06:56.851105 [info ] [MainThread]: 
[0m13:06:56.851455 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:06:56.856305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m13:06:56.856798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m13:06:56.891824 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:06:56.892143 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:06:56.892359 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m13:06:56.892567 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m13:06:56.892758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:56.892941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:56.912306 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m13:06:56.912592 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m13:06:56.912827 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:06:56.913078 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:06:56.913333 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:06:56.913582 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:06:56.917756 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m13:06:56.917997 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.004 seconds
[0m13:06:56.918946 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m13:06:56.920433 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m13:06:56.920938 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m13:06:56.921136 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m13:06:56.932135 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:56.932440 [debug] [MainThread]: On master: BEGIN
[0m13:06:56.932636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:56.940744 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:06:56.941056 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:56.941327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:06:56.975239 [debug] [MainThread]: SQL status: SELECT 4 in 0.034 seconds
[0m13:06:56.978544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f649f3a8-3147-4abf-a574-03f81c5ad8bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e61c0>]}
[0m13:06:56.978854 [debug] [MainThread]: On master: ROLLBACK
[0m13:06:56.979422 [debug] [MainThread]: On master: Close
[0m13:06:56.980764 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m13:06:56.981047 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m13:06:56.981383 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m13:06:56.981674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m13:06:56.981901 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m13:06:56.982159 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m13:06:56.982471 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m13:06:56.982715 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m13:06:56.983009 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m13:06:56.983235 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m13:06:56.983458 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m13:06:56.989939 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m13:06:56.990217 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m13:06:56.992910 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m13:06:56.995569 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m13:06:56.998836 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m13:06:56.999438 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m13:06:56.999694 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m13:06:56.999920 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m13:06:57.000139 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m13:06:57.000566 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m13:06:57.000973 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m13:06:57.001364 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m13:06:57.001746 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m13:06:57.002224 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:06:57.002578 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now test.ecommerce_test.assert_no_duplicate_orders)
[0m13:06:57.002897 [debug] [Thread-2  ]: Began running node model.ecommerce_test.dim_customers
[0m13:06:57.003137 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m13:06:57.003394 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_products
[0m13:06:57.003630 [debug] [Thread-3  ]: Began running node model.ecommerce_test.fct_orders
[0m13:06:57.003876 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.dim_customers)
[0m13:06:57.006997 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:06:57.007283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.dim_products)
[0m13:06:57.007540 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.fct_orders)
[0m13:06:57.007776 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.dim_customers
[0m13:06:57.008055 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_products
[0m13:06:57.008295 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.fct_orders
[0m13:06:57.012827 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m13:06:57.013208 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m13:06:57.017575 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m13:06:57.021870 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m13:06:57.022514 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:06:57.023053 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.fct_orders
[0m13:06:57.023466 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.fct_orders
[0m13:06:57.023748 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.dim_customers
[0m13:06:57.024206 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.dim_customers
[0m13:06:57.024555 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_products
[0m13:06:57.024821 [debug] [Thread-4  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:06:57.025288 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_products
[0m13:06:57.025604 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:06:57.025943 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:06:57.026200 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:06:57.026472 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:06:57.026782 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.fct_orders, now test.ecommerce_test.assert_total_amount_equals_sum_of_items)
[0m13:06:57.027151 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_customers, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:06:57.027411 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:06:57.027659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_products, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m13:06:57.038097 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:06:57.045783 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:06:57.046277 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:06:57.027894 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:06:57.046536 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:06:57.028119 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:06:57.045003 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:06:57.050059 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:06:57.050437 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m13:06:57.056860 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:06:57.061303 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:06:57.061766 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:06:57.062256 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:06:57.065724 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:06:57.066024 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:06:57.066535 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:06:57.066846 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:06:57.067260 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:06:57.067535 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:06:57.067990 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:06:57.068201 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:06:57.068455 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:06:57.068737 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m13:06:57.069053 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:06:57.069527 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:06:57.069795 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:06:57.070063 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:06:57.070365 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m13:06:57.070667 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:06:57.070952 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:06:57.074328 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:06:57.074654 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:06:57.074968 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m13:06:57.078237 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:06:57.081711 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:06:57.082046 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:06:57.082451 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:06:57.088157 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:06:57.088749 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:06:57.088978 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:06:57.089286 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:06:57.089668 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:06:57.090187 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:06:57.090585 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:06:57.090842 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:06:57.091111 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:06:57.091377 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:06:57.091649 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:06:57.092090 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:06:57.092338 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:06:57.092593 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:06:57.092837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m13:06:57.093096 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:06:57.105263 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:06:57.105686 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:06:57.105934 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:06:57.106224 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:06:57.109940 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:06:57.113620 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:06:57.113983 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:06:57.114562 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:06:57.114872 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:06:57.119936 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:06:57.120290 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:06:57.120807 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:06:57.121274 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:06:57.121774 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:06:57.122068 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:06:57.122429 [debug] [Thread-2  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:06:57.122770 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:06:57.123118 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m13:06:57.123368 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:06:57.123642 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:06:57.123904 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:06:57.124190 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:06:57.124666 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:06:57.124978 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:06:57.125224 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:06:57.129281 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:06:57.129724 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:06:57.138707 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:06:57.140469 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:06:57.140947 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m13:06:57.141383 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:06:57.145723 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:06:57.146199 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:06:57.146666 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:06:57.146919 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:06:57.147193 [debug] [Thread-3  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:06:57.147524 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:06:57.147935 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:06:57.148248 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:06:57.148689 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:06:57.148923 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:06:57.149194 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:06:57.149477 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:06:57.149729 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:06:57.150151 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:06:57.150431 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m13:06:57.155447 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:06:57.155834 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m13:06:57.156126 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:06:57.156420 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:06:57.156728 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:06:57.157034 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_email.0472f7c2e8, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m13:06:57.160931 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:06:57.164563 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:06:57.164901 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:06:57.165161 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:06:57.169338 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:06:57.169924 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:06:57.170274 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:06:57.170543 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:06:57.170828 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:06:57.171354 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:06:57.171614 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:06:57.171894 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m13:06:57.172342 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:06:57.172645 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:06:57.173086 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:06:57.173391 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:06:57.173680 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:06:57.173964 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m13:06:57.177816 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:06:57.178209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m13:06:57.178487 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:06:57.178869 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:06:57.182594 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:06:57.182935 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:06:57.186578 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:06:57.187210 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:06:57.187688 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:06:57.188145 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:06:57.188377 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:06:57.188882 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:06:57.189522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:57.189746 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m13:06:57.189928 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a' was properly closed.
[0m13:06:57.190103 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a' was properly closed.
[0m13:06:57.190276 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m13:06:57.192880 [debug] [MainThread]: Command end result
[0m13:06:57.334306 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:06:57.337259 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:06:57.343169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:06:57.345414 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:06:57.345800 [info ] [MainThread]: Building catalog
[0m13:06:57.358580 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db_ex2.information_schema'
[0m13:06:57.364799 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m13:06:57.365140 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: BEGIN
[0m13:06:57.365338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:57.378115 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:06:57.378451 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m13:06:57.378851 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "dbt_db_ex2.information_schema"} */

    
    

    select
        'dbt_db_ex2' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_quantity_sold')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_status')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_lifetime_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_name')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_no_duplicate_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_revenue')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_amount')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_customer_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_date')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_products_product_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_total_amount_equals_sum_of_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_price')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_customer_id')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:06:57.386733 [debug] [ThreadPool]: SQL status: SELECT 214 in 0.007 seconds
[0m13:06:57.397614 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: ROLLBACK
[0m13:06:57.398407 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: Close
[0m13:06:57.414662 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m13:06:57.445644 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:06:57.446812 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:06:57.447035 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m13:06:57.448162 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1582305, "process_in_blocks": "0", "process_kernel_time": 0.162979, "process_mem_max_rss": "127451136", "process_out_blocks": "0", "process_user_time": 1.77532}
[0m13:06:57.448446 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:06:57.448393 after 1.16 seconds
[0m13:06:57.448662 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:06:57.448839 [debug] [MainThread]: Connection 'dbt_db_ex2.information_schema' was properly closed.
[0m13:06:57.449117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104585580>]}
[0m13:06:57.449398 [debug] [MainThread]: Flushing usage events
[0m13:06:58.392922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:10.963493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a82790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cebbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cebd90>]}


============================== 13:10:10.966684 | bcb88649-588c-42f3-a9af-87fdd075ddcb ==============================
[0m13:10:10.966684 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:10:10.967064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:10:11.073424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcb88649-588c-42f3-a9af-87fdd075ddcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a11640>]}
[0m13:10:11.125195 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-jrqmsu_e'
[0m13:10:11.125699 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:10:11.188341 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:10:11.189681 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:10:11.208769 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:10:11.213275 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:10:11.231591 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:10:11.233138 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m13:10:11.233453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bcb88649-588c-42f3-a9af-87fdd075ddcb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb4df0>]}
[0m13:10:11.235922 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:10:11.273657 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:10:11.276929 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:10:11.889803 [info ] [MainThread]: Installed from version 1.1.1
[0m13:10:11.890156 [info ] [MainThread]: Updated version available: 1.3.0
[0m13:10:11.890409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bcb88649-588c-42f3-a9af-87fdd075ddcb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d519a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb46a0>]}
[0m13:10:11.890683 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m13:10:13.510714 [info ] [MainThread]: Installed from version 0.10.0
[0m13:10:13.511069 [info ] [MainThread]: Updated version available: 0.10.4
[0m13:10:13.511335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bcb88649-588c-42f3-a9af-87fdd075ddcb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb4d30>]}
[0m13:10:13.511627 [info ] [MainThread]: Installing calogica/dbt_date
[0m13:10:14.003753 [info ] [MainThread]: Installed from version 0.10.0
[0m13:10:14.004344 [info ] [MainThread]: Updated version available: 0.10.1
[0m13:10:14.004623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bcb88649-588c-42f3-a9af-87fdd075ddcb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fb4e50>]}
[0m13:10:14.005476 [info ] [MainThread]: 
[0m13:10:14.006287 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m13:10:14.009130 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.1001513, "process_in_blocks": "0", "process_kernel_time": 0.30138, "process_mem_max_rss": "105316352", "process_out_blocks": "0", "process_user_time": 1.192896}
[0m13:10:14.009605 [debug] [MainThread]: Command `dbt deps` succeeded at 13:10:14.009525 after 3.10 seconds
[0m13:10:14.009868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a82790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d53250>]}
[0m13:10:14.010139 [debug] [MainThread]: Flushing usage events
[0m13:10:15.002157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:16.343096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dca760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6acd0>]}


============================== 13:10:16.345625 | de49432c-bb1b-4ac4-859d-c7347424b062 ==============================
[0m13:10:16.345625 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:10:16.345998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:10:16.353867 [info ] [MainThread]: dbt version: 1.9.4
[0m13:10:16.354165 [info ] [MainThread]: python version: 3.9.6
[0m13:10:16.354356 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m13:10:16.354537 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m13:10:16.403610 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m13:10:16.403985 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m13:10:16.404192 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/dbt_project.yml
[0m13:10:16.404778 [info ] [MainThread]: adapter type: postgres
[0m13:10:16.405008 [info ] [MainThread]: adapter version: 1.9.0
[0m13:10:16.487249 [info ] [MainThread]: Configuration:
[0m13:10:16.487605 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:10:16.487807 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:10:16.487997 [info ] [MainThread]: Required dependencies:
[0m13:10:16.488263 [debug] [MainThread]: Executing "git --help"
[0m13:10:16.504005 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:10:16.504568 [debug] [MainThread]: STDERR: "b''"
[0m13:10:16.504783 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:10:16.505003 [info ] [MainThread]: Connection:
[0m13:10:16.505261 [info ] [MainThread]:   host: localhost
[0m13:10:16.505441 [info ] [MainThread]:   port: 5433
[0m13:10:16.505618 [info ] [MainThread]:   user: dbt_user
[0m13:10:16.505802 [info ] [MainThread]:   database: dbt_db_ex2
[0m13:10:16.505970 [info ] [MainThread]:   schema: public
[0m13:10:16.506138 [info ] [MainThread]:   connect_timeout: 10
[0m13:10:16.506307 [info ] [MainThread]:   role: None
[0m13:10:16.506474 [info ] [MainThread]:   search_path: None
[0m13:10:16.506642 [info ] [MainThread]:   keepalives_idle: 0
[0m13:10:16.506810 [info ] [MainThread]:   sslmode: None
[0m13:10:16.506983 [info ] [MainThread]:   sslcert: None
[0m13:10:16.507150 [info ] [MainThread]:   sslkey: None
[0m13:10:16.507317 [info ] [MainThread]:   sslrootcert: None
[0m13:10:16.507488 [info ] [MainThread]:   application_name: dbt
[0m13:10:16.507653 [info ] [MainThread]:   retries: 1
[0m13:10:16.508162 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:10:16.578083 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:10:16.605035 [debug] [MainThread]: Using postgres connection "debug"
[0m13:10:16.605337 [debug] [MainThread]: On debug: select 1 as id
[0m13:10:16.605524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:16.635478 [debug] [MainThread]: SQL status: SELECT 1 in 0.030 seconds
[0m13:10:16.636195 [debug] [MainThread]: On debug: Close
[0m13:10:16.636438 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:10:16.636869 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:10:16.638092 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.349455, "process_in_blocks": "0", "process_kernel_time": 0.164705, "process_mem_max_rss": "114786304", "process_out_blocks": "0", "process_user_time": 1.097218}
[0m13:10:16.638441 [debug] [MainThread]: Command `dbt debug` succeeded at 13:10:16.638370 after 0.35 seconds
[0m13:10:16.638686 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:10:16.638950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dca760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108387400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108312880>]}
[0m13:10:16.639282 [debug] [MainThread]: Flushing usage events
[0m13:10:17.635446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:18.733627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ca730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7adf0>]}


============================== 13:10:18.736156 | 0bbb242c-f3fa-4f2b-8e31-b2a11686fc32 ==============================
[0m13:10:18.736156 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:10:18.736515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:10:18.860381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4a370>]}
[0m13:10:18.907045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bedf0>]}
[0m13:10:18.907644 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:10:18.997417 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:10:19.172874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:10:19.173203 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:10:19.179055 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:10:19.252760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ba0a0>]}
[0m13:10:19.346174 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:10:19.349313 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:10:19.359583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102fa670>]}
[0m13:10:19.359989 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m13:10:19.360221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102c6880>]}
[0m13:10:19.361489 [info ] [MainThread]: 
[0m13:10:19.361744 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:10:19.361939 [info ] [MainThread]: 
[0m13:10:19.362320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:19.365658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m13:10:19.396034 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m13:10:19.396340 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m13:10:19.396537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:19.418550 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m13:10:19.419448 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m13:10:19.421825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m13:10:19.426810 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:10:19.427224 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m13:10:19.427446 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m13:10:19.429622 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:10:19.429861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:19.430064 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m13:10:19.430359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:19.441846 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:10:19.442187 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:10:19.442413 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:10:19.442713 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:10:19.442976 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:10:19.443293 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:10:19.446922 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m13:10:19.448087 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m13:10:19.448370 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.005 seconds
[0m13:10:19.450198 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m13:10:19.450515 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m13:10:19.452078 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m13:10:19.537800 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:19.538167 [debug] [MainThread]: On master: BEGIN
[0m13:10:19.538378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:19.559450 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m13:10:19.559771 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:19.560042 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:10:19.596366 [debug] [MainThread]: SQL status: SELECT 4 in 0.036 seconds
[0m13:10:19.597898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f59cd0>]}
[0m13:10:19.598247 [debug] [MainThread]: On master: ROLLBACK
[0m13:10:19.599258 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:19.599549 [debug] [MainThread]: On master: BEGIN
[0m13:10:19.600602 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:10:19.600945 [debug] [MainThread]: On master: COMMIT
[0m13:10:19.601157 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:19.601384 [debug] [MainThread]: On master: COMMIT
[0m13:10:19.602092 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:10:19.602325 [debug] [MainThread]: On master: Close
[0m13:10:19.605031 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m13:10:19.605676 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m13:10:19.605459 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m13:10:19.606275 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m13:10:19.605997 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m13:10:19.606659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m13:10:19.606890 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m13:10:19.607552 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m13:10:19.607204 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m13:10:19.607875 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m13:10:19.608175 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m13:10:19.608445 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m13:10:19.608758 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m13:10:19.614446 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m13:10:19.616227 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m13:10:19.619215 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m13:10:19.619542 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m13:10:19.619779 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m13:10:19.622868 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m13:10:19.626545 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m13:10:19.626860 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m13:10:19.627204 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m13:10:19.650981 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m13:10:19.653412 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_test.stg_customers"
[0m13:10:19.656958 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.stg_order_items"
[0m13:10:19.657315 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m13:10:19.660909 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.stg_orders"
[0m13:10:19.664538 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.stg_products"
[0m13:10:19.665054 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:10:19.665340 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:10:19.665561 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: BEGIN
[0m13:10:19.665848 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: BEGIN
[0m13:10:19.666119 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:10:19.666384 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:10:19.666598 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:19.666827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:19.667063 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: BEGIN
[0m13:10:19.667300 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: BEGIN
[0m13:10:19.667729 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:10:19.668191 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:10:19.680282 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m13:10:19.680642 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m13:10:19.680889 [debug] [Thread-3  ]: SQL status: BEGIN in 0.013 seconds
[0m13:10:19.681123 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:10:19.681369 [debug] [Thread-2  ]: SQL status: BEGIN in 0.015 seconds
[0m13:10:19.681653 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:10:19.681918 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:10:19.682179 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */

  create view "dbt_db_ex2"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price, -- Ensure no NULL values
        category,
        created_at
    from source
)

select * from staged
  );
[0m13:10:19.682434 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:10:19.682684 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */

  create view "dbt_db_ex2"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email, -- Normalize email
        created_at
    from source
)

select * from staged
  );
[0m13:10:19.682951 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */

  create view "dbt_db_ex2"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at,
        -- Add tracking for data lineage
        '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32' as _invocation_id
    from source
)

select * from staged
  );
[0m13:10:19.683269 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */

  create view "dbt_db_ex2"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity, -- Ensure minimum quantity is 1
        coalesce(unit_price, 0) as unit_price, -- Ensure no NULL prices
        created_at
    from source
)

select * from staged
  );
[0m13:10:19.688323 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:10:19.693833 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:10:19.697177 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:10:19.697559 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:10:19.697829 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.014 seconds
[0m13:10:19.698065 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m13:10:19.698280 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.015 seconds
[0m13:10:19.698518 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:10:19.701945 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:10:19.705222 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:10:19.705547 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:10:19.705835 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:10:19.706102 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:10:19.709055 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:10:19.709364 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:10:19.709717 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m13:10:19.712851 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:10:19.713168 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:10:19.713409 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:10:19.713705 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:10:19.716604 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:10:19.719933 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:10:19.720202 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.007 seconds
[0m13:10:19.720523 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:10:19.720822 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:10:19.732020 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.012 seconds
[0m13:10:19.732942 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m13:10:19.734037 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m13:10:19.734345 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:10:19.734598 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:10:19.734858 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:10:19.735089 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:10:19.735341 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m13:10:19.736184 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m13:10:19.736436 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m13:10:19.737263 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m13:10:19.737575 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:10:19.737854 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:10:19.738082 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m13:10:19.738295 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m13:10:19.740986 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m13:10:19.741312 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m13:10:19.746882 [debug] [Thread-4  ]: SQL status: COMMIT in 0.008 seconds
[0m13:10:19.746639 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_order_items__dbt_backup"
[0m13:10:19.747221 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m13:10:19.749644 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_orders__dbt_backup"
[0m13:10:19.752079 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_products__dbt_backup"
[0m13:10:19.755552 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:10:19.758041 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_customers__dbt_backup"
[0m13:10:19.758522 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:10:19.758901 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:10:19.759168 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
drop view if exists "dbt_db_ex2"."public"."stg_order_items__dbt_backup" cascade
[0m13:10:19.759554 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:10:19.759811 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
drop view if exists "dbt_db_ex2"."public"."stg_orders__dbt_backup" cascade
[0m13:10:19.760068 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
drop view if exists "dbt_db_ex2"."public"."stg_products__dbt_backup" cascade
[0m13:10:19.760348 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
drop view if exists "dbt_db_ex2"."public"."stg_customers__dbt_backup" cascade
[0m13:10:19.763132 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.003 seconds
[0m13:10:19.763370 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m13:10:19.763595 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.003 seconds
[0m13:10:19.765249 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: Close
[0m13:10:19.765487 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.005 seconds
[0m13:10:19.766257 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: Close
[0m13:10:19.766970 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: Close
[0m13:10:19.767751 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: Close
[0m13:10:19.770642 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115b3b80>]}
[0m13:10:19.771029 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066bb3a0>]}
[0m13:10:19.771387 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11592dac0>]}
[0m13:10:19.771999 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11592df40>]}
[0m13:10:19.771769 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m13:10:19.772535 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m13:10:19.773520 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m13:10:19.772838 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m13:10:19.773904 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m13:10:19.773242 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m13:10:19.774367 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m13:10:19.774740 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m13:10:19.775041 [debug] [Thread-3  ]: Began running node model.ecommerce_test.dim_products
[0m13:10:19.775376 [debug] [Thread-2  ]: Began running node model.ecommerce_test.fct_orders
[0m13:10:19.775675 [info ] [Thread-3  ]: 5 of 7 START sql table model public.dim_products ............................... [RUN]
[0m13:10:19.776052 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_customers
[0m13:10:19.776346 [info ] [Thread-2  ]: 6 of 7 START sql table model public.fct_orders ................................. [RUN]
[0m13:10:19.776700 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.dim_products)
[0m13:10:19.777021 [info ] [Thread-1  ]: 7 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m13:10:19.777614 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.fct_orders)
[0m13:10:19.778109 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.dim_products
[0m13:10:19.778467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.dim_customers)
[0m13:10:19.778720 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.fct_orders
[0m13:10:19.781991 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m13:10:19.782259 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_customers
[0m13:10:19.785388 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m13:10:19.788667 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m13:10:19.789284 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_customers
[0m13:10:19.921237 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.fct_orders
[0m13:10:19.947624 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.dim_products
[0m13:10:19.995739 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_test.dim_customers"
[0m13:10:19.996858 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.fct_orders"
[0m13:10:19.999982 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.dim_products"
[0m13:10:20.001057 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:10:20.001372 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:10:20.001625 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:10:20.001860 [debug] [Thread-1  ]: On model.ecommerce_test.dim_customers: BEGIN
[0m13:10:20.002100 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: BEGIN
[0m13:10:20.002363 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: BEGIN
[0m13:10:20.002628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:20.002863 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:20.003131 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:20.025051 [debug] [Thread-2  ]: SQL status: BEGIN in 0.022 seconds
[0m13:10:20.025438 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m13:10:20.025713 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:10:20.026097 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:10:20.026499 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */

  
    

  create  table "dbt_db_ex2"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

with orders as (
    select * from "dbt_db_ex2"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db_ex2"."public"."stg_order_items"
),

order_totals as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(quantity * unit_price) as total_amount
    from order_items
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        coalesce(ot.total_items, 0) as total_items,
        coalesce(ot.total_amount, 0) as total_amount,
        o.created_at,
        current_timestamp as updated_at,
        o._invocation_id
    from orders o
    left join order_totals ot on o.order_id = ot.order_id
)

select * from final
  );
  
[0m13:10:20.027312 [debug] [Thread-3  ]: SQL status: BEGIN in 0.024 seconds
[0m13:10:20.028162 [debug] [Thread-1  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex2"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as lifetime_orders,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1
),

final as (
    select
        c.customer_id,
        c.name,
        c.email,
        c.created_at,
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        current_timestamp as updated_at
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
  );
  
[0m13:10:20.028767 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:10:20.030066 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex2"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(quantity * unit_price) as total_revenue
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

final as (
    select
        p.product_id,
        p.name,
        p.price,
        p.category,
        p.created_at,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_revenue, 0) as total_revenue,
        current_timestamp as updated_at
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
  );
  
[0m13:10:20.041669 [debug] [Thread-3  ]: SQL status: SELECT 4 in 0.011 seconds
[0m13:10:20.042037 [debug] [Thread-2  ]: SQL status: SELECT 3 in 0.013 seconds
[0m13:10:20.047705 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.019 seconds
[0m13:10:20.051407 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:10:20.055093 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:10:20.058697 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:10:20.059066 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m13:10:20.059348 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:10:20.059606 [debug] [Thread-1  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:10:20.060664 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:10:20.060965 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:10:20.061203 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:10:20.064119 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:10:20.067466 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:10:20.070639 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:10:20.070981 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:10:20.071237 [debug] [Thread-1  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:10:20.071475 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:10:20.073748 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:10:20.074093 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:10:20.075032 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m13:10:20.075394 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:10:20.076208 [debug] [Thread-1  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m13:10:20.076483 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:10:20.077237 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: COMMIT
[0m13:10:20.077494 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:10:20.077732 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m13:10:20.077964 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:10:20.078189 [debug] [Thread-1  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m13:10:20.078532 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: COMMIT
[0m13:10:20.079319 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m13:10:20.081699 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."fct_orders__dbt_backup"
[0m13:10:20.083352 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:10:20.083682 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m13:10:20.083983 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
drop table if exists "dbt_db_ex2"."public"."fct_orders__dbt_backup" cascade
[0m13:10:20.084232 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m13:10:20.086588 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_customers__dbt_backup"
[0m13:10:20.089565 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_products__dbt_backup"
[0m13:10:20.089852 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:10:20.090221 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:10:20.090587 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:10:20.091432 [debug] [Thread-2  ]: On model.ecommerce_test.fct_orders: Close
[0m13:10:20.091674 [debug] [Thread-1  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
drop table if exists "dbt_db_ex2"."public"."dim_customers__dbt_backup" cascade
[0m13:10:20.091920 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
drop table if exists "dbt_db_ex2"."public"."dim_products__dbt_backup" cascade
[0m13:10:20.092338 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115989220>]}
[0m13:10:20.092863 [info ] [Thread-2  ]: 6 of 7 OK created sql table model public.fct_orders ............................ [[32mSELECT 3[0m in 0.31s]
[0m13:10:20.093284 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.fct_orders
[0m13:10:20.096847 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:10:20.097222 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:10:20.098189 [debug] [Thread-3  ]: On model.ecommerce_test.dim_products: Close
[0m13:10:20.099294 [debug] [Thread-1  ]: On model.ecommerce_test.dim_customers: Close
[0m13:10:20.099855 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11592dac0>]}
[0m13:10:20.101402 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bbb242c-f3fa-4f2b-8e31-b2a11686fc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11172ab50>]}
[0m13:10:20.100684 [info ] [Thread-3  ]: 5 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.32s]
[0m13:10:20.102518 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.dim_products
[0m13:10:20.102093 [info ] [Thread-1  ]: 7 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.32s]
[0m13:10:20.103216 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_customers
[0m13:10:20.104062 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:20.104299 [debug] [MainThread]: On master: BEGIN
[0m13:10:20.104499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:20.113087 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:10:20.113480 [debug] [MainThread]: On master: COMMIT
[0m13:10:20.113771 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:20.114079 [debug] [MainThread]: On master: COMMIT
[0m13:10:20.114619 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:10:20.114852 [debug] [MainThread]: On master: Close
[0m13:10:20.115165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:20.115360 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_customers' was properly closed.
[0m13:10:20.115539 [debug] [MainThread]: Connection 'model.ecommerce_test.fct_orders' was properly closed.
[0m13:10:20.115712 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_products' was properly closed.
[0m13:10:20.115884 [debug] [MainThread]: Connection 'model.ecommerce_test.stg_products' was properly closed.
[0m13:10:20.116163 [info ] [MainThread]: 
[0m13:10:20.116390 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m13:10:20.117287 [debug] [MainThread]: Command end result
[0m13:10:20.149636 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:10:20.151140 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:10:20.155887 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:10:20.156182 [info ] [MainThread]: 
[0m13:10:20.156448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:20.156659 [info ] [MainThread]: 
[0m13:10:20.156870 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:10:20.158082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.475492, "process_in_blocks": "0", "process_kernel_time": 0.182598, "process_mem_max_rss": "127188992", "process_out_blocks": "0", "process_user_time": 1.871806}
[0m13:10:20.158391 [debug] [MainThread]: Command `dbt run` succeeded at 13:10:20.158336 after 1.48 seconds
[0m13:10:20.158644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ca730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078bedf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102fa670>]}
[0m13:10:20.158907 [debug] [MainThread]: Flushing usage events
[0m13:10:21.419982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:22.494769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c22790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a9af10>]}


============================== 13:10:22.497265 | 4f59380f-8409-469c-a6a2-59e2ffed3d27 ==============================
[0m13:10:22.497265 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:10:22.497619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --store-failures', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:10:22.617611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f59380f-8409-469c-a6a2-59e2ffed3d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442dee0>]}
[0m13:10:22.663274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f59380f-8409-469c-a6a2-59e2ffed3d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a71a90>]}
[0m13:10:22.663811 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:10:22.742295 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:10:22.855903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:10:22.856224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:10:22.861437 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:10:22.923044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f59380f-8409-469c-a6a2-59e2ffed3d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788cdc0>]}
[0m13:10:23.008191 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:10:23.010573 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:10:23.023669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f59380f-8409-469c-a6a2-59e2ffed3d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d1d90>]}
[0m13:10:23.024027 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m13:10:23.024240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f59380f-8409-469c-a6a2-59e2ffed3d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b9640>]}
[0m13:10:23.025832 [info ] [MainThread]: 
[0m13:10:23.026049 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:10:23.026228 [info ] [MainThread]: 
[0m13:10:23.026516 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:23.030081 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m13:10:23.054831 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m13:10:23.055109 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m13:10:23.055295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:23.076209 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.021 seconds
[0m13:10:23.077119 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m13:10:23.079579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m13:10:23.079978 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m13:10:23.085740 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:10:23.088282 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:10:23.088565 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m13:10:23.088767 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m13:10:23.088959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:10:23.089137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:23.098760 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:10:23.100454 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:10:23.100723 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:10:23.102409 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:10:23.102668 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:10:23.102902 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:10:23.104442 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m13:10:23.105539 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m13:10:23.105796 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.003 seconds
[0m13:10:23.107374 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m13:10:23.107600 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m13:10:23.108983 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m13:10:23.118832 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:23.119138 [debug] [MainThread]: On master: BEGIN
[0m13:10:23.119344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:23.127318 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:10:23.127630 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:23.127893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:10:23.170207 [debug] [MainThread]: SQL status: SELECT 4 in 0.042 seconds
[0m13:10:23.171895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f59380f-8409-469c-a6a2-59e2ffed3d27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d6bb0>]}
[0m13:10:23.172268 [debug] [MainThread]: On master: ROLLBACK
[0m13:10:23.172885 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:23.173184 [debug] [MainThread]: On master: BEGIN
[0m13:10:23.173975 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.174275 [debug] [MainThread]: On master: COMMIT
[0m13:10:23.174533 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:23.174771 [debug] [MainThread]: On master: COMMIT
[0m13:10:23.175322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:10:23.175575 [debug] [MainThread]: On master: Close
[0m13:10:23.177697 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:10:23.178078 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:10:23.178654 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:10:23.179194 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:10:23.178404 [info ] [Thread-1  ]: 1 of 25 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m13:10:23.178980 [info ] [Thread-2  ]: 2 of 25 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m13:10:23.179557 [info ] [Thread-3  ]: 3 of 25 START test assert_no_duplicate_orders .................................. [RUN]
[0m13:10:23.179890 [info ] [Thread-4  ]: 4 of 25 START test assert_total_amount_equals_sum_of_items ..................... [RUN]
[0m13:10:23.180373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:10:23.180702 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:10:23.181063 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_no_duplicate_orders'
[0m13:10:23.181397 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_total_amount_equals_sum_of_items'
[0m13:10:23.181671 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:10:23.181931 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:10:23.182180 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m13:10:23.182428 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:10:23.203564 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:10:23.204568 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:10:23.207411 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:10:23.210070 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:10:23.210664 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m13:10:23.210931 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:10:23.217211 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:10:23.217454 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:10:23.234441 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:10:23.230106 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:10:23.234885 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m13:10:23.239161 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m13:10:23.242528 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:10:23.243029 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:10:23.243412 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:10:23.243928 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:10:23.244226 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m13:10:23.244486 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m13:10:23.244722 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders" cascade
[0m13:10:23.244957 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items" cascade
[0m13:10:23.245185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:23.245399 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:23.245610 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:10:23.245813 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:10:23.258752 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.013 seconds
[0m13:10:23.259171 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:10:23.259414 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:10:23.259638 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:10:23.261439 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:10:23.262090 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:10:23.262701 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m13:10:23.263291 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m13:10:23.271427 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:10:23.271868 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:10:23.272297 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:10:23.272706 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:10:23.272943 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:10:23.273167 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:10:23.273378 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m13:10:23.273591 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m13:10:23.274320 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.274587 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.274827 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:10:23.275049 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.275281 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:10:23.275486 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m13:10:23.275737 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
  
  
    as
  
  (
    /*
  Custom test to check if the total amount in orders table
  matches the sum of the item amounts in order_items.
  
  If there are differences, this test will return the records with discrepancies.
*/

with orders as (
    select 
        order_id,
        total_amount as order_total
    from "dbt_db_ex2"."public"."fct_orders"
),

order_items_grouped as (
    select
        order_id,
        sum(quantity * unit_price) as items_total
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

joined as (
    select
        o.order_id,
        o.order_total,
        coalesce(oi.items_total, 0) as items_total,
        abs(o.order_total - coalesce(oi.items_total, 0)) as difference
    from orders o
    left join order_items_grouped oi on o.order_id = oi.order_id
)

select * from joined where difference > 0.01  -- Allow small rounding differences
  );
  
    
[0m13:10:23.275989 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:10:23.276223 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m13:10:23.276449 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:10:23.276726 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m13:10:23.277088 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  
  
    as
  
  (
    /*
  Custom test to ensure there are no duplicate orders in the core table.
  This test checks for duplicates based on customer_id and order_date within 15 minutes
*/

with orders as (
    select 
        customer_id,
        order_date,
        count(*) as order_count
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1, 2
),

potential_duplicates as (
    select
        o1.customer_id,
        o1.order_date as order_date_1,
        o2.order_date as order_date_2,
        abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) as minutes_difference
    from "dbt_db_ex2"."public"."stg_orders" o1
    join "dbt_db_ex2"."public"."stg_orders" o2
        on o1.customer_id = o2.customer_id
        and o1.order_id <> o2.order_id
        and abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) < 15  -- Orders less than 15 minutes apart
)

select * from potential_duplicates
  );
  
    
[0m13:10:23.280333 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:10:23.281013 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:10:23.281276 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:10:23.281588 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:10:23.281827 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:10:23.282423 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:10:23.282717 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:10:23.282948 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:10:23.284520 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.008 seconds
[0m13:10:23.284770 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m13:10:23.285348 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m13:10:23.285614 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:10:23.288357 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:10:23.288642 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.011 seconds
[0m13:10:23.288878 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:10:23.289289 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:10:23.289953 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m13:10:23.290235 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m13:10:23.290569 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:10:23.290856 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:10:23.291274 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m13:10:23.291616 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:10:23.291872 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:10:23.292155 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:10:23.292709 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.292957 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.293200 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:10:23.293455 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:10:23.293733 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m13:10:23.294040 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m13:10:23.294291 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m13:10:23.294513 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m13:10:23.294989 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:10:23.295283 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.295641 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:10:23.295875 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.298730 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m13:10:23.299823 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m13:10:23.300147 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:10:23.300401 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m13:10:23.300653 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m13:10:23.300897 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:10:23.301123 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m13:10:23.301770 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.302052 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m13:10:23.301548 [info ] [Thread-2  ]: 2 of 25 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.12s]
[0m13:10:23.302495 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:10:23.302965 [info ] [Thread-1  ]: 1 of 25 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.12s]
[0m13:10:23.303506 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:10:23.303783 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
    
      
    ) dbt_internal_test
[0m13:10:23.304197 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:10:23.304461 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.304720 [debug] [Thread-2  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:10:23.305060 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:10:23.305325 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:10:23.305566 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.305800 [info ] [Thread-2  ]: 5 of 25 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m13:10:23.306063 [info ] [Thread-1  ]: 6 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m13:10:23.306321 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
    
      
    ) dbt_internal_test
[0m13:10:23.307242 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: ROLLBACK
[0m13:10:23.307546 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:10:23.307806 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:10:23.308106 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:10:23.308336 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: Close
[0m13:10:23.308564 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.308780 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:10:23.321284 [info ] [Thread-4  ]: 4 of 25 PASS assert_total_amount_equals_sum_of_items ........................... [[32mPASS[0m in 0.14s]
[0m13:10:23.322319 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: ROLLBACK
[0m13:10:23.321000 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:10:23.327439 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:10:23.327824 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:10:23.328490 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:10:23.328741 [info ] [Thread-4  ]: 7 of 25 START test not_null_dim_customers_email ................................ [RUN]
[0m13:10:23.329023 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m13:10:23.329245 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:10:23.332271 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:10:23.332677 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: Close
[0m13:10:23.332938 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:10:23.338435 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:10:23.338857 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:10:23.339119 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:10:23.339688 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m13:10:23.339486 [error] [Thread-3  ]: 3 of 25 FAIL 2 assert_no_duplicate_orders ...................................... [[31mFAIL 2[0m in 0.16s]
[0m13:10:23.344051 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m13:10:23.344307 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:10:23.344575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:23.344925 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:10:23.345364 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:10:23.350536 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:10:23.351039 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:10:23.351358 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3" cascade
[0m13:10:23.351962 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:10:23.352296 [info ] [Thread-3  ]: 8 of 25 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m13:10:23.352837 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:23.353127 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m13:10:23.353463 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:10:23.353829 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:23.354109 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:10:23.392152 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:10:23.392518 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.039 seconds
[0m13:10:23.393358 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:10:23.393957 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:10:23.394290 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:10:23.394606 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.042 seconds
[0m13:10:23.394853 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.050 seconds
[0m13:10:23.395896 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m13:10:23.396243 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:10:23.396497 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.397233 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:10:23.397849 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:10:23.403373 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:10:23.403610 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:10:23.404489 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:10:23.404952 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m13:10:23.405479 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:10:23.406286 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where email is null



  );
  
    
[0m13:10:23.406571 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:10:23.406919 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m13:10:23.407312 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:23.407799 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.408298 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:10:23.408581 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
  
  
    as
  
  (
    




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(email, '^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$', '')), 1), 0)


 > 0
 as expression


    from "dbt_db_ex2"."public"."dim_customers"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  );
  
    
[0m13:10:23.409044 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m13:10:23.409305 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:10:23.410704 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m13:10:23.414021 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:10:23.414928 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m13:10:23.415246 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:10:23.415517 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m13:10:23.418289 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.011 seconds
[0m13:10:23.419490 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:10:23.419836 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m13:10:23.420227 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:10:23.420555 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.009 seconds
[0m13:10:23.421049 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:10:23.421579 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:10:23.422490 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:10:23.422752 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.015 seconds
[0m13:10:23.423226 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:10:23.424037 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:10:23.424577 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:10:23.424859 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:10:23.425654 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:10:23.426158 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m13:10:23.426439 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m13:10:23.426741 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:10:23.427423 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:10:23.427734 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.430395 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:10:23.430824 [debug] [Thread-3  ]: SQL status: BEGIN in 0.003 seconds
[0m13:10:23.431134 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:10:23.431512 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:10:23.431874 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:10:23.432384 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
    
      
    ) dbt_internal_test
[0m13:10:23.433737 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m13:10:23.435539 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m13:10:23.436575 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m13:10:23.438221 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:10:23.438851 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:10:23.440590 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.003 seconds
[0m13:10:23.443463 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:10:23.445005 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:10:23.446790 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: ROLLBACK
[0m13:10:23.447234 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:10:23.447667 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.010 seconds
[0m13:10:23.448597 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:10:23.448890 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.449154 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:10:23.449386 [debug] [Thread-2  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: Close
[0m13:10:23.449641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m13:10:23.450523 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m13:10:23.450777 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:10:23.451562 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:10:23.451306 [info ] [Thread-2  ]: 5 of 25 PASS dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[32mPASS[0m in 0.14s]
[0m13:10:23.452323 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:10:23.452602 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: Close
[0m13:10:23.452964 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:10:23.453439 [info ] [Thread-4  ]: 7 of 25 PASS not_null_dim_customers_email ...................................... [[32mPASS[0m in 0.12s]
[0m13:10:23.453758 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:10:23.454069 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.454390 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:10:23.454673 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m13:10:23.454949 [info ] [Thread-2  ]: 9 of 25 START test not_null_dim_customers_name ................................. [RUN]
[0m13:10:23.455916 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:10:23.456195 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:10:23.456648 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:10:23.456935 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m13:10:23.457217 [info ] [Thread-4  ]: 10 of 25 START test not_null_dim_products_name ................................. [RUN]
[0m13:10:23.457550 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:10:23.457780 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:10:23.458040 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m13:10:23.462423 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:10:23.462737 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:10:23.462993 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:10:23.463348 [info ] [Thread-1  ]: 6 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.16s]
[0m13:10:23.463689 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:10:23.467325 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:10:23.467765 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:10:23.468115 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:10:23.468370 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:10:23.468604 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.473003 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:10:23.473233 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:10:23.473482 [info ] [Thread-1  ]: 11 of 25 START test not_null_dim_products_price ................................ [RUN]
[0m13:10:23.473734 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:10:23.474088 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:10:23.483827 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:10:23.484854 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m13:10:23.485233 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m13:10:23.485639 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m13:10:23.486379 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:10:23.486820 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:10:23.487450 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:23.487902 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m13:10:23.491922 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:10:23.492283 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.005 seconds
[0m13:10:23.492681 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:23.493890 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m13:10:23.494535 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:10:23.500093 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:10:23.500420 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m13:10:23.500851 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:10:23.501207 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m13:10:23.501859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:23.501643 [info ] [Thread-3  ]: 8 of 25 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.15s]
[0m13:10:23.502466 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:10:23.502745 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:10:23.503171 [info ] [Thread-3  ]: 12 of 25 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:10:23.503675 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m13:10:23.503964 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:10:23.504184 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.017 seconds
[0m13:10:23.504411 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:10:23.505407 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:10:23.506066 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:10:23.510100 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:10:23.510736 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:10:23.511193 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:10:23.511523 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:10:23.511794 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.010 seconds
[0m13:10:23.511999 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:10:23.512767 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:10:23.513022 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.513266 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:10:23.513515 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.513944 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:10:23.514184 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:10:23.518472 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:10:23.518709 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:10:23.518933 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:10:23.519169 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where name is null



  );
  
    
[0m13:10:23.519539 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:10:23.519784 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where name is null



  );
  
    
[0m13:10:23.520082 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m13:10:23.520371 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:23.520611 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.520922 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:10:23.521181 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where price is null



  );
  
    
[0m13:10:23.527051 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:10:23.527817 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:10:23.528096 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:10:23.528345 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.008 seconds
[0m13:10:23.528597 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:10:23.528853 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:10:23.529440 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:10:23.529702 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.009 seconds
[0m13:10:23.530277 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:10:23.530567 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:10:23.531265 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:10:23.531542 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:10:23.531788 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:10:23.532023 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m13:10:23.532488 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:10:23.532719 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:10:23.533100 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:10:23.533344 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:10:23.533816 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:10:23.534149 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.534375 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:10:23.534613 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:10:23.534936 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where product_id is null



  );
  
    
[0m13:10:23.535410 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m13:10:23.535651 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.536061 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:10:23.536329 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:10:23.536764 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m13:10:23.537054 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:10:23.537472 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:10:23.537786 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:10:23.538036 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.538260 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:10:23.539208 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m13:10:23.539720 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:10:23.539950 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: Close
[0m13:10:23.540185 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.540407 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:10:23.540622 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:10:23.541188 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:10:23.540999 [info ] [Thread-2  ]: 9 of 25 PASS not_null_dim_customers_name ....................................... [[32mPASS[0m in 0.08s]
[0m13:10:23.541855 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:10:23.542156 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m13:10:23.542409 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.542739 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:10:23.542982 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:10:23.543241 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:10:23.543502 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:10:23.543781 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.543997 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:10:23.544234 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m13:10:23.544497 [info ] [Thread-2  ]: 13 of 25 START test not_null_dim_products_total_quantity_sold .................. [RUN]
[0m13:10:23.545449 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m13:10:23.545799 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m13:10:23.546181 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:10:23.550179 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:10:23.550490 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m13:10:23.550720 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: Close
[0m13:10:23.550947 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m13:10:23.551388 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:10:23.552782 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m13:10:23.553021 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:10:23.551847 [info ] [Thread-4  ]: 10 of 25 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.09s]
[0m13:10:23.558330 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m13:10:23.558759 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:10:23.559011 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: Close
[0m13:10:23.559474 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:10:23.559764 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:10:23.560029 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:10:23.560337 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold" cascade
[0m13:10:23.560741 [info ] [Thread-1  ]: 11 of 25 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.08s]
[0m13:10:23.561221 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:10:23.560963 [info ] [Thread-4  ]: 14 of 25 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m13:10:23.561512 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:23.561844 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:10:23.562154 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m13:10:23.562437 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.562761 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:10:23.563026 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:10:23.563276 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:10:23.563547 [info ] [Thread-1  ]: 15 of 25 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:10:23.567137 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:10:23.567459 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:10:23.567763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:10:23.568142 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:10:23.571433 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:10:23.571815 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m13:10:23.572828 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:10:23.573172 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:10:23.573828 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m13:10:23.574072 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:10:23.574293 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:10:23.574738 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:10:23.574951 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:10:23.579937 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m13:10:23.584071 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:10:23.584332 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m13:10:23.584722 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:10:23.585081 [info ] [Thread-3  ]: 12 of 25 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.08s]
[0m13:10:23.585459 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:10:23.585759 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue" cascade
[0m13:10:23.586147 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:10:23.586402 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.586659 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m13:10:23.586910 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:23.587166 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:10:23.587385 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:10:23.587626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:23.587951 [info ] [Thread-3  ]: 16 of 25 START test not_null_fct_orders_order_date ............................. [RUN]
[0m13:10:23.588255 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_quantity_sold is null



  );
  
    
[0m13:10:23.588653 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m13:10:23.588986 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:10:23.592881 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:10:23.593542 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:10:23.598612 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:10:23.598941 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.010 seconds
[0m13:10:23.599680 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:10:23.600427 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m13:10:23.600717 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m13:10:23.600988 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.013 seconds
[0m13:10:23.601228 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:10:23.601483 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:10:23.601714 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:23.602391 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:10:23.602993 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m13:10:23.603230 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m13:10:23.603782 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:10:23.604334 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:10:23.604630 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:10:23.604881 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m13:10:23.605710 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.606035 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:10:23.606303 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_revenue is null



  );
  
    
[0m13:10:23.606580 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.606825 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:10:23.607056 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m13:10:23.607980 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m13:10:23.608439 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:10:23.609409 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:10:23.609672 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m13:10:23.610133 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.610367 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:10:23.610644 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
    
      
    ) dbt_internal_test
[0m13:10:23.611472 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.612529 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: ROLLBACK
[0m13:10:23.612811 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:10:23.613440 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m13:10:23.613714 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:10:23.613961 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:10:23.614176 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: Close
[0m13:10:23.614386 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m13:10:23.614589 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:10:23.615208 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:10:23.615600 [info ] [Thread-2  ]: 13 of 25 PASS not_null_dim_products_total_quantity_sold ........................ [[32mPASS[0m in 0.07s]
[0m13:10:23.616258 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:10:23.616830 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:10:23.617216 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:10:23.617527 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:10:23.617962 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:10:23.618225 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m13:10:23.618572 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:10:23.618858 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:10:23.619322 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:10:23.619579 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.619809 [info ] [Thread-2  ]: 17 of 25 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:10:23.620165 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:10:23.620454 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m13:10:23.620737 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_date is null



  );
  
    
[0m13:10:23.621021 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:10:23.621261 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:10:23.621486 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:10:23.621730 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m13:10:23.625361 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:10:23.625663 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:10:23.626034 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:10:23.626767 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:10:23.627032 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.627360 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:10:23.627627 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:10:23.627925 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:10:23.628176 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:10:23.628450 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:10:23.628767 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
    
      
    ) dbt_internal_test
[0m13:10:23.629175 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:10:23.634417 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:10:23.634703 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m13:10:23.635135 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:10:23.635393 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.635757 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:10:23.635972 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.636218 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m13:10:23.636465 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:10:23.637415 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m13:10:23.637677 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:23.637946 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m13:10:23.638372 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:10:23.638617 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m13:10:23.638867 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:10:23.639347 [info ] [Thread-4  ]: 14 of 25 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.08s]
[0m13:10:23.639907 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.640286 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:10:23.641275 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:10:23.641515 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m13:10:23.641798 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:10:23.642130 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:10:23.642362 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:10:23.642620 [info ] [Thread-4  ]: 18 of 25 START test not_null_fct_orders_status ................................. [RUN]
[0m13:10:23.642893 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m13:10:23.643527 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m13:10:23.643298 [info ] [Thread-1  ]: 15 of 25 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.08s]
[0m13:10:23.643883 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:10:23.644218 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:10:23.647919 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:10:23.648234 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m13:10:23.648509 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:10:23.649628 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m13:10:23.649936 [info ] [Thread-1  ]: 19 of 25 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m13:10:23.650268 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.013 seconds
[0m13:10:23.650556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:10:23.650762 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: Close
[0m13:10:23.650963 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:10:23.651585 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:10:23.651809 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:10:23.652144 [info ] [Thread-3  ]: 16 of 25 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.06s]
[0m13:10:23.656617 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:10:23.657085 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:10:23.660936 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:10:23.661349 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:10:23.661720 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:10:23.661954 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:10:23.662317 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:10:23.662555 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m13:10:23.662904 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:10:23.663136 [info ] [Thread-3  ]: 20 of 25 START test not_null_fct_orders_total_items ............................ [RUN]
[0m13:10:23.663382 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.663588 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:23.667835 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:10:23.668135 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m13:10:23.668375 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:10:23.668857 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:10:23.671699 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:10:23.672006 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_id is null



  );
  
    
[0m13:10:23.672271 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m13:10:23.675629 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:10:23.675965 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:23.676685 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:10:23.681915 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m13:10:23.682210 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.019 seconds
[0m13:10:23.682450 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:10:23.682852 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:10:23.683646 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:10:23.684268 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:10:23.684519 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items" cascade
[0m13:10:23.684746 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.009 seconds
[0m13:10:23.685204 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:10:23.685439 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:10:23.685660 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:23.686286 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:10:23.686508 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m13:10:23.686733 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:10:23.687231 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:10:23.687678 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:10:23.688181 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.688733 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:10:23.689192 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.689477 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where status is null



  );
  
    
[0m13:10:23.689745 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:10:23.690005 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m13:10:23.690258 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m13:10:23.690727 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:10:23.691261 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:10:23.691545 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:10:23.692098 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.692323 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:10:23.692553 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:10:23.693278 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:10:23.694243 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:10:23.694549 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:10:23.694799 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:10:23.695388 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m13:10:23.695651 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:10:23.695954 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:10:23.696345 [info ] [Thread-2  ]: 17 of 25 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m13:10:23.697001 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:10:23.697292 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:10:23.697523 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m13:10:23.697872 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:10:23.698105 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:10:23.698780 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m13:10:23.699085 [debug] [Thread-2  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:10:23.699360 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:10:23.699828 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:10:23.700099 [info ] [Thread-2  ]: 21 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m13:10:23.700407 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m13:10:23.700634 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m13:10:23.700919 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:10:23.701620 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:10:23.702150 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.702384 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:10:23.702685 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:10:23.702908 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:10:23.708911 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:10:23.709228 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_items is null



  );
  
    
[0m13:10:23.709521 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:10:23.709895 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:10:23.710207 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m13:10:23.710564 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:10:23.710842 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.715887 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:10:23.716202 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:10:23.716481 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:10:23.716693 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:10:23.717067 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:10:23.717688 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m13:10:23.717930 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:10:23.718168 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m13:10:23.718414 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m13:10:23.718656 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:10:23.718944 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:23.719197 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m13:10:23.719444 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.719674 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.720015 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:10:23.720998 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: ROLLBACK
[0m13:10:23.721311 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m13:10:23.721901 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: Close
[0m13:10:23.722189 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m13:10:23.722459 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.723211 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:10:23.724891 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m13:10:23.723890 [info ] [Thread-4  ]: 18 of 25 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.08s]
[0m13:10:23.725444 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:10:23.725684 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m13:10:23.725966 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:10:23.726435 [info ] [Thread-1  ]: 19 of 25 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.08s]
[0m13:10:23.727085 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:10:23.727432 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:10:23.726674 [info ] [Thread-4  ]: 22 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:10:23.727760 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m13:10:23.728074 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:10:23.728434 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:10:23.728947 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.728733 [info ] [Thread-1  ]: 23 of 25 START test unique_dim_customers_email ................................. [RUN]
[0m13:10:23.729250 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:10:23.729495 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:10:23.729717 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:10:23.729977 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m13:10:23.735205 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:10:23.736116 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:10:23.736407 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
    
      
    ) dbt_internal_test
[0m13:10:23.736690 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:10:23.737433 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:10:23.740883 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:10:23.741166 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:10:23.741399 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m13:10:23.741631 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:10:23.745867 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:10:23.746737 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: ROLLBACK
[0m13:10:23.747171 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:10:23.747422 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:10:23.747686 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.747921 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: Close
[0m13:10:23.748169 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m13:10:23.790985 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:10:23.791263 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:10:23.791679 [info ] [Thread-3  ]: 20 of 25 PASS not_null_fct_orders_total_items .................................. [[32mPASS[0m in 0.12s]
[0m13:10:23.791946 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:10:23.792310 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:10:23.792563 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex2"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex2"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:10:23.792936 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:10:23.793298 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m13:10:23.793636 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:10:23.793921 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:10:23.794176 [info ] [Thread-3  ]: 24 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m13:10:23.794569 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m13:10:23.794816 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:10:23.798347 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:10:23.798656 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:10:23.799324 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:10:23.799603 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:10:23.799838 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:10:23.800178 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:10:23.804669 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:10:23.805132 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:10:23.805577 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m13:10:23.805839 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m13:10:23.806314 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:10:23.806570 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:10:23.806836 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.013 seconds
[0m13:10:23.807112 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.015 seconds
[0m13:10:23.808523 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:10:23.809195 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:10:23.809727 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:10:23.810179 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:10:23.810447 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:10:23.810694 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:10:23.810961 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:10:23.811189 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:10:23.811762 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.812020 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.812238 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:10:23.812461 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.812684 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:10:23.812927 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m13:10:23.813178 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:10:23.813438 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m13:10:23.813729 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m13:10:23.814235 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.815842 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m13:10:23.816110 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.010 seconds
[0m13:10:23.820480 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:10:23.820991 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:10:23.821242 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:10:23.821467 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:10:23.821679 [debug] [Thread-2  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m13:10:23.822263 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:10:23.822529 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.009 seconds
[0m13:10:23.822819 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.823216 [info ] [Thread-2  ]: 21 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.12s]
[0m13:10:23.823520 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:10:23.824129 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:10:23.824380 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:10:23.824743 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:10:23.824995 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:10:23.825238 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:10:23.825481 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m13:10:23.825746 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:10:23.826030 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:10:23.826327 [info ] [Thread-2  ]: 25 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m13:10:23.826684 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m13:10:23.826935 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:10:23.830474 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:10:23.830762 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:10:23.830991 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m13:10:23.831259 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m13:10:23.832011 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:10:23.832533 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:10:23.832933 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:10:23.833185 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:10:23.833424 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:10:23.833751 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:10:23.838108 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:10:23.838395 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:10:23.838695 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:10:23.839059 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:10:23.839309 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:10:23.839548 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:10:23.839779 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m13:10:23.839997 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m13:10:23.840533 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:10:23.840778 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.841018 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.841231 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:10:23.841494 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:10:23.841723 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:10:23.842060 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:10:23.842333 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:10:23.842572 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:10:23.842862 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:10:23.843404 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.843794 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:10:23.844974 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m13:10:23.845231 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:10:23.845489 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:10:23.846367 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:10:23.846622 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:10:23.846853 [debug] [Thread-1  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: Close
[0m13:10:23.847347 [info ] [Thread-1  ]: 23 of 25 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.12s]
[0m13:10:23.847624 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:10:23.847954 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:10:23.848211 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:10:23.848612 [info ] [Thread-4  ]: 22 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.12s]
[0m13:10:23.849740 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:10:23.850166 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:10:23.850656 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:10:23.851302 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.010 seconds
[0m13:10:23.851091 [info ] [Thread-3  ]: 24 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.06s]
[0m13:10:23.852128 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:10:23.852484 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:10:23.852974 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:10:23.853302 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:10:23.853853 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.854107 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:10:23.854349 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m13:10:23.856523 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:10:23.857108 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:10:23.857348 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:10:23.857564 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:10:23.858754 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m13:10:23.859147 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:10:23.859603 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:10:23.859825 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:10:23.860217 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:10:23.860437 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:10:23.860664 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:10:23.861378 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:10:23.862254 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m13:10:23.862667 [debug] [Thread-2  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m13:10:23.863039 [info ] [Thread-2  ]: 25 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m13:10:23.863389 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:10:23.864177 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:23.864392 [debug] [MainThread]: On master: BEGIN
[0m13:10:23.864572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:23.871120 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:10:23.871361 [debug] [MainThread]: On master: COMMIT
[0m13:10:23.871552 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:23.871730 [debug] [MainThread]: On master: COMMIT
[0m13:10:23.872222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:10:23.872427 [debug] [MainThread]: On master: Close
[0m13:10:23.872705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:23.872895 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m13:10:23.873073 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m13:10:23.873244 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m13:10:23.873409 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m13:10:23.873644 [info ] [MainThread]: 
[0m13:10:23.873857 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m13:10:23.876098 [debug] [MainThread]: Command end result
[0m13:10:23.928318 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:10:23.929763 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:10:23.938177 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:10:23.938829 [info ] [MainThread]: 
[0m13:10:23.939111 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:10:23.939449 [info ] [MainThread]: 
[0m13:10:23.939772 [error] [MainThread]: [31mFailure in test assert_no_duplicate_orders (tests/assert_no_duplicate_orders.sql)[0m
[0m13:10:23.940118 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m13:10:23.940335 [info ] [MainThread]: 
[0m13:10:23.940575 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/tests/assert_no_duplicate_orders.sql
[0m13:10:23.940769 [info ] [MainThread]: 
[0m13:10:23.940996 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  --------------------------------------------------------------------------------
[0m13:10:23.941218 [info ] [MainThread]: 
[0m13:10:23.941431 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=1 SKIP=0 TOTAL=25
[0m13:10:23.942977 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.496947, "process_in_blocks": "0", "process_kernel_time": 0.191711, "process_mem_max_rss": "132415488", "process_out_blocks": "0", "process_user_time": 2.124081}
[0m13:10:23.943732 [debug] [MainThread]: Command `dbt test` failed at 13:10:23.943650 after 1.50 seconds
[0m13:10:23.944061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c22790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d66d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d6a90>]}
[0m13:10:23.944418 [debug] [MainThread]: Flushing usage events
[0m13:10:24.908796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:26.047550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075127c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10837adc0>]}


============================== 13:10:26.049973 | b1634b85-5ae9-421d-b5de-b974237edf7b ==============================
[0m13:10:26.049973 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:10:26.050352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:10:26.171007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1634b85-5ae9-421d-b5de-b974237edf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089b12e0>]}
[0m13:10:26.216587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1634b85-5ae9-421d-b5de-b974237edf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d5d60>]}
[0m13:10:26.217128 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:10:26.370722 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:10:26.488643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:10:26.488957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:10:26.494291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:10:26.558407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1634b85-5ae9-421d-b5de-b974237edf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109540eb0>]}
[0m13:10:26.567602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1634b85-5ae9-421d-b5de-b974237edf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109395a60>]}
[0m13:10:26.567923 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 810 macros
[0m13:10:26.568148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1634b85-5ae9-421d-b5de-b974237edf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109395a00>]}
[0m13:10:26.569549 [info ] [MainThread]: 
[0m13:10:26.569776 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:10:26.569968 [info ] [MainThread]: 
[0m13:10:26.570252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:26.574394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m13:10:26.574854 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m13:10:26.607766 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:10:26.608069 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:10:26.608271 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m13:10:26.608467 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m13:10:26.608649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:26.608826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:26.628896 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m13:10:26.629221 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m13:10:26.629458 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:10:26.629680 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:10:26.629916 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:10:26.630201 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:10:26.634654 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m13:10:26.634927 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.004 seconds
[0m13:10:26.636012 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m13:10:26.637702 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m13:10:26.638280 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m13:10:26.638526 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m13:10:26.649955 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:26.650235 [debug] [MainThread]: On master: BEGIN
[0m13:10:26.650442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:26.660338 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:10:26.660666 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:26.660953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:10:26.708954 [debug] [MainThread]: SQL status: SELECT 4 in 0.048 seconds
[0m13:10:26.710622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1634b85-5ae9-421d-b5de-b974237edf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109539250>]}
[0m13:10:26.710981 [debug] [MainThread]: On master: ROLLBACK
[0m13:10:26.711567 [debug] [MainThread]: On master: Close
[0m13:10:26.713257 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m13:10:26.713602 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m13:10:26.714078 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m13:10:26.714376 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m13:10:26.714688 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m13:10:26.715005 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m13:10:26.715302 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m13:10:26.715665 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m13:10:26.716013 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m13:10:26.716290 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m13:10:26.723936 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m13:10:26.724213 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m13:10:26.724474 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m13:10:26.727316 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m13:10:26.730229 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m13:10:26.733580 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m13:10:26.734159 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m13:10:26.734539 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m13:10:26.735154 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m13:10:26.735644 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m13:10:26.735900 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m13:10:26.736241 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m13:10:26.736744 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m13:10:26.737163 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m13:10:26.737691 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_customers
[0m13:10:26.737950 [debug] [Thread-2  ]: Began running node model.ecommerce_test.dim_products
[0m13:10:26.738269 [debug] [Thread-3  ]: Began running node model.ecommerce_test.fct_orders
[0m13:10:26.738563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.dim_customers)
[0m13:10:26.738821 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:10:26.739103 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.dim_products)
[0m13:10:26.739359 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.fct_orders)
[0m13:10:26.739598 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_customers
[0m13:10:26.739843 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now test.ecommerce_test.assert_no_duplicate_orders)
[0m13:10:26.740070 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.dim_products
[0m13:10:26.740295 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.fct_orders
[0m13:10:26.743579 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m13:10:26.743840 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m13:10:26.746772 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m13:10:26.749730 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m13:10:26.753183 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:10:26.753571 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_customers
[0m13:10:26.754076 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_customers
[0m13:10:26.754394 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.dim_products
[0m13:10:26.754625 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.fct_orders
[0m13:10:26.754994 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.dim_products
[0m13:10:26.755480 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.fct_orders
[0m13:10:26.755689 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m13:10:26.755927 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:10:26.756147 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:10:26.756419 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:10:26.756900 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:10:26.757243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_customers, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:10:26.757481 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_products, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:10:26.757722 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.fct_orders, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m13:10:26.757983 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:10:26.758249 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:10:26.758481 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:10:26.758703 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:10:26.758941 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:10:26.776596 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:10:26.777790 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:10:26.780800 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:10:26.781052 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:10:26.784720 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:10:26.785148 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:10:26.785547 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:10:26.785783 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:10:26.786018 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m13:10:26.786313 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:10:26.786538 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:10:26.786762 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:10:26.789782 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:10:26.790061 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:10:26.790440 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:10:26.790803 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:10:26.791222 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:10:26.791480 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:10:26.791752 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:10:26.791994 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:10:26.792214 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:10:26.792475 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:10:26.792715 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m13:10:26.793084 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:10:26.793343 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:10:26.793584 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:10:26.793809 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:10:26.794055 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:10:26.794313 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:10:26.798686 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:10:26.801614 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:10:26.801878 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m13:10:26.808994 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:10:26.809371 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:10:26.809693 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:10:26.812692 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:10:26.812955 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:10:26.813225 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:10:26.813641 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:10:26.814087 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:10:26.814464 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:10:26.814729 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:10:26.814996 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:10:26.815201 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:10:26.815462 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:10:26.815713 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_email.0472f7c2e8, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m13:10:26.815973 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m13:10:26.816351 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:10:26.816580 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m13:10:26.816813 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:10:26.817028 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:10:26.817261 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:10:26.817498 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:10:26.820596 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:10:26.823605 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:10:26.823900 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m13:10:26.826905 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:10:26.827263 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:10:26.827600 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:10:26.827825 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:10:26.831526 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:10:26.831990 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:10:26.832368 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:10:26.832642 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:10:26.832897 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:10:26.833187 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:10:26.833622 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:10:26.833863 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:10:26.834117 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m13:10:26.834382 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:10:26.834647 [debug] [Thread-1  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:10:26.835097 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:10:26.835335 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:10:26.835569 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:10:26.835835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.assert_total_amount_equals_sum_of_items)
[0m13:10:26.836096 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:10:26.839515 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:10:26.843885 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:10:26.844149 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:10:26.844421 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:10:26.847166 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:10:26.847434 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:10:26.847794 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:10:26.851634 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:10:26.851891 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:10:26.852403 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:10:26.852647 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:10:26.853092 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:10:26.853351 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:10:26.853845 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:10:26.854086 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:10:26.854354 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:10:26.854672 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m13:10:26.854937 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:10:26.855341 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:10:26.855607 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m13:10:26.855848 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:10:26.856091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m13:10:26.856336 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:10:26.856559 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:10:26.859997 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:10:26.860264 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:10:26.860532 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:10:26.863622 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:10:26.866687 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:10:26.866965 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:10:26.870793 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:10:26.871100 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:10:26.871530 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:10:26.871767 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:10:26.872030 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:10:26.872320 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m13:10:26.872789 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:10:26.872999 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:10:26.873247 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:10:26.873464 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:10:26.873720 [debug] [Thread-2  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:10:26.874110 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:10:26.874503 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:10:26.877591 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:10:26.877856 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:10:26.878109 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:10:26.878445 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:10:26.878705 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m13:10:26.884241 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:10:26.884518 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:10:26.884742 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:10:26.888268 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:10:26.889029 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:10:26.889406 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:10:26.889982 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:10:26.890325 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:10:26.890820 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:10:26.891470 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:26.891680 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m13:10:26.891852 [debug] [MainThread]: Connection 'test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m13:10:26.892015 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38' was properly closed.
[0m13:10:26.892175 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6' was properly closed.
[0m13:10:26.894854 [debug] [MainThread]: Command end result
[0m13:10:27.030148 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:10:27.032734 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:10:27.038283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:10:27.041761 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:10:27.042366 [info ] [MainThread]: Building catalog
[0m13:10:27.053572 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db_ex2.information_schema'
[0m13:10:27.059305 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m13:10:27.059553 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: BEGIN
[0m13:10:27.059740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:27.073589 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:10:27.073862 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m13:10:27.074283 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "dbt_db_ex2.information_schema"} */

    
    

    select
        'dbt_db_ex2' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_no_duplicate_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_lifetime_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_price')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_status')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_total_amount_equals_sum_of_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_revenue')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_date')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_quantity_sold')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_customer_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_amount')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_fct_orders_order_id')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:10:27.081726 [debug] [ThreadPool]: SQL status: SELECT 214 in 0.007 seconds
[0m13:10:27.095736 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: ROLLBACK
[0m13:10:27.097090 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: Close
[0m13:10:27.119207 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m13:10:27.154127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:10:27.155498 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:10:27.155748 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m13:10:27.157030 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.1584793, "process_in_blocks": "0", "process_kernel_time": 0.16151, "process_mem_max_rss": "124125184", "process_out_blocks": "0", "process_user_time": 1.712094}
[0m13:10:27.157949 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:10:27.157725 after 1.16 seconds
[0m13:10:27.158335 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:10:27.158537 [debug] [MainThread]: Connection 'dbt_db_ex2.information_schema' was properly closed.
[0m13:10:27.158761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075127c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739dd00>]}
[0m13:10:27.159036 [debug] [MainThread]: Flushing usage events
[0m13:10:28.402064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:23.233031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107242760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ac3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ac1c0>]}


============================== 13:12:23.236313 | 8ca9e25b-247a-421c-8d00-d5d884f43fbd ==============================
[0m13:12:23.236313 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:12:23.236725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m13:12:23.388412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ca9e25b-247a-421c-8d00-d5d884f43fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4d580>]}
[0m13:12:23.435020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ca9e25b-247a-421c-8d00-d5d884f43fbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807d0d0>]}
[0m13:16:16.171514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c83790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cebbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cebd90>]}


============================== 13:16:16.174480 | c6600421-bb3d-4370-b967-91b1db7fa477 ==============================
[0m13:16:16.174480 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:16:16.174901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation log_macro_tests --args {output_path: "../logs/dbt_test_macros.md"}', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:16:16.322204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6600421-bb3d-4370-b967-91b1db7fa477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101188e0>]}
[0m13:16:16.369581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6600421-bb3d-4370-b967-91b1db7fa477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111030520>]}
[0m13:16:16.370402 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:16:16.457847 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:16:16.603791 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:16:16.604256 [debug] [MainThread]: Partial parsing: added file: ecommerce_test://macros/log_macros.sql
[0m13:16:16.700191 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:16:16.711021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6600421-bb3d-4370-b967-91b1db7fa477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11160de50>]}
[0m13:16:16.803765 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:16:16.806789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:16:16.817474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6600421-bb3d-4370-b967-91b1db7fa477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d19d0>]}
[0m13:16:16.817862 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 811 macros
[0m13:16:16.818091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6600421-bb3d-4370-b967-91b1db7fa477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d1880>]}
[0m13:16:16.818444 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_macro_tests'
[0m13:16:16.818657 [debug] [MainThread]: Using postgres connection "macro_log_macro_tests"
[0m13:16:16.818834 [debug] [MainThread]: On macro_log_macro_tests: BEGIN
[0m13:16:16.819002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:16.851428 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m13:16:16.851823 [debug] [MainThread]: On macro_log_macro_tests: COMMIT
[0m13:16:16.852043 [debug] [MainThread]: Using postgres connection "macro_log_macro_tests"
[0m13:16:16.852233 [debug] [MainThread]: On macro_log_macro_tests: COMMIT
[0m13:16:16.852633 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:16:16.859661 [info ] [MainThread]: Ghi log các macro tests vào: ../logs/dbt_test_macros.md
[0m13:16:16.902088 [debug] [MainThread]: Using postgres connection "macro_log_macro_tests"
[0m13:16:16.910977 [debug] [MainThread]: On macro_log_macro_tests: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "macro_log_macro_tests"} */

    
-- Ghi log về macro test_not_negative
SELECT 
    'test_not_negative' as macro_name,
    'Kiểm tra giá trị không âm trong một cột' as description,
    'model, column_name' as parameters,
    'True nếu tất cả giá trị đều không âm, False nếu có giá trị âm' as return_type,
    current_timestamp as logged_at;

-- Ghi log về macro test_date_in_range
SELECT 
    'test_date_in_range' as macro_name,
    'Kiểm tra giá trị ngày nằm trong khoảng cho phép' as description,
    'model, column_name, min_date, max_date' as parameters,
    'True nếu tất cả ngày đều trong khoảng, False nếu có ngày nằm ngoài khoảng' as return_type,
    current_timestamp as logged_at;

  
[0m13:16:16.915250 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m13:16:16.924599 [info ] [MainThread]: 

# Log Macro Tests

*Tạo lúc: 2025-05-12 13:16:16*

## Danh sách các Macros Test

| Tên Macro | Mô tả | Tham số | Kiểu trả về |
|-----------|-------|---------|------------|


| `test_not_negative` | Kiểm tra giá trị không âm trong một cột | model, column_name | True nếu tất cả giá trị đều không âm, False nếu có giá trị âm |
| `test_date_in_range` | Kiểm tra giá trị ngày nằm trong khoảng cho phép | model, column_name, min_date, max_date | True nếu tất cả ngày đều trong khoảng, False nếu có ngày nằm ngoài khoảng |



## Ví dụ sử dụng

### test_not_negative

```yaml
columns:
  - name: amount
    tests:
      - test_not_negative
```

### test_date_in_range

```yaml
columns:
  - name: order_date
    tests:
      - test_date_in_range:
          min_date: '2020-01-01'
          max_date: '2030-12-31'
```


## Tests đã chạy

Các macro tests được tham chiếu trong schema.yml và chạy bằng lệnh `dbt test`.
Xem kết quả chi tiết trong file `reports/test_summary.md`.

[0m13:16:16.934116 [debug] [MainThread]: Postgres adapter: Error running SQL: macro log_macro_tests
[0m13:16:16.950141 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m13:16:16.959608 [debug] [MainThread]: On macro_log_macro_tests: Close
[0m13:16:16.980878 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  'write_file' is undefined
[0m13:16:17.001773 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/clients/jinja.py", line 418, in exception_handler
    yield
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 95, in macro
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/jinja2/sandbox.py", line 399, in call
    if not __self.is_safe_callable(__obj):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/jinja2/sandbox.py", line 265, in is_safe_callable
    getattr(obj, "unsafe_callable", False) or getattr(obj, "alters_data", False)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/jinja2/runtime.py", line 870, in __getattr__
    return self._fail_with_undefined_error()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/jinja2/runtime.py", line 859, in _fail_with_undefined_error
    raise self._undefined_exception(self._undefined_message)
jinja2.exceptions.UndefinedError: 'write_file' is undefined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/adapters/base/impl.py", line 1276, in execute_macro
    result = macro_function(**kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/clients/jinja.py", line 397, in call_macro
    return e.value
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/contextlib.py", line 135, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/clients/jinja.py", line 420, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt_common.exceptions.macros.CaughtMacroErrorWithNodeError: Compilation Error
  'write_file' is undefined

[0m13:16:17.012964 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:16:17.014096 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.8970337, "process_in_blocks": "0", "process_kernel_time": 0.215707, "process_mem_max_rss": "126320640", "process_out_blocks": "0", "process_user_time": 1.5212}
[0m13:16:17.014376 [debug] [MainThread]: Command `dbt run-operation` failed at 13:16:17.014321 after 0.90 seconds
[0m13:16:17.014592 [debug] [MainThread]: Connection 'macro_log_macro_tests' was properly closed.
[0m13:16:17.014804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c83790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101188e0>]}
[0m13:16:17.015043 [debug] [MainThread]: Flushing usage events
[0m13:16:18.067611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:52.284268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fae760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b6baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b6bcd0>]}


============================== 13:16:52.287291 | cb3d9c4f-ce8a-46a7-a24d-f95f5d4576f5 ==============================
[0m13:16:52.287291 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:16:52.287694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run-operation log_macro_tests', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:16:52.416968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb3d9c4f-ce8a-46a7-a24d-f95f5d4576f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110593580>]}
[0m13:16:52.464129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb3d9c4f-ce8a-46a7-a24d-f95f5d4576f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11213d130>]}
[0m13:16:52.464980 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:16:52.548790 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:16:52.721405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:52.721915 [debug] [MainThread]: Partial parsing: updated file: ecommerce_test://macros/log_macros.sql
[0m13:16:52.788044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:16:52.798177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb3d9c4f-ce8a-46a7-a24d-f95f5d4576f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b98130>]}
[0m13:16:52.889451 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:16:52.892305 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:16:52.902226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb3d9c4f-ce8a-46a7-a24d-f95f5d4576f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b5c820>]}
[0m13:16:52.902599 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 811 macros
[0m13:16:52.902816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3d9c4f-ce8a-46a7-a24d-f95f5d4576f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112831370>]}
[0m13:16:52.903165 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_macro_tests'
[0m13:16:52.903363 [debug] [MainThread]: Using postgres connection "macro_log_macro_tests"
[0m13:16:52.903544 [debug] [MainThread]: On macro_log_macro_tests: BEGIN
[0m13:16:52.903724 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:52.928561 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m13:16:52.928887 [debug] [MainThread]: On macro_log_macro_tests: COMMIT
[0m13:16:52.929091 [debug] [MainThread]: Using postgres connection "macro_log_macro_tests"
[0m13:16:52.929280 [debug] [MainThread]: On macro_log_macro_tests: COMMIT
[0m13:16:52.929941 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:16:52.934916 [info ] [MainThread]: 

# Log Macro Tests

*Tạo lúc: 2025-05-12 13:16:52*

## Danh sách các Macros Test

| Tên Macro | Mô tả | Tham số | Kiểu trả về |
|-----------|-------|---------|------------|


| `test_not_negative` | Kiểm tra giá trị không âm trong một cột | model, column_name | True nếu tất cả giá trị đều không âm, False nếu có giá trị âm |
| `test_date_in_range` | Kiểm tra giá trị ngày nằm trong khoảng cho phép | model, column_name, min_date, max_date | True nếu tất cả ngày đều trong khoảng, False nếu có ngày nằm ngoài khoảng |



## Ví dụ sử dụng

### test_not_negative

```yaml
columns:
  - name: amount
    tests:
      - test_not_negative
```

### test_date_in_range

```yaml
columns:
  - name: order_date
    tests:
      - test_date_in_range:
          min_date: '2020-01-01'
          max_date: '2030-12-31'
```


## Tests đã chạy

Các macro tests được tham chiếu trong schema.yml và chạy bằng lệnh `dbt test`.
Xem kết quả chi tiết trong file `reports/test_summary.md`.

[0m13:16:52.935232 [debug] [MainThread]: On macro_log_macro_tests: Close
[0m13:16:52.940165 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:16:52.941294 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.7170453, "process_in_blocks": "0", "process_kernel_time": 0.173332, "process_mem_max_rss": "119193600", "process_out_blocks": "0", "process_user_time": 1.422257}
[0m13:16:52.941575 [debug] [MainThread]: Command `dbt run-operation` succeeded at 13:16:52.941521 after 0.72 seconds
[0m13:16:52.941794 [debug] [MainThread]: Connection 'macro_log_macro_tests' was properly closed.
[0m13:16:52.942008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fae760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d9a00>]}
[0m13:16:52.942250 [debug] [MainThread]: Flushing usage events
[0m13:16:53.920914 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:09.183841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635fd90>]}


============================== 13:18:09.187232 | a217c49e-dd2b-4e7b-88d1-cd980a53745d ==============================
[0m13:18:09.187232 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:18:09.187655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt run-operation log_macro_tests', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:09.380038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a217c49e-dd2b-4e7b-88d1-cd980a53745d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0acd0>]}
[0m13:18:09.434887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a217c49e-dd2b-4e7b-88d1-cd980a53745d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e02520>]}
[0m13:18:09.435831 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:18:09.529625 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:18:09.703923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:18:09.704443 [debug] [MainThread]: Partial parsing: added file: ecommerce_test://macros/log_custom_tests.sql
[0m13:18:09.816270 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:18:09.828358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a217c49e-dd2b-4e7b-88d1-cd980a53745d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111390130>]}
[0m13:18:09.930817 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:18:09.933733 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:18:09.945189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a217c49e-dd2b-4e7b-88d1-cd980a53745d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111ade20>]}
[0m13:18:09.945618 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 811 macros
[0m13:18:09.945854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a217c49e-dd2b-4e7b-88d1-cd980a53745d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113638b0>]}
[0m13:18:09.946278 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_macro_tests'
[0m13:18:09.946514 [debug] [MainThread]: Using postgres connection "macro_log_macro_tests"
[0m13:18:09.946713 [debug] [MainThread]: On macro_log_macro_tests: BEGIN
[0m13:18:09.946889 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:09.978624 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m13:18:09.979030 [debug] [MainThread]: On macro_log_macro_tests: COMMIT
[0m13:18:09.979258 [debug] [MainThread]: Using postgres connection "macro_log_macro_tests"
[0m13:18:09.979483 [debug] [MainThread]: On macro_log_macro_tests: COMMIT
[0m13:18:09.980114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:18:09.985415 [info ] [MainThread]: 

# Log Macro Tests

*Tạo lúc: 2025-05-12 13:18:09*

## Danh sách các Macros Test

| Tên Macro | Mô tả | Tham số | Kiểu trả về |
|-----------|-------|---------|------------|


| `test_not_negative` | Kiểm tra giá trị không âm trong một cột | model, column_name | True nếu tất cả giá trị đều không âm, False nếu có giá trị âm |
| `test_date_in_range` | Kiểm tra giá trị ngày nằm trong khoảng cho phép | model, column_name, min_date, max_date | True nếu tất cả ngày đều trong khoảng, False nếu có ngày nằm ngoài khoảng |



## Ví dụ sử dụng

### test_not_negative

```yaml
columns:
  - name: amount
    tests:
      - test_not_negative
```

### test_date_in_range

```yaml
columns:
  - name: order_date
    tests:
      - test_date_in_range:
          min_date: '2020-01-01'
          max_date: '2030-12-31'
```


## Tests đã chạy

Các macro tests được tham chiếu trong schema.yml và chạy bằng lệnh `dbt test`.
Xem kết quả chi tiết trong file `reports/test_summary.md`.

[0m13:18:09.985797 [debug] [MainThread]: On macro_log_macro_tests: Close
[0m13:18:09.991097 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:18:09.993012 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.87813866, "process_in_blocks": "0", "process_kernel_time": 0.185928, "process_mem_max_rss": "118685696", "process_out_blocks": "0", "process_user_time": 1.530311}
[0m13:18:09.993421 [debug] [MainThread]: Command `dbt run-operation` succeeded at 13:18:09.993353 after 0.88 seconds
[0m13:18:09.993659 [debug] [MainThread]: Connection 'macro_log_macro_tests' was properly closed.
[0m13:18:09.993891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d0acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494ca30>]}
[0m13:18:09.994209 [debug] [MainThread]: Flushing usage events
[0m13:18:11.042536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:21.998707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036f6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486bd90>]}


============================== 13:20:22.002888 | 0716205f-e711-4848-9929-0558c2c91071 ==============================
[0m13:20:22.002888 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:20:22.003409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run-operation log_custom_tests', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:20:22.193838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0716205f-e711-4848-9929-0558c2c91071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a6f8e0>]}
[0m13:20:22.251522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0716205f-e711-4848-9929-0558c2c91071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105233ac0>]}
[0m13:20:22.252513 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:20:22.356012 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:20:22.556991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:22.557560 [debug] [MainThread]: Partial parsing: updated file: ecommerce_test://macros/log_custom_tests.sql
[0m13:20:22.633758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:20:22.644004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0716205f-e711-4848-9929-0558c2c91071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573eeb0>]}
[0m13:20:22.733078 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:20:22.736433 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:20:22.747634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0716205f-e711-4848-9929-0558c2c91071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105538790>]}
[0m13:20:22.748093 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 812 macros
[0m13:20:22.748345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0716205f-e711-4848-9929-0558c2c91071', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105538f10>]}
[0m13:20:22.748721 [debug] [MainThread]: Acquiring new postgres connection 'macro_log_custom_tests'
[0m13:20:22.748969 [debug] [MainThread]: Using postgres connection "macro_log_custom_tests"
[0m13:20:22.749232 [debug] [MainThread]: On macro_log_custom_tests: BEGIN
[0m13:20:22.749450 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:22.771713 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m13:20:22.772139 [debug] [MainThread]: On macro_log_custom_tests: COMMIT
[0m13:20:22.772376 [debug] [MainThread]: Using postgres connection "macro_log_custom_tests"
[0m13:20:22.772576 [debug] [MainThread]: On macro_log_custom_tests: COMMIT
[0m13:20:22.772997 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:20:22.780146 [info ] [MainThread]: 

# Log Custom Tests

*Tạo lúc: 2025-05-12 13:20:22*

## Danh sách các Custom Tests

| Tên Test | Mô tả | File | Kết quả |
|----------|-------|------|---------|


| `assert_no_duplicate_orders` | Kiểm tra sự trùng lặp đơn hàng dựa trên customer_id và order_date | tests/assert_no_duplicate_orders.sql | Fail (Tìm thấy 2 đơn hàng trùng lặp) |
| `assert_total_amount_equals_sum_of_items` | Kiểm tra tính nhất quán giữa tổng tiền đơn hàng và tổng giá trị các items | tests/assert_total_amount_equals_sum_of_items.sql | Pass |



## Chi tiết test: assert_no_duplicate_orders

**File:** `tests/assert_no_duplicate_orders.sql`

**Mô tả:** Kiểm tra sự trùng lặp đơn hàng dựa trên customer_id và khoảng thời gian giữa các đơn hàng.

**Logic:**
- Tìm kiếm các đơn hàng của cùng một khách hàng có khoảng cách thời gian dưới 15 phút
- Sử dụng self-join để so sánh mỗi đơn hàng với tất cả các đơn hàng khác của cùng một khách hàng
- Tính khoảng cách thời gian bằng phút: `abs(extract(epoch from (o1.order_date - o2.order_date)) / 60)`

**Kết quả:** Tìm thấy 2 đơn hàng tiềm ẩn trùng lặp



## Chi tiết test: assert_total_amount_equals_sum_of_items

**File:** `tests/assert_total_amount_equals_sum_of_items.sql`

**Mô tả:** Kiểm tra tính nhất quán giữa tổng số tiền đơn hàng và tổng tiền từng mặt hàng.

**Logic:**
- Lấy tổng tiền đơn hàng từ bảng `fct_orders`
- Tính tổng tiền từ chi tiết đơn hàng: `sum(quantity * unit_price)` từ bảng `stg_order_items`
- So sánh hai tổng, cho phép sai số nhỏ (0.01) do làm tròn

**Kết quả:** Pass - Không tìm thấy sự khác biệt


## Kết quả chạy tests

Kết quả chi tiết việc chạy các tests được lưu trong:
- File log: `reports/test_results.log`
- Báo cáo tóm tắt: `reports/test_summary.md`

[0m13:20:22.780564 [debug] [MainThread]: On macro_log_custom_tests: Close
[0m13:20:22.785775 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:20:22.786879 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 0.85466, "process_in_blocks": "0", "process_kernel_time": 0.234114, "process_mem_max_rss": "117981184", "process_out_blocks": "0", "process_user_time": 1.639921}
[0m13:20:22.787146 [debug] [MainThread]: Command `dbt run-operation` succeeded at 13:20:22.787093 after 0.85 seconds
[0m13:20:22.787415 [debug] [MainThread]: Connection 'macro_log_custom_tests' was properly closed.
[0m13:20:22.787696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036f6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105221f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105538370>]}
[0m13:20:22.787987 [debug] [MainThread]: Flushing usage events
[0m13:20:23.780712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:52.894204 [error] [MainThread]: Encountered an error:

[0m13:23:52.918936 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m13:23:52.921873 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 689.7464, "process_in_blocks": "0", "process_kernel_time": 0.181939, "process_mem_max_rss": "104742912", "process_out_blocks": "0", "process_user_time": 1.103478}
[0m13:23:52.922425 [debug] [MainThread]: Command `dbt docs serve` failed at 13:23:52.922324 after 689.75 seconds
[0m13:23:52.922843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107242760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a73520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a73790>]}
[0m13:23:52.923198 [debug] [MainThread]: Flushing usage events
[0m13:24:08.729050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061da7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107043b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107043d30>]}


============================== 13:24:08.733630 | 837abf28-bce4-48d2-b056-9618eb2f519a ==============================
[0m13:24:08.733630 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:24:08.734021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:08.841919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '837abf28-bce4-48d2-b056-9618eb2f519a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703da60>]}
[0m13:24:09.045037 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-37zg1mlv'
[0m13:24:09.045792 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:24:09.269507 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:24:09.270706 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:24:09.290026 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:24:09.293968 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:24:09.321840 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:24:09.325350 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m13:24:09.325769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '837abf28-bce4-48d2-b056-9618eb2f519a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720c910>]}
[0m13:24:09.327944 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:24:09.345117 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:24:09.347972 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:24:10.244279 [info ] [MainThread]: Installed from version 1.1.1
[0m13:24:10.244609 [info ] [MainThread]: Updated version available: 1.3.0
[0m13:24:10.244860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '837abf28-bce4-48d2-b056-9618eb2f519a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f612b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f0820>]}
[0m13:24:10.245132 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m13:24:16.486202 [info ] [MainThread]: Installed from version 0.10.0
[0m13:24:16.486546 [info ] [MainThread]: Updated version available: 0.10.4
[0m13:24:16.486800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '837abf28-bce4-48d2-b056-9618eb2f519a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107224970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107224bb0>]}
[0m13:24:16.487075 [info ] [MainThread]: Installing calogica/dbt_date
[0m13:24:16.982835 [info ] [MainThread]: Installed from version 0.10.0
[0m13:24:16.983404 [info ] [MainThread]: Updated version available: 0.10.1
[0m13:24:16.983949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '837abf28-bce4-48d2-b056-9618eb2f519a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072248e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107224130>]}
[0m13:24:16.984492 [info ] [MainThread]: 
[0m13:24:16.984895 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations', 'calogica/dbt_date']                 
Update your versions in packages.yml, then run dbt deps
[0m13:24:16.987718 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.313268, "process_in_blocks": "0", "process_kernel_time": 0.335855, "process_mem_max_rss": "104759296", "process_out_blocks": "0", "process_user_time": 1.249412}
[0m13:24:16.988229 [debug] [MainThread]: Command `dbt deps` succeeded at 13:24:16.988133 after 8.31 seconds
[0m13:24:16.988614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061da7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063313a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703da60>]}
[0m13:24:16.988995 [debug] [MainThread]: Flushing usage events
[0m13:24:18.700957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:20.095173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d06730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104daab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104daad00>]}


============================== 13:24:20.098090 | 384f9aad-cfe8-457e-b54e-669e92845adb ==============================
[0m13:24:20.098090 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:24:20.098458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:24:20.107230 [info ] [MainThread]: dbt version: 1.9.4
[0m13:24:20.107560 [info ] [MainThread]: python version: 3.9.6
[0m13:24:20.107763 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m13:24:20.107958 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m13:24:20.155641 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m13:24:20.155977 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m13:24:20.156216 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/dbt_project.yml
[0m13:24:20.156704 [info ] [MainThread]: adapter type: postgres
[0m13:24:20.156938 [info ] [MainThread]: adapter version: 1.9.0
[0m13:24:20.258736 [info ] [MainThread]: Configuration:
[0m13:24:20.259101 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:24:20.259308 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:24:20.259497 [info ] [MainThread]: Required dependencies:
[0m13:24:20.259769 [debug] [MainThread]: Executing "git --help"
[0m13:24:20.281284 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:24:20.282018 [debug] [MainThread]: STDERR: "b''"
[0m13:24:20.282285 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:24:20.282536 [info ] [MainThread]: Connection:
[0m13:24:20.282826 [info ] [MainThread]:   host: localhost
[0m13:24:20.283020 [info ] [MainThread]:   port: 5433
[0m13:24:20.283204 [info ] [MainThread]:   user: dbt_user
[0m13:24:20.283385 [info ] [MainThread]:   database: dbt_db_ex2
[0m13:24:20.283564 [info ] [MainThread]:   schema: public
[0m13:24:20.283743 [info ] [MainThread]:   connect_timeout: 10
[0m13:24:20.283922 [info ] [MainThread]:   role: None
[0m13:24:20.284101 [info ] [MainThread]:   search_path: None
[0m13:24:20.284278 [info ] [MainThread]:   keepalives_idle: 0
[0m13:24:20.284612 [info ] [MainThread]:   sslmode: None
[0m13:24:20.284889 [info ] [MainThread]:   sslcert: None
[0m13:24:20.285124 [info ] [MainThread]:   sslkey: None
[0m13:24:20.285321 [info ] [MainThread]:   sslrootcert: None
[0m13:24:20.285509 [info ] [MainThread]:   application_name: dbt
[0m13:24:20.285696 [info ] [MainThread]:   retries: 1
[0m13:24:20.286289 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:20.357729 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:24:20.383522 [debug] [MainThread]: Using postgres connection "debug"
[0m13:24:20.383781 [debug] [MainThread]: On debug: select 1 as id
[0m13:24:20.383966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:20.416042 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m13:24:20.416875 [debug] [MainThread]: On debug: Close
[0m13:24:20.417159 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:24:20.417717 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:24:20.419137 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.37527356, "process_in_blocks": "0", "process_kernel_time": 0.172187, "process_mem_max_rss": "115195904", "process_out_blocks": "0", "process_user_time": 1.090198}
[0m13:24:20.419561 [debug] [MainThread]: Command `dbt debug` succeeded at 13:24:20.419475 after 0.38 seconds
[0m13:24:20.419842 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:24:20.420135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d06730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e53df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051432e0>]}
[0m13:24:20.420479 [debug] [MainThread]: Flushing usage events
[0m13:24:21.398945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:22.731616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c8b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d3abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d3adc0>]}


============================== 13:24:22.734458 | ea59a1a9-b4a6-48c7-85ca-a329413f07c8 ==============================
[0m13:24:22.734458 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:24:22.734860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:24:22.882978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705dee0>]}
[0m13:24:22.939799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1c75b0>]}
[0m13:24:22.940492 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:23.037649 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:24:23.227704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:24:23.228290 [debug] [MainThread]: Partial parsing: updated file: ecommerce_test://macros/log_macros.sql
[0m13:24:23.228895 [debug] [MainThread]: Partial parsing: updated file: ecommerce_test://macros/log_custom_tests.sql
[0m13:24:23.322018 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:24:23.337606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab07130>]}
[0m13:24:23.445256 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:24:23.449398 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:24:23.464428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab1adc0>]}
[0m13:24:23.464863 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 812 macros
[0m13:24:23.465110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a784700>]}
[0m13:24:23.466442 [info ] [MainThread]: 
[0m13:24:23.466707 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:24:23.466905 [info ] [MainThread]: 
[0m13:24:23.467235 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:24:23.470432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m13:24:23.501585 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m13:24:23.501907 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m13:24:23.502113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:23.524563 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m13:24:23.525464 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m13:24:23.527734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m13:24:23.532680 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:24:23.533113 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m13:24:23.533339 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m13:24:23.535615 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:24:23.535869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:23.536071 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m13:24:23.536370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:23.547159 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:24:23.547519 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:24:23.547743 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:24:23.547992 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:24:23.548246 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:24:23.548531 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:24:23.552562 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.004 seconds
[0m13:24:23.552872 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m13:24:23.554521 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m13:24:23.555356 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m13:24:23.555946 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m13:24:23.556161 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m13:24:23.567774 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:23.568098 [debug] [MainThread]: On master: BEGIN
[0m13:24:23.568296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:23.582460 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m13:24:23.582789 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:23.583193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:24:23.633355 [debug] [MainThread]: SQL status: SELECT 4 in 0.050 seconds
[0m13:24:23.634926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f5be0>]}
[0m13:24:23.635320 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:23.636232 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:23.636548 [debug] [MainThread]: On master: BEGIN
[0m13:24:23.638651 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:24:23.639046 [debug] [MainThread]: On master: COMMIT
[0m13:24:23.639298 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:23.639504 [debug] [MainThread]: On master: COMMIT
[0m13:24:23.640196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:23.640461 [debug] [MainThread]: On master: Close
[0m13:24:23.642908 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m13:24:23.643268 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m13:24:23.643540 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m13:24:23.644182 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m13:24:23.643910 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m13:24:23.645474 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m13:24:23.645767 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m13:24:23.646269 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m13:24:23.646639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m13:24:23.646927 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m13:24:23.647273 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m13:24:23.647591 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m13:24:23.647847 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m13:24:23.648090 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m13:24:23.648332 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m13:24:23.648568 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m13:24:23.657310 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m13:24:23.659485 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m13:24:23.662692 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m13:24:23.666223 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m13:24:23.667071 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m13:24:23.667398 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m13:24:23.667686 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m13:24:23.673980 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m13:24:23.712031 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.stg_order_items"
[0m13:24:23.712800 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_test.stg_customers"
[0m13:24:23.729332 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.stg_products"
[0m13:24:23.732271 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.stg_orders"
[0m13:24:23.733957 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:24:23.734829 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: BEGIN
[0m13:24:23.736023 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:24:23.755889 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:24:23.758695 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: BEGIN
[0m13:24:23.759580 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:23.762693 [debug] [Thread-3  ]: SQL status: BEGIN in 0.027 seconds
[0m13:24:23.763472 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:24:23.763762 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */

  create view "dbt_db_ex2"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at,
        -- Add tracking for data lineage
        'ea59a1a9-b4a6-48c7-85ca-a329413f07c8' as _invocation_id
    from source
)

select * from staged
  );
[0m13:24:23.768290 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:24:23.770666 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: BEGIN
[0m13:24:23.771717 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:24:23.772489 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:24:23.773361 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:24:23.782541 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:24:23.791910 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:24:23.793752 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:23.801520 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:24:23.801946 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
alter table "dbt_db_ex2"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:24:23.804039 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:23.786723 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: BEGIN
[0m13:24:23.828489 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m13:24:23.832155 [debug] [Thread-2  ]: SQL status: BEGIN in 0.072 seconds
[0m13:24:23.835236 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:23.836154 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:24:23.837688 [debug] [Thread-4  ]: SQL status: BEGIN in 0.065 seconds
[0m13:24:23.839221 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:24:23.840642 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: COMMIT
[0m13:24:23.842536 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:24:23.846090 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */

  create view "dbt_db_ex2"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price, -- Ensure no NULL values
        category,
        created_at
    from source
)

select * from staged
  );
[0m13:24:23.844696 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */

  create view "dbt_db_ex2"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity, -- Ensure minimum quantity is 1
        coalesce(unit_price, 0) as unit_price, -- Ensure no NULL prices
        created_at
    from source
)

select * from staged
  );
[0m13:24:23.847202 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m13:24:23.858035 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:24:23.862759 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:24:23.863521 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m13:24:23.864275 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.017 seconds
[0m13:24:23.871062 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_orders__dbt_backup"
[0m13:24:23.876335 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.stg_orders"
[0m13:24:23.877310 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_orders"} */
drop view if exists "dbt_db_ex2"."public"."stg_orders__dbt_backup" cascade
[0m13:24:23.878192 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.014 seconds
[0m13:24:23.882756 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:24:23.883305 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
alter table "dbt_db_ex2"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m13:24:23.870070 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:24:23.883920 [debug] [Thread-1  ]: SQL status: BEGIN in 0.049 seconds
[0m13:24:23.884439 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.006 seconds
[0m13:24:23.885081 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:24:23.885745 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:24:23.886044 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:23.889021 [debug] [Thread-3  ]: On model.ecommerce_test.stg_orders: Close
[0m13:24:23.890142 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */

  create view "dbt_db_ex2"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex2"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email, -- Normalize email
        created_at
    from source
)

select * from staged
  );
[0m13:24:23.891729 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m13:24:23.892280 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:24:23.892831 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:24:23.899942 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:24:23.900376 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:24:23.900624 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: COMMIT
[0m13:24:23.900941 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
alter table "dbt_db_ex2"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:24:23.905706 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:24:23.906154 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107119ca0>]}
[0m13:24:23.906585 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:24:23.909286 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:24:23.910244 [debug] [Thread-2  ]: SQL status: COMMIT in 0.004 seconds
[0m13:24:23.908142 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.25s]
[0m13:24:23.912565 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m13:24:23.917555 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_order_items__dbt_backup"
[0m13:24:23.918470 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.008 seconds
[0m13:24:23.918928 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m13:24:23.919211 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:24:23.920339 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.stg_order_items"
[0m13:24:23.925090 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:24:23.925759 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: COMMIT
[0m13:24:23.926060 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_order_items"} */
drop view if exists "dbt_db_ex2"."public"."stg_order_items__dbt_backup" cascade
[0m13:24:23.926307 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
alter table "dbt_db_ex2"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:24:23.928064 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:23.930020 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m13:24:23.930439 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:24:23.930934 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m13:24:23.931388 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: COMMIT
[0m13:24:23.932045 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.005 seconds
[0m13:24:23.936224 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_products__dbt_backup"
[0m13:24:23.938693 [debug] [Thread-2  ]: On model.ecommerce_test.stg_order_items: Close
[0m13:24:23.939470 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.stg_products"
[0m13:24:23.939862 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:24:23.940788 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_products"} */
drop view if exists "dbt_db_ex2"."public"."stg_products__dbt_backup" cascade
[0m13:24:23.941866 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab08550>]}
[0m13:24:23.946135 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public"."stg_customers__dbt_backup"
[0m13:24:23.946782 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_test.stg_customers"
[0m13:24:23.947201 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.29s]
[0m13:24:23.947610 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.stg_customers"} */
drop view if exists "dbt_db_ex2"."public"."stg_customers__dbt_backup" cascade
[0m13:24:23.947978 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m13:24:23.948352 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.002 seconds
[0m13:24:23.949417 [debug] [Thread-4  ]: On model.ecommerce_test.stg_products: Close
[0m13:24:23.949953 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0c4df0>]}
[0m13:24:23.950229 [debug] [Thread-3  ]: Began running node model.ecommerce_test.fct_orders
[0m13:24:23.950671 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.30s]
[0m13:24:23.951536 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m13:24:23.951822 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m13:24:23.950969 [info ] [Thread-3  ]: 5 of 7 START sql table model public.fct_orders ................................. [RUN]
[0m13:24:23.953121 [debug] [Thread-1  ]: On model.ecommerce_test.stg_customers: Close
[0m13:24:23.953505 [debug] [Thread-2  ]: Began running node model.ecommerce_test.dim_products
[0m13:24:23.953819 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now model.ecommerce_test.fct_orders)
[0m13:24:23.954347 [info ] [Thread-2  ]: 6 of 7 START sql table model public.dim_products ............................... [RUN]
[0m13:24:23.955092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b09cd00>]}
[0m13:24:23.955595 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.fct_orders
[0m13:24:23.956115 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.dim_products)
[0m13:24:24.002948 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m13:24:24.003326 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.dim_products
[0m13:24:24.003703 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m13:24:24.007232 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m13:24:24.007667 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m13:24:24.008177 [debug] [Thread-4  ]: Began running node model.ecommerce_test.dim_customers
[0m13:24:24.008809 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.fct_orders
[0m13:24:24.008571 [info ] [Thread-4  ]: 7 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m13:24:24.009133 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.dim_products
[0m13:24:24.014845 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.dim_customers)
[0m13:24:24.027747 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_test.fct_orders"
[0m13:24:24.031976 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_test.dim_products"
[0m13:24:24.032334 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.dim_customers
[0m13:24:24.035797 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m13:24:24.036362 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.dim_customers
[0m13:24:24.040336 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_test.dim_customers"
[0m13:24:24.040868 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:24:24.041160 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:24:24.041392 [debug] [Thread-3  ]: On model.ecommerce_test.fct_orders: BEGIN
[0m13:24:24.041647 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: BEGIN
[0m13:24:24.041894 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:24:24.042167 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:24.042437 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:24:24.042885 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: BEGIN
[0m13:24:24.043137 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:24:24.053628 [debug] [Thread-4  ]: SQL status: BEGIN in 0.010 seconds
[0m13:24:24.053978 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m13:24:24.054246 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m13:24:24.054498 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:24:24.054771 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:24:24.055026 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:24:24.055308 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex2"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as lifetime_orders,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1
),

final as (
    select
        c.customer_id,
        c.name,
        c.email,
        c.created_at,
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        current_timestamp as updated_at
    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
)

select * from final
  );
  
[0m13:24:24.055611 [debug] [Thread-3  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */

  
    

  create  table "dbt_db_ex2"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    

with orders as (
    select * from "dbt_db_ex2"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db_ex2"."public"."stg_order_items"
),

order_totals as (
    select
        order_id,
        sum(quantity) as total_items,
        sum(quantity * unit_price) as total_amount
    from order_items
    group by 1
),

final as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        coalesce(ot.total_items, 0) as total_items,
        coalesce(ot.total_amount, 0) as total_amount,
        o.created_at,
        current_timestamp as updated_at,
        o._invocation_id
    from orders o
    left join order_totals ot on o.order_id = ot.order_id
)

select * from final
  );
  
[0m13:24:24.055911 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */

  
    

  create  table "dbt_db_ex2"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex2"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(quantity * unit_price) as total_revenue
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

final as (
    select
        p.product_id,
        p.name,
        p.price,
        p.category,
        p.created_at,
        coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
        coalesce(ps.total_revenue, 0) as total_revenue,
        current_timestamp as updated_at
    from products p
    left join product_sales ps on p.product_id = ps.product_id
)

select * from final
  );
  
[0m13:24:24.071529 [debug] [Thread-4  ]: SQL status: SELECT 3 in 0.015 seconds
[0m13:24:24.071914 [debug] [Thread-3  ]: SQL status: SELECT 3 in 0.016 seconds
[0m13:24:24.072194 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.016 seconds
[0m13:24:24.078228 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:24:24.082153 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:24:24.085189 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:24:24.085535 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:24:24.085821 [debug] [Thread-3  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:24:24.086084 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m13:24:24.087110 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:24.089865 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:24:24.090144 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
alter table "dbt_db_ex2"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:24:24.090406 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:24:24.090683 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:24:24.093700 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:24:24.096469 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:24:24.096729 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:24:24.096994 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
alter table "dbt_db_ex2"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:24:24.097237 [debug] [Thread-3  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
alter table "dbt_db_ex2"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:24:24.098035 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: COMMIT
[0m13:24:24.098354 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:24:24.098608 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: COMMIT
[0m13:24:24.099334 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:24.099573 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:24:24.100383 [debug] [Thread-3  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m13:24:24.100612 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:24.101378 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m13:24:24.101614 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:24:24.104904 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_products__dbt_backup"
[0m13:24:24.105188 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:24:24.105432 [debug] [Thread-3  ]: On model.ecommerce_test.fct_orders: COMMIT
[0m13:24:24.106992 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_test.dim_products"
[0m13:24:24.107239 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: COMMIT
[0m13:24:24.107522 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_products"} */
drop table if exists "dbt_db_ex2"."public"."dim_products__dbt_backup" cascade
[0m13:24:24.108359 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m13:24:24.110980 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public"."fct_orders__dbt_backup"
[0m13:24:24.111432 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m13:24:24.111682 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:24:24.112054 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_test.fct_orders"
[0m13:24:24.114416 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public"."dim_customers__dbt_backup"
[0m13:24:24.115263 [debug] [Thread-2  ]: On model.ecommerce_test.dim_products: Close
[0m13:24:24.115507 [debug] [Thread-3  ]: On model.ecommerce_test.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.fct_orders"} */
drop table if exists "dbt_db_ex2"."public"."fct_orders__dbt_backup" cascade
[0m13:24:24.115869 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_test.dim_customers"
[0m13:24:24.116358 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b06b070>]}
[0m13:24:24.116624 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "model.ecommerce_test.dim_customers"} */
drop table if exists "dbt_db_ex2"."public"."dim_customers__dbt_backup" cascade
[0m13:24:24.117376 [info ] [Thread-2  ]: 6 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.16s]
[0m13:24:24.118184 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.dim_products
[0m13:24:24.119852 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:24:24.120776 [debug] [Thread-3  ]: On model.ecommerce_test.fct_orders: Close
[0m13:24:24.121017 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:24:24.121612 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b30cd30>]}
[0m13:24:24.123047 [debug] [Thread-4  ]: On model.ecommerce_test.dim_customers: Close
[0m13:24:24.123898 [info ] [Thread-3  ]: 5 of 7 OK created sql table model public.fct_orders ............................ [[32mSELECT 3[0m in 0.17s]
[0m13:24:24.124338 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.fct_orders
[0m13:24:24.124796 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea59a1a9-b4a6-48c7-85ca-a329413f07c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b311610>]}
[0m13:24:24.125288 [info ] [Thread-4  ]: 7 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.11s]
[0m13:24:24.125651 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.dim_customers
[0m13:24:24.126349 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:24.126556 [debug] [MainThread]: On master: BEGIN
[0m13:24:24.126732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:24.134394 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:24:24.134731 [debug] [MainThread]: On master: COMMIT
[0m13:24:24.134948 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:24.135141 [debug] [MainThread]: On master: COMMIT
[0m13:24:24.135631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:24.135878 [debug] [MainThread]: On master: Close
[0m13:24:24.136223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:24.136468 [debug] [MainThread]: Connection 'model.ecommerce_test.stg_customers' was properly closed.
[0m13:24:24.136672 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_products' was properly closed.
[0m13:24:24.136894 [debug] [MainThread]: Connection 'model.ecommerce_test.fct_orders' was properly closed.
[0m13:24:24.137220 [debug] [MainThread]: Connection 'model.ecommerce_test.dim_customers' was properly closed.
[0m13:24:24.137568 [info ] [MainThread]: 
[0m13:24:24.138012 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m13:24:24.139503 [debug] [MainThread]: Command end result
[0m13:24:24.174405 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:24:24.175623 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:24:24.180186 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:24:24.180525 [info ] [MainThread]: 
[0m13:24:24.180852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:24.181094 [info ] [MainThread]: 
[0m13:24:24.181320 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:24:24.182414 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5139303, "process_in_blocks": "0", "process_kernel_time": 0.214574, "process_mem_max_rss": "123043840", "process_out_blocks": "0", "process_user_time": 2.119337}
[0m13:24:24.182681 [debug] [MainThread]: Command `dbt run` succeeded at 13:24:24.182629 after 1.51 seconds
[0m13:24:24.182924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c8b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1c75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8f7280>]}
[0m13:24:24.183180 [debug] [MainThread]: Flushing usage events
[0m13:24:25.543726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:26.912775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106702700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767adf0>]}


============================== 13:24:26.915258 | c040a497-d7bc-4a0b-9409-81a43af3f126 ==============================
[0m13:24:26.915258 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:24:26.915620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --store-failures', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:27.041946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c040a497-d7bc-4a0b-9409-81a43af3f126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079897f0>]}
[0m13:24:27.087691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c040a497-d7bc-4a0b-9409-81a43af3f126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107858c40>]}
[0m13:24:27.088206 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:27.178837 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:24:27.297767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:27.298069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:27.303377 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:24:27.367965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c040a497-d7bc-4a0b-9409-81a43af3f126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063c130>]}
[0m13:24:27.455867 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:24:27.458295 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:24:27.470992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c040a497-d7bc-4a0b-9409-81a43af3f126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11068aa60>]}
[0m13:24:27.471346 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 812 macros
[0m13:24:27.471557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c040a497-d7bc-4a0b-9409-81a43af3f126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063adc0>]}
[0m13:24:27.473151 [info ] [MainThread]: 
[0m13:24:27.473370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:24:27.473551 [info ] [MainThread]: 
[0m13:24:27.473835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:24:27.477482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2'
[0m13:24:27.503118 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2"
[0m13:24:27.503389 [debug] [ThreadPool]: On list_dbt_db_ex2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2"} */

    select distinct nspname from pg_namespace
  
[0m13:24:27.503575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:27.525816 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m13:24:27.526758 [debug] [ThreadPool]: On list_dbt_db_ex2: Close
[0m13:24:27.529542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex2, now list_dbt_db_ex2_public)
[0m13:24:27.530004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m13:24:27.535883 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:24:27.538391 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:24:27.538632 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m13:24:27.538838 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m13:24:27.539030 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:27.539213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:27.549785 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:24:27.550127 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:24:27.550365 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:24:27.550587 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:24:27.550829 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:24:27.551076 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:24:27.553906 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m13:24:27.554151 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.003 seconds
[0m13:24:27.555208 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m13:24:27.556806 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m13:24:27.557293 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m13:24:27.557526 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m13:24:27.569016 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:27.569274 [debug] [MainThread]: On master: BEGIN
[0m13:24:27.569449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:27.576670 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:24:27.576905 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:27.577151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:24:27.622467 [debug] [MainThread]: SQL status: SELECT 4 in 0.045 seconds
[0m13:24:27.627198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c040a497-d7bc-4a0b-9409-81a43af3f126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107968d30>]}
[0m13:24:27.627607 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:27.628216 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:27.628484 [debug] [MainThread]: On master: BEGIN
[0m13:24:27.629257 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.629565 [debug] [MainThread]: On master: COMMIT
[0m13:24:27.629838 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:27.630099 [debug] [MainThread]: On master: COMMIT
[0m13:24:27.630606 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:27.630908 [debug] [MainThread]: On master: Close
[0m13:24:27.633015 [debug] [Thread-1  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:24:27.633392 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:24:27.633717 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:24:27.634322 [debug] [Thread-4  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:24:27.634034 [info ] [Thread-1  ]: 1 of 25 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m13:24:27.634785 [info ] [Thread-2  ]: 2 of 25 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m13:24:27.635121 [info ] [Thread-3  ]: 3 of 25 START test assert_no_duplicate_orders .................................. [RUN]
[0m13:24:27.635465 [info ] [Thread-4  ]: 4 of 25 START test assert_total_amount_equals_sum_of_items ..................... [RUN]
[0m13:24:27.635844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:24:27.636182 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:24:27.636566 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_no_duplicate_orders'
[0m13:24:27.636944 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_test.assert_total_amount_equals_sum_of_items'
[0m13:24:27.637239 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:24:27.637524 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:24:27.637788 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m13:24:27.638047 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:24:27.653947 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:24:27.658867 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:24:27.661923 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:24:27.664653 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:24:27.665484 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m13:24:27.665745 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:24:27.680661 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m13:24:27.680917 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:24:27.685188 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:24:27.687913 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:24:27.688170 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:24:27.692722 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m13:24:27.693090 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:24:27.693344 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders" cascade
[0m13:24:27.697561 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:24:27.697908 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:24:27.698175 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m13:24:27.698405 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:24:27.698730 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:24:27.698953 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items" cascade
[0m13:24:27.699168 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:27.699499 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m13:24:27.699731 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m13:24:27.700053 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:27.712303 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:24:27.712645 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.013 seconds
[0m13:24:27.712889 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:24:27.714656 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
[0m13:24:27.714905 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.015 seconds
[0m13:24:27.715534 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
[0m13:24:27.716143 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:24:27.724311 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:24:27.724927 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:24:27.725362 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:24:27.725782 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:24:27.726011 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m13:24:27.726483 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:24:27.726703 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m13:24:27.726920 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:24:27.727185 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:24:27.727537 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.727899 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:24:27.728208 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.728470 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  
  
    as
  
  (
    /*
  Custom test to ensure there are no duplicate orders in the core table.
  This test checks for duplicates based on customer_id and order_date within 15 minutes
*/

with orders as (
    select 
        customer_id,
        order_date,
        count(*) as order_count
    from "dbt_db_ex2"."public"."stg_orders"
    group by 1, 2
),

potential_duplicates as (
    select
        o1.customer_id,
        o1.order_date as order_date_1,
        o2.order_date as order_date_2,
        abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) as minutes_difference
    from "dbt_db_ex2"."public"."stg_orders" o1
    join "dbt_db_ex2"."public"."stg_orders" o2
        on o1.customer_id = o2.customer_id
        and o1.order_id <> o2.order_id
        and abs(extract(epoch from (o1.order_date - o2.order_date)) / 60) < 15  -- Orders less than 15 minutes apart
)

select * from potential_duplicates
  );
  
    
[0m13:24:27.728721 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.728945 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.729153 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:24:27.729426 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:24:27.729694 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:24:27.729970 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
  
  
    as
  
  (
    /*
  Custom test to check if the total amount in orders table
  matches the sum of the item amounts in order_items.
  
  If there are differences, this test will return the records with discrepancies.
*/

with orders as (
    select 
        order_id,
        total_amount as order_total
    from "dbt_db_ex2"."public"."fct_orders"
),

order_items_grouped as (
    select
        order_id,
        sum(quantity * unit_price) as items_total
    from "dbt_db_ex2"."public"."stg_order_items"
    group by 1
),

joined as (
    select
        o.order_id,
        o.order_total,
        coalesce(oi.items_total, 0) as items_total,
        abs(o.order_total - coalesce(oi.items_total, 0)) as difference
    from orders o
    left join order_items_grouped oi on o.order_id = oi.order_id
)

select * from joined where difference > 0.01  -- Allow small rounding differences
  );
  
    
[0m13:24:27.730254 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m13:24:27.730541 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex2"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m13:24:27.734295 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:24:27.734979 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:24:27.735251 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:24:27.735487 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:24:27.735742 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:24:27.736336 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:24:27.736589 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:24:27.736826 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:24:27.737097 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.008 seconds
[0m13:24:27.737658 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m13:24:27.737920 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:27.738163 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:24:27.738389 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:24:27.738617 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:24:27.741187 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:24:27.741774 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m13:24:27.742154 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:24:27.742394 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: COMMIT
[0m13:24:27.742710 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:24:27.743212 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:24:27.743487 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: COMMIT
[0m13:24:27.743739 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:24:27.744161 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:24:27.744619 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:24:27.745102 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.745384 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.745649 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:24:27.745900 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:24:27.746163 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m13:24:27.746448 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m13:24:27.746728 [debug] [Thread-3  ]: SQL status: COMMIT in 0.004 seconds
[0m13:24:27.747278 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:24:27.747996 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m13:24:27.748760 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:24:27.749413 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:24:27.755686 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.009 seconds
[0m13:24:27.757066 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m13:24:27.757586 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m13:24:27.758096 [debug] [Thread-1  ]: On test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m13:24:27.759339 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:24:27.759879 [debug] [Thread-2  ]: On test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m13:24:27.760225 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: BEGIN
[0m13:24:27.760536 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:24:27.758960 [info ] [Thread-1  ]: 1 of 25 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.12s]
[0m13:24:27.761179 [info ] [Thread-2  ]: 2 of 25 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.12s]
[0m13:24:27.761831 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: BEGIN
[0m13:24:27.762425 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.763065 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:24:27.763542 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:24:27.763854 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:24:27.764187 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:24:27.764498 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:24:27.765044 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.765547 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_total_amount_equals_sum_of_items"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_total_amount_equals_sum_of_items"
    
      
    ) dbt_internal_test
[0m13:24:27.765926 [info ] [Thread-1  ]: 5 of 25 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m13:24:27.766239 [info ] [Thread-2  ]: 6 of 25 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m13:24:27.766517 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:24:27.767247 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:24:27.767692 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:24:27.767998 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.assert_no_duplicate_orders"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
    
      
    ) dbt_internal_test
[0m13:24:27.768367 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:24:27.768622 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:24:27.768876 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:24:27.774278 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.005 seconds
[0m13:24:27.781944 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:24:27.786810 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:24:27.787745 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: ROLLBACK
[0m13:24:27.788526 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: ROLLBACK
[0m13:24:27.789099 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:24:27.793611 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m13:24:27.793996 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:24:27.794254 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3" cascade
[0m13:24:27.794496 [debug] [Thread-4  ]: On test.ecommerce_test.assert_total_amount_equals_sum_of_items: Close
[0m13:24:27.794719 [debug] [Thread-3  ]: On test.ecommerce_test.assert_no_duplicate_orders: Close
[0m13:24:27.794942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:27.795155 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:24:27.795541 [info ] [Thread-4  ]: 4 of 25 PASS assert_total_amount_equals_sum_of_items ........................... [[32mPASS[0m in 0.16s]
[0m13:24:27.795839 [error] [Thread-3  ]: 3 of 25 FAIL 2 assert_no_duplicate_orders ...................................... [[31mFAIL 2[0m in 0.16s]
[0m13:24:27.801497 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:24:27.801908 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:24:27.802262 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:24:27.802654 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:24:27.802938 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:24:27.803269 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:24:27.803516 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m13:24:27.803782 [info ] [Thread-4  ]: 7 of 25 START test not_null_dim_customers_email ................................ [RUN]
[0m13:24:27.804068 [info ] [Thread-3  ]: 8 of 25 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m13:24:27.804312 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:27.804614 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m13:24:27.804901 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:24:27.805224 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:24:27.805526 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:24:27.805837 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:24:27.809339 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:24:27.810077 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
[0m13:24:27.813304 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:24:27.813999 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:24:27.814346 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m13:24:27.814748 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:24:27.815028 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.852169 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:24:27.852494 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.048 seconds
[0m13:24:27.852734 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:24:27.852955 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:24:27.853321 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:24:27.853943 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:24:27.858141 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:24:27.858411 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
  
  
    as
  
  (
    




    with grouped_expression as (
    select
        
        
    
  


    

coalesce(array_length((select regexp_matches(email, '^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$', '')), 1), 0)


 > 0
 as expression


    from "dbt_db_ex2"."public"."dim_customers"
    

),
validation_errors as (

    select
        *
    from
        grouped_expression
    where
        not(expression = true)

)

select *
from validation_errors





  );
  
    
[0m13:24:27.858678 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m13:24:27.859151 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:24:27.859488 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:24:27.859749 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:24:27.859988 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:24:27.860234 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m13:24:27.860587 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:24:27.861032 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.861266 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:24:27.861568 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m13:24:27.863988 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:24:27.864818 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m13:24:27.865226 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:24:27.865501 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: COMMIT
[0m13:24:27.867612 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:27.868125 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:24:27.868475 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:24:27.869165 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:24:27.869423 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:24:27.869658 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:24:27.870016 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:24:27.870274 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: BEGIN
[0m13:24:27.870761 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.871033 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:24:27.871295 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3"
    
      
    ) dbt_internal_test
[0m13:24:27.871799 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:24:27.872051 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:24:27.872720 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:24:27.872952 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:27.873177 [debug] [Thread-2  ]: SQL status: COMMIT in 0.003 seconds
[0m13:24:27.873806 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:24:27.874281 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:24:27.875208 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: ROLLBACK
[0m13:24:27.875617 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:24:27.876060 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:24:27.876314 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:24:27.876646 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:24:27.876909 [debug] [Thread-1  ]: On test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53: Close
[0m13:24:27.877384 [info ] [Thread-1  ]: 5 of 25 PASS dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[32mPASS[0m in 0.11s]
[0m13:24:27.877781 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:24:27.878027 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.878299 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:24:27.878530 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.878793 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:24:27.879082 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:24:27.879324 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:24:27.879565 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:24:27.879803 [info ] [Thread-1  ]: 9 of 25 START test not_null_dim_customers_name ................................. [RUN]
[0m13:24:27.880055 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where email is null



  );
  
    
[0m13:24:27.880344 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m13:24:27.880579 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.880852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m13:24:27.881141 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:24:27.881378 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:24:27.881622 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:24:27.885360 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:24:27.885672 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:24:27.885901 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:24:27.886602 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:24:27.886864 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:27.887399 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:24:27.887687 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:24:27.887921 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:24:27.888843 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:24:27.889180 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:24:27.889465 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:24:27.894792 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:24:27.895130 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:24:27.895587 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:24:27.895835 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:24:27.896131 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m13:24:27.896412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:27.896815 [info ] [Thread-2  ]: 6 of 25 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.13s]
[0m13:24:27.897393 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:24:27.897661 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:24:27.897908 [info ] [Thread-2  ]: 10 of 25 START test not_null_dim_products_name ................................. [RUN]
[0m13:24:27.898317 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m13:24:27.898572 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:24:27.902146 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:24:27.902493 [debug] [Thread-4  ]: SQL status: COMMIT in 0.007 seconds
[0m13:24:27.902747 [debug] [Thread-3  ]: SQL status: COMMIT in 0.007 seconds
[0m13:24:27.903181 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:24:27.903677 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:24:27.904189 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:24:27.904522 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:24:27.909982 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:24:27.910282 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:24:27.910584 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:24:27.910960 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:24:27.911210 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:24:27.911490 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m13:24:27.911817 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.912060 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.016 seconds
[0m13:24:27.912279 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.912484 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:27.912712 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:24:27.913424 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:24:27.913676 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:24:27.914033 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:24:27.914505 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:24:27.914783 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m13:24:27.915085 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:24:27.915772 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.916050 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:24:27.916339 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_customers"
where name is null



  );
  
    
[0m13:24:27.916630 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:27.916875 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:24:27.917873 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m13:24:27.918787 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m13:24:27.919453 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m13:24:27.919722 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a: Close
[0m13:24:27.920213 [info ] [Thread-4  ]: 7 of 25 PASS not_null_dim_customers_email ...................................... [[32mPASS[0m in 0.12s]
[0m13:24:27.920658 [info ] [Thread-3  ]: 8 of 25 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.12s]
[0m13:24:27.921043 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:24:27.921408 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:24:27.921693 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:24:27.921998 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:24:27.922266 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:24:27.922620 [info ] [Thread-4  ]: 11 of 25 START test not_null_dim_products_price ................................ [RUN]
[0m13:24:27.923311 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:24:27.923599 [info ] [Thread-3  ]: 12 of 25 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:24:27.923904 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m13:24:27.924127 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:24:27.924377 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:24:27.924625 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m13:24:27.924856 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:24:27.925491 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:24:27.925723 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:24:27.925952 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:24:27.929465 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:24:27.929961 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:24:27.933274 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:24:27.933590 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:24:27.933839 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:24:27.934299 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:24:27.934577 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:24:27.934865 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.939766 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:24:27.940010 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:24:27.940232 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:24:27.940609 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:24:27.940851 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where name is null



  );
  
    
[0m13:24:27.945195 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:24:27.945485 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:24:27.945717 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m13:24:27.946123 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:24:27.946375 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:24:27.946615 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:24:27.946859 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m13:24:27.947227 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:24:27.947479 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.947777 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:24:27.948018 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m13:24:27.948986 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:27.950011 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m13:24:27.950690 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_customers_name.e0448e04f1: Close
[0m13:24:27.950962 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:24:27.951736 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:24:27.952164 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:24:27.952454 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:24:27.952934 [info ] [Thread-1  ]: 9 of 25 PASS not_null_dim_customers_name ....................................... [[32mPASS[0m in 0.07s]
[0m13:24:27.953300 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:24:27.953555 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:24:27.953796 [info ] [Thread-1  ]: 13 of 25 START test not_null_dim_products_total_quantity_sold .................. [RUN]
[0m13:24:27.954362 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m13:24:27.954633 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:24:27.958897 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:24:27.959244 [debug] [Thread-2  ]: SQL status: COMMIT in 0.007 seconds
[0m13:24:27.959836 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:24:27.960526 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:24:27.960829 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:24:27.961093 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:24:27.961351 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:24:27.961615 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.015 seconds
[0m13:24:27.967070 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m13:24:27.968024 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:24:27.968307 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.968971 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:24:27.969407 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:24:27.969885 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:24:27.970127 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:24:27.970666 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:24:27.970919 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold" cascade
[0m13:24:27.971168 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:24:27.971414 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m13:24:27.971650 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:24:27.971880 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:27.972840 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.973142 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:24:27.973423 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.973711 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where product_id is null



  );
  
    
[0m13:24:27.973952 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:24:27.974219 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:24:27.975264 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m13:24:27.975598 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where price is null



  );
  
    
[0m13:24:27.976274 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_name.bffc7524ff: Close
[0m13:24:27.976715 [info ] [Thread-2  ]: 10 of 25 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.08s]
[0m13:24:27.977087 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:24:27.977348 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:24:27.977592 [info ] [Thread-2  ]: 14 of 25 START test not_null_dim_products_total_revenue ........................ [RUN]
[0m13:24:27.978072 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m13:24:27.978340 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:24:27.982079 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:24:27.982656 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:24:27.983357 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:24:27.983650 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:24:27.983899 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:24:27.984134 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.010 seconds
[0m13:24:27.984818 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
[0m13:24:27.985066 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:24:27.985321 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:24:27.985868 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:24:27.986616 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:24:27.991640 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m13:24:27.991924 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m13:24:27.992175 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:24:27.992422 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m13:24:27.992789 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:24:27.993174 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:24:27.993405 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:24:27.993664 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue" cascade
[0m13:24:27.994155 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.994460 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:27.994931 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:24:27.995361 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:24:27.995707 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_quantity_sold is null



  );
  
    
[0m13:24:27.995968 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:24:27.996315 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:27.996880 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:24:27.997170 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:27.997483 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:24:27.997741 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m13:24:27.998118 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:24:27.998387 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:24:27.998631 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:27.998877 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:27.999867 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m13:24:28.000234 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:24:28.000519 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:24:28.000875 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_dim_products_price.93519fc0ed: Close
[0m13:24:28.001402 [info ] [Thread-4  ]: 11 of 25 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.08s]
[0m13:24:28.001918 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:24:28.002179 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:28.002438 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:24:28.002672 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:24:28.003605 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:24:28.003884 [info ] [Thread-4  ]: 15 of 25 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:24:28.004551 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m13:24:28.004883 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:24:28.005139 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.011 seconds
[0m13:24:28.005351 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:24:28.005581 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:24:28.005810 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:24:28.006450 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
[0m13:24:28.007027 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: COMMIT
[0m13:24:28.006829 [info ] [Thread-3  ]: 12 of 25 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.08s]
[0m13:24:28.011405 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:24:28.011960 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:24:28.012450 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:24:28.012774 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m13:24:28.013090 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:24:28.013728 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:24:28.018477 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:24:28.018758 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m13:24:28.013497 [info ] [Thread-3  ]: 16 of 25 START test not_null_fct_orders_order_date ............................. [RUN]
[0m13:24:28.019227 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:24:28.019449 [debug] [Thread-2  ]: SQL status: BEGIN in 0.006 seconds
[0m13:24:28.019843 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:24:28.020114 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m13:24:28.020369 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m13:24:28.020604 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:24:28.020877 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:24:28.021103 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:24:28.021346 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."dim_products"
where total_revenue is null



  );
  
    
[0m13:24:28.024619 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:24:28.024921 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:24:28.025402 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: BEGIN
[0m13:24:28.025802 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:24:28.031186 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:24:28.031488 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:24:28.031772 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.007 seconds
[0m13:24:28.032161 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:24:28.032419 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:24:28.032659 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:24:28.033276 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m13:24:28.033529 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m13:24:28.033781 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_quantity_sold"
    
      
    ) dbt_internal_test
[0m13:24:28.034408 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:24:28.034649 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:24:28.034875 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:24:28.035347 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:24:28.035590 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:24:28.035805 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: COMMIT
[0m13:24:28.036108 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:24:28.037078 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: ROLLBACK
[0m13:24:28.037705 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a: Close
[0m13:24:28.038916 [info ] [Thread-1  ]: 13 of 25 PASS not_null_dim_products_total_quantity_sold ........................ [[32mPASS[0m in 0.08s]
[0m13:24:28.039966 [debug] [Thread-4  ]: SQL status: BEGIN in 0.002 seconds
[0m13:24:28.040645 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:24:28.040928 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:24:28.041221 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:24:28.041525 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m13:24:28.041804 [info ] [Thread-1  ]: 17 of 25 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:24:28.042156 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m13:24:28.042461 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m13:24:28.042902 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:24:28.043175 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:24:28.046837 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:24:28.047171 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:24:28.047877 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:24:28.048186 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:24:28.048426 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:24:28.048664 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:24:28.048901 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:24:28.049114 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: BEGIN
[0m13:24:28.049336 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:24:28.049959 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:24:28.054971 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:24:28.055580 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:24:28.055852 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:28.056218 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:24:28.056470 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:24:28.056716 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:24:28.056960 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:28.057187 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m13:24:28.057471 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_dim_products_total_revenue"
    
      
    ) dbt_internal_test
[0m13:24:28.057707 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.058140 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:24:28.058374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:28.058618 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:24:28.059010 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_date is null



  );
  
    
[0m13:24:28.059325 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:28.060353 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: ROLLBACK
[0m13:24:28.060667 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:24:28.060959 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:24:28.061198 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a: Close
[0m13:24:28.061856 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.062137 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:24:28.062394 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m13:24:28.061640 [info ] [Thread-2  ]: 14 of 25 PASS not_null_dim_products_total_revenue .............................. [[32mPASS[0m in 0.08s]
[0m13:24:28.062849 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:24:28.063112 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:24:28.063399 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:28.063832 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:24:28.063646 [info ] [Thread-2  ]: 18 of 25 START test not_null_fct_orders_status ................................. [RUN]
[0m13:24:28.064828 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:24:28.065434 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:24:28.065767 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m13:24:28.066061 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:24:28.066289 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:24:28.066520 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:24:28.066769 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m13:24:28.066993 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:24:28.067406 [info ] [Thread-4  ]: 15 of 25 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.06s]
[0m13:24:28.070981 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:24:28.071724 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:24:28.072141 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:24:28.072772 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:24:28.073095 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:24:28.073399 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:24:28.073652 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:24:28.074129 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:28.073903 [info ] [Thread-4  ]: 19 of 25 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m13:24:28.078892 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:24:28.079167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:24:28.079540 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:24:28.079821 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:24:28.080190 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:24:28.080441 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:24:28.080782 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:24:28.081112 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m13:24:28.081395 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:24:28.081639 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where order_id is null



  );
  
    
[0m13:24:28.085378 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:24:28.085638 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:28.085860 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:24:28.086341 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:24:28.091024 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:24:28.091463 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:24:28.091735 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:24:28.092017 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m13:24:28.092272 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m13:24:28.093113 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:24:28.093404 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:24:28.093653 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:24:28.093918 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:24:28.094173 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m13:24:28.094433 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.009 seconds
[0m13:24:28.094726 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:24:28.095456 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:24:28.095741 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:28.096357 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:24:28.097349 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m13:24:28.097634 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m13:24:28.097922 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:28.098155 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362: Close
[0m13:24:28.098631 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:24:28.098887 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.099569 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:24:28.099359 [info ] [Thread-3  ]: 16 of 25 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.08s]
[0m13:24:28.099907 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where status is null



  );
  
    
[0m13:24:28.100316 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:24:28.100692 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:24:28.101253 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:24:28.101018 [info ] [Thread-3  ]: 20 of 25 START test not_null_fct_orders_total_items ............................ [RUN]
[0m13:24:28.101568 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:24:28.101891 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m13:24:28.102176 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:24:28.102413 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.105838 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:24:28.106110 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:24:28.106333 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:24:28.106546 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:24:28.107247 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:24:28.107503 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:24:28.108163 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m13:24:28.108654 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:24:28.108961 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:24:28.109196 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:24:28.109491 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:24:28.114459 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m13:24:28.114736 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.006 seconds
[0m13:24:28.114965 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: COMMIT
[0m13:24:28.115377 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:24:28.115643 [debug] [Thread-4  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.116610 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:24:28.116933 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items" cascade
[0m13:24:28.117887 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:24:28.118909 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:24:28.120372 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m13:24:28.120676 [debug] [Thread-1  ]: On test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:24:28.121311 [info ] [Thread-1  ]: 17 of 25 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.08s]
[0m13:24:28.123851 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:24:28.124490 [debug] [Thread-2  ]: SQL status: COMMIT in 0.008 seconds
[0m13:24:28.124818 [debug] [Thread-1  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:24:28.126873 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:24:28.128467 [info ] [Thread-1  ]: 21 of 25 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m13:24:28.132799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:24:28.133962 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:24:28.146261 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:24:28.147499 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:24:28.148260 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.027 seconds
[0m13:24:28.148558 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: BEGIN
[0m13:24:28.150371 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:24:28.151477 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:24:28.152061 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:24:28.152459 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:28.152842 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.034 seconds
[0m13:24:28.159380 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:24:28.159918 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:24:28.160253 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:24:28.167806 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m13:24:28.162978 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
[0m13:24:28.168480 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:24:28.168890 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m13:24:28.167318 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:24:28.169223 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m13:24:28.170224 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:24:28.170877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:28.171265 [debug] [Thread-3  ]: SQL status: BEGIN in 0.002 seconds
[0m13:24:28.171764 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m13:24:28.174674 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: ROLLBACK
[0m13:24:28.175412 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:24:28.176786 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:24:28.178469 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex2"."public"."fct_orders"
where total_items is null



  );
  
    
[0m13:24:28.178872 [debug] [Thread-2  ]: On test.ecommerce_test.not_null_fct_orders_status.1455048989: Close
[0m13:24:28.179948 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:24:28.182200 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:24:28.181164 [info ] [Thread-2  ]: 18 of 25 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.12s]
[0m13:24:28.183084 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:24:28.183713 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:24:28.184502 [info ] [Thread-2  ]: 22 of 25 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:24:28.184939 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:24:28.185242 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:24:28.185678 [debug] [Thread-4  ]: SQL status: BEGIN in 0.003 seconds
[0m13:24:28.191381 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.012 seconds
[0m13:24:28.191882 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:24:28.198785 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:24:28.199234 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.028 seconds
[0m13:24:28.200490 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m13:24:28.200954 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m13:24:28.201860 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:24:28.202547 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:24:28.203647 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:24:28.203971 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: COMMIT
[0m13:24:28.204506 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:24:28.204962 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:24:28.205822 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:24:28.212497 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m13:24:28.217324 [debug] [Thread-2  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:24:28.219209 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m13:24:28.220644 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:24:28.221246 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:24:28.221538 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:28.222304 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m13:24:28.222771 [debug] [Thread-4  ]: On test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m13:24:28.223464 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:24:28.223755 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:24:28.224504 [info ] [Thread-4  ]: 19 of 25 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.14s]
[0m13:24:28.225054 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:24:28.225616 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex2"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex2"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:24:28.226203 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:24:28.226918 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: BEGIN
[0m13:24:28.228243 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:24:28.229350 [info ] [Thread-4  ]: 23 of 25 START test unique_dim_customers_email ................................. [RUN]
[0m13:24:28.230247 [debug] [Thread-3  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:28.230707 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m13:24:28.231264 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:24:28.231870 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:24:28.232197 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."not_null_fct_orders_total_items"
    
      
    ) dbt_internal_test
[0m13:24:28.238573 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.010 seconds
[0m13:24:28.239267 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:24:28.240988 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:24:28.241761 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:24:28.242685 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:24:28.243802 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: ROLLBACK
[0m13:24:28.244240 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:24:28.244898 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.021 seconds
[0m13:24:28.245460 [debug] [Thread-3  ]: On test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6: Close
[0m13:24:28.248014 [info ] [Thread-3  ]: 20 of 25 PASS not_null_fct_orders_total_items .................................. [[32mPASS[0m in 0.15s]
[0m13:24:28.247154 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:24:28.248461 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:24:28.246805 [debug] [Thread-2  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:24:28.303842 [debug] [Thread-1  ]: SQL status: COMMIT in 0.059 seconds
[0m13:24:28.306966 [debug] [Thread-4  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:24:28.307406 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:24:28.308438 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:24:28.309474 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:24:28.310180 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:24:28.310920 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:24:28.310528 [info ] [Thread-3  ]: 24 of 25 START test unique_dim_products_product_id ............................. [RUN]
[0m13:24:28.311449 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m13:24:28.311992 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m13:24:28.312345 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m13:24:28.312749 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:24:28.313036 [debug] [Thread-2  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:28.313434 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:24:28.317709 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:24:28.318047 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:24:28.318315 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:24:28.318626 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m13:24:28.319062 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:24:28.319329 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.323780 [debug] [Thread-3  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:24:28.324092 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:24:28.324336 [debug] [Thread-2  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:24:28.324750 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:24:28.325040 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m13:24:28.326326 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:24:28.326591 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.014 seconds
[0m13:24:28.326835 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m13:24:28.327125 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:24:28.327786 [debug] [Thread-4  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:24:28.328031 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:28.328262 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m13:24:28.328499 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:24:28.328936 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:24:28.329802 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m13:24:28.330156 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:24:28.330764 [debug] [Thread-1  ]: On test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m13:24:28.331034 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:28.331331 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:24:28.331597 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m13:24:28.331854 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:28.332750 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:24:28.332357 [info ] [Thread-1  ]: 21 of 25 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.20s]
[0m13:24:28.333305 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:24:28.333569 [debug] [Thread-1  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:24:28.333811 [info ] [Thread-1  ]: 25 of 25 START test unique_fct_orders_order_id ................................. [RUN]
[0m13:24:28.334119 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m13:24:28.334397 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:24:28.334688 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:24:28.338115 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:24:28.338398 [debug] [Thread-4  ]: SQL status: SELECT 0 in 0.006 seconds
[0m13:24:28.338620 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:24:28.339341 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:24:28.339654 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:24:28.339897 [debug] [Thread-2  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.340122 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:24:28.340338 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:24:28.340542 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:24:28.340757 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:24:28.345105 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:24:28.345824 [debug] [Thread-3  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:24:28.346123 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:24:28.346532 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:24:28.346996 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:24:28.347271 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m13:24:28.347522 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:24:28.347771 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:28.347986 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:24:28.348207 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:24:28.348626 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:24:28.348874 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.349861 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:24:28.350199 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:24:28.350511 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m13:24:28.350803 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:24:28.351026 [debug] [Thread-2  ]: On test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:24:28.351293 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:24:28.351710 [info ] [Thread-2  ]: 22 of 25 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.17s]
[0m13:24:28.352144 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:24:28.352726 [debug] [Thread-4  ]: SQL status: BEGIN in 0.001 seconds
[0m13:24:28.352979 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:24:28.353216 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:24:28.353936 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:24:28.354880 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m13:24:28.355132 [debug] [Thread-3  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:24:28.355767 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:24:28.355996 [debug] [Thread-4  ]: On test.ecommerce_test.unique_dim_customers_email.0472f7c2e8: Close
[0m13:24:28.356234 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:24:28.356457 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m13:24:28.357026 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:24:28.356832 [info ] [Thread-4  ]: 23 of 25 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.13s]
[0m13:24:28.357742 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:24:28.358156 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:24:28.358689 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:24:28.359024 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:24:28.359324 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m13:24:28.359815 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:24:28.360049 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.360327 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:24:28.360565 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex2"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m13:24:28.360909 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:24:28.361132 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:24:28.361584 [debug] [Thread-3  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.361822 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:24:28.362059 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:24:28.362662 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:24:28.362898 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:24:28.363964 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:24:28.364572 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:24:28.364838 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:24:28.365069 [debug] [Thread-3  ]: On test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:24:28.365290 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:24:28.365698 [info ] [Thread-3  ]: 24 of 25 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.05s]
[0m13:24:28.366062 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:24:28.367759 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:24:28.368178 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:24:28.368626 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:24:28.368842 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:24:28.369254 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:24:28.369470 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:24:28.369693 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "node_id": "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex2"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:24:28.370389 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:24:28.371297 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m13:24:28.371721 [debug] [Thread-1  ]: On test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5: Close
[0m13:24:28.372104 [info ] [Thread-1  ]: 25 of 25 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.04s]
[0m13:24:28.372500 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:24:28.373278 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:28.373480 [debug] [MainThread]: On master: BEGIN
[0m13:24:28.373659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:28.380096 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:24:28.380376 [debug] [MainThread]: On master: COMMIT
[0m13:24:28.380577 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:28.380766 [debug] [MainThread]: On master: COMMIT
[0m13:24:28.381135 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:24:28.381329 [debug] [MainThread]: On master: Close
[0m13:24:28.381603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:28.381784 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m13:24:28.381953 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m13:24:28.382121 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m13:24:28.382288 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m13:24:28.382537 [info ] [MainThread]: 
[0m13:24:28.382777 [info ] [MainThread]: Finished running 25 data tests in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m13:24:28.385058 [debug] [MainThread]: Command end result
[0m13:24:28.429931 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:24:28.431458 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:24:28.437813 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:24:28.438711 [info ] [MainThread]: 
[0m13:24:28.439083 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:24:28.439300 [info ] [MainThread]: 
[0m13:24:28.439553 [error] [MainThread]: [31mFailure in test assert_no_duplicate_orders (tests/assert_no_duplicate_orders.sql)[0m
[0m13:24:28.439792 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m13:24:28.439982 [info ] [MainThread]: 
[0m13:24:28.440204 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_test/tests/assert_no_duplicate_orders.sql
[0m13:24:28.440396 [info ] [MainThread]: 
[0m13:24:28.440698 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex2"."public_dbt_test__audit"."assert_no_duplicate_orders"
  --------------------------------------------------------------------------------
[0m13:24:28.440938 [info ] [MainThread]: 
[0m13:24:28.441160 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=1 SKIP=0 TOTAL=25
[0m13:24:28.442379 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.5809673, "process_in_blocks": "0", "process_kernel_time": 0.223254, "process_mem_max_rss": "128696320", "process_out_blocks": "0", "process_user_time": 2.23029}
[0m13:24:28.442682 [debug] [MainThread]: Command `dbt test` failed at 13:24:28.442627 after 1.58 seconds
[0m13:24:28.442955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106702700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110692e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110692a90>]}
[0m13:24:28.443233 [debug] [MainThread]: Flushing usage events
[0m13:24:29.603636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:24:30.949821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e27c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504adc0>]}


============================== 13:24:31.037261 | 5bc188b1-e30b-470c-9905-f7e712bfd576 ==============================
[0m13:24:31.037261 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:24:31.038696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:24:31.230700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bc188b1-e30b-470c-9905-f7e712bfd576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a92e0>]}
[0m13:24:31.277080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bc188b1-e30b-470c-9905-f7e712bfd576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053cdd60>]}
[0m13:24:31.277630 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:24:31.362663 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:24:31.488434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:24:31.488725 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:24:31.493885 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_test.sources
[0m13:24:31.557437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bc188b1-e30b-470c-9905-f7e712bfd576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607b100>]}
[0m13:24:31.567042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bc188b1-e30b-470c-9905-f7e712bfd576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebbee0>]}
[0m13:24:31.567496 [info ] [MainThread]: Found 7 models, 25 data tests, 4 sources, 812 macros
[0m13:24:31.567731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc188b1-e30b-470c-9905-f7e712bfd576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebbe80>]}
[0m13:24:31.569339 [info ] [MainThread]: 
[0m13:24:31.569607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:24:31.569799 [info ] [MainThread]: 
[0m13:24:31.570125 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:24:31.574594 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public'
[0m13:24:31.575217 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex2_public_dbt_test__audit'
[0m13:24:31.606079 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:24:31.606380 [debug] [ThreadPool]: On list_dbt_db_ex2_public: BEGIN
[0m13:24:31.606575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:31.606930 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:24:31.607154 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: BEGIN
[0m13:24:31.607335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:31.628162 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m13:24:31.628492 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m13:24:31.628715 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public"
[0m13:24:31.628933 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex2_public_dbt_test__audit"
[0m13:24:31.629153 [debug] [ThreadPool]: On list_dbt_db_ex2_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:24:31.629394 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "list_dbt_db_ex2_public_dbt_test__audit"} */
select
      'dbt_db_ex2' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex2' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:24:31.634104 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m13:24:31.634364 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.005 seconds
[0m13:24:31.635288 [debug] [ThreadPool]: On list_dbt_db_ex2_public: ROLLBACK
[0m13:24:31.636733 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: ROLLBACK
[0m13:24:31.637178 [debug] [ThreadPool]: On list_dbt_db_ex2_public_dbt_test__audit: Close
[0m13:24:31.637387 [debug] [ThreadPool]: On list_dbt_db_ex2_public: Close
[0m13:24:31.648535 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:31.648820 [debug] [MainThread]: On master: BEGIN
[0m13:24:31.649014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:31.658986 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:24:31.659313 [debug] [MainThread]: Using postgres connection "master"
[0m13:24:31.659598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:24:31.701641 [debug] [MainThread]: SQL status: SELECT 4 in 0.042 seconds
[0m13:24:31.703417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc188b1-e30b-470c-9905-f7e712bfd576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10557adc0>]}
[0m13:24:31.703802 [debug] [MainThread]: On master: ROLLBACK
[0m13:24:31.704410 [debug] [MainThread]: On master: Close
[0m13:24:31.706125 [debug] [Thread-1  ]: Began running node model.ecommerce_test.stg_customers
[0m13:24:31.706541 [debug] [Thread-2  ]: Began running node model.ecommerce_test.stg_order_items
[0m13:24:31.706965 [debug] [Thread-3  ]: Began running node model.ecommerce_test.stg_orders
[0m13:24:31.707376 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public, now model.ecommerce_test.stg_customers)
[0m13:24:31.707715 [debug] [Thread-4  ]: Began running node model.ecommerce_test.stg_products
[0m13:24:31.708221 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex2_public_dbt_test__audit, now model.ecommerce_test.stg_order_items)
[0m13:24:31.708637 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_orders'
[0m13:24:31.708949 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.stg_customers
[0m13:24:31.709318 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_test.stg_products'
[0m13:24:31.709627 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.stg_order_items
[0m13:24:31.709927 [debug] [Thread-3  ]: Began compiling node model.ecommerce_test.stg_orders
[0m13:24:31.717647 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.stg_customers"
[0m13:24:31.717936 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.stg_products
[0m13:24:31.720888 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.stg_order_items"
[0m13:24:31.723896 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_test.stg_orders"
[0m13:24:31.727244 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.stg_products"
[0m13:24:31.727761 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.stg_customers
[0m13:24:31.728296 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.stg_customers
[0m13:24:31.728602 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.stg_order_items
[0m13:24:31.729028 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.stg_order_items
[0m13:24:31.729319 [debug] [Thread-3  ]: Began executing node model.ecommerce_test.stg_orders
[0m13:24:31.729561 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.stg_products
[0m13:24:31.729961 [debug] [Thread-3  ]: Finished running node model.ecommerce_test.stg_orders
[0m13:24:31.730373 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.stg_products
[0m13:24:31.730808 [debug] [Thread-1  ]: Began running node model.ecommerce_test.dim_customers
[0m13:24:31.731066 [debug] [Thread-2  ]: Began running node model.ecommerce_test.fct_orders
[0m13:24:31.731306 [debug] [Thread-3  ]: Began running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:24:31.731560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_customers, now model.ecommerce_test.dim_customers)
[0m13:24:31.731788 [debug] [Thread-4  ]: Began running node model.ecommerce_test.dim_products
[0m13:24:31.732042 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_order_items, now model.ecommerce_test.fct_orders)
[0m13:24:31.732306 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_orders, now test.ecommerce_test.assert_no_duplicate_orders)
[0m13:24:31.732553 [debug] [Thread-1  ]: Began compiling node model.ecommerce_test.dim_customers
[0m13:24:31.732808 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.stg_products, now model.ecommerce_test.dim_products)
[0m13:24:31.733047 [debug] [Thread-2  ]: Began compiling node model.ecommerce_test.fct_orders
[0m13:24:31.733280 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.assert_no_duplicate_orders
[0m13:24:31.736391 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_test.dim_customers"
[0m13:24:31.736668 [debug] [Thread-4  ]: Began compiling node model.ecommerce_test.dim_products
[0m13:24:31.739553 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_test.fct_orders"
[0m13:24:31.742447 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.assert_no_duplicate_orders"
[0m13:24:31.745525 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_test.dim_products"
[0m13:24:31.746052 [debug] [Thread-2  ]: Began executing node model.ecommerce_test.fct_orders
[0m13:24:31.746320 [debug] [Thread-4  ]: Began executing node model.ecommerce_test.dim_products
[0m13:24:31.746749 [debug] [Thread-2  ]: Finished running node model.ecommerce_test.fct_orders
[0m13:24:31.747180 [debug] [Thread-4  ]: Finished running node model.ecommerce_test.dim_products
[0m13:24:31.747399 [debug] [Thread-1  ]: Began executing node model.ecommerce_test.dim_customers
[0m13:24:31.747662 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.assert_no_duplicate_orders
[0m13:24:31.748226 [debug] [Thread-1  ]: Finished running node model.ecommerce_test.dim_customers
[0m13:24:31.748772 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.assert_no_duplicate_orders
[0m13:24:31.749006 [debug] [Thread-2  ]: Began running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:24:31.749241 [debug] [Thread-4  ]: Began running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:24:31.749476 [debug] [Thread-1  ]: Began running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:24:31.749746 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:24:31.750098 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.fct_orders, now test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:24:31.750346 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_products, now test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:24:31.750588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_test.dim_customers, now test.ecommerce_test.assert_total_amount_equals_sum_of_items)
[0m13:24:31.750833 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_no_duplicate_orders, now test.ecommerce_test.not_null_dim_products_name.bffc7524ff)
[0m13:24:31.751057 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:24:31.751281 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:24:31.751491 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:24:31.751697 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:24:31.761297 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:24:31.765643 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:24:31.768193 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.assert_total_amount_equals_sum_of_items"
[0m13:24:31.773854 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_name.bffc7524ff"
[0m13:24:31.774485 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:24:31.774930 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_name.bffc7524ff
[0m13:24:31.775177 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:24:31.775415 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_name.bffc7524ff, now test.ecommerce_test.not_null_dim_products_price.93519fc0ed)
[0m13:24:31.775636 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:24:31.779243 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_price.93519fc0ed"
[0m13:24:31.779538 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:24:31.779799 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:24:31.780254 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:24:31.780499 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:24:31.780926 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:24:31.781174 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:24:31.781387 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:24:31.781781 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.assert_total_amount_equals_sum_of_items
[0m13:24:31.782014 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:24:31.782289 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1)
[0m13:24:31.782664 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_products_price.93519fc0ed
[0m13:24:31.782897 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:24:31.783157 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a)
[0m13:24:31.783390 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:24:31.783622 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:24:31.783873 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.assert_total_amount_equals_sum_of_items, now test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a)
[0m13:24:31.784095 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:24:31.787393 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1"
[0m13:24:31.787726 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_price.93519fc0ed, now test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:24:31.787981 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:24:31.791081 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a"
[0m13:24:31.791367 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:24:31.794401 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a"
[0m13:24:31.798039 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:24:31.798308 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:24:31.798628 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:24:31.799057 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1
[0m13:24:31.799498 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a
[0m13:24:31.799748 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:24:31.800020 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:24:31.800240 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:24:31.800554 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:24:31.800982 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a
[0m13:24:31.801236 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362)
[0m13:24:31.801618 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b
[0m13:24:31.801850 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_quantity_sold.fdec65104a, now test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0)
[0m13:24:31.802094 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:24:31.802337 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:24:31.802574 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:24:31.802804 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:24:31.803041 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_products_total_revenue.07243f7e3a, now test.ecommerce_test.not_null_fct_orders_status.1455048989)
[0m13:24:31.806130 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362"
[0m13:24:31.806411 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:24:31.809595 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0"
[0m13:24:31.809861 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:24:31.810151 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:24:31.813199 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_status.1455048989"
[0m13:24:31.816810 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:24:31.817162 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:24:31.817369 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:24:31.817759 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:24:31.818151 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0
[0m13:24:31.818378 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:24:31.818735 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362
[0m13:24:31.819083 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:24:31.819308 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:24:31.819722 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_fct_orders_status.1455048989
[0m13:24:31.819985 [debug] [Thread-2  ]: Began running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:24:31.820215 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:24:31.820490 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6)
[0m13:24:31.820735 [debug] [Thread-1  ]: Began running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:24:31.820997 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985)
[0m13:24:31.821252 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5)
[0m13:24:31.821485 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:24:31.821720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_status.1455048989, now test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:24:31.821942 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:24:31.822154 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:24:31.825223 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6"
[0m13:24:31.825476 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:24:31.829905 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985"
[0m13:24:31.832926 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5"
[0m13:24:31.844587 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53"
[0m13:24:31.845021 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:24:31.845444 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985
[0m13:24:31.845682 [debug] [Thread-2  ]: Began running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:24:31.845921 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:24:31.846146 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:24:31.849184 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:24:31.849553 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:24:31.849790 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:24:31.850233 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6
[0m13:24:31.850493 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:24:31.850721 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:24:31.851161 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5
[0m13:24:31.851401 [debug] [Thread-4  ]: Began running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:24:31.851820 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:24:31.852384 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:24:31.852639 [debug] [Thread-3  ]: Began running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:24:31.852923 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_fct_orders_total_items.7d12c034a6, now test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a)
[0m13:24:31.853165 [debug] [Thread-1  ]: Began running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:24:31.853428 [debug] [Thread-2  ]: Began running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:24:31.853739 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.unique_fct_orders_order_id.523ddb6ce5, now test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:24:31.853994 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:24:31.854261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_test.not_null_dim_customers_name.e0448e04f1)
[0m13:24:31.854524 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:24:31.854771 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:24:31.858277 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a"
[0m13:24:31.858605 [debug] [Thread-1  ]: Began compiling node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:24:31.858861 [debug] [Thread-2  ]: Began compiling node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:24:31.862254 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:24:31.866482 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_test.not_null_dim_customers_name.e0448e04f1"
[0m13:24:31.872704 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:24:31.873310 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:24:31.873892 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a
[0m13:24:31.874158 [debug] [Thread-4  ]: Began running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:24:31.874420 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:24:31.874659 [debug] [Thread-4  ]: Began compiling node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:24:31.878244 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:24:31.878726 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:24:31.879320 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:24:31.879561 [debug] [Thread-1  ]: Began executing node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:24:31.879783 [debug] [Thread-2  ]: Began executing node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:24:31.880010 [debug] [Thread-3  ]: Began running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:24:31.880216 [debug] [Thread-4  ]: Began executing node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:24:31.880625 [debug] [Thread-1  ]: Finished running node test.ecommerce_test.not_null_dim_customers_name.e0448e04f1
[0m13:24:31.881008 [debug] [Thread-2  ]: Finished running node test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:24:31.881261 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_test.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_test.unique_dim_customers_email.0472f7c2e8)
[0m13:24:31.881671 [debug] [Thread-4  ]: Finished running node test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:24:31.882004 [debug] [Thread-3  ]: Began compiling node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:24:31.885255 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_test.unique_dim_customers_email.0472f7c2e8"
[0m13:24:31.885637 [debug] [Thread-3  ]: Began executing node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:24:31.886021 [debug] [Thread-3  ]: Finished running node test.ecommerce_test.unique_dim_customers_email.0472f7c2e8
[0m13:24:31.886545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:31.886745 [debug] [MainThread]: Connection 'test.ecommerce_test.not_null_dim_customers_name.e0448e04f1' was properly closed.
[0m13:24:31.886915 [debug] [MainThread]: Connection 'test.ecommerce_test.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4' was properly closed.
[0m13:24:31.887077 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_email.0472f7c2e8' was properly closed.
[0m13:24:31.887235 [debug] [MainThread]: Connection 'test.ecommerce_test.unique_dim_customers_customer_id.15c9f1e2fd' was properly closed.
[0m13:24:31.889625 [debug] [MainThread]: Command end result
[0m13:24:32.005202 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:24:32.007881 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:24:32.013424 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/run_results.json
[0m13:24:32.016346 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:24:32.016634 [info ] [MainThread]: Building catalog
[0m13:24:32.031497 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db_ex2.information_schema'
[0m13:24:32.037620 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m13:24:32.037922 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: BEGIN
[0m13:24:32.038108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:32.046168 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:24:32.046486 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex2.information_schema"
[0m13:24:32.046844 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_test", "target_name": "dev", "connection_name": "dbt_db_ex2.information_schema"} */

    
    

    select
        'dbt_db_ex2' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_date')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_total_amount_equals_sum_of_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_revenue')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('assert_no_duplicate_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_lifetime_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_items')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_customers_email')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_customer_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_price')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_name')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_total_amount')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_dim_products_total_quantity_sold')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('not_null_fct_orders_order_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('dbt_expectations_expect_column_304c8338142bcbe6b165b77b98c40fc3')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_products_product_id')) or (upper(sch.nspname) = upper('public_dbt_test__audit') and
           upper(tbl.relname) = upper('unique_dim_customers_email')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:24:32.055601 [debug] [ThreadPool]: SQL status: SELECT 214 in 0.008 seconds
[0m13:24:32.065858 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: ROLLBACK
[0m13:24:32.066437 [debug] [ThreadPool]: On dbt_db_ex2.information_schema: Close
[0m13:24:32.085886 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m13:24:32.117432 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/manifest.json
[0m13:24:32.118615 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/semantic_manifest.json
[0m13:24:32.118824 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex2/ecommerce_dbt/target/catalog.json
[0m13:24:32.119976 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2295626, "process_in_blocks": "0", "process_kernel_time": 0.186398, "process_mem_max_rss": "128368640", "process_out_blocks": "0", "process_user_time": 1.88063}
[0m13:24:32.120252 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:24:32.120202 after 1.23 seconds
[0m13:24:32.120504 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:24:32.120719 [debug] [MainThread]: Connection 'dbt_db_ex2.information_schema' was properly closed.
[0m13:24:32.120941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e27c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aba370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9f7c0>]}
[0m13:24:32.121195 [debug] [MainThread]: Flushing usage events
[0m13:24:33.105584 [debug] [MainThread]: An error was encountered while trying to flush usage events
