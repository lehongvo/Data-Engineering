[0m13:42:04.078316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110394c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110392e0>]}


============================== 13:42:04.082051 | 18237f39-6d21-4953-bd6c-4ecd04ba7c1a ==============================
[0m13:42:04.082051 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:42:04.082437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:42:04.216642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18237f39-6d21-4953-bd6c-4ecd04ba7c1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fa8d00>]}
[0m13:42:04.229876 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-38fnkbmj'
[0m13:42:04.230310 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:42:04.500250 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:42:04.501678 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:42:04.519869 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:42:04.525291 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:42:04.542620 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:42:04.543987 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m13:42:04.544253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18237f39-6d21-4953-bd6c-4ecd04ba7c1a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f5340>]}
[0m13:42:04.546346 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m13:42:04.856475 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m13:42:04.858723 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/metrics
  Requested range: =1.5.0, =1.5.0
  Compatible versions: ['0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.3.3', '0.3.4', '0.3.5']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m13:42:04.868655 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 211, in run
    self.lock()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/registry.py", line 124, in resolved
    raise PackageVersionNotFoundError(
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package dbt-labs/metrics
  Requested range: =1.5.0, =1.5.0
  Compatible versions: ['0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.3.3', '0.3.4', '0.3.5']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m13:42:04.870440 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.85708606, "process_in_blocks": "0", "process_kernel_time": 0.151239, "process_mem_max_rss": "104349696", "process_out_blocks": "0", "process_user_time": 1.080628}
[0m13:42:04.870730 [debug] [MainThread]: Command `dbt deps` failed at 13:42:04.870673 after 0.86 seconds
[0m13:42:04.870961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f5190>]}
[0m13:42:04.871204 [debug] [MainThread]: Flushing usage events
[0m13:42:06.932663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:44.297726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106442760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204b9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204b9340>]}


============================== 13:42:44.302302 | 0336d048-f67f-48a5-a224-7cf0fe007185 ==============================
[0m13:42:44.302302 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:42:44.302741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:42:44.448889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0336d048-f67f-48a5-a224-7cf0fe007185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ee070>]}
[0m13:42:44.467248 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-hwvs1xwe'
[0m13:42:44.467689 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:42:44.539985 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:42:44.541214 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:42:44.744957 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:42:44.755308 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:42:44.778220 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:42:44.780381 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m13:42:44.780782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0336d048-f67f-48a5-a224-7cf0fe007185', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219750d0>]}
[0m13:42:44.784090 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m13:42:44.804663 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m13:42:44.807647 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/metrics
  Requested range: =1.5.0, =1.5.0
  Compatible versions: ['0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.3.3', '0.3.4', '0.3.5']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m13:42:44.817260 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 211, in run
    self.lock()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/registry.py", line 124, in resolved
    raise PackageVersionNotFoundError(
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package dbt-labs/metrics
  Requested range: =1.5.0, =1.5.0
  Compatible versions: ['0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.3.3', '0.3.4', '0.3.5']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m13:42:44.818393 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.5824963, "process_in_blocks": "0", "process_kernel_time": 0.133725, "process_mem_max_rss": "102383616", "process_out_blocks": "0", "process_user_time": 1.060152}
[0m13:42:44.818685 [debug] [MainThread]: Command `dbt deps` failed at 13:42:44.818625 after 0.58 seconds
[0m13:42:44.818899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106442760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121975520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121975460>]}
[0m13:42:44.819131 [debug] [MainThread]: Flushing usage events
[0m13:42:45.816060 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:22.729171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e854c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e852e0>]}


============================== 13:43:22.732348 | 64f43bc0-0025-49f3-81eb-49158b7ee3bb ==============================
[0m13:43:22.732348 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:43:22.732773 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m13:43:22.875425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f43bc0-0025-49f3-81eb-49158b7ee3bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108df4d00>]}
[0m13:43:22.888573 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-gmwctvwd'
[0m13:43:22.888958 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:43:23.062255 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:43:23.064677 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:43:23.089465 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:43:23.099823 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:43:23.172387 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:43:23.175223 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m13:43:23.175823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '64f43bc0-0025-49f3-81eb-49158b7ee3bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109041340>]}
[0m13:43:23.180198 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m13:43:23.729964 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m13:43:23.736104 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/metrics
  Requested range: =1.5.0, =1.5.0
  Compatible versions: ['0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.3.3', '0.3.4', '0.3.5']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m13:43:23.756917 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 211, in run
    self.lock()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/registry.py", line 124, in resolved
    raise PackageVersionNotFoundError(
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package dbt-labs/metrics
  Requested range: =1.5.0, =1.5.0
  Compatible versions: ['0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.2.0', '0.3.0', '0.3.1', '0.3.2', '0.3.3', '0.3.4', '0.3.5']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m13:43:23.759864 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 1.0856404, "process_in_blocks": "0", "process_kernel_time": 0.1383, "process_mem_max_rss": "104235008", "process_out_blocks": "0", "process_user_time": 1.062386}
[0m13:43:23.760417 [debug] [MainThread]: Command `dbt deps` failed at 13:43:23.760280 after 1.09 seconds
[0m13:43:23.760872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10800e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090416a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109041190>]}
[0m13:43:23.761424 [debug] [MainThread]: Flushing usage events
[0m13:43:24.772502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:05.010531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d39460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d39280>]}


============================== 13:44:05.014922 | 06be741f-6967-42df-a6de-1a57d65514b5 ==============================
[0m13:44:05.014922 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:44:05.015314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:05.124846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06be741f-6967-42df-a6de-1a57d65514b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108011e20>]}
[0m13:44:05.137003 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-t_p0_n8o'
[0m13:44:05.137367 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:44:05.192951 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:44:05.194399 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:44:05.213808 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:44:05.221294 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m13:44:05.297994 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m13:44:05.299699 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_expectations` package is deprecated in favor of
`metaplane/dbt_expectations`. Please update your `packages.yml` configuration to
use `metaplane/dbt_expectations` instead.
[0m13:44:05.300088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '06be741f-6967-42df-a6de-1a57d65514b5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef5160>]}
[0m13:44:05.302450 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m13:44:05.319626 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m13:44:05.321964 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:44:05.550227 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:44:05.553007 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m13:44:05.626621 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m13:44:05.629035 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:44:05.647896 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:44:05.651409 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['=1.1.1', '>=0.8.1', '<0.9.0', '>=0.8.0', '<2.0.0', '>=0.9.0', '<2.0.0']
[0m13:44:05.662889 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 422, in reduce_versions
    to_return = to_return.reduce(version_specifier.to_range())
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 332, in reduce
    end = self._try_combine_upper_bound(self.end, other.end)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 320, in _try_combine_upper_bound
    return self._try_combine_upper_bound_with_exact(b, a)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 301, in _try_combine_upper_bound_with_exact
    raise VersionsNotCompatibleError()
dbt_common.exceptions.base.VersionsNotCompatibleError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/registry.py", line 100, in resolved
    range_ = semver.reduce_versions(*self.versions)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 424, in reduce_versions
    raise VersionsNotCompatibleError(
dbt_common.exceptions.base.VersionsNotCompatibleError: Could not find a satisfactory version from options: ['=1.1.1', '>=0.8.1', '<0.9.0', '>=0.8.0', '<2.0.0', '>=0.9.0', '<2.0.0']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 211, in run
    self.lock()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/registry.py", line 103, in resolved
    raise DependencyError(new_msg) from e
dbt.exceptions.DependencyError: Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['=1.1.1', '>=0.8.1', '<0.9.0', '>=0.8.0', '<2.0.0', '>=0.9.0', '<2.0.0']

[0m13:44:05.664612 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.7123015, "process_in_blocks": "0", "process_kernel_time": 0.144628, "process_mem_max_rss": "104153088", "process_out_blocks": "0", "process_user_time": 1.141608}
[0m13:44:05.664957 [debug] [MainThread]: Command `dbt deps` failed at 13:44:05.664894 after 0.71 seconds
[0m13:44:05.665214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef5340>]}
[0m13:44:05.665475 [debug] [MainThread]: Flushing usage events
[0m13:44:06.728783 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:31.756442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c28b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c28d60>]}


============================== 13:44:31.760267 | 3059598f-d712-41f6-8ce1-e90e9c85e696 ==============================
[0m13:44:31.760267 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:44:31.760747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:31.858320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3059598f-d712-41f6-8ce1-e90e9c85e696', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce4280>]}
[0m13:44:31.871268 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-bup_x6ig'
[0m13:44:31.871673 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:44:31.894772 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:44:31.896061 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:44:31.918955 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:44:31.925973 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m13:44:32.175641 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m13:44:32.195166 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m13:44:32.309669 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m13:44:32.311848 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:44:32.329371 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:44:32.331635 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m13:44:32.413425 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m13:44:32.416331 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:44:32.436047 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:44:32.437757 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m13:44:32.438095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3059598f-d712-41f6-8ce1-e90e9c85e696', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de5160>]}
[0m13:44:32.440845 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['=0.8.6', '>=0.8.1', '<0.9.0', '>=0.8.0', '<2.0.0', '>=0.9.0', '<2.0.0']
[0m13:44:32.452141 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 422, in reduce_versions
    to_return = to_return.reduce(version_specifier.to_range())
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 331, in reduce
    start = self._try_combine_lower_bound(self.start, other.start)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 288, in _try_combine_lower_bound
    return self._try_combine_lower_bound_with_exact(b, a)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 269, in _try_combine_lower_bound_with_exact
    raise VersionsNotCompatibleError()
dbt_common.exceptions.base.VersionsNotCompatibleError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/registry.py", line 100, in resolved
    range_ = semver.reduce_versions(*self.versions)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 424, in reduce_versions
    raise VersionsNotCompatibleError(
dbt_common.exceptions.base.VersionsNotCompatibleError: Could not find a satisfactory version from options: ['=0.8.6', '>=0.8.1', '<0.9.0', '>=0.8.0', '<2.0.0', '>=0.9.0', '<2.0.0']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 211, in run
    self.lock()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/registry.py", line 103, in resolved
    raise DependencyError(new_msg) from e
dbt.exceptions.DependencyError: Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['=0.8.6', '>=0.8.1', '<0.9.0', '>=0.8.0', '<2.0.0', '>=0.9.0', '<2.0.0']

[0m13:44:32.453808 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.75294065, "process_in_blocks": "0", "process_kernel_time": 0.132563, "process_mem_max_rss": "104431616", "process_out_blocks": "0", "process_user_time": 1.082881}
[0m13:44:32.454251 [debug] [MainThread]: Command `dbt deps` failed at 13:44:32.454177 after 0.75 seconds
[0m13:44:32.454546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108de5310>]}
[0m13:44:32.454857 [debug] [MainThread]: Flushing usage events
[0m13:44:33.443619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:02.282364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c53a0>]}


============================== 13:45:02.286073 | e1b41586-f6ae-43d2-a488-59a1210d43a5 ==============================
[0m13:45:02.286073 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:45:02.286538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --no-version-check', 'send_anonymous_usage_stats': 'True'}
[0m13:45:02.495436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1b41586-f6ae-43d2-a488-59a1210d43a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106921b20>]}
[0m13:45:02.613083 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-i211foch'
[0m13:45:02.613543 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:45:02.643258 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:45:02.644722 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:45:02.667285 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:45:02.673636 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json
[0m13:45:02.994307 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/metaplane/dbt_expectations.json 200
[0m13:45:02.998585 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json
[0m13:45:03.017917 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/metrics.json 200
[0m13:45:03.020575 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:45:03.341269 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:45:03.343816 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json
[0m13:45:03.361682 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/audit_helper.json 200
[0m13:45:03.363916 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m13:45:03.382747 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m13:45:03.384820 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `calogica/dbt_date` package is deprecated in favor of
`godatadriven/dbt_date`. Please update your `packages.yml` configuration to use
`godatadriven/dbt_date` instead.
[0m13:45:03.385252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e1b41586-f6ae-43d2-a488-59a1210d43a5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b80e80>]}
[0m13:45:03.387313 [error] [MainThread]: Encountered an error:
Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['=0.8.6', '>=0.8.1', '<0.9.0', '>=0.8.0', '<2.0.0', '>=0.9.0', '<2.0.0']
[0m13:45:03.401783 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 422, in reduce_versions
    to_return = to_return.reduce(version_specifier.to_range())
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 331, in reduce
    start = self._try_combine_lower_bound(self.start, other.start)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 288, in _try_combine_lower_bound
    return self._try_combine_lower_bound_with_exact(b, a)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 269, in _try_combine_lower_bound_with_exact
    raise VersionsNotCompatibleError()
dbt_common.exceptions.base.VersionsNotCompatibleError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/registry.py", line 100, in resolved
    range_ = semver.reduce_versions(*self.versions)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt_common/semver.py", line 424, in reduce_versions
    raise VersionsNotCompatibleError(
dbt_common.exceptions.base.VersionsNotCompatibleError: Could not find a satisfactory version from options: ['=0.8.6', '>=0.8.1', '<0.9.0', '>=0.8.0', '<2.0.0', '>=0.9.0', '<2.0.0']

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 455, in deps
    results = task.run()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 211, in run
    self.lock()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/deps/registry.py", line 103, in resolved
    raise DependencyError(new_msg) from e
dbt.exceptions.DependencyError: Version error for package dbt-labs/dbt_utils: Could not find a satisfactory version from options: ['=0.8.6', '>=0.8.1', '<0.9.0', '>=0.8.0', '<2.0.0', '>=0.9.0', '<2.0.0']

[0m13:45:03.403774 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 1.1925566, "process_in_blocks": "0", "process_kernel_time": 0.17993, "process_mem_max_rss": "99614720", "process_out_blocks": "0", "process_user_time": 1.233767}
[0m13:45:03.404218 [debug] [MainThread]: Command `dbt deps` failed at 13:45:03.404148 after 1.19 seconds
[0m13:45:03.404546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b4f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b80ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b80550>]}
[0m13:45:03.404850 [debug] [MainThread]: Flushing usage events
[0m13:45:04.491078 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:02.095829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a60a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6b93a0>]}


============================== 13:46:02.099252 | 72071ade-41d0-4c64-b58e-056ca6f425ee ==============================
[0m13:46:02.099252 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:46:02.099645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'version_check': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --no-version-check', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:46:02.203269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72071ade-41d0-4c64-b58e-056ca6f425ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c01100>]}
[0m13:46:02.215590 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-qj7kp8c9'
[0m13:46:02.216036 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:46:02.272429 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:46:02.273949 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:46:02.292222 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:46:02.297838 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:46:02.317853 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:46:02.328042 [info ] [MainThread]: Updating lock file in file path: /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/package-lock.yml
[0m13:46:02.329709 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-rzi3bm35'
[0m13:46:02.332387 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:46:02.917665 [info ] [MainThread]: Installed from version 1.3.0
[0m13:46:02.917982 [info ] [MainThread]: Up to date!
[0m13:46:02.918292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '72071ade-41d0-4c64-b58e-056ca6f425ee', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa11c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7570a0>]}
[0m13:46:02.918583 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:46:03.385387 [info ] [MainThread]: Installed from version 0.13.1
[0m13:46:03.385771 [info ] [MainThread]: Up to date!
[0m13:46:03.386085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '72071ade-41d0-4c64-b58e-056ca6f425ee', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c078e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c078940>]}
[0m13:46:03.387986 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3486366, "process_in_blocks": "0", "process_kernel_time": 0.202497, "process_mem_max_rss": "104300544", "process_out_blocks": "0", "process_user_time": 1.086371}
[0m13:46:03.388375 [debug] [MainThread]: Command `dbt deps` succeeded at 13:46:03.388294 after 1.35 seconds
[0m13:46:03.388670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a60a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7893d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928d2b0>]}
[0m13:46:03.388972 [debug] [MainThread]: Flushing usage events
[0m13:46:04.386066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:05.635135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107597760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840c340>]}


============================== 13:46:05.638520 | 6075649d-569b-4196-83a7-bd44fd99d88d ==============================
[0m13:46:05.638520 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:46:05.638957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:46:05.646236 [info ] [MainThread]: dbt version: 1.9.4
[0m13:46:05.646577 [info ] [MainThread]: python version: 3.9.6
[0m13:46:05.646858 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m13:46:05.647113 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m13:46:05.699630 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m13:46:05.699967 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m13:46:05.700176 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/dbt_project.yml
[0m13:46:05.700736 [info ] [MainThread]: adapter type: postgres
[0m13:46:05.700969 [info ] [MainThread]: adapter version: 1.9.0
[0m13:46:05.789129 [info ] [MainThread]: Configuration:
[0m13:46:05.789507 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:46:05.789718 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:46:05.789912 [info ] [MainThread]: Required dependencies:
[0m13:46:05.790202 [debug] [MainThread]: Executing "git --help"
[0m13:46:05.812444 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:46:05.813148 [debug] [MainThread]: STDERR: "b''"
[0m13:46:05.813413 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:46:05.813655 [info ] [MainThread]: Connection:
[0m13:46:05.813924 [info ] [MainThread]:   host: localhost
[0m13:46:05.814208 [info ] [MainThread]:   port: 5434
[0m13:46:05.814389 [info ] [MainThread]:   user: dbt_user
[0m13:46:05.814571 [info ] [MainThread]:   database: dbt_db_ex3
[0m13:46:05.814750 [info ] [MainThread]:   schema: public
[0m13:46:05.814940 [info ] [MainThread]:   connect_timeout: 10
[0m13:46:05.815120 [info ] [MainThread]:   role: None
[0m13:46:05.815303 [info ] [MainThread]:   search_path: None
[0m13:46:05.815478 [info ] [MainThread]:   keepalives_idle: 0
[0m13:46:05.815652 [info ] [MainThread]:   sslmode: None
[0m13:46:05.815831 [info ] [MainThread]:   sslcert: None
[0m13:46:05.816003 [info ] [MainThread]:   sslkey: None
[0m13:46:05.816177 [info ] [MainThread]:   sslrootcert: None
[0m13:46:05.816351 [info ] [MainThread]:   application_name: dbt
[0m13:46:05.816525 [info ] [MainThread]:   retries: 1
[0m13:46:05.817037 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:46:05.889588 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:46:05.919143 [debug] [MainThread]: Using postgres connection "debug"
[0m13:46:05.919479 [debug] [MainThread]: On debug: select 1 as id
[0m13:46:05.919709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:06.026754 [debug] [MainThread]: SQL status: SELECT 1 in 0.107 seconds
[0m13:46:06.027711 [debug] [MainThread]: On debug: Close
[0m13:46:06.028029 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:46:06.028328 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:46:06.029559 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.45344922, "process_in_blocks": "0", "process_kernel_time": 0.166852, "process_mem_max_rss": "113721344", "process_out_blocks": "0", "process_user_time": 1.117336}
[0m13:46:06.030075 [debug] [MainThread]: Command `dbt debug` succeeded at 13:46:06.029957 after 0.45 seconds
[0m13:46:06.030758 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:46:06.031090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107597760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108906730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f85b0>]}
[0m13:46:06.031470 [debug] [MainThread]: Flushing usage events
[0m13:46:07.065676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:08.503387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d01820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d7bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d7beb0>]}


============================== 13:46:08.507749 | acdfee88-26c1-41bb-bf1f-780ec2740b01 ==============================
[0m13:46:08.507749 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:46:08.508907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select source:* staging.* core.*', 'send_anonymous_usage_stats': 'True'}
[0m13:46:08.706233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acdfee88-26c1-41bb-bf1f-780ec2740b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11318cdc0>]}
[0m13:46:08.842699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acdfee88-26c1-41bb-bf1f-780ec2740b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131cb130>]}
[0m13:46:08.843469 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:46:08.963384 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:46:08.964490 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:46:08.964803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'acdfee88-26c1-41bb-bf1f-780ec2740b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ff2e0>]}
[0m13:46:10.379802 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_products (models/staging/stg_products.sql)
  maximum recursion depth exceeded while calling a Python object
[0m13:46:10.381588 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0091188, "process_in_blocks": "0", "process_kernel_time": 0.207438, "process_mem_max_rss": "110510080", "process_out_blocks": "0", "process_user_time": 2.354183}
[0m13:46:10.381970 [debug] [MainThread]: Command `dbt run` failed at 13:46:10.381903 after 2.01 seconds
[0m13:46:10.382301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d01820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ff2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d6eeb0>]}
[0m13:46:10.382821 [debug] [MainThread]: Flushing usage events
[0m13:46:11.337968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:09.831168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103407790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10427d3a0>]}


============================== 13:47:09.834531 | de582841-9e7d-42f8-8b9a-97511c74e4be ==============================
[0m13:47:09.834531 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:47:09.834916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'version_check': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --no-version-check', 'send_anonymous_usage_stats': 'True'}
[0m13:47:09.932233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de582841-9e7d-42f8-8b9a-97511c74e4be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041d9b20>]}
[0m13:47:09.971548 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-f3cqqb50'
[0m13:47:09.971878 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:47:10.023046 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:47:10.024452 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:47:10.043099 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:47:10.046660 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:47:10.375888 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:47:10.380775 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:47:10.904637 [info ] [MainThread]: Installed from version 1.3.0
[0m13:47:10.904950 [info ] [MainThread]: Up to date!
[0m13:47:10.905203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'de582841-9e7d-42f8-8b9a-97511c74e4be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10218db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036d59a0>]}
[0m13:47:10.905478 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:47:11.370651 [info ] [MainThread]: Installed from version 0.13.1
[0m13:47:11.371017 [info ] [MainThread]: Up to date!
[0m13:47:11.371319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'de582841-9e7d-42f8-8b9a-97511c74e4be', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10443b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10443b850>]}
[0m13:47:11.373134 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5951173, "process_in_blocks": "0", "process_kernel_time": 0.210726, "process_mem_max_rss": "103612416", "process_out_blocks": "0", "process_user_time": 1.081792}
[0m13:47:11.373526 [debug] [MainThread]: Command `dbt deps` succeeded at 13:47:11.373450 after 1.60 seconds
[0m13:47:11.373811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103407790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c11ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439b0a0>]}
[0m13:47:11.374090 [debug] [MainThread]: Flushing usage events
[0m13:47:12.347340 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:13.756071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d027c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f784c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f782e0>]}


============================== 13:47:13.759274 | 39942428-bdf6-459b-a4da-9b382725b56d ==============================
[0m13:47:13.759274 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:47:13.759684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:13.767284 [info ] [MainThread]: dbt version: 1.9.4
[0m13:47:13.767665 [info ] [MainThread]: python version: 3.9.6
[0m13:47:13.767964 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m13:47:13.768242 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m13:47:13.822652 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m13:47:13.823030 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m13:47:13.823241 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/dbt_project.yml
[0m13:47:13.823941 [info ] [MainThread]: adapter type: postgres
[0m13:47:13.824201 [info ] [MainThread]: adapter version: 1.9.0
[0m13:47:13.922849 [info ] [MainThread]: Configuration:
[0m13:47:13.923215 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:47:13.923436 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:47:13.923637 [info ] [MainThread]: Required dependencies:
[0m13:47:13.923914 [debug] [MainThread]: Executing "git --help"
[0m13:47:13.943499 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:47:13.944161 [debug] [MainThread]: STDERR: "b''"
[0m13:47:13.944444 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:47:13.944692 [info ] [MainThread]: Connection:
[0m13:47:13.944954 [info ] [MainThread]:   host: localhost
[0m13:47:13.945152 [info ] [MainThread]:   port: 5434
[0m13:47:13.945335 [info ] [MainThread]:   user: dbt_user
[0m13:47:13.945517 [info ] [MainThread]:   database: dbt_db_ex3
[0m13:47:13.945702 [info ] [MainThread]:   schema: public
[0m13:47:13.945939 [info ] [MainThread]:   connect_timeout: 10
[0m13:47:13.946262 [info ] [MainThread]:   role: None
[0m13:47:13.946502 [info ] [MainThread]:   search_path: None
[0m13:47:13.946698 [info ] [MainThread]:   keepalives_idle: 0
[0m13:47:13.946888 [info ] [MainThread]:   sslmode: None
[0m13:47:13.947073 [info ] [MainThread]:   sslcert: None
[0m13:47:13.947255 [info ] [MainThread]:   sslkey: None
[0m13:47:13.947436 [info ] [MainThread]:   sslrootcert: None
[0m13:47:13.947617 [info ] [MainThread]:   application_name: dbt
[0m13:47:13.947832 [info ] [MainThread]:   retries: 1
[0m13:47:13.948362 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:14.030668 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:47:14.062108 [debug] [MainThread]: Using postgres connection "debug"
[0m13:47:14.062421 [debug] [MainThread]: On debug: select 1 as id
[0m13:47:14.062631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:47:14.094224 [debug] [MainThread]: SQL status: SELECT 1 in 0.032 seconds
[0m13:47:14.095017 [debug] [MainThread]: On debug: Close
[0m13:47:14.095348 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:47:14.095681 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:47:14.096936 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.40129524, "process_in_blocks": "0", "process_kernel_time": 0.169877, "process_mem_max_rss": "114753536", "process_out_blocks": "0", "process_user_time": 1.152899}
[0m13:47:14.097301 [debug] [MainThread]: Command `dbt debug` succeeded at 13:47:14.097228 after 0.40 seconds
[0m13:47:14.097533 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:47:14.097847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d027c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107468490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107139ee0>]}
[0m13:47:14.098170 [debug] [MainThread]: Flushing usage events
[0m13:47:15.074044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:16.140818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2c1f0>]}


============================== 13:47:16.143515 | d2c3ff92-9f25-4f28-a08b-2eb68bf5a709 ==============================
[0m13:47:16.143515 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:47:16.143910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select source:* staging.* core.*', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:16.290309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2c3ff92-9f25-4f28-a08b-2eb68bf5a709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4b1f0>]}
[0m13:47:16.337087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2c3ff92-9f25-4f28-a08b-2eb68bf5a709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a86790>]}
[0m13:47:16.337705 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:47:16.415770 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:47:16.416356 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:47:16.416604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd2c3ff92-9f25-4f28-a08b-2eb68bf5a709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108422d30>]}
[0m13:47:17.799218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_datamart.sources
[0m13:47:17.807698 [error] [MainThread]: Encountered an error:
Compilation Error
  'model' is undefined
[0m13:47:17.808999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.718271, "process_in_blocks": "0", "process_kernel_time": 0.142367, "process_mem_max_rss": "123076608", "process_out_blocks": "0", "process_user_time": 2.418159}
[0m13:47:17.809348 [debug] [MainThread]: Command `dbt run` failed at 13:47:17.809290 after 1.72 seconds
[0m13:47:17.809612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b6e670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b6efd0>]}
[0m13:47:17.809895 [debug] [MainThread]: Flushing usage events
[0m13:47:18.783082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:46.590520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaa460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eaa280>]}


============================== 13:48:46.594005 | 7a188c75-1843-40f3-97db-d81711b36d48 ==============================
[0m13:48:46.594005 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:48:46.594418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select source:* staging.* core.* --vars {monitoring_enabled: false}', 'send_anonymous_usage_stats': 'True'}
[0m13:48:46.868543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a188c75-1843-40f3-97db-d81711b36d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107211af0>]}
[0m13:48:46.928954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a188c75-1843-40f3-97db-d81711b36d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107211dc0>]}
[0m13:48:46.930010 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:48:47.022196 [debug] [MainThread]: checksum: ea0c879e6197322c6b1d922b2530e73c48a7dda244a276baa676024ceb155f36, vars: {'monitoring_enabled': False}, profile: , target: , version: 1.9.4
[0m13:48:47.111287 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:48:47.111634 [debug] [MainThread]: previous checksum: ea0c879e6197322c6b1d922b2530e73c48a7dda244a276baa676024ceb155f36, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m13:48:47.111839 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:48:47.112055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a188c75-1843-40f3-97db-d81711b36d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690fbb0>]}
[0m13:48:48.499525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_datamart.sources
[0m13:48:48.507784 [error] [MainThread]: Encountered an error:
Compilation Error
  'this' is undefined
[0m13:48:48.509051 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9889386, "process_in_blocks": "0", "process_kernel_time": 0.202281, "process_mem_max_rss": "122978304", "process_out_blocks": "0", "process_user_time": 2.580834}
[0m13:48:48.509381 [debug] [MainThread]: Command `dbt run` failed at 13:48:48.509322 after 1.99 seconds
[0m13:48:48.509640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9efd0>]}
[0m13:48:48.509907 [debug] [MainThread]: Flushing usage events
[0m13:48:49.508389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:28.203299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082123a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082121c0>]}


============================== 13:49:28.206801 | 2974a54d-6ef0-41fa-a6fb-7f9199c4406f ==============================
[0m13:49:28.206801 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:49:28.207184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging.stg_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:28.354997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2974a54d-6ef0-41fa-a6fb-7f9199c4406f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10856a8e0>]}
[0m13:49:28.401928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2974a54d-6ef0-41fa-a6fb-7f9199c4406f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853e820>]}
[0m13:49:28.402715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:49:28.490121 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:49:28.581943 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:49:28.583331 [debug] [MainThread]: previous checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, current checksum: ea0c879e6197322c6b1d922b2530e73c48a7dda244a276baa676024ceb155f36
[0m13:49:28.585327 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:49:28.585871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2974a54d-6ef0-41fa-a6fb-7f9199c4406f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c77bb0>]}
[0m13:49:30.044152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2974a54d-6ef0-41fa-a6fb-7f9199c4406f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092a9eb0>]}
[0m13:49:30.126930 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:49:30.130572 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:49:30.146075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2974a54d-6ef0-41fa-a6fb-7f9199c4406f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092e6d30>]}
[0m13:49:30.146455 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:49:30.146680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2974a54d-6ef0-41fa-a6fb-7f9199c4406f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c11f0>]}
[0m13:49:30.147730 [info ] [MainThread]: 
[0m13:49:30.147946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:30.148143 [info ] [MainThread]: 
[0m13:49:30.148451 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:49:30.148937 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:49:30.182672 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:49:30.185775 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:49:30.186036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:30.219110 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m13:49:30.220066 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:49:30.224386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:49:30.229224 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:49:30.229468 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:49:30.229663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:30.234362 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:49:30.234698 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:49:30.234911 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:49:30.237854 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m13:49:30.238732 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:49:30.239236 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:49:30.244248 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:30.244507 [debug] [MainThread]: On master: BEGIN
[0m13:49:30.244776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:30.248485 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:49:30.248770 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:30.249029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:49:30.256176 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m13:49:30.257115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2974a54d-6ef0-41fa-a6fb-7f9199c4406f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6dcd0>]}
[0m13:49:30.257483 [debug] [MainThread]: On master: ROLLBACK
[0m13:49:30.258241 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:30.258540 [debug] [MainThread]: On master: BEGIN
[0m13:49:30.259570 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:49:30.259858 [debug] [MainThread]: On master: COMMIT
[0m13:49:30.260098 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:30.260317 [debug] [MainThread]: On master: COMMIT
[0m13:49:30.260911 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:30.261156 [debug] [MainThread]: On master: Close
[0m13:49:30.265703 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:49:30.266167 [info ] [Thread-1  ]: 1 of 1 START sql view model public.stg_customers ............................... [RUN]
[0m13:49:30.266541 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.stg_customers)
[0m13:49:30.266800 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:49:30.274068 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:49:30.274926 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:49:30.306148 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_customers"
[0m13:49:30.307483 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:30.307813 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: BEGIN
[0m13:49:30.308049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:30.314094 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:49:30.314431 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:30.314667 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */

  create view "dbt_db_ex3"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email,
        coalesce(phone, 'Unknown') as phone,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:49:30.318060 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:49:30.322883 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:30.323161 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:49:30.324804 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:30.335267 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:49:30.335596 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:30.335818 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:49:30.338232 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:49:30.377131 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_customers__dbt_backup"
[0m13:49:30.380101 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:30.380377 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
drop view if exists "dbt_db_ex3"."public"."stg_customers__dbt_backup" cascade
[0m13:49:30.381544 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m13:49:30.383051 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: Close
[0m13:49:30.384312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2974a54d-6ef0-41fa-a6fb-7f9199c4406f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b90610>]}
[0m13:49:30.384699 [info ] [Thread-1  ]: 1 of 1 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:49:30.385047 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:49:30.385660 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:30.385844 [debug] [MainThread]: On master: BEGIN
[0m13:49:30.386011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:30.397588 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:49:30.397916 [debug] [MainThread]: On master: COMMIT
[0m13:49:30.398137 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:30.398340 [debug] [MainThread]: On master: COMMIT
[0m13:49:30.398801 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:30.399039 [debug] [MainThread]: On master: Close
[0m13:49:30.399350 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:30.399553 [debug] [MainThread]: Connection 'model.ecommerce_datamart.stg_customers' was properly closed.
[0m13:49:30.399770 [info ] [MainThread]: 
[0m13:49:30.399997 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m13:49:30.400434 [debug] [MainThread]: Command end result
[0m13:49:30.434831 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:49:30.436544 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:49:30.441620 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:49:30.441926 [info ] [MainThread]: 
[0m13:49:30.442213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:30.442419 [info ] [MainThread]: 
[0m13:49:30.442633 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:49:30.443763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.291972, "process_in_blocks": "0", "process_kernel_time": 0.223127, "process_mem_max_rss": "134905856", "process_out_blocks": "0", "process_user_time": 2.832874}
[0m13:49:30.444044 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:30.443988 after 2.29 seconds
[0m13:49:30.444298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853e820>]}
[0m13:49:30.444551 [debug] [MainThread]: Flushing usage events
[0m13:49:31.783476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:37.924259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672e400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10672e220>]}


============================== 13:49:37.927325 | 98e60dfc-a860-47e7-b0c2-6e19c01de9af ==============================
[0m13:49:37.927325 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:49:37.927852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging.* core.*', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:38.080463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edbfd0>]}
[0m13:49:38.128398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aca790>]}
[0m13:49:38.129229 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:49:38.222351 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:49:38.354103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:38.354463 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:38.395796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e1ee0>]}
[0m13:49:38.517298 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:49:38.519878 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:49:38.534566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a9b80>]}
[0m13:49:38.534993 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:49:38.535239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e4f70>]}
[0m13:49:38.552225 [info ] [MainThread]: 
[0m13:49:38.555705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:38.564212 [info ] [MainThread]: 
[0m13:49:38.583652 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:49:38.635104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:49:38.670324 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:49:38.670690 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:49:38.670904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:38.699237 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.028 seconds
[0m13:49:38.701870 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:49:38.705645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:49:38.713918 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:49:38.714408 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:49:38.714613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:38.720528 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:49:38.720803 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:49:38.721015 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:49:38.723199 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m13:49:38.724112 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:49:38.724599 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:49:38.729862 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:38.730185 [debug] [MainThread]: On master: BEGIN
[0m13:49:38.730383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:38.734317 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:49:38.734617 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:38.734881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:49:38.742899 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m13:49:38.744040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107799ee0>]}
[0m13:49:38.744394 [debug] [MainThread]: On master: ROLLBACK
[0m13:49:38.744950 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:38.745198 [debug] [MainThread]: On master: BEGIN
[0m13:49:38.746020 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:49:38.746251 [debug] [MainThread]: On master: COMMIT
[0m13:49:38.746473 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:38.746683 [debug] [MainThread]: On master: COMMIT
[0m13:49:38.747126 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:38.747370 [debug] [MainThread]: On master: Close
[0m13:49:38.749807 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:49:38.750226 [info ] [Thread-1  ]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m13:49:38.750577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.stg_customers)
[0m13:49:38.750841 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:49:38.757755 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:49:38.758536 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:49:38.784288 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_customers"
[0m13:49:38.785035 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:38.785270 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: BEGIN
[0m13:49:38.785484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:38.791807 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:49:38.792127 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:38.792379 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */

  create view "dbt_db_ex3"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email,
        coalesce(phone, 'Unknown') as phone,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:49:38.795613 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:49:38.801558 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:38.801891 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:49:38.802927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:38.805361 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:38.805605 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:49:38.806800 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:38.818278 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:49:38.818635 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:38.818870 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:49:38.821357 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:49:38.826096 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_customers__dbt_backup"
[0m13:49:38.828950 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:38.829218 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
drop view if exists "dbt_db_ex3"."public"."stg_customers__dbt_backup" cascade
[0m13:49:38.833136 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m13:49:38.834819 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: Close
[0m13:49:38.836351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ec220>]}
[0m13:49:38.836834 [info ] [Thread-1  ]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m13:49:38.837218 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:49:38.837486 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_order_items
[0m13:49:38.837861 [info ] [Thread-1  ]: 2 of 8 START sql incremental model public.stg_order_items ...................... [RUN]
[0m13:49:38.838218 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_customers, now model.ecommerce_datamart.stg_order_items)
[0m13:49:38.838483 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_order_items
[0m13:49:38.843889 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_order_items"
[0m13:49:38.844439 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_order_items
[0m13:49:38.873292 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_order_items"
[0m13:49:38.873929 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:38.874164 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: BEGIN
[0m13:49:38.874425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:38.881025 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:49:38.881364 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:38.881605 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      
  
    

  create  table "dbt_db_ex3"."public"."stg_order_items"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."order_items"
    
    
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity,
        coalesce(unit_price, 0) as unit_price,
        coalesce(discount_amount, 0) as discount_amount,
        (quantity * unit_price) - coalesce(discount_amount, 0) as item_total,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:49:38.887622 [debug] [Thread-1  ]: SQL status: SELECT 306 in 0.006 seconds
[0m13:49:38.891103 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:49:38.891403 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:38.891653 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:49:38.892502 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:38.892997 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: Close
[0m13:49:38.893403 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104f3be0>]}
[0m13:49:38.893855 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model public.stg_order_items ................. [[32mSELECT 306[0m in 0.06s]
[0m13:49:38.894235 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_order_items
[0m13:49:38.894507 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_orders
[0m13:49:38.894858 [info ] [Thread-1  ]: 3 of 8 START sql incremental model public.stg_orders ........................... [RUN]
[0m13:49:38.895162 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_order_items, now model.ecommerce_datamart.stg_orders)
[0m13:49:38.895403 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_orders
[0m13:49:38.898626 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_orders"
[0m13:49:38.899178 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_orders
[0m13:49:38.902658 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_orders"
[0m13:49:38.903336 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:38.903677 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: BEGIN
[0m13:49:38.903914 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:38.908772 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:49:38.909118 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:38.909363 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      
  
    

  create  table "dbt_db_ex3"."public"."stg_orders"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."orders"
    
    
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        payment_method,
        shipping_address,
        shipping_cost,
        total_amount,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:49:38.912243 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.003 seconds
[0m13:49:38.913229 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:49:38.913508 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:38.913747 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:49:38.914928 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:38.915632 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: Close
[0m13:49:38.916060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106affa0>]}
[0m13:49:38.916503 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model public.stg_orders ...................... [[32mSELECT 100[0m in 0.02s]
[0m13:49:38.916863 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_orders
[0m13:49:38.917118 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_products
[0m13:49:38.917473 [info ] [Thread-1  ]: 4 of 8 START sql view model public.stg_products ................................ [RUN]
[0m13:49:38.917853 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_orders, now model.ecommerce_datamart.stg_products)
[0m13:49:38.918092 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_products
[0m13:49:38.920488 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_products"
[0m13:49:38.920979 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_products
[0m13:49:38.924021 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_products"
[0m13:49:38.924625 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:38.924862 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: BEGIN
[0m13:49:38.925078 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:38.928699 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:49:38.929062 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:38.929329 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */

  create view "dbt_db_ex3"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price,
        category,
        coalesce(inventory_count, 0) as inventory_count,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:49:38.931241 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:49:38.935000 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:38.935294 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
alter table "dbt_db_ex3"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:49:38.936100 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:38.936911 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:49:38.937153 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:38.937363 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:49:38.937987 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:49:38.939857 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_products__dbt_backup"
[0m13:49:38.940200 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:38.940418 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
drop view if exists "dbt_db_ex3"."public"."stg_products__dbt_backup" cascade
[0m13:49:38.941105 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m13:49:38.942090 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: Close
[0m13:49:38.942500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ccd30>]}
[0m13:49:38.942925 [info ] [Thread-1  ]: 4 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.02s]
[0m13:49:38.943280 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_products
[0m13:49:38.943590 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers
[0m13:49:38.943981 [info ] [Thread-1  ]: 5 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m13:49:38.944361 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_products, now model.ecommerce_datamart.dim_customers)
[0m13:49:38.944614 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers
[0m13:49:38.947141 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers"
[0m13:49:38.947689 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers
[0m13:49:38.957027 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers"
[0m13:49:38.957837 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:38.958078 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: BEGIN
[0m13:49:38.958290 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:38.964026 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:49:38.964337 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:38.964591 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db_ex3"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        sum(total_amount) as lifetime_value
    from "dbt_db_ex3"."public"."stg_orders"
    group by 1
)

select
    c.customer_id,
    c.name,
    c.email,
    c.phone,
    c.created_at,
    coalesce(co.order_count, 0) as lifetime_orders,
    co.first_order_date,
    co.most_recent_order_date,
    coalesce(co.lifetime_value, 0) as lifetime_value,
    current_timestamp as updated_at
from customers c
left join customer_orders co using (customer_id)
  );
  
[0m13:49:38.968090 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m13:49:38.971066 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:38.971372 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
alter table "dbt_db_ex3"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:49:38.972059 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:38.972871 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:49:38.973125 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:38.973357 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:49:38.974209 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:38.976281 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_customers__dbt_backup"
[0m13:49:38.978736 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:38.979010 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
drop table if exists "dbt_db_ex3"."public"."dim_customers__dbt_backup" cascade
[0m13:49:38.979601 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:49:38.980442 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: Close
[0m13:49:38.981047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f8d00>]}
[0m13:49:38.981672 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.dim_customers ......................... [[32mSELECT 10[0m in 0.04s]
[0m13:49:38.982125 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers
[0m13:49:38.982446 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_orders
[0m13:49:38.982863 [info ] [Thread-1  ]: 6 of 8 START sql table model public.fct_orders ................................. [RUN]
[0m13:49:38.983746 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers, now model.ecommerce_datamart.fct_orders)
[0m13:49:38.984557 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_orders
[0m13:49:38.987430 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_orders"
[0m13:49:38.988987 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_orders
[0m13:49:38.991770 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_orders"
[0m13:49:38.992236 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:38.992471 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: BEGIN
[0m13:49:38.992690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:38.998395 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:49:38.998730 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:38.999084 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

order_items as (
    select
        order_id,
        count(*) as number_of_items,
        sum(quantity) as total_items,
        sum(item_total) as items_subtotal
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_date,
    o.status,
    o.payment_method,
    o.shipping_address,
    o.shipping_cost,
    o.total_amount,
    oi.number_of_items,
    oi.total_items,
    oi.items_subtotal,
    (oi.items_subtotal + o.shipping_cost) as calculated_total,
    abs(o.total_amount - (oi.items_subtotal + o.shipping_cost)) as total_amount_discrepancy,
    o.created_at,
    o.updated_at,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    extract(hour from o.order_date) as order_hour
from orders o
left join order_items oi using (order_id)
  );
  
[0m13:49:39.002691 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.003 seconds
[0m13:49:39.005476 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:39.005747 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
alter table "dbt_db_ex3"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:49:39.006312 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:39.007166 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:49:39.007437 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:39.007677 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:49:39.008624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:39.010885 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_orders__dbt_backup"
[0m13:49:39.011274 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:39.011506 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
drop table if exists "dbt_db_ex3"."public"."fct_orders__dbt_backup" cascade
[0m13:49:39.012103 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:49:39.012913 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: Close
[0m13:49:39.013320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11074d7f0>]}
[0m13:49:39.013764 [info ] [Thread-1  ]: 6 of 8 OK created sql table model public.fct_orders ............................ [[32mSELECT 100[0m in 0.03s]
[0m13:49:39.014122 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_orders
[0m13:49:39.014367 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products
[0m13:49:39.014651 [info ] [Thread-1  ]: 7 of 8 START sql table model public.dim_products ............................... [RUN]
[0m13:49:39.015001 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_orders, now model.ecommerce_datamart.dim_products)
[0m13:49:39.015250 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products
[0m13:49:39.017883 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products"
[0m13:49:39.018415 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products
[0m13:49:39.022197 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products"
[0m13:49:39.022842 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:39.023081 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: BEGIN
[0m13:49:39.023297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:39.027703 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:49:39.028035 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:39.028302 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db_ex3"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(item_total) as total_revenue
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    p.product_id,
    p.name,
    p.price,
    p.category,
    p.inventory_count,
    p.is_active,
    p.created_at,
    coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(ps.total_revenue, 0) as total_revenue,
    case
        when p.inventory_count = 0 then 'Out of stock'
        when p.inventory_count < 10 then 'Low stock'
        else 'In stock'
    end as inventory_status,
    current_timestamp as updated_at
from products p
left join product_sales ps using (product_id)
  );
  
[0m13:49:39.031081 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.002 seconds
[0m13:49:39.033671 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:39.033929 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
alter table "dbt_db_ex3"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:49:39.034936 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:39.036035 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:49:39.036311 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:39.036537 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:49:39.037930 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:39.040083 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products__dbt_backup"
[0m13:49:39.040469 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:39.040717 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
drop table if exists "dbt_db_ex3"."public"."dim_products__dbt_backup" cascade
[0m13:49:39.041726 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:49:39.042613 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: Close
[0m13:49:39.043006 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f8d00>]}
[0m13:49:39.043434 [info ] [Thread-1  ]: 7 of 8 OK created sql table model public.dim_products .......................... [[32mSELECT 15[0m in 0.03s]
[0m13:49:39.043805 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products
[0m13:49:39.044062 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_order_items
[0m13:49:39.044429 [info ] [Thread-1  ]: 8 of 8 START sql table model public.fct_order_items ............................ [RUN]
[0m13:49:39.044764 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products, now model.ecommerce_datamart.fct_order_items)
[0m13:49:39.045026 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_order_items
[0m13:49:39.047773 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_order_items"
[0m13:49:39.048394 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_order_items
[0m13:49:39.051538 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_order_items"
[0m13:49:39.052230 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:49:39.052471 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: BEGIN
[0m13:49:39.052688 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:39.057123 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:49:39.057377 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:49:39.057633 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp"
  
  
    as
  
  (
    with order_items as (
    select * from "dbt_db_ex3"."public"."stg_order_items"
),

orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

products as (
    select * from "dbt_db_ex3"."public"."stg_products"
)

select
    oi.order_item_id,
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.order_date,
    p.category as product_category,
    oi.quantity,
    oi.unit_price,
    oi.discount_amount,
    oi.item_total,
    (oi.unit_price * oi.quantity) as gross_item_sales_value,
    oi.discount_amount as item_discount_value,
    ((oi.unit_price * oi.quantity) - oi.item_total) as total_discount_impact,
    case
        when oi.discount_amount > 0 then true
        else false
    end as is_discounted,
    o.status as order_status,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    oi.created_at,
    current_timestamp as updated_at
from order_items oi
join orders o using (order_id)
join products p using (product_id)
  );
  
[0m13:49:39.061250 [debug] [Thread-1  ]: SQL status: SELECT 306 in 0.003 seconds
[0m13:49:39.065318 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:49:39.065676 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
alter table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m13:49:39.066511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:39.067595 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:49:39.067901 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:49:39.068154 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:49:39.069208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:39.071413 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_order_items__dbt_backup"
[0m13:49:39.071858 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:49:39.072113 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
drop table if exists "dbt_db_ex3"."public"."fct_order_items__dbt_backup" cascade
[0m13:49:39.072805 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:49:39.073784 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: Close
[0m13:49:39.074246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98e60dfc-a860-47e7-b0c2-6e19c01de9af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f5d00>]}
[0m13:49:39.074798 [info ] [Thread-1  ]: 8 of 8 OK created sql table model public.fct_order_items ....................... [[32mSELECT 306[0m in 0.03s]
[0m13:49:39.075347 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_order_items
[0m13:49:39.076378 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:39.076650 [debug] [MainThread]: On master: BEGIN
[0m13:49:39.076853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:49:39.080358 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:49:39.080877 [debug] [MainThread]: On master: COMMIT
[0m13:49:39.081106 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:39.081312 [debug] [MainThread]: On master: COMMIT
[0m13:49:39.081867 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:39.082082 [debug] [MainThread]: On master: Close
[0m13:49:39.082400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:49:39.082594 [debug] [MainThread]: Connection 'model.ecommerce_datamart.fct_order_items' was properly closed.
[0m13:49:39.082884 [info ] [MainThread]: 
[0m13:49:39.083116 [info ] [MainThread]: Finished running 2 incremental models, 4 table models, 2 view models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m13:49:39.084128 [debug] [MainThread]: Command end result
[0m13:49:39.145076 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:49:39.146280 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:49:39.150305 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:49:39.150531 [info ] [MainThread]: 
[0m13:49:39.150782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:49:39.150983 [info ] [MainThread]: 
[0m13:49:39.151192 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:49:39.152213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2835516, "process_in_blocks": "0", "process_kernel_time": 0.203485, "process_mem_max_rss": "127172608", "process_out_blocks": "0", "process_user_time": 1.75475}
[0m13:49:39.152451 [debug] [MainThread]: Command `dbt run` succeeded at 13:49:39.152405 after 1.28 seconds
[0m13:49:39.152672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a6f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106e3760>]}
[0m13:49:39.152895 [debug] [MainThread]: Flushing usage events
[0m13:49:40.386058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:52.661276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b036d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79280>]}


============================== 13:49:52.664284 | 28b0815e-0e91-46c9-b5cb-761bf8cc9ac6 ==============================
[0m13:49:52.664284 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:49:52.664668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps --no-version-check', 'send_anonymous_usage_stats': 'True'}
[0m13:49:52.761391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28b0815e-0e91-46c9-b5cb-761bf8cc9ac6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79190>]}
[0m13:49:52.802728 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-52qr7qqp'
[0m13:49:52.803096 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:49:52.945488 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:49:52.947322 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:49:53.025651 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:49:53.029830 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:49:53.125664 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:49:53.127776 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:49:53.698461 [info ] [MainThread]: Installed from version 1.3.0
[0m13:49:53.698828 [info ] [MainThread]: Up to date!
[0m13:49:53.699121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '28b0815e-0e91-46c9-b5cb-761bf8cc9ac6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1f850>]}
[0m13:49:53.699408 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:49:54.151956 [info ] [MainThread]: Installed from version 0.13.1
[0m13:49:54.152282 [info ] [MainThread]: Up to date!
[0m13:49:54.152605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '28b0815e-0e91-46c9-b5cb-761bf8cc9ac6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e34610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e34280>]}
[0m13:49:54.154364 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5522026, "process_in_blocks": "0", "process_kernel_time": 0.22645, "process_mem_max_rss": "103514112", "process_out_blocks": "0", "process_user_time": 1.079383}
[0m13:49:54.154823 [debug] [MainThread]: Command `dbt deps` succeeded at 13:49:54.154734 after 1.55 seconds
[0m13:49:54.155112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b036d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104644e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d80070>]}
[0m13:49:54.155396 [debug] [MainThread]: Flushing usage events
[0m13:49:55.151871 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:56.293403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033de6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104254460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104254280>]}


============================== 13:49:56.296259 | b586036f-0b50-402c-9ab2-5f303f45e64e ==============================
[0m13:49:56.296259 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:49:56.296650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:56.303479 [info ] [MainThread]: dbt version: 1.9.4
[0m13:49:56.303770 [info ] [MainThread]: python version: 3.9.6
[0m13:49:56.303967 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m13:49:56.304159 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m13:49:56.353320 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m13:49:56.353675 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m13:49:56.353879 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/dbt_project.yml
[0m13:49:56.354407 [info ] [MainThread]: adapter type: postgres
[0m13:49:56.354599 [info ] [MainThread]: adapter version: 1.9.0
[0m13:49:56.434174 [info ] [MainThread]: Configuration:
[0m13:49:56.434503 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:49:56.434701 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:49:56.434890 [info ] [MainThread]: Required dependencies:
[0m13:49:56.435159 [debug] [MainThread]: Executing "git --help"
[0m13:49:56.452243 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:49:56.452830 [debug] [MainThread]: STDERR: "b''"
[0m13:49:56.453077 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:49:56.453305 [info ] [MainThread]: Connection:
[0m13:49:56.453567 [info ] [MainThread]:   host: localhost
[0m13:49:56.453750 [info ] [MainThread]:   port: 5434
[0m13:49:56.453926 [info ] [MainThread]:   user: dbt_user
[0m13:49:56.454105 [info ] [MainThread]:   database: dbt_db_ex3
[0m13:49:56.454281 [info ] [MainThread]:   schema: public
[0m13:49:56.454582 [info ] [MainThread]:   connect_timeout: 10
[0m13:49:56.454855 [info ] [MainThread]:   role: None
[0m13:49:56.455064 [info ] [MainThread]:   search_path: None
[0m13:49:56.455259 [info ] [MainThread]:   keepalives_idle: 0
[0m13:49:56.455443 [info ] [MainThread]:   sslmode: None
[0m13:49:56.455623 [info ] [MainThread]:   sslcert: None
[0m13:49:56.455801 [info ] [MainThread]:   sslkey: None
[0m13:49:56.455981 [info ] [MainThread]:   sslrootcert: None
[0m13:49:56.456160 [info ] [MainThread]:   application_name: dbt
[0m13:49:56.456341 [info ] [MainThread]:   retries: 1
[0m13:49:56.456874 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:49:56.531781 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:49:56.559440 [debug] [MainThread]: Using postgres connection "debug"
[0m13:49:56.559835 [debug] [MainThread]: On debug: select 1 as id
[0m13:49:56.560101 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:56.584823 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m13:49:56.585506 [debug] [MainThread]: On debug: Close
[0m13:49:56.585748 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:49:56.585964 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:49:56.586992 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.34672225, "process_in_blocks": "0", "process_kernel_time": 0.147052, "process_mem_max_rss": "114425856", "process_out_blocks": "0", "process_user_time": 1.057752}
[0m13:49:56.587287 [debug] [MainThread]: Command `dbt debug` succeeded at 13:49:56.587225 after 0.35 seconds
[0m13:49:56.587500 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:49:56.587723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033de6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104627220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104636df0>]}
[0m13:49:56.588375 [debug] [MainThread]: Flushing usage events
[0m13:49:57.618154 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:58.850884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11227acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11227aeb0>]}


============================== 13:49:58.853397 | 65486692-82ba-4fb0-bfc4-98ddbd8b9460 ==============================
[0m13:49:58.853397 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:49:58.853774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select source:* staging.* core.*', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:58.990415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11257bfa0>]}
[0m13:49:59.038812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111342cd0>]}
[0m13:49:59.039471 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:49:59.132411 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:49:59.258814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:49:59.259111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:49:59.300856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131e0ee0>]}
[0m13:49:59.420507 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:49:59.423263 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:49:59.435377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a48b0>]}
[0m13:49:59.435762 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:49:59.436005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131a4940>]}
[0m13:49:59.437814 [info ] [MainThread]: 
[0m13:49:59.438074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:49:59.438274 [info ] [MainThread]: 
[0m13:49:59.438591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:49:59.441687 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:49:59.470031 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:49:59.470367 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:49:59.470573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:49:59.491278 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m13:49:59.492172 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:49:59.493805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:49:59.499251 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:49:59.499609 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:49:59.499817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:49:59.505684 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:49:59.506282 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:49:59.506529 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:49:59.515151 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.008 seconds
[0m13:49:59.516474 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:49:59.517485 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:49:59.523441 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:59.523814 [debug] [MainThread]: On master: BEGIN
[0m13:49:59.524034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:59.528821 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:49:59.529189 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:59.529612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:49:59.539421 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m13:49:59.540691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125b23d0>]}
[0m13:49:59.541066 [debug] [MainThread]: On master: ROLLBACK
[0m13:49:59.541789 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:59.542053 [debug] [MainThread]: On master: BEGIN
[0m13:49:59.542723 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:49:59.542950 [debug] [MainThread]: On master: COMMIT
[0m13:49:59.543152 [debug] [MainThread]: Using postgres connection "master"
[0m13:49:59.543455 [debug] [MainThread]: On master: COMMIT
[0m13:49:59.544369 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:49:59.544629 [debug] [MainThread]: On master: Close
[0m13:49:59.546717 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:49:59.547067 [info ] [Thread-1  ]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m13:49:59.547368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.stg_customers)
[0m13:49:59.547589 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:49:59.554338 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:49:59.554974 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:49:59.582512 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_customers"
[0m13:49:59.583401 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:59.583688 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: BEGIN
[0m13:49:59.583912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:59.590272 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:49:59.590642 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:59.590948 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */

  create view "dbt_db_ex3"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email,
        coalesce(phone, 'Unknown') as phone,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:49:59.593912 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:49:59.599633 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:59.599959 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:49:59.601153 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:59.603845 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:59.604182 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:49:59.605371 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:59.617123 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:49:59.617489 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:59.617714 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:49:59.619848 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:49:59.624402 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_customers__dbt_backup"
[0m13:49:59.627064 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:49:59.627307 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
drop view if exists "dbt_db_ex3"."public"."stg_customers__dbt_backup" cascade
[0m13:49:59.629895 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m13:49:59.631606 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: Close
[0m13:49:59.633207 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136e98b0>]}
[0m13:49:59.633679 [info ] [Thread-1  ]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m13:49:59.634045 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:49:59.634308 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_order_items
[0m13:49:59.634771 [info ] [Thread-1  ]: 2 of 8 START sql incremental model public.stg_order_items ...................... [RUN]
[0m13:49:59.635117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_customers, now model.ecommerce_datamart.stg_order_items)
[0m13:49:59.635359 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_order_items
[0m13:49:59.641875 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_order_items"
[0m13:49:59.642474 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_order_items
[0m13:49:59.669892 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:59.670281 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

    
  
    

  create temporary table "stg_order_items__dbt_tmp134959660550"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."order_items"
    
    
    where created_at >= (select max(created_at) from "dbt_db_ex3"."public"."stg_order_items")
    
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity,
        coalesce(unit_price, 0) as unit_price,
        coalesce(discount_amount, 0) as discount_amount,
        (quantity * unit_price) - coalesce(discount_amount, 0) as item_total,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:49:59.670530 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:59.681778 [debug] [Thread-1  ]: SQL status: SELECT 306 in 0.011 seconds
[0m13:49:59.692053 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:59.692390 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: BEGIN
[0m13:49:59.693400 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:49:59.693671 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:59.693906 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_items__dbt_tmp134959660550'
        
      order by ordinal_position

  
[0m13:49:59.702333 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.008 seconds
[0m13:49:59.706497 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:59.706807 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_items'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:49:59.709057 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.002 seconds
[0m13:49:59.715462 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:59.715832 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_items'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:49:59.719500 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m13:49:59.730886 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_order_items"
[0m13:49:59.731529 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:59.731803 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      
        
        
        delete from "dbt_db_ex3"."public"."stg_order_items" as DBT_INTERNAL_DEST
        where (order_item_id) in (
            select distinct order_item_id
            from "stg_order_items__dbt_tmp134959660550" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dbt_db_ex3"."public"."stg_order_items" ("order_item_id", "order_id", "product_id", "quantity", "unit_price", "discount_amount", "item_total", "created_at", "updated_at")
    (
        select "order_item_id", "order_id", "product_id", "quantity", "unit_price", "discount_amount", "item_total", "created_at", "updated_at"
        from "stg_order_items__dbt_tmp134959660550"
    )
  
[0m13:49:59.734567 [debug] [Thread-1  ]: SQL status: INSERT 0 306 in 0.002 seconds
[0m13:49:59.735492 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:49:59.735771 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:49:59.736011 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:49:59.737406 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:59.737965 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: Close
[0m13:49:59.738418 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145fe50>]}
[0m13:49:59.738956 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model public.stg_order_items ................. [[32mINSERT 0 306[0m in 0.10s]
[0m13:49:59.739368 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_order_items
[0m13:49:59.739645 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_orders
[0m13:49:59.739992 [info ] [Thread-1  ]: 3 of 8 START sql incremental model public.stg_orders ........................... [RUN]
[0m13:49:59.740285 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_order_items, now model.ecommerce_datamart.stg_orders)
[0m13:49:59.740516 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_orders
[0m13:49:59.743637 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_orders"
[0m13:49:59.744141 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_orders
[0m13:49:59.748254 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:59.748561 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

    
  
    

  create temporary table "stg_orders__dbt_tmp134959747142"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."orders"
    
    
    where created_at >= (select max(created_at) from "dbt_db_ex3"."public"."stg_orders")
    
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        payment_method,
        shipping_address,
        shipping_cost,
        total_amount,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:49:59.748811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:59.753813 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.005 seconds
[0m13:49:59.756440 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:59.756707 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: BEGIN
[0m13:49:59.757398 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:49:59.757642 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:59.757878 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders__dbt_tmp134959747142'
        
      order by ordinal_position

  
[0m13:49:59.761921 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m13:49:59.765095 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:59.765473 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:49:59.767755 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.002 seconds
[0m13:49:59.770706 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:59.771021 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:49:59.772873 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.002 seconds
[0m13:49:59.774347 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_orders"
[0m13:49:59.774884 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:59.775161 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      
        
        
        delete from "dbt_db_ex3"."public"."stg_orders" as DBT_INTERNAL_DEST
        where (order_id) in (
            select distinct order_id
            from "stg_orders__dbt_tmp134959747142" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dbt_db_ex3"."public"."stg_orders" ("order_id", "customer_id", "order_date", "status", "payment_method", "shipping_address", "shipping_cost", "total_amount", "created_at", "updated_at")
    (
        select "order_id", "customer_id", "order_date", "status", "payment_method", "shipping_address", "shipping_cost", "total_amount", "created_at", "updated_at"
        from "stg_orders__dbt_tmp134959747142"
    )
  
[0m13:49:59.776327 [debug] [Thread-1  ]: SQL status: INSERT 0 100 in 0.001 seconds
[0m13:49:59.777274 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:49:59.777550 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:49:59.777793 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:49:59.778901 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:59.779472 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: Close
[0m13:49:59.779899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145fe50>]}
[0m13:49:59.780349 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model public.stg_orders ...................... [[32mINSERT 0 100[0m in 0.04s]
[0m13:49:59.780739 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_orders
[0m13:49:59.781016 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_products
[0m13:49:59.781370 [info ] [Thread-1  ]: 4 of 8 START sql view model public.stg_products ................................ [RUN]
[0m13:49:59.781763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_orders, now model.ecommerce_datamart.stg_products)
[0m13:49:59.782013 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_products
[0m13:49:59.784661 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_products"
[0m13:49:59.785189 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_products
[0m13:49:59.789015 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_products"
[0m13:49:59.789666 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:59.789922 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: BEGIN
[0m13:49:59.790146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:59.796052 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:49:59.796402 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:59.796647 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */

  create view "dbt_db_ex3"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price,
        category,
        coalesce(inventory_count, 0) as inventory_count,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:49:59.798476 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:49:59.801416 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:59.801686 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
alter table "dbt_db_ex3"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:49:59.802682 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:59.805377 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:59.805803 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
alter table "dbt_db_ex3"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:49:59.806596 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:59.807469 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:49:59.807715 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:59.807937 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:49:59.808802 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:59.810931 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_products__dbt_backup"
[0m13:49:59.811308 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:49:59.811540 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
drop view if exists "dbt_db_ex3"."public"."stg_products__dbt_backup" cascade
[0m13:49:59.814094 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m13:49:59.814978 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: Close
[0m13:49:59.815373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145fe50>]}
[0m13:49:59.815814 [info ] [Thread-1  ]: 4 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:49:59.816202 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_products
[0m13:49:59.816474 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers
[0m13:49:59.816861 [info ] [Thread-1  ]: 5 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m13:49:59.817256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_products, now model.ecommerce_datamart.dim_customers)
[0m13:49:59.817509 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers
[0m13:49:59.820427 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers"
[0m13:49:59.821025 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers
[0m13:49:59.831816 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers"
[0m13:49:59.832454 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:59.832687 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: BEGIN
[0m13:49:59.832901 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:59.839522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:49:59.839877 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:59.840136 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db_ex3"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        sum(total_amount) as lifetime_value
    from "dbt_db_ex3"."public"."stg_orders"
    group by 1
)

select
    c.customer_id,
    c.name,
    c.email,
    c.phone,
    c.created_at,
    coalesce(co.order_count, 0) as lifetime_orders,
    co.first_order_date,
    co.most_recent_order_date,
    coalesce(co.lifetime_value, 0) as lifetime_value,
    current_timestamp as updated_at
from customers c
left join customer_orders co using (customer_id)
  );
  
[0m13:49:59.844985 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.005 seconds
[0m13:49:59.850763 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:59.851127 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
alter table "dbt_db_ex3"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:49:59.851976 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:59.854370 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:59.854610 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
alter table "dbt_db_ex3"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:49:59.855296 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:59.856214 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:49:59.856481 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:59.856705 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:49:59.857822 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:59.859947 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_customers__dbt_backup"
[0m13:49:59.861519 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:49:59.861770 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
drop table if exists "dbt_db_ex3"."public"."dim_customers__dbt_backup" cascade
[0m13:49:59.864085 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:49:59.865077 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: Close
[0m13:49:59.865479 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145fe50>]}
[0m13:49:59.865915 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.dim_customers ......................... [[32mSELECT 10[0m in 0.05s]
[0m13:49:59.866323 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers
[0m13:49:59.866603 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_orders
[0m13:49:59.866972 [info ] [Thread-1  ]: 6 of 8 START sql table model public.fct_orders ................................. [RUN]
[0m13:49:59.867320 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers, now model.ecommerce_datamart.fct_orders)
[0m13:49:59.867563 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_orders
[0m13:49:59.870232 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_orders"
[0m13:49:59.870799 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_orders
[0m13:49:59.874791 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_orders"
[0m13:49:59.875348 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:59.875576 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: BEGIN
[0m13:49:59.875781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:59.881160 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:49:59.881455 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:59.881699 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

order_items as (
    select
        order_id,
        count(*) as number_of_items,
        sum(quantity) as total_items,
        sum(item_total) as items_subtotal
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_date,
    o.status,
    o.payment_method,
    o.shipping_address,
    o.shipping_cost,
    o.total_amount,
    oi.number_of_items,
    oi.total_items,
    oi.items_subtotal,
    (oi.items_subtotal + o.shipping_cost) as calculated_total,
    abs(o.total_amount - (oi.items_subtotal + o.shipping_cost)) as total_amount_discrepancy,
    o.created_at,
    o.updated_at,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    extract(hour from o.order_date) as order_hour
from orders o
left join order_items oi using (order_id)
  );
  
[0m13:49:59.886452 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.004 seconds
[0m13:49:59.889315 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:59.889585 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
alter table "dbt_db_ex3"."public"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:49:59.890239 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:59.892726 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:59.892999 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
alter table "dbt_db_ex3"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:49:59.893668 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:59.894492 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:49:59.894737 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:59.894959 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:49:59.895868 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:59.898100 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_orders__dbt_backup"
[0m13:49:59.898681 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:49:59.898952 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
drop table if exists "dbt_db_ex3"."public"."fct_orders__dbt_backup" cascade
[0m13:49:59.900859 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:49:59.902359 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: Close
[0m13:49:59.905893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e1cd0>]}
[0m13:49:59.906354 [info ] [Thread-1  ]: 6 of 8 OK created sql table model public.fct_orders ............................ [[32mSELECT 100[0m in 0.04s]
[0m13:49:59.906715 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_orders
[0m13:49:59.906964 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products
[0m13:49:59.907285 [info ] [Thread-1  ]: 7 of 8 START sql table model public.dim_products ............................... [RUN]
[0m13:49:59.907558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_orders, now model.ecommerce_datamart.dim_products)
[0m13:49:59.907782 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products
[0m13:49:59.910459 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products"
[0m13:49:59.911065 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products
[0m13:49:59.914223 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products"
[0m13:49:59.914801 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:59.915028 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: BEGIN
[0m13:49:59.915243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:59.922248 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:49:59.922625 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:59.922919 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db_ex3"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(item_total) as total_revenue
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    p.product_id,
    p.name,
    p.price,
    p.category,
    p.inventory_count,
    p.is_active,
    p.created_at,
    coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(ps.total_revenue, 0) as total_revenue,
    case
        when p.inventory_count = 0 then 'Out of stock'
        when p.inventory_count < 10 then 'Low stock'
        else 'In stock'
    end as inventory_status,
    current_timestamp as updated_at
from products p
left join product_sales ps using (product_id)
  );
  
[0m13:49:59.927122 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.004 seconds
[0m13:49:59.931264 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:59.931602 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
alter table "dbt_db_ex3"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m13:49:59.932499 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:49:59.935028 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:59.935284 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
alter table "dbt_db_ex3"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:49:59.936045 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:49:59.936992 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:49:59.937245 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:59.937467 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:49:59.938469 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:49:59.940634 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products__dbt_backup"
[0m13:49:59.941015 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:49:59.941247 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
drop table if exists "dbt_db_ex3"."public"."dim_products__dbt_backup" cascade
[0m13:49:59.942763 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:49:59.943710 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: Close
[0m13:49:59.944141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110b1970>]}
[0m13:49:59.944587 [info ] [Thread-1  ]: 7 of 8 OK created sql table model public.dim_products .......................... [[32mSELECT 15[0m in 0.04s]
[0m13:49:59.944992 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products
[0m13:49:59.945243 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_order_items
[0m13:49:59.945582 [info ] [Thread-1  ]: 8 of 8 START sql table model public.fct_order_items ............................ [RUN]
[0m13:49:59.945886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products, now model.ecommerce_datamart.fct_order_items)
[0m13:49:59.946122 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_order_items
[0m13:49:59.948886 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_order_items"
[0m13:49:59.949442 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_order_items
[0m13:49:59.952665 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_order_items"
[0m13:49:59.953224 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:49:59.953449 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: BEGIN
[0m13:49:59.953659 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:49:59.959091 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:49:59.959374 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:49:59.959620 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp"
  
  
    as
  
  (
    with order_items as (
    select * from "dbt_db_ex3"."public"."stg_order_items"
),

orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

products as (
    select * from "dbt_db_ex3"."public"."stg_products"
)

select
    oi.order_item_id,
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.order_date,
    p.category as product_category,
    oi.quantity,
    oi.unit_price,
    oi.discount_amount,
    oi.item_total,
    (oi.unit_price * oi.quantity) as gross_item_sales_value,
    oi.discount_amount as item_discount_value,
    ((oi.unit_price * oi.quantity) - oi.item_total) as total_discount_impact,
    case
        when oi.discount_amount > 0 then true
        else false
    end as is_discounted,
    o.status as order_status,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    oi.created_at,
    current_timestamp as updated_at
from order_items oi
join orders o using (order_id)
join products p using (product_id)
  );
  
[0m13:49:59.963422 [debug] [Thread-1  ]: SQL status: SELECT 306 in 0.004 seconds
[0m13:49:59.967176 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:49:59.967497 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
alter table "dbt_db_ex3"."public"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m13:49:59.968369 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:00.003660 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:50:00.004052 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
alter table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m13:50:00.015281 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.011 seconds
[0m13:50:00.016845 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:50:00.017258 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:50:00.017503 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:50:00.021405 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:50:00.025138 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_order_items__dbt_backup"
[0m13:50:00.025723 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:50:00.026043 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
drop table if exists "dbt_db_ex3"."public"."fct_order_items__dbt_backup" cascade
[0m13:50:00.028472 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:50:00.029521 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: Close
[0m13:50:00.030003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65486692-82ba-4fb0-bfc4-98ddbd8b9460', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ab2d30>]}
[0m13:50:00.030505 [info ] [Thread-1  ]: 8 of 8 OK created sql table model public.fct_order_items ....................... [[32mSELECT 306[0m in 0.08s]
[0m13:50:00.030889 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_order_items
[0m13:50:00.031741 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:00.031969 [debug] [MainThread]: On master: BEGIN
[0m13:50:00.032154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:00.035701 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:50:00.036020 [debug] [MainThread]: On master: COMMIT
[0m13:50:00.036233 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:00.036424 [debug] [MainThread]: On master: COMMIT
[0m13:50:00.036860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:00.037289 [debug] [MainThread]: On master: Close
[0m13:50:00.037688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:00.037884 [debug] [MainThread]: Connection 'model.ecommerce_datamart.fct_order_items' was properly closed.
[0m13:50:00.038163 [info ] [MainThread]: 
[0m13:50:00.038419 [info ] [MainThread]: Finished running 2 incremental models, 4 table models, 2 view models in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m13:50:00.039418 [debug] [MainThread]: Command end result
[0m13:50:00.068360 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:00.069704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:00.074440 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:50:00.074739 [info ] [MainThread]: 
[0m13:50:00.075050 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:00.075361 [info ] [MainThread]: 
[0m13:50:00.075598 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:50:00.076767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2771363, "process_in_blocks": "0", "process_kernel_time": 0.191465, "process_mem_max_rss": "126173184", "process_out_blocks": "0", "process_user_time": 1.806908}
[0m13:50:00.077053 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:00.077001 after 1.28 seconds
[0m13:50:00.077303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111c87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111454850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111342cd0>]}
[0m13:50:00.077551 [debug] [MainThread]: Flushing usage events
[0m13:50:01.362575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:02.511927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba3f70>]}


============================== 13:50:02.514848 | aea60836-7f3d-4d53-b37f-b732126f03c2 ==============================
[0m13:50:02.514848 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:02.515237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select core.* --store-failures', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:02.672807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aea60836-7f3d-4d53-b37f-b732126f03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efc970>]}
[0m13:50:02.731970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aea60836-7f3d-4d53-b37f-b732126f03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb5cd0>]}
[0m13:50:02.733557 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:02.825120 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:50:02.942359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:02.942679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:03.022487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aea60836-7f3d-4d53-b37f-b732126f03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c8790>]}
[0m13:50:03.118262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:03.121065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:03.141632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aea60836-7f3d-4d53-b37f-b732126f03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511c8b0>]}
[0m13:50:03.142142 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:50:03.142397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea60836-7f3d-4d53-b37f-b732126f03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc9c10>]}
[0m13:50:03.144713 [info ] [MainThread]: 
[0m13:50:03.144971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:03.145167 [info ] [MainThread]: 
[0m13:50:03.145486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:03.149995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:50:03.179181 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:50:03.179794 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:50:03.180046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:03.203381 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.023 seconds
[0m13:50:03.204392 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:50:03.205010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now create_dbt_db_ex3_public_dbt_test__audit)
[0m13:50:03.205693 [debug] [ThreadPool]: Creating schema "database: "dbt_db_ex3"
schema: "public_dbt_test__audit"
"
[0m13:50:03.210108 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:03.210444 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: BEGIN
[0m13:50:03.210650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:03.216685 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:50:03.216993 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:03.217200 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "create_dbt_db_ex3_public_dbt_test__audit"} */
create schema if not exists "public_dbt_test__audit"
[0m13:50:03.217958 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m13:50:03.218615 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: COMMIT
[0m13:50:03.218854 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:03.219050 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: COMMIT
[0m13:50:03.219987 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.220265 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: Close
[0m13:50:03.224145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_db_ex3_public_dbt_test__audit, now list_dbt_db_ex3_public)
[0m13:50:03.228858 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:03.229137 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:50:03.229335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:03.234073 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.234399 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:03.234625 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:03.236749 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m13:50:03.237749 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:50:03.238291 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:50:03.238662 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now list_dbt_db_ex3_public_dbt_test__audit)
[0m13:50:03.241098 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:03.241351 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: BEGIN
[0m13:50:03.242539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:03.247725 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.248051 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:03.248282 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public_dbt_test__audit"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:50:03.250840 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:03.251730 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: ROLLBACK
[0m13:50:03.252434 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: Close
[0m13:50:03.259344 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:03.259677 [debug] [MainThread]: On master: BEGIN
[0m13:50:03.259884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:03.267330 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:50:03.267723 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:03.268068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:03.277207 [debug] [MainThread]: SQL status: SELECT 2 in 0.009 seconds
[0m13:50:03.278762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aea60836-7f3d-4d53-b37f-b732126f03c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db9070>]}
[0m13:50:03.279164 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:03.280030 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:03.280273 [debug] [MainThread]: On master: BEGIN
[0m13:50:03.281340 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:50:03.281637 [debug] [MainThread]: On master: COMMIT
[0m13:50:03.281847 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:03.282036 [debug] [MainThread]: On master: COMMIT
[0m13:50:03.282572 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:03.282913 [debug] [MainThread]: On master: Close
[0m13:50:03.285357 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:50:03.285706 [info ] [Thread-1  ]: 1 of 39 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m13:50:03.286047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public_dbt_test__audit, now test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:50:03.286289 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:50:03.301985 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:03.302723 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:50:03.314490 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:50:03.323174 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:03.323545 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:50:03.323870 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.330008 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:03.330382 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:03.330647 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex3"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m13:50:03.333125 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:03.334011 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:50:03.334360 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:03.334654 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:50:03.336988 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:50:03.340723 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:03.342076 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:03.342431 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:50:03.343968 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:03.344291 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:03.344549 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m13:50:03.346602 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:50:03.349387 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m13:50:03.350111 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m13:50:03.350641 [info ] [Thread-1  ]: 1 of 39 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.06s]
[0m13:50:03.351108 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:50:03.351395 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:50:03.351693 [info ] [Thread-1  ]: 2 of 39 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m13:50:03.352026 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:50:03.352275 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:50:03.357962 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:03.359353 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:50:03.361456 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:50:03.363772 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:03.364836 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:50:03.365091 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.370757 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:03.371090 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:03.371352 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex3"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m13:50:03.374889 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.375655 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:50:03.375932 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:03.376173 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:50:03.377769 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.378250 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:03.378882 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:03.379173 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:50:03.379958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:03.380229 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:03.380480 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m13:50:03.381558 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:03.382520 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m13:50:03.383334 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m13:50:03.383786 [info ] [Thread-1  ]: 2 of 39 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.03s]
[0m13:50:03.384172 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:50:03.384433 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:50:03.384734 [info ] [Thread-1  ]: 3 of 39 START test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True  [RUN]
[0m13:50:03.385250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f)
[0m13:50:03.385529 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:50:03.480063 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:03.480515 [error] [Thread-1  ]: 3 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True  [[31mERROR[0m in 0.10s]
[0m13:50:03.480864 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:50:03.481123 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:50:03.481365 [info ] [Thread-1  ]: 4 of 39 START test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0  [RUN]
[0m13:50:03.481694 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:03.482020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506)
[0m13:50:03.482372 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:50:03.489407 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:03.489876 [error] [Thread-1  ]: 4 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0  [[31mERROR[0m in 0.01s]
[0m13:50:03.490224 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:50:03.490490 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:50:03.490789 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:03.491074 [info ] [Thread-1  ]: 5 of 39 START test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True  [RUN]
[0m13:50:03.491492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295)
[0m13:50:03.491750 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:50:03.497875 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:03.498354 [error] [Thread-1  ]: 5 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True  [[31mERROR[0m in 0.01s]
[0m13:50:03.498726 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:50:03.499131 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:50:03.499544 [info ] [Thread-1  ]: 6 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True  [RUN]
[0m13:50:03.500075 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:03.500585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767)
[0m13:50:03.500983 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:50:03.507768 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:03.508206 [error] [Thread-1  ]: 6 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True  [[31mERROR[0m in 0.01s]
[0m13:50:03.508550 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:50:03.508807 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:50:03.509050 [info ] [Thread-1  ]: 7 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True  [RUN]
[0m13:50:03.509368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507)
[0m13:50:03.509608 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:50:03.509887 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:03.516955 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:03.517418 [error] [Thread-1  ]: 7 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True  [[31mERROR[0m in 0.01s]
[0m13:50:03.517772 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:50:03.518035 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:50:03.518327 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:03.518602 [info ] [Thread-1  ]: 8 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True  [RUN]
[0m13:50:03.519036 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097)
[0m13:50:03.519311 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:50:03.525701 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:03.526141 [error] [Thread-1  ]: 8 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True  [[31mERROR[0m in 0.01s]
[0m13:50:03.526488 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:50:03.526749 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:50:03.527031 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:03.527312 [info ] [Thread-1  ]: 9 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True  [RUN]
[0m13:50:03.527688 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e)
[0m13:50:03.527926 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:50:03.534895 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:03.535351 [error] [Thread-1  ]: 9 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True  [[31mERROR[0m in 0.01s]
[0m13:50:03.535679 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:50:03.535927 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:50:03.536211 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:03.536555 [info ] [Thread-1  ]: 10 of 39 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m13:50:03.536954 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:50:03.537201 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:50:03.542807 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:03.543166 [error] [Thread-1  ]: 10 of 39 ERROR dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[31mERROR[0m in 0.01s]
[0m13:50:03.543484 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:50:03.543719 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:50:03.543939 [info ] [Thread-1  ]: 11 of 39 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m13:50:03.544206 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:50:03.544425 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:50:03.550094 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:03.549814 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:03.551035 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:50:03.553881 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:50:03.554365 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:03.554594 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:50:03.554805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.558297 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:50:03.558611 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:03.558853 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m13:50:03.561732 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.562418 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:50:03.562672 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:03.562902 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:50:03.563842 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.564311 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:03.564842 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:03.565079 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:50:03.565689 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.565941 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:03.566174 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:50:03.566861 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:03.567856 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:50:03.568298 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:50:03.568697 [info ] [Thread-1  ]: 11 of 39 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.02s]
[0m13:50:03.569065 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:50:03.569318 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:50:03.569581 [info ] [Thread-1  ]: 12 of 39 START test not_null_dim_customers_email ............................... [RUN]
[0m13:50:03.569862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a)
[0m13:50:03.570086 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:50:03.573299 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:03.573877 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:50:03.575853 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:50:03.576303 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:03.576532 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:50:03.576739 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.580360 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:03.580684 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:03.580918 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where email is null



  );
  
    
[0m13:50:03.583368 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:03.584078 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:50:03.584343 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:03.584572 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:50:03.586259 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.586668 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:03.587153 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:03.587373 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:50:03.587884 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.588098 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:03.588313 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:50:03.589053 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:03.589927 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m13:50:03.590506 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: Close
[0m13:50:03.590948 [info ] [Thread-1  ]: 12 of 39 PASS not_null_dim_customers_email ..................................... [[32mPASS[0m in 0.02s]
[0m13:50:03.591335 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:50:03.591593 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:50:03.591872 [info ] [Thread-1  ]: 13 of 39 START test not_null_dim_customers_lifetime_orders ..................... [RUN]
[0m13:50:03.592153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:50:03.592388 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:50:03.595570 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:03.596092 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:50:03.598087 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:50:03.598577 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:03.598806 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:50:03.599016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.603625 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.603939 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:03.604184 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m13:50:03.606512 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:03.607295 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:50:03.607562 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:03.607789 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:50:03.608762 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.609309 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:03.609883 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:03.610119 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:50:03.610750 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.610979 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:03.611206 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m13:50:03.611949 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:03.612912 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m13:50:03.613428 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m13:50:03.613867 [info ] [Thread-1  ]: 13 of 39 PASS not_null_dim_customers_lifetime_orders ........................... [[32mPASS[0m in 0.02s]
[0m13:50:03.614242 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:50:03.614495 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:50:03.614773 [info ] [Thread-1  ]: 14 of 39 START test not_null_dim_customers_lifetime_value ...................... [RUN]
[0m13:50:03.615062 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888)
[0m13:50:03.615293 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:50:03.620377 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:03.621053 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:50:03.623219 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
[0m13:50:03.623721 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:03.623951 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m13:50:03.624166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.628993 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.629370 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:03.629629 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where lifetime_value is null



  );
  
    
[0m13:50:03.633414 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.634160 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: COMMIT
[0m13:50:03.634412 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:03.634644 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: COMMIT
[0m13:50:03.635444 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.635882 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:03.636346 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:03.636642 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m13:50:03.637394 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.637695 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:03.637951 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
    
      
    ) dbt_internal_test
[0m13:50:03.639004 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:03.640058 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: ROLLBACK
[0m13:50:03.640708 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: Close
[0m13:50:03.641174 [info ] [Thread-1  ]: 14 of 39 PASS not_null_dim_customers_lifetime_value ............................ [[32mPASS[0m in 0.03s]
[0m13:50:03.641587 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:50:03.641845 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:50:03.642168 [info ] [Thread-1  ]: 15 of 39 START test not_null_dim_customers_name ................................ [RUN]
[0m13:50:03.642543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888, now test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1)
[0m13:50:03.642799 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:50:03.646509 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:03.647059 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:50:03.649041 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:50:03.649504 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:03.649731 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:50:03.649943 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.654000 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:03.654306 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:03.654539 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where name is null



  );
  
    
[0m13:50:03.657235 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:03.658091 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:50:03.658384 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:03.658612 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:50:03.659744 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.660222 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:03.660729 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:03.660958 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:50:03.661711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:03.661964 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:03.662204 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m13:50:03.662939 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:03.664054 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m13:50:03.664582 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: Close
[0m13:50:03.665051 [info ] [Thread-1  ]: 15 of 39 PASS not_null_dim_customers_name ...................................... [[32mPASS[0m in 0.02s]
[0m13:50:03.665438 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:50:03.665698 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:50:03.665990 [info ] [Thread-1  ]: 16 of 39 START test not_null_dim_products_category ............................. [RUN]
[0m13:50:03.666293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0)
[0m13:50:03.666534 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:50:03.669911 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:03.670414 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:50:03.673414 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
[0m13:50:03.673930 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:03.674172 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: BEGIN
[0m13:50:03.674386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.678144 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:03.678483 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:03.678718 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where category is null



  );
  
    
[0m13:50:03.681390 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:03.682083 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: COMMIT
[0m13:50:03.682328 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:03.682545 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: COMMIT
[0m13:50:03.684021 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.684504 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:03.685069 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:03.685351 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: BEGIN
[0m13:50:03.686213 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:03.686439 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:03.686654 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
    
      
    ) dbt_internal_test
[0m13:50:03.687707 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:03.688637 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: ROLLBACK
[0m13:50:03.689258 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: Close
[0m13:50:03.689640 [info ] [Thread-1  ]: 16 of 39 PASS not_null_dim_products_category ................................... [[32mPASS[0m in 0.02s]
[0m13:50:03.689970 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:50:03.690206 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:50:03.690468 [info ] [Thread-1  ]: 17 of 39 START test not_null_dim_products_inventory_count ...................... [RUN]
[0m13:50:03.690730 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0, now test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e)
[0m13:50:03.690944 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:50:03.694201 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:03.694702 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:50:03.696947 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
[0m13:50:03.697519 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:03.697789 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: BEGIN
[0m13:50:03.698052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.703417 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.703761 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:03.704022 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where inventory_count is null



  );
  
    
[0m13:50:03.706276 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:03.706958 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: COMMIT
[0m13:50:03.707211 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:03.707436 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: COMMIT
[0m13:50:03.708100 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:03.708493 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:03.708982 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:03.709209 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: BEGIN
[0m13:50:03.709747 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.710051 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:03.710293 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
    
      
    ) dbt_internal_test
[0m13:50:03.710989 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:03.711922 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: ROLLBACK
[0m13:50:03.712345 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: Close
[0m13:50:03.712771 [info ] [Thread-1  ]: 17 of 39 PASS not_null_dim_products_inventory_count ............................ [[32mPASS[0m in 0.02s]
[0m13:50:03.713140 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:50:03.713388 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:50:03.713686 [info ] [Thread-1  ]: 18 of 39 START test not_null_dim_products_name ................................. [RUN]
[0m13:50:03.714008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e, now test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff)
[0m13:50:03.714248 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:50:03.717435 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:03.717920 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:50:03.719885 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:50:03.720376 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:03.720606 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:50:03.720819 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.725711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.726057 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:03.726303 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where name is null



  );
  
    
[0m13:50:03.728623 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:03.729338 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:50:03.729591 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:03.729817 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:50:03.730511 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:03.730976 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:03.731511 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:03.731747 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:50:03.741543 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m13:50:03.741883 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:03.742124 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m13:50:03.744941 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:50:03.746230 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m13:50:03.747348 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: Close
[0m13:50:03.747825 [info ] [Thread-1  ]: 18 of 39 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.03s]
[0m13:50:03.748201 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:50:03.748462 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:50:03.748703 [info ] [Thread-1  ]: 19 of 39 START test not_null_dim_products_price ................................ [RUN]
[0m13:50:03.749052 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff, now test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed)
[0m13:50:03.749324 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:50:03.752810 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:03.753412 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:50:03.756467 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:50:03.757002 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:03.757252 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:50:03.757469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.763551 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:03.763902 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:03.764150 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where price is null



  );
  
    
[0m13:50:03.767348 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.768141 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:50:03.768418 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:03.768650 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:50:03.769711 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.770189 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:03.770746 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:03.770976 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:50:03.771639 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.771899 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:03.772138 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m13:50:03.772885 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:03.774057 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m13:50:03.774851 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: Close
[0m13:50:03.775349 [info ] [Thread-1  ]: 19 of 39 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.03s]
[0m13:50:03.775748 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:50:03.776040 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:50:03.776659 [info ] [Thread-1  ]: 20 of 39 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:50:03.777357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed, now test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1)
[0m13:50:03.777656 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:50:03.781336 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:03.781899 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:50:03.784103 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:50:03.785991 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:03.786302 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:50:03.786556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.791632 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.791974 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:03.792222 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where product_id is null



  );
  
    
[0m13:50:03.795074 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.795857 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:50:03.796127 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:03.796357 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:50:03.797331 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.797831 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:03.798423 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:03.798694 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:50:03.799359 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.799601 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:03.799834 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:50:03.800762 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:03.801781 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:50:03.802393 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:50:03.802873 [info ] [Thread-1  ]: 20 of 39 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.03s]
[0m13:50:03.803485 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:50:03.803783 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:50:03.804114 [info ] [Thread-1  ]: 21 of 39 START test not_null_fct_order_items_item_total ........................ [RUN]
[0m13:50:03.804480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6)
[0m13:50:03.804730 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:50:03.808111 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:03.808709 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:50:03.810822 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
[0m13:50:03.811330 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:03.811569 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: BEGIN
[0m13:50:03.811790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.816187 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:03.816565 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:03.816829 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where item_total is null



  );
  
    
[0m13:50:03.820041 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.820825 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: COMMIT
[0m13:50:03.821088 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:03.821321 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: COMMIT
[0m13:50:03.822267 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.822732 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:03.823250 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:03.823491 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: BEGIN
[0m13:50:03.824051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.824280 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:03.824510 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
    
      
    ) dbt_internal_test
[0m13:50:03.825370 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:03.826386 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: ROLLBACK
[0m13:50:03.827075 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: Close
[0m13:50:03.827592 [info ] [Thread-1  ]: 21 of 39 PASS not_null_fct_order_items_item_total .............................. [[32mPASS[0m in 0.02s]
[0m13:50:03.827970 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:50:03.828225 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:50:03.828508 [info ] [Thread-1  ]: 22 of 39 START test not_null_fct_order_items_order_id .......................... [RUN]
[0m13:50:03.828884 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6, now test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02)
[0m13:50:03.829137 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:50:03.833880 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:03.834566 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:50:03.836826 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
[0m13:50:03.837384 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:03.837636 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: BEGIN
[0m13:50:03.837860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.843100 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.843445 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:03.843846 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where order_id is null



  );
  
    
[0m13:50:03.846784 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.847557 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: COMMIT
[0m13:50:03.847829 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:03.848064 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: COMMIT
[0m13:50:03.850811 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:50:03.851345 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:03.851913 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:03.852156 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: BEGIN
[0m13:50:03.852818 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.853088 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:03.853334 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
    
      
    ) dbt_internal_test
[0m13:50:03.854095 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:03.855166 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: ROLLBACK
[0m13:50:03.855953 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: Close
[0m13:50:03.856407 [info ] [Thread-1  ]: 22 of 39 PASS not_null_fct_order_items_order_id ................................ [[32mPASS[0m in 0.03s]
[0m13:50:03.856778 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:50:03.857034 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:50:03.857394 [info ] [Thread-1  ]: 23 of 39 START test not_null_fct_order_items_order_item_id ..................... [RUN]
[0m13:50:03.857740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02, now test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55)
[0m13:50:03.857989 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:50:03.861605 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:03.862222 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:50:03.864382 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
[0m13:50:03.864901 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:03.865146 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: BEGIN
[0m13:50:03.865366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.871201 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:03.871618 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:03.871912 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where order_item_id is null



  );
  
    
[0m13:50:03.875925 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:50:03.876700 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: COMMIT
[0m13:50:03.876969 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:03.877202 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: COMMIT
[0m13:50:03.878396 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.878858 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:03.879332 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:03.879565 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: BEGIN
[0m13:50:03.880077 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.880341 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:03.880589 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m13:50:03.881384 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:03.882391 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: ROLLBACK
[0m13:50:03.883037 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: Close
[0m13:50:03.883634 [info ] [Thread-1  ]: 23 of 39 PASS not_null_fct_order_items_order_item_id ........................... [[32mPASS[0m in 0.03s]
[0m13:50:03.884108 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:50:03.884391 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:50:03.884683 [info ] [Thread-1  ]: 24 of 39 START test not_null_fct_order_items_product_id ........................ [RUN]
[0m13:50:03.885020 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55, now test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc)
[0m13:50:03.885256 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:50:03.888651 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:03.889242 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:50:03.891389 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
[0m13:50:03.892867 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:03.893148 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: BEGIN
[0m13:50:03.893368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.897458 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:03.897821 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:03.898107 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where product_id is null



  );
  
    
[0m13:50:03.901908 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.902692 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: COMMIT
[0m13:50:03.902964 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:03.903193 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: COMMIT
[0m13:50:03.904195 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.904629 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:03.905151 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:03.905380 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: BEGIN
[0m13:50:03.905924 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.906199 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:03.906444 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
    
      
    ) dbt_internal_test
[0m13:50:03.907241 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:03.908197 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: ROLLBACK
[0m13:50:03.908707 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: Close
[0m13:50:03.909132 [info ] [Thread-1  ]: 24 of 39 PASS not_null_fct_order_items_product_id .............................. [[32mPASS[0m in 0.02s]
[0m13:50:03.909525 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:50:03.909784 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:50:03.910021 [info ] [Thread-1  ]: 25 of 39 START test not_null_fct_order_items_quantity .......................... [RUN]
[0m13:50:03.910455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc, now test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03)
[0m13:50:03.910684 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:50:03.914040 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:03.914605 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:50:03.916702 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
[0m13:50:03.917210 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:03.917451 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: BEGIN
[0m13:50:03.917675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.923272 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.923704 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:03.924010 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where quantity is null



  );
  
    
[0m13:50:03.927166 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.927915 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: COMMIT
[0m13:50:03.928186 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:03.928416 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: COMMIT
[0m13:50:03.929455 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.929891 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:03.930418 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:03.930649 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: BEGIN
[0m13:50:03.931189 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.931412 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:03.931643 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
    
      
    ) dbt_internal_test
[0m13:50:03.932380 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:03.933386 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: ROLLBACK
[0m13:50:03.933962 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: Close
[0m13:50:03.934406 [info ] [Thread-1  ]: 25 of 39 PASS not_null_fct_order_items_quantity ................................ [[32mPASS[0m in 0.02s]
[0m13:50:03.934786 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:50:03.935041 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:50:03.935281 [info ] [Thread-1  ]: 26 of 39 START test not_null_fct_order_items_unit_price ........................ [RUN]
[0m13:50:03.935657 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03, now test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8)
[0m13:50:03.935934 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:50:03.939236 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:03.942260 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:50:03.944373 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
[0m13:50:03.944934 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:03.945186 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: BEGIN
[0m13:50:03.945421 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.950707 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.951051 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:03.951304 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where unit_price is null



  );
  
    
[0m13:50:03.954611 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:03.955552 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: COMMIT
[0m13:50:03.955841 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:03.956079 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: COMMIT
[0m13:50:03.957191 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:03.957634 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:03.958129 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:03.958359 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: BEGIN
[0m13:50:03.958927 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.959183 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:03.959425 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
    
      
    ) dbt_internal_test
[0m13:50:03.960171 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:03.961179 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: ROLLBACK
[0m13:50:03.962065 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: Close
[0m13:50:03.962666 [info ] [Thread-1  ]: 26 of 39 PASS not_null_fct_order_items_unit_price .............................. [[32mPASS[0m in 0.03s]
[0m13:50:03.963073 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:50:03.963416 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:50:03.963749 [info ] [Thread-1  ]: 27 of 39 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:50:03.964261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8, now test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:50:03.964600 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:50:03.968331 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:03.968935 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:50:03.971991 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:50:03.972554 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:03.972815 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:50:03.973041 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.977747 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:03.978047 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:03.978281 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m13:50:03.980652 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:03.981351 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:50:03.981602 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:03.981818 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:50:03.982456 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:03.982854 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:03.983338 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:03.983563 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:50:03.983964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:03.984179 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:03.984401 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m13:50:03.985036 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:03.985899 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:50:03.986328 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:50:03.986715 [info ] [Thread-1  ]: 27 of 39 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.02s]
[0m13:50:03.987068 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:50:03.987315 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:50:03.987585 [info ] [Thread-1  ]: 28 of 39 START test not_null_fct_orders_order_date ............................. [RUN]
[0m13:50:03.987862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362)
[0m13:50:03.988083 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:50:03.991252 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:03.991799 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:50:03.993759 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:50:03.994205 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:03.994431 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:50:03.994644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:03.999021 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:03.999327 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:03.999562 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where order_date is null



  );
  
    
[0m13:50:04.001794 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:04.002524 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:50:04.002783 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:04.003021 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:50:04.004129 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:04.004744 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:04.005390 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:04.005628 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:50:04.006299 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.006536 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:04.006767 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m13:50:04.007486 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:04.008430 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m13:50:04.008950 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: Close
[0m13:50:04.009353 [info ] [Thread-1  ]: 28 of 39 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.02s]
[0m13:50:04.009711 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:50:04.009956 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:50:04.010235 [info ] [Thread-1  ]: 29 of 39 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:50:04.010522 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0)
[0m13:50:04.010746 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:50:04.013965 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:04.014523 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:50:04.016588 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:50:04.017045 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:04.017297 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:50:04.017542 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.022701 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:04.023006 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:04.023241 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where order_id is null



  );
  
    
[0m13:50:04.025565 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:04.026206 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:50:04.026439 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:04.026648 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:50:04.027227 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:04.027614 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:04.028039 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:04.028258 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:50:04.028678 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.028886 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:04.029094 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:50:04.029686 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:04.030526 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:50:04.030950 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:50:04.031385 [info ] [Thread-1  ]: 29 of 39 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.02s]
[0m13:50:04.031937 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:50:04.032217 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:50:04.032524 [info ] [Thread-1  ]: 30 of 39 START test not_null_fct_orders_status ................................. [RUN]
[0m13:50:04.032996 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_datamart.not_null_fct_orders_status.1455048989)
[0m13:50:04.033329 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:50:04.041567 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:04.042163 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:50:04.044146 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:50:04.044647 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:04.044976 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: BEGIN
[0m13:50:04.045231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.050326 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:04.050669 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:04.050904 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where status is null



  );
  
    
[0m13:50:04.053433 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:04.054100 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: COMMIT
[0m13:50:04.054342 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:04.054553 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: COMMIT
[0m13:50:04.055401 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:04.055799 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:04.056261 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:04.056489 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: BEGIN
[0m13:50:04.056967 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.057207 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:04.057447 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m13:50:04.058069 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:04.059027 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: ROLLBACK
[0m13:50:04.059448 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: Close
[0m13:50:04.059828 [info ] [Thread-1  ]: 30 of 39 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.03s]
[0m13:50:04.060179 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:50:04.060425 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:50:04.060693 [info ] [Thread-1  ]: 31 of 39 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m13:50:04.060962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_status.1455048989, now test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:50:04.061181 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:50:04.064253 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:04.064787 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:50:04.066619 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:50:04.067033 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:04.067248 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:50:04.067449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.071775 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:04.072074 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:04.072328 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m13:50:04.074668 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:04.075340 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:50:04.075594 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:04.075815 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:50:04.076547 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:04.076939 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:04.077449 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:04.077672 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:50:04.078051 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.078262 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:04.078484 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m13:50:04.079075 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:04.079912 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m13:50:04.080398 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m13:50:04.080831 [info ] [Thread-1  ]: 31 of 39 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.02s]
[0m13:50:04.081229 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:50:04.081498 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:50:04.081793 [info ] [Thread-1  ]: 32 of 39 START test relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [RUN]
[0m13:50:04.082109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m13:50:04.082347 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:50:04.088036 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:04.088540 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:50:04.090465 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
[0m13:50:04.091722 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:04.091954 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m13:50:04.092173 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.095544 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:50:04.095835 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:04.096077 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
  
  
    as
  
  (
    
    
    

with child as (
    select order_id as from_field
    from "dbt_db_ex3"."public"."fct_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "dbt_db_ex3"."public"."fct_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:50:04.097351 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:04.097966 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: COMMIT
[0m13:50:04.098201 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:04.098412 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: COMMIT
[0m13:50:04.099153 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:04.099541 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:04.100012 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:04.100233 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m13:50:04.100746 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.100966 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:04.101185 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
    
      
    ) dbt_internal_test
[0m13:50:04.101727 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:04.102568 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: ROLLBACK
[0m13:50:04.103568 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: Close
[0m13:50:04.103944 [info ] [Thread-1  ]: 32 of 39 PASS relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [[32mPASS[0m in 0.02s]
[0m13:50:04.104275 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:50:04.104507 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:50:04.104778 [info ] [Thread-1  ]: 33 of 39 START test relationships_fct_order_items_product_id__product_id__ref_dim_products_  [RUN]
[0m13:50:04.105037 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m13:50:04.105254 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:50:04.142218 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:04.142840 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:50:04.144656 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
[0m13:50:04.145097 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:04.145329 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m13:50:04.145535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.149556 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:04.149873 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:04.150116 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
  
  
    as
  
  (
    
    
    

with child as (
    select product_id as from_field
    from "dbt_db_ex3"."public"."fct_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "dbt_db_ex3"."public"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:50:04.151517 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:04.152220 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: COMMIT
[0m13:50:04.152464 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:04.152682 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: COMMIT
[0m13:50:04.153370 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:04.153746 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:04.154222 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:04.154442 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m13:50:04.154900 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.155149 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:04.155396 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
    
      
    ) dbt_internal_test
[0m13:50:04.156015 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:04.156888 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: ROLLBACK
[0m13:50:04.157352 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: Close
[0m13:50:04.157736 [info ] [Thread-1  ]: 33 of 39 PASS relationships_fct_order_items_product_id__product_id__ref_dim_products_  [[32mPASS[0m in 0.05s]
[0m13:50:04.158121 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:50:04.158377 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:50:04.158656 [info ] [Thread-1  ]: 34 of 39 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m13:50:04.158934 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:50:04.159165 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:50:04.163368 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:04.164046 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:50:04.166140 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:50:04.166620 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:04.166861 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:50:04.167077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.172134 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:04.172426 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:04.172687 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex3"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex3"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:50:04.174060 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:04.174727 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:50:04.175000 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:04.175245 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:50:04.175915 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:04.176322 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:04.176893 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:04.177159 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:50:04.177847 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.178127 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:04.178393 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m13:50:04.179580 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:04.180533 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m13:50:04.181103 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m13:50:04.181487 [info ] [Thread-1  ]: 34 of 39 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.02s]
[0m13:50:04.181835 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:50:04.182077 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:50:04.182339 [info ] [Thread-1  ]: 35 of 39 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:50:04.182602 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:50:04.182825 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:50:04.187432 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:04.187927 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:50:04.190587 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:50:04.191113 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:04.191343 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:50:04.191558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.196887 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:04.197146 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:04.197399 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m13:50:04.198740 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:04.199410 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:50:04.199669 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:04.199907 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:50:04.200855 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:04.201264 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:04.201728 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:04.201963 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:50:04.202429 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.202661 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:04.202901 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:50:04.203504 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:04.204476 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:50:04.204925 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:50:04.205343 [info ] [Thread-1  ]: 35 of 39 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.02s]
[0m13:50:04.205723 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:50:04.205986 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:50:04.206267 [info ] [Thread-1  ]: 36 of 39 START test unique_dim_customers_email ................................. [RUN]
[0m13:50:04.206556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8)
[0m13:50:04.206794 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:50:04.210117 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:04.210660 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:50:04.212670 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:50:04.213114 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:04.213345 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:50:04.213564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.217678 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:04.218054 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:04.218331 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m13:50:04.221112 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:04.221918 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:50:04.222174 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:04.222452 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:50:04.223436 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:04.223872 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:04.224425 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:04.224652 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:50:04.225335 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.225600 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:04.225842 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:50:04.226870 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:04.227795 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m13:50:04.228364 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: Close
[0m13:50:04.228737 [info ] [Thread-1  ]: 36 of 39 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.02s]
[0m13:50:04.229082 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:50:04.229321 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:50:04.229586 [info ] [Thread-1  ]: 37 of 39 START test unique_dim_products_product_id ............................. [RUN]
[0m13:50:04.229846 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8, now test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985)
[0m13:50:04.230065 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:50:04.233116 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:04.233602 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:50:04.235410 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:50:04.235855 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:04.236070 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:50:04.236270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.240749 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:04.241009 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:04.241245 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m13:50:04.242564 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:04.243176 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:50:04.243394 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:04.243597 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:50:04.245071 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:04.245458 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:04.245956 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:04.246171 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:50:04.246737 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.246934 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:04.247137 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:50:04.247908 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:04.248698 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:50:04.249222 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:50:04.249559 [info ] [Thread-1  ]: 37 of 39 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m13:50:04.249883 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:50:04.250109 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:50:04.250361 [info ] [Thread-1  ]: 38 of 39 START test unique_fct_order_items_order_item_id ....................... [RUN]
[0m13:50:04.250608 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768)
[0m13:50:04.250819 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:50:04.254583 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:04.254991 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:50:04.256821 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
[0m13:50:04.257232 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:04.257449 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: BEGIN
[0m13:50:04.257652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.263375 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:04.263664 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:04.263913 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
  
  
    as
  
  (
    
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."fct_order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



  );
  
    
[0m13:50:04.265378 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:04.266060 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: COMMIT
[0m13:50:04.266320 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:04.266545 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: COMMIT
[0m13:50:04.267341 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:04.267754 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:04.268257 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:04.268488 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: BEGIN
[0m13:50:04.268980 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.269236 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:04.269487 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m13:50:04.270126 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:04.271024 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: ROLLBACK
[0m13:50:04.271458 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: Close
[0m13:50:04.271839 [info ] [Thread-1  ]: 38 of 39 PASS unique_fct_order_items_order_item_id ............................. [[32mPASS[0m in 0.02s]
[0m13:50:04.272199 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:50:04.272451 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:50:04.272723 [info ] [Thread-1  ]: 39 of 39 START test unique_fct_orders_order_id ................................. [RUN]
[0m13:50:04.272993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768, now test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5)
[0m13:50:04.273218 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:50:04.276334 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:04.276808 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:50:04.278725 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:50:04.279164 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:04.279391 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:50:04.279600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:04.283939 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:04.284283 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:04.284534 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m13:50:04.286146 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:04.286876 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:50:04.287130 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:04.287361 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:50:04.288218 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:04.288678 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:04.289208 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:04.289439 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:50:04.289969 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:04.290195 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:04.290417 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:50:04.291125 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:04.292089 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m13:50:04.292777 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: Close
[0m13:50:04.293225 [info ] [Thread-1  ]: 39 of 39 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m13:50:04.293600 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:50:04.294740 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:04.295216 [debug] [MainThread]: On master: BEGIN
[0m13:50:04.295435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:04.300992 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:50:04.301348 [debug] [MainThread]: On master: COMMIT
[0m13:50:04.301579 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:04.301791 [debug] [MainThread]: On master: COMMIT
[0m13:50:04.302380 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:04.302651 [debug] [MainThread]: On master: Close
[0m13:50:04.302986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:04.303271 [debug] [MainThread]: Connection 'test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m13:50:04.303572 [info ] [MainThread]: 
[0m13:50:04.303823 [info ] [MainThread]: Finished running 39 data tests in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m13:50:04.307096 [debug] [MainThread]: Command end result
[0m13:50:04.339255 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:04.340473 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:04.346318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:50:04.346643 [info ] [MainThread]: 
[0m13:50:04.346892 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:50:04.347098 [info ] [MainThread]: 
[0m13:50:04.347340 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:04.347535 [info ] [MainThread]: 
[0m13:50:04.347758 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:04.347947 [info ] [MainThread]: 
[0m13:50:04.348172 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:04.348365 [info ] [MainThread]: 
[0m13:50:04.348584 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:04.348768 [info ] [MainThread]: 
[0m13:50:04.348982 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:04.349164 [info ] [MainThread]: 
[0m13:50:04.349378 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:04.349560 [info ] [MainThread]: 
[0m13:50:04.349773 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:04.350029 [info ] [MainThread]: 
[0m13:50:04.350279 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:04.350526 [info ] [MainThread]: 
[0m13:50:04.350744 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=8 SKIP=0 TOTAL=39
[0m13:50:04.351845 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8991259, "process_in_blocks": "0", "process_kernel_time": 0.211023, "process_mem_max_rss": "121307136", "process_out_blocks": "0", "process_user_time": 2.205493}
[0m13:50:04.352128 [debug] [MainThread]: Command `dbt test` failed at 13:50:04.352076 after 1.90 seconds
[0m13:50:04.352389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d2a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9e700>]}
[0m13:50:04.352662 [debug] [MainThread]: Flushing usage events
[0m13:50:05.741771 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:06.833129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104201760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516e1f0>]}


============================== 13:50:06.836342 | 9967be6f-8866-4127-81df-16ae8c2722e6 ==============================
[0m13:50:06.836342 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:06.836816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select mart.*', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:06.983936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512e640>]}
[0m13:50:07.035088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051412b0>]}
[0m13:50:07.035810 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:07.046611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c27c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743ae80>]}


============================== 13:50:07.050432 | 36c4f37e-b93d-423f-81ee-4fbe0d7263bb ==============================
[0m13:50:07.050432 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:07.050933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select mart.dimensions.*', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:07.131271 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:50:07.203671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36c4f37e-b93d-423f-81ee-4fbe0d7263bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d1fa0>]}
[0m13:50:07.250642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:07.250955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:07.256834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36c4f37e-b93d-423f-81ee-4fbe0d7263bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ca190>]}
[0m13:50:07.257438 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:07.296637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcdfa0>]}
[0m13:50:07.343003 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:50:07.419510 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:07.422578 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:07.433244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddd4f0>]}
[0m13:50:07.433709 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:50:07.434014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eaec40>]}
[0m13:50:07.435633 [info ] [MainThread]: 
[0m13:50:07.435927 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:07.436136 [info ] [MainThread]: 
[0m13:50:07.436471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:07.440406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:50:07.463505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:07.463839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:07.473757 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:50:07.474122 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:50:07.474341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:07.485996 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m13:50:07.486877 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:50:07.488471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:50:07.493342 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:07.493794 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:50:07.494230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:07.498819 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:50:07.499142 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:07.499363 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:07.501447 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m13:50:07.502408 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:50:07.502901 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:50:07.508118 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.508391 [debug] [MainThread]: On master: BEGIN
[0m13:50:07.508582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:07.509688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36c4f37e-b93d-423f-81ee-4fbe0d7263bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba0ee0>]}
[0m13:50:07.514300 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:50:07.514674 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.514965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:07.537211 [debug] [MainThread]: SQL status: SELECT 2 in 0.022 seconds
[0m13:50:07.538404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc9c70>]}
[0m13:50:07.538856 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:07.539706 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.539976 [debug] [MainThread]: On master: BEGIN
[0m13:50:07.540743 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:50:07.540976 [debug] [MainThread]: On master: COMMIT
[0m13:50:07.541181 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.541367 [debug] [MainThread]: On master: COMMIT
[0m13:50:07.541926 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:07.542144 [debug] [MainThread]: On master: Close
[0m13:50:07.543555 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:50:07.544074 [info ] [Thread-1  ]: 1 of 9 START sql table model public.dim_customers_mart ......................... [RUN]
[0m13:50:07.544453 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_customers_mart)
[0m13:50:07.544693 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:50:07.551468 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:07.552513 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:50:07.584383 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:07.585170 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:07.585408 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: BEGIN
[0m13:50:07.585622 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.589103 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:50:07.589392 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:07.589658 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex3"."public"."dim_customers"
),

customer_segments as (
    select
        customer_id,
        case
            when lifetime_value >= 1000000 then 'VIP'
            when lifetime_value >= 500000 then 'High Value'
            when lifetime_value >= 100000 then 'Medium Value'
            else 'Low Value'
        end as customer_segment,
        case
            when lifetime_orders >= 10 then 'Frequent'
            when lifetime_orders >= 5 then 'Regular'
            when lifetime_orders >= 2 then 'Occasional'
            else 'One-time'
        end as purchase_frequency,
        case
            when datediff('day', most_recent_order_date, current_date) <= 30 then 'Active'
            when datediff('day', most_recent_order_date, current_date) <= 90 then 'Recent'
            when datediff('day', most_recent_order_date, current_date) <= 180 then 'Lapsed'
            else 'Inactive'
        end as customer_status
    from customers
    where lifetime_orders > 0
)

select
    c.*,
    coalesce(cs.customer_segment, 'New') as customer_segment,
    coalesce(cs.purchase_frequency, 'None') as purchase_frequency,
    coalesce(cs.customer_status, 'New') as customer_status,
    case
        when cs.customer_segment = 'VIP' and cs.customer_status = 'Active' then true
        else false
    end as is_high_value_active
from customers c
left join customer_segments cs using (customer_id)
  );
  
[0m13:50:07.590675 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function datediff(unknown, timestamp without time zone, date) does not exist
LINE 34:             when datediff('day', most_recent_order_date, cur...
                          ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:50:07.590920 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: ROLLBACK
[0m13:50:07.591830 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: Close
[0m13:50:07.607794 [debug] [Thread-1  ]: Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 34:             when datediff('day', most_recent_order_date, cur...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql
[0m13:50:07.609190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e7af0>]}
[0m13:50:07.609654 [error] [Thread-1  ]: 1 of 9 ERROR creating sql table model public.dim_customers_mart ................ [[31mERROR[0m in 0.06s]
[0m13:50:07.610041 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:50:07.610298 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:50:07.610630 [debug] [Thread-4  ]: Marking all children of 'model.ecommerce_datamart.dim_customers_mart' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 34:             when datediff('day', most_recent_order_date, cur...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql.
[0m13:50:07.610969 [info ] [Thread-1  ]: 2 of 9 START sql table model public.dim_date ................................... [RUN]
[0m13:50:07.611373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now model.ecommerce_datamart.dim_date)
[0m13:50:07.611612 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:50:07.628138 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.628491 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:50:07.628725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.634490 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:07.634859 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.635104 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:50:07.635908 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:07.640518 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:07.643031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:07.643848 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:50:07.644365 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:50:07.647921 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_date"
[0m13:50:07.648559 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.648883 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

-- Generate a date series from 2020-01-01 to 2025-12-31
with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2191
    order by generated_number



),

all_periods as (

    select (
        

    cast('2020-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as date)

)

select * from filtered


),

dates as (
    select
        cast(date_day as date) as date_key,
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dow from date_day) as day_of_week,
        extract(doy from date_day) as day_of_year,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Day') as day_name,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when extract(month from date_day) in (1, 2, 3) then 'Q1'
            when extract(month from date_day) in (4, 5, 6) then 'Q2'
            when extract(month from date_day) in (7, 8, 9) then 'Q3'
            else 'Q4'
        end as quarter_name
    from date_spine
)

select * from dates
  );
  
[0m13:50:07.654081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36c4f37e-b93d-423f-81ee-4fbe0d7263bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a84c0>]}
[0m13:50:07.654491 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:50:07.654730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c4f37e-b93d-423f-81ee-4fbe0d7263bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a8820>]}
[0m13:50:07.655949 [info ] [MainThread]: 
[0m13:50:07.656182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:07.656373 [info ] [MainThread]: 
[0m13:50:07.656686 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:07.660103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:50:07.661133 [debug] [Thread-1  ]: SQL status: SELECT 2191 in 0.012 seconds
[0m13:50:07.668868 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.669218 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:50:07.670301 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:07.684476 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:50:07.684812 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.685044 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:50:07.687898 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:50:07.693387 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:50:07.693736 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:50:07.693948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:07.693872 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_date__dbt_backup"
[0m13:50:07.697030 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.697373 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
drop table if exists "dbt_db_ex3"."public"."dim_date__dbt_backup" cascade
[0m13:50:07.702020 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:50:07.704471 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:50:07.705312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104369160>]}
[0m13:50:07.706259 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.dim_date .............................. [[32mSELECT 2191[0m in 0.09s]
[0m13:50:07.706683 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:50:07.707496 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:50:07.708915 [info ] [Thread-1  ]: 3 of 9 START sql table model public.dim_products_mart .......................... [RUN]
[0m13:50:07.709868 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.dim_products_mart)
[0m13:50:07.710329 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:50:07.714976 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.715662 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:50:07.718773 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.719491 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.719785 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: BEGIN
[0m13:50:07.720022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.720481 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m13:50:07.721468 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:50:07.723360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:50:07.724522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:07.724861 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.725154 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex3"."public"."dim_products"
)

select
    p.*,
    case
        when total_quantity_sold > 100 then 'High Selling'
        when total_quantity_sold > 50 then 'Medium Selling'
        when total_quantity_sold > 0 then 'Low Selling'
        else 'Not Selling'
    end as sales_performance,
    case
        when total_revenue > 10000000 then 'High Revenue'
        when total_revenue > 5000000 then 'Medium Revenue'
        when total_revenue > 0 then 'Low Revenue'
        else 'No Revenue'
    end as revenue_tier,
    (total_revenue / nullif(total_quantity_sold, 0)) as average_selling_price,
    case
        when is_active = true and inventory_status != 'Out of stock' then true
        else false
    end as is_available_for_purchase,
    case
        when is_active = false then 'Discontinued'
        when inventory_status = 'Out of stock' then 'Temporarily Unavailable'
        else 'Available'
    end as availability_status
from products p
  );
  
[0m13:50:07.729562 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.004 seconds
[0m13:50:07.729817 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:07.730133 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:50:07.730332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:07.733033 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.733415 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp" rename to "dim_products_mart"
[0m13:50:07.734144 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:50:07.735110 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:50:07.735398 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.735627 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:50:07.735553 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:50:07.735836 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:07.736061 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:07.736496 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:07.737831 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.002 seconds
[0m13:50:07.739191 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products_mart__dbt_backup"
[0m13:50:07.739511 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:50:07.739886 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.740180 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_products_mart__dbt_backup" cascade
[0m13:50:07.740495 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:50:07.741032 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:50:07.742186 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: Close
[0m13:50:07.742675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104369160>]}
[0m13:50:07.743143 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.dim_products_mart ..................... [[32mSELECT 15[0m in 0.03s]
[0m13:50:07.743650 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:50:07.743918 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_customer_retention
[0m13:50:07.744258 [info ] [Thread-1  ]: 4 of 9 START sql table model public.fct_customer_retention ..................... [RUN]
[0m13:50:07.745219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products_mart, now model.ecommerce_datamart.fct_customer_retention)
[0m13:50:07.745607 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_customer_retention
[0m13:50:07.746896 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.748473 [debug] [MainThread]: On master: BEGIN
[0m13:50:07.748700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:07.752219 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:50:07.753520 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_customer_retention
[0m13:50:07.754053 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:50:07.754367 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.754648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:07.758445 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:50:07.759168 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:50:07.759419 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: BEGIN
[0m13:50:07.759644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.763656 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:07.763989 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:50:07.764338 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_customer_retention__dbt_tmp"
  
  
    as
  
  (
    

with customer_orders as (
    select
        customer_id,
        order_id,
        order_date,
        total_amount,
        row_number() over(partition by customer_id order by order_date) as order_sequence,
        lead(order_date) over(partition by customer_id order by order_date) as next_order_date,
        datediff('day', order_date, lead(order_date) over(partition by customer_id order by order_date)) as days_until_next_order
    from "dbt_db_ex3"."public"."fct_orders"
),

customer_first_orders as (
    select
        customer_id,
        min(case when order_sequence = 1 then order_date end) as first_order_date,
        extract(year from min(case when order_sequence = 1 then order_date end)) as first_order_year,
        extract(month from min(case when order_sequence = 1 then order_date end)) as first_order_month,
        to_char(min(case when order_sequence = 1 then order_date end), 'YYYY-MM') as first_order_year_month
    from customer_orders
    group by 1
),

repeat_purchase_facts as (
    select
        c.customer_id,
        c.first_order_date,
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        count(distinct case when co.order_sequence > 1 then co.order_id end) as repeat_orders,
        max(co.order_sequence) as total_orders,
        sum(case when co.order_sequence > 1 then co.total_amount else 0 end) as repeat_order_revenue,
        min(case when co.order_sequence = 2 then co.order_date end) as second_order_date,
        avg(co.days_until_next_order) as avg_days_between_orders
    from customer_first_orders c
    left join customer_orders co using (customer_id)
    group by 1, 2, 3, 4, 5
),

cohort_sizes as (
    select
        first_order_year,
        first_order_month,
        first_order_year_month,
        count(distinct customer_id) as cohort_size
    from customer_first_orders
    group by 1, 2, 3
),

retention_by_month as (
    select
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        cs.cohort_size,
        date_part('month', age(date_trunc('month', o.order_date), 
                              date_trunc('month', c.first_order_date))) as months_since_first_order,
        count(distinct o.customer_id) as retained_customers,
        sum(o.total_amount) as cohort_revenue
    from customer_first_orders c
    join "dbt_db_ex3"."public"."fct_orders" o using(customer_id)
    join cohort_sizes cs 
        on c.first_order_year = cs.first_order_year 
        and c.first_order_month = cs.first_order_month
    where o.order_date > c.first_order_date
    group by 1, 2, 3, 4, 5
)

select
    r.first_order_year,
    r.first_order_month,
    r.first_order_year_month as cohort,
    r.cohort_size,
    r.months_since_first_order,
    r.retained_customers,
    r.cohort_revenue,
    (r.retained_customers::float / r.cohort_size) * 100 as retention_rate,
    (r.cohort_revenue::float / r.retained_customers) as revenue_per_retained_customer,
    sum(r.retained_customers) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_retained_customers,
    sum(r.cohort_revenue) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_cohort_revenue,
    current_timestamp as updated_at
from retention_by_month r
order by r.first_order_year, r.first_order_month, r.months_since_first_order
  );
  
[0m13:50:07.766379 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
LINE 22:         datediff('day', order_date, lead(order_date) over(pa...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:50:07.766745 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: ROLLBACK
[0m13:50:07.767392 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: Close
[0m13:50:07.771832 [debug] [Thread-1  ]: Database Error in model fct_customer_retention (models/mart/facts/fct_customer_retention.sql)
  function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
  LINE 22:         datediff('day', order_date, lead(order_date) over(pa...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/facts/fct_customer_retention.sql
[0m13:50:07.772305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104369160>]}
[0m13:50:07.772758 [error] [Thread-1  ]: 4 of 9 ERROR creating sql table model public.fct_customer_retention ............ [[31mERROR[0m in 0.03s]
[0m13:50:07.773212 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_customer_retention
[0m13:50:07.773482 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_monthly_sales
[0m13:50:07.773797 [debug] [Thread-4  ]: Marking all children of 'model.ecommerce_datamart.fct_customer_retention' to be skipped because of status 'error'.  Reason: Database Error in model fct_customer_retention (models/mart/facts/fct_customer_retention.sql)
  function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
  LINE 22:         datediff('day', order_date, lead(order_date) over(pa...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/facts/fct_customer_retention.sql.
[0m13:50:07.774123 [info ] [Thread-1  ]: 5 of 9 START sql incremental model public.fct_monthly_sales .................... [RUN]
[0m13:50:07.774544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_customer_retention, now model.ecommerce_datamart.fct_monthly_sales)
[0m13:50:07.774841 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_monthly_sales
[0m13:50:07.780504 [debug] [MainThread]: SQL status: SELECT 2 in 0.026 seconds
[0m13:50:07.781998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36c4f37e-b93d-423f-81ee-4fbe0d7263bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e6580>]}
[0m13:50:07.782408 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:07.783276 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.783562 [debug] [MainThread]: On master: BEGIN
[0m13:50:07.784860 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:50:07.785163 [debug] [MainThread]: On master: COMMIT
[0m13:50:07.785043 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:50:07.785374 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.785569 [debug] [MainThread]: On master: COMMIT
[0m13:50:07.785919 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_monthly_sales
[0m13:50:07.786176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:07.786431 [debug] [MainThread]: On master: Close
[0m13:50:07.788008 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:50:07.788470 [info ] [Thread-1  ]: 1 of 3 START sql table model public.dim_customers_mart ......................... [RUN]
[0m13:50:07.788830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_customers_mart)
[0m13:50:07.789075 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:50:07.799423 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:07.800157 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:50:07.818646 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:50:07.819809 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:50:07.820247 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: BEGIN
[0m13:50:07.820492 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.825382 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:07.825739 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:50:07.826161 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      
  
    

  create  table "dbt_db_ex3"."public"."fct_monthly_sales"
  
  
    as
  
  (
    

with monthly_order_facts as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        to_char(order_date, 'YYYY-MM') as year_month,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as unique_customers,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold,
        count(distinct case when status = 'completed' then order_id end) as completed_orders,
        count(distinct case when status = 'cancelled' then order_id end) as cancelled_orders
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1, 2, 3
),

monthly_product_category_sales as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        product_category,
        sum(item_total) as category_sales,
        count(distinct order_id) as category_orders,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2, 3
),

monthly_new_customers as (
    select
        extract(year from first_order_date) as year,
        extract(month from first_order_date) as month,
        count(distinct customer_id) as new_customers
    from "dbt_db_ex3"."public"."dim_customers"
    where first_order_date is not null
    group by 1, 2
)

select
    m.year,
    m.month,
    m.year_month,
    m.orders_count,
    m.unique_customers,
    m.total_sales_amount,
    m.total_shipping_cost,
    m.average_order_value,
    m.total_items_sold,
    m.completed_orders,
    m.cancelled_orders,
    coalesce(pc_electronics.category_sales, 0) as electronics_sales,
    coalesce(pc_clothing.category_sales, 0) as clothing_sales,
    coalesce(pc_footwear.category_sales, 0) as footwear_sales,
    coalesce(pc_accessories.category_sales, 0) as accessories_sales,
    coalesce(pc_electronics.category_items_sold, 0) as electronics_items_sold,
    coalesce(pc_clothing.category_items_sold, 0) as clothing_items_sold,
    coalesce(pc_footwear.category_items_sold, 0) as footwear_items_sold,
    coalesce(pc_accessories.category_items_sold, 0) as accessories_items_sold,
    coalesce(nc.new_customers, 0) as new_customers,
    case 
        when m.orders_count = 0 then 0
        else (m.cancelled_orders::float / m.orders_count) * 100
    end as cancellation_rate,
    case
        when lag(m.total_sales_amount) over (order by m.year, m.month) = 0 then null
        else (m.total_sales_amount - lag(m.total_sales_amount) over (order by m.year, m.month)) / 
             lag(m.total_sales_amount) over (order by m.year, m.month) * 100
    end as sales_growth_pct,
    current_timestamp as updated_at
from monthly_order_facts m
left join monthly_new_customers nc on m.year = nc.year and m.month = nc.month
left join monthly_product_category_sales pc_electronics 
    on m.year = pc_electronics.year and m.month = pc_electronics.month and pc_electronics.product_category = 'Electronics'
left join monthly_product_category_sales pc_clothing 
    on m.year = pc_clothing.year and m.month = pc_clothing.month and pc_clothing.product_category = 'Clothing'
left join monthly_product_category_sales pc_footwear 
    on m.year = pc_footwear.year and m.month = pc_footwear.month and pc_footwear.product_category = 'Footwear'
left join monthly_product_category_sales pc_accessories 
    on m.year = pc_accessories.year and m.month = pc_accessories.month and pc_accessories.product_category = 'Accessories'


  );
  
  
[0m13:50:07.832016 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.005 seconds
[0m13:50:07.833198 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:50:07.833380 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:07.833502 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:50:07.833747 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:50:07.834024 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:07.834331 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: BEGIN
[0m13:50:07.834577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.835024 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:07.835794 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: Close
[0m13:50:07.836298 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d30a0>]}
[0m13:50:07.836803 [info ] [Thread-1  ]: 5 of 9 OK created sql incremental model public.fct_monthly_sales ............... [[32mSELECT 7[0m in 0.06s]
[0m13:50:07.837214 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_monthly_sales
[0m13:50:07.837667 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_daily_sales
[0m13:50:07.838126 [info ] [Thread-1  ]: 6 of 9 START sql table model public.fct_daily_sales ............................ [RUN]
[0m13:50:07.838686 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_monthly_sales, now model.ecommerce_datamart.fct_daily_sales)
[0m13:50:07.839106 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_daily_sales
[0m13:50:07.839295 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:07.839627 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:07.839919 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex3"."public"."dim_customers"
),

customer_segments as (
    select
        customer_id,
        case
            when lifetime_value >= 1000000 then 'VIP'
            when lifetime_value >= 500000 then 'High Value'
            when lifetime_value >= 100000 then 'Medium Value'
            else 'Low Value'
        end as customer_segment,
        case
            when lifetime_orders >= 10 then 'Frequent'
            when lifetime_orders >= 5 then 'Regular'
            when lifetime_orders >= 2 then 'Occasional'
            else 'One-time'
        end as purchase_frequency,
        case
            when datediff('day', most_recent_order_date, current_date) <= 30 then 'Active'
            when datediff('day', most_recent_order_date, current_date) <= 90 then 'Recent'
            when datediff('day', most_recent_order_date, current_date) <= 180 then 'Lapsed'
            else 'Inactive'
        end as customer_status
    from customers
    where lifetime_orders > 0
)

select
    c.*,
    coalesce(cs.customer_segment, 'New') as customer_segment,
    coalesce(cs.purchase_frequency, 'None') as purchase_frequency,
    coalesce(cs.customer_status, 'New') as customer_status,
    case
        when cs.customer_segment = 'VIP' and cs.customer_status = 'Active' then true
        else false
    end as is_high_value_active
from customers c
left join customer_segments cs using (customer_id)
  );
  
[0m13:50:07.841179 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function datediff(unknown, timestamp without time zone, date) does not exist
LINE 34:             when datediff('day', most_recent_order_date, cur...
                          ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:50:07.841508 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: ROLLBACK
[0m13:50:07.842092 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: Close
[0m13:50:07.842636 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:50:07.843230 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_daily_sales
[0m13:50:07.847195 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:50:07.848613 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:50:07.849036 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: BEGIN
[0m13:50:07.849294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.854941 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:07.855298 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:50:07.855618 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

with order_facts as (
    select
        date_trunc('day', order_date) as order_day,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as customers_count,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        sum(total_amount - shipping_cost) as total_product_revenue,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1
),

product_category_facts as (
    select
        date_trunc('day', order_date) as order_day,
        product_category,
        count(distinct order_id) as category_orders_count,
        sum(item_total) as category_revenue,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2
)

select
    d.date_key,
    d.year,
    d.month,
    d.quarter,
    d.day_of_month,
    d.day_of_week,
    d.is_weekend,
    d.month_name,
    coalesce(o.orders_count, 0) as orders_count,
    coalesce(o.customers_count, 0) as customers_count,
    coalesce(o.total_sales_amount, 0) as total_sales_amount,
    coalesce(o.total_shipping_cost, 0) as total_shipping_cost,
    coalesce(o.total_product_revenue, 0) as total_product_revenue,
    coalesce(o.average_order_value, 0) as average_order_value,
    coalesce(o.total_items_sold, 0) as total_items_sold,
    -- Metrics specific to each product category
    coalesce(pc_electronics.category_revenue, 0) as electronics_revenue,
    coalesce(pc_clothing.category_revenue, 0) as clothing_revenue,
    coalesce(pc_footwear.category_revenue, 0) as footwear_revenue,
    coalesce(pc_accessories.category_revenue, 0) as accessories_revenue,
    -- Calculated metrics
    case 
        when coalesce(o.orders_count, 0) = 0 then 0
        else coalesce(o.customers_count, 0)::float / o.orders_count 
    end as customers_per_order_ratio,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."dim_date" d
left join order_facts o on d.date_key = o.order_day
left join product_category_facts pc_electronics 
    on d.date_key = pc_electronics.order_day and pc_electronics.product_category = 'Electronics'
left join product_category_facts pc_clothing 
    on d.date_key = pc_clothing.order_day and pc_clothing.product_category = 'Clothing'
left join product_category_facts pc_footwear 
    on d.date_key = pc_footwear.order_day and pc_footwear.product_category = 'Footwear'
left join product_category_facts pc_accessories 
    on d.date_key = pc_accessories.order_day and pc_accessories.product_category = 'Accessories'
where d.date_key <= current_date
  );
  
[0m13:50:07.862891 [debug] [Thread-1  ]: Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 34:             when datediff('day', most_recent_order_date, cur...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql
[0m13:50:07.864118 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.008 seconds
[0m13:50:07.864432 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c4f37e-b93d-423f-81ee-4fbe0d7263bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110aab80>]}
[0m13:50:07.864981 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model public.dim_customers_mart ................ [[31mERROR[0m in 0.07s]
[0m13:50:07.865394 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:50:07.865669 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:50:07.866018 [debug] [Thread-4  ]: Marking all children of 'model.ecommerce_datamart.dim_customers_mart' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 34:             when datediff('day', most_recent_order_date, cur...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql.
[0m13:50:07.866399 [info ] [Thread-1  ]: 2 of 3 START sql table model public.dim_date ................................... [RUN]
[0m13:50:07.866828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now model.ecommerce_datamart.dim_date)
[0m13:50:07.867075 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:50:07.867795 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:50:07.868131 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
alter table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m13:50:07.869158 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:07.870183 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:50:07.870466 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:50:07.870695 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:50:07.873082 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:50:07.875354 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup"
[0m13:50:07.875792 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:50:07.876034 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup" cascade
[0m13:50:07.876782 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:50:07.877775 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: Close
[0m13:50:07.878290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d30a0>]}
[0m13:50:07.878971 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 1959[0m in 0.04s]
[0m13:50:07.879391 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_daily_sales
[0m13:50:07.879672 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_customer_retention
[0m13:50:07.879989 [info ] [Thread-1  ]: 7 of 9 SKIP relation public.metric_customer_retention .......................... [[33mSKIP[0m]
[0m13:50:07.880404 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_customer_retention
[0m13:50:07.880645 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_monthly_sales
[0m13:50:07.881001 [info ] [Thread-1  ]: 8 of 9 START sql table model public.metric_monthly_sales ....................... [RUN]
[0m13:50:07.881359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_daily_sales, now model.ecommerce_datamart.metric_monthly_sales)
[0m13:50:07.881606 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_monthly_sales
[0m13:50:07.884507 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:50:07.884885 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.885438 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_monthly_sales
[0m13:50:07.885384 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:50:07.885840 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.891236 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:50:07.892838 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:50:07.893335 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: BEGIN
[0m13:50:07.893236 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:50:07.894217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.894339 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.894765 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:50:07.895830 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:07.899947 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:07.900300 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:50:07.900595 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates monthly sales metrics
-- for easier analytics consumption

select
    year,
    month,
    year_month,
    orders_count,
    unique_customers,
    total_sales_amount,
    total_shipping_cost,
    average_order_value,
    total_items_sold,
    completed_orders,
    cancelled_orders,
    electronics_sales,
    clothing_sales,
    footwear_sales,
    accessories_sales,
    electronics_items_sold,
    clothing_items_sold,
    footwear_items_sold,
    accessories_items_sold,
    new_customers,
    cancellation_rate,
    sales_growth_pct,
    -- Additional calculated metrics
    case
        when lag(new_customers) over (order by year, month) = 0 then null
        else (new_customers - lag(new_customers) over (order by year, month)) / 
             nullif(lag(new_customers) over (order by year, month), 0) * 100
    end as new_customer_growth_pct,
    case 
        when unique_customers = 0 then 0 
        else total_sales_amount / unique_customers 
    end as revenue_per_customer,
    (completed_orders::float / nullif(orders_count, 0)) * 100 as completion_rate,
    case
        when total_sales_amount = 0 then 0
        else electronics_sales / total_sales_amount * 100
    end as electronics_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else clothing_sales / total_sales_amount * 100
    end as clothing_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else footwear_sales / total_sales_amount * 100
    end as footwear_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else accessories_sales / total_sales_amount * 100
    end as accessories_sales_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_monthly_sales"
  );
  
[0m13:50:07.904206 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.003 seconds
[0m13:50:07.905997 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:50:07.906618 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:50:07.907342 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:50:07.907709 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
alter table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp" rename to "metric_monthly_sales"
[0m13:50:07.908688 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:07.909872 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:50:07.910180 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:50:07.910223 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_date"
[0m13:50:07.910411 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:50:07.910834 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.911389 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

-- Generate a date series from 2020-01-01 to 2025-12-31
with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2191
    order by generated_number



),

all_periods as (

    select (
        

    cast('2020-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as date)

)

select * from filtered


),

dates as (
    select
        cast(date_day as date) as date_key,
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dow from date_day) as day_of_week,
        extract(doy from date_day) as day_of_year,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Day') as day_name,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when extract(month from date_day) in (1, 2, 3) then 'Q1'
            when extract(month from date_day) in (4, 5, 6) then 'Q2'
            when extract(month from date_day) in (7, 8, 9) then 'Q3'
            else 'Q4'
        end as quarter_name
    from date_spine
)

select * from dates
  );
  
[0m13:50:07.911904 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:07.916113 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup"
[0m13:50:07.916676 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:50:07.916980 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup" cascade
[0m13:50:07.917826 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:50:07.918817 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: Close
[0m13:50:07.919296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104369160>]}
[0m13:50:07.919762 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.metric_monthly_sales .................. [[32mSELECT 7[0m in 0.04s]
[0m13:50:07.920152 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_monthly_sales
[0m13:50:07.920623 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_daily_sales
[0m13:50:07.921006 [info ] [Thread-1  ]: 9 of 9 START sql table model public.metric_daily_sales ......................... [RUN]
[0m13:50:07.921516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_monthly_sales, now model.ecommerce_datamart.metric_daily_sales)
[0m13:50:07.921785 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_daily_sales
[0m13:50:07.925076 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:50:07.925376 [debug] [Thread-1  ]: SQL status: SELECT 2191 in 0.013 seconds
[0m13:50:07.926214 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_daily_sales
[0m13:50:07.929728 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:50:07.930353 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:50:07.930600 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: BEGIN
[0m13:50:07.930819 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.934261 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.934754 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m13:50:07.935752 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:07.936468 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:07.936906 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:50:07.937240 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates daily sales metrics
-- for easier analytics consumption

select
    date_key,
    year,
    month,
    quarter,
    day_of_month,
    day_of_week,
    is_weekend,
    month_name,
    orders_count,
    customers_count,
    total_sales_amount,
    total_shipping_cost,
    total_product_revenue,
    average_order_value,
    total_items_sold,
    electronics_revenue,
    clothing_revenue,
    footwear_revenue,
    accessories_revenue,
    -- Additional calculated metrics
    case 
        when orders_count = 0 then 0 
        else total_sales_amount / orders_count 
    end as revenue_per_order,
    case 
        when customers_count = 0 then 0 
        else total_sales_amount / customers_count 
    end as revenue_per_customer,
    case 
        when total_sales_amount = 0 then 0 
        else electronics_revenue / total_sales_amount * 100 
    end as electronics_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else clothing_revenue / total_sales_amount * 100 
    end as clothing_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else footwear_revenue / total_sales_amount * 100 
    end as footwear_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else accessories_revenue / total_sales_amount * 100 
    end as accessories_revenue_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_daily_sales"
  );
  
[0m13:50:07.939559 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.940299 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:50:07.941978 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:07.945450 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.008 seconds
[0m13:50:07.949952 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:50:07.950292 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
alter table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp" rename to "metric_daily_sales"
[0m13:50:07.951688 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:07.953054 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:50:07.953372 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:50:07.953604 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:50:07.954897 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:07.957144 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup"
[0m13:50:07.957579 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:50:07.957822 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup" cascade
[0m13:50:07.958160 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:50:07.958621 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.958782 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:50:07.958870 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:50:07.959792 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: Close
[0m13:50:07.959919 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:07.960314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9967be6f-8866-4127-81df-16ae8c2722e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067967c0>]}
[0m13:50:07.961053 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.metric_daily_sales .................... [[32mSELECT 1959[0m in 0.04s]
[0m13:50:07.961534 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_daily_sales
[0m13:50:07.962662 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.962933 [debug] [MainThread]: On master: BEGIN
[0m13:50:07.963133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:07.966913 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_date__dbt_backup"
[0m13:50:07.967819 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:50:07.968124 [debug] [MainThread]: On master: COMMIT
[0m13:50:07.968339 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:07.968532 [debug] [MainThread]: On master: COMMIT
[0m13:50:07.968996 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:07.969246 [debug] [MainThread]: On master: Close
[0m13:50:07.969592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:07.969819 [debug] [MainThread]: Connection 'model.ecommerce_datamart.metric_daily_sales' was properly closed.
[0m13:50:07.970103 [info ] [MainThread]: 
[0m13:50:07.970337 [info ] [MainThread]: Finished running 1 incremental model, 8 table models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m13:50:07.970795 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:07.971116 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
drop table if exists "dbt_db_ex3"."public"."dim_date__dbt_backup" cascade
[0m13:50:07.971518 [debug] [MainThread]: Command end result
[0m13:50:07.972795 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:50:07.974914 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:50:07.975434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c4f37e-b93d-423f-81ee-4fbe0d7263bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b20a0>]}
[0m13:50:07.975916 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.dim_date .............................. [[32mSELECT 2191[0m in 0.11s]
[0m13:50:07.976597 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:50:07.977022 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:50:07.977488 [info ] [Thread-1  ]: 3 of 3 START sql table model public.dim_products_mart .......................... [RUN]
[0m13:50:07.977911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.dim_products_mart)
[0m13:50:07.978386 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:50:07.982082 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.982709 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:50:07.986451 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.987280 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.987602 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: BEGIN
[0m13:50:07.987828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:07.993690 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:07.994074 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:07.994486 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex3"."public"."dim_products"
)

select
    p.*,
    case
        when total_quantity_sold > 100 then 'High Selling'
        when total_quantity_sold > 50 then 'Medium Selling'
        when total_quantity_sold > 0 then 'Low Selling'
        else 'Not Selling'
    end as sales_performance,
    case
        when total_revenue > 10000000 then 'High Revenue'
        when total_revenue > 5000000 then 'Medium Revenue'
        when total_revenue > 0 then 'Low Revenue'
        else 'No Revenue'
    end as revenue_tier,
    (total_revenue / nullif(total_quantity_sold, 0)) as average_selling_price,
    case
        when is_active = true and inventory_status != 'Out of stock' then true
        else false
    end as is_available_for_purchase,
    case
        when is_active = false then 'Discontinued'
        when inventory_status = 'Out of stock' then 'Temporarily Unavailable'
        else 'Available'
    end as availability_status
from products p
  );
  
[0m13:50:08.059157 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.039 seconds
[0m13:50:08.068520 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:08.068999 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart" rename to "dim_products_mart__dbt_backup"
[0m13:50:08.070524 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:08.075503 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:08.075895 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp" rename to "dim_products_mart"
[0m13:50:08.078514 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:50:08.087052 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:50:08.087453 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:08.087705 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:50:08.089618 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:50:08.092366 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products_mart__dbt_backup"
[0m13:50:08.092911 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:08.093169 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_products_mart__dbt_backup" cascade
[0m13:50:08.095961 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:50:08.097119 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: Close
[0m13:50:08.097620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36c4f37e-b93d-423f-81ee-4fbe0d7263bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b20a0>]}
[0m13:50:08.098123 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public.dim_products_mart ..................... [[32mSELECT 15[0m in 0.12s]
[0m13:50:08.098729 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:50:08.100107 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:08.100436 [debug] [MainThread]: On master: BEGIN
[0m13:50:08.100648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:08.105673 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:50:08.106021 [debug] [MainThread]: On master: COMMIT
[0m13:50:08.106305 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:08.106534 [debug] [MainThread]: On master: COMMIT
[0m13:50:08.107175 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:08.107423 [debug] [MainThread]: On master: Close
[0m13:50:08.107830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:08.108072 [debug] [MainThread]: Connection 'model.ecommerce_datamart.dim_products_mart' was properly closed.
[0m13:50:08.108360 [info ] [MainThread]: 
[0m13:50:08.108597 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m13:50:08.109500 [debug] [MainThread]: Command end result
[0m13:50:08.128311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:08.129647 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:08.134787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:50:08.135099 [info ] [MainThread]: 
[0m13:50:08.135368 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:50:08.135591 [info ] [MainThread]: 
[0m13:50:08.135840 [error] [MainThread]:   Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 34:             when datediff('day', most_recent_order_date, cur...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql
[0m13:50:08.136054 [info ] [MainThread]: 
[0m13:50:08.136368 [error] [MainThread]:   Database Error in model fct_customer_retention (models/mart/facts/fct_customer_retention.sql)
  function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
  LINE 22:         datediff('day', order_date, lead(order_date) over(pa...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/facts/fct_customer_retention.sql
[0m13:50:08.136617 [info ] [MainThread]: 
[0m13:50:08.136840 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=2 SKIP=1 TOTAL=9
[0m13:50:08.137945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3613567, "process_in_blocks": "0", "process_kernel_time": 0.204022, "process_mem_max_rss": "127746048", "process_out_blocks": "0", "process_user_time": 1.91568}
[0m13:50:08.138222 [debug] [MainThread]: Command `dbt run` failed at 13:50:08.138169 after 1.36 seconds
[0m13:50:08.138484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104201760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065baa90>]}
[0m13:50:08.138744 [debug] [MainThread]: Flushing usage events
[0m13:50:08.143850 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:08.145967 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:08.150344 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:50:08.150620 [info ] [MainThread]: 
[0m13:50:08.150871 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:50:08.151086 [info ] [MainThread]: 
[0m13:50:08.151398 [error] [MainThread]:   Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 34:             when datediff('day', most_recent_order_date, cur...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql
[0m13:50:08.151804 [info ] [MainThread]: 
[0m13:50:08.152087 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:50:08.153440 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1638647, "process_in_blocks": "0", "process_kernel_time": 0.179988, "process_mem_max_rss": "127336448", "process_out_blocks": "0", "process_user_time": 1.756389}
[0m13:50:08.153837 [debug] [MainThread]: Command `dbt run` failed at 13:50:08.153772 after 1.16 seconds
[0m13:50:08.154123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c27c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100d6640>]}
[0m13:50:08.154416 [debug] [MainThread]: Flushing usage events
[0m13:50:10.153519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:10.784041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:32.843553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f3adf0>]}


============================== 13:50:32.847365 | 305b4db4-015b-4c3a-b922-628b958a8689 ==============================
[0m13:50:32.847365 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:32.847793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --no-version-check', 'send_anonymous_usage_stats': 'True'}
[0m13:50:32.977395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '305b4db4-015b-4c3a-b922-628b958a8689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f13a00>]}
[0m13:50:33.030218 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-_zwl8y_x'
[0m13:50:33.031088 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:50:33.058453 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:50:33.059704 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:50:33.078895 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:50:33.082624 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:50:33.402063 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:50:33.406485 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:50:33.960882 [info ] [MainThread]: Installed from version 1.3.0
[0m13:50:33.961225 [info ] [MainThread]: Up to date!
[0m13:50:33.961501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '305b4db4-015b-4c3a-b922-628b958a8689', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ca99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580fd30>]}
[0m13:50:33.961823 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:50:34.616758 [info ] [MainThread]: Installed from version 0.13.1
[0m13:50:34.617261 [info ] [MainThread]: Up to date!
[0m13:50:34.617672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '305b4db4-015b-4c3a-b922-628b958a8689', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f5430>]}
[0m13:50:34.619783 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8426261, "process_in_blocks": "0", "process_kernel_time": 0.247103, "process_mem_max_rss": "104038400", "process_out_blocks": "0", "process_user_time": 1.155363}
[0m13:50:34.620224 [debug] [MainThread]: Command `dbt deps` succeeded at 13:50:34.620131 after 1.84 seconds
[0m13:50:34.620577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dfe550>]}
[0m13:50:34.620933 [debug] [MainThread]: Flushing usage events
[0m13:50:36.383345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:37.501992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106604460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106604280>]}


============================== 13:50:37.504573 | 37600e2f-ce77-43cf-8dc5-62651858625a ==============================
[0m13:50:37.504573 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:37.504956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:37.512447 [info ] [MainThread]: dbt version: 1.9.4
[0m13:50:37.512752 [info ] [MainThread]: python version: 3.9.6
[0m13:50:37.512955 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m13:50:37.513147 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m13:50:37.561960 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m13:50:37.562341 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m13:50:37.562561 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/dbt_project.yml
[0m13:50:37.563117 [info ] [MainThread]: adapter type: postgres
[0m13:50:37.563363 [info ] [MainThread]: adapter version: 1.9.0
[0m13:50:37.645270 [info ] [MainThread]: Configuration:
[0m13:50:37.645601 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:50:37.645799 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:50:37.645983 [info ] [MainThread]: Required dependencies:
[0m13:50:37.646255 [debug] [MainThread]: Executing "git --help"
[0m13:50:37.666406 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:50:37.666995 [debug] [MainThread]: STDERR: "b''"
[0m13:50:37.667242 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:50:37.667463 [info ] [MainThread]: Connection:
[0m13:50:37.667727 [info ] [MainThread]:   host: localhost
[0m13:50:37.667925 [info ] [MainThread]:   port: 5434
[0m13:50:37.668108 [info ] [MainThread]:   user: dbt_user
[0m13:50:37.668287 [info ] [MainThread]:   database: dbt_db_ex3
[0m13:50:37.668467 [info ] [MainThread]:   schema: public
[0m13:50:37.668643 [info ] [MainThread]:   connect_timeout: 10
[0m13:50:37.668820 [info ] [MainThread]:   role: None
[0m13:50:37.668997 [info ] [MainThread]:   search_path: None
[0m13:50:37.669175 [info ] [MainThread]:   keepalives_idle: 0
[0m13:50:37.669351 [info ] [MainThread]:   sslmode: None
[0m13:50:37.669527 [info ] [MainThread]:   sslcert: None
[0m13:50:37.669709 [info ] [MainThread]:   sslkey: None
[0m13:50:37.669887 [info ] [MainThread]:   sslrootcert: None
[0m13:50:37.670064 [info ] [MainThread]:   application_name: dbt
[0m13:50:37.670238 [info ] [MainThread]:   retries: 1
[0m13:50:37.670786 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:37.738158 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:50:37.766400 [debug] [MainThread]: Using postgres connection "debug"
[0m13:50:37.766708 [debug] [MainThread]: On debug: select 1 as id
[0m13:50:37.766903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:37.795493 [debug] [MainThread]: SQL status: SELECT 1 in 0.029 seconds
[0m13:50:37.796193 [debug] [MainThread]: On debug: Close
[0m13:50:37.796445 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:50:37.796681 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:50:37.797856 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.34756246, "process_in_blocks": "0", "process_kernel_time": 0.142263, "process_mem_max_rss": "114311168", "process_out_blocks": "0", "process_user_time": 1.048189}
[0m13:50:37.798201 [debug] [MainThread]: Command `dbt debug` succeeded at 13:50:37.798135 after 0.35 seconds
[0m13:50:37.798516 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:50:37.798807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f0c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a20eb0>]}
[0m13:50:37.799133 [debug] [MainThread]: Flushing usage events
[0m13:50:38.800469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:39.848381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113facd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113faeb0>]}


============================== 13:50:39.850955 | da3e247a-6fbb-433c-a4c4-ab8008d8662e ==============================
[0m13:50:39.850955 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:39.851328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select source:* staging.* core.*', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:39.974985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173bfa0>]}
[0m13:50:40.021855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbbcd0>]}
[0m13:50:40.022477 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:40.105637 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:50:40.238792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:40.239084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:40.283487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123a0ee0>]}
[0m13:50:40.396193 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:40.398990 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:40.410161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123648b0>]}
[0m13:50:40.410550 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:50:40.410789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112364940>]}
[0m13:50:40.412435 [info ] [MainThread]: 
[0m13:50:40.412667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:40.412867 [info ] [MainThread]: 
[0m13:50:40.413181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:40.416190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:50:40.443012 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:50:40.443363 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:50:40.443599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:40.467435 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m13:50:40.468386 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:50:40.470181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:50:40.476563 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:40.477017 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:50:40.477274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:40.482178 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:50:40.482490 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:40.482733 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:40.486396 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m13:50:40.487385 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:50:40.487976 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:50:40.493091 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:40.493372 [debug] [MainThread]: On master: BEGIN
[0m13:50:40.493587 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:40.498312 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:50:40.498657 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:40.498967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:40.510539 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m13:50:40.511565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117713d0>]}
[0m13:50:40.511988 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:40.512585 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:40.512881 [debug] [MainThread]: On master: BEGIN
[0m13:50:40.513628 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:50:40.513892 [debug] [MainThread]: On master: COMMIT
[0m13:50:40.514141 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:40.514380 [debug] [MainThread]: On master: COMMIT
[0m13:50:40.514898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:40.515153 [debug] [MainThread]: On master: Close
[0m13:50:40.517415 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:50:40.517839 [info ] [Thread-1  ]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m13:50:40.518194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.stg_customers)
[0m13:50:40.518468 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:50:40.526151 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:50:40.526783 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:50:40.552167 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_customers"
[0m13:50:40.553221 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:50:40.553726 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: BEGIN
[0m13:50:40.554009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:40.560046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:40.560373 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:50:40.560626 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */

  create view "dbt_db_ex3"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email,
        coalesce(phone, 'Unknown') as phone,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:50:40.565574 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:50:40.571411 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:50:40.571726 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:50:40.574552 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:50:40.585732 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:50:40.586084 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:50:40.586324 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:50:40.588300 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:50:40.593135 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_customers__dbt_backup"
[0m13:50:40.596121 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:50:40.596389 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
drop view if exists "dbt_db_ex3"."public"."stg_customers__dbt_backup" cascade
[0m13:50:40.597474 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m13:50:40.599194 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: Close
[0m13:50:40.600551 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11274f6a0>]}
[0m13:50:40.600968 [info ] [Thread-1  ]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m13:50:40.601334 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:50:40.601589 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_order_items
[0m13:50:40.601920 [info ] [Thread-1  ]: 2 of 8 START sql incremental model public.stg_order_items ...................... [RUN]
[0m13:50:40.602200 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_customers, now model.ecommerce_datamart.stg_order_items)
[0m13:50:40.602431 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_order_items
[0m13:50:40.607625 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_order_items"
[0m13:50:40.608157 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_order_items
[0m13:50:40.635177 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_order_items"
[0m13:50:40.635804 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:50:40.636033 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: BEGIN
[0m13:50:40.636245 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:40.641904 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:40.642172 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:50:40.642429 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      
  
    

  create  table "dbt_db_ex3"."public"."stg_order_items"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."order_items"
    
    
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity,
        coalesce(unit_price, 0) as unit_price,
        coalesce(discount_amount, 0) as discount_amount,
        (quantity * unit_price) - coalesce(discount_amount, 0) as item_total,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:50:40.648589 [debug] [Thread-1  ]: SQL status: SELECT 301 in 0.006 seconds
[0m13:50:40.651968 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:50:40.652265 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:50:40.652514 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:50:40.653465 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:40.653971 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: Close
[0m13:50:40.654392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127b4040>]}
[0m13:50:40.654853 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model public.stg_order_items ................. [[32mSELECT 301[0m in 0.05s]
[0m13:50:40.655239 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_order_items
[0m13:50:40.655530 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_orders
[0m13:50:40.655906 [info ] [Thread-1  ]: 3 of 8 START sql incremental model public.stg_orders ........................... [RUN]
[0m13:50:40.656248 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_order_items, now model.ecommerce_datamart.stg_orders)
[0m13:50:40.656508 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_orders
[0m13:50:40.660549 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_orders"
[0m13:50:40.661139 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_orders
[0m13:50:40.664358 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_orders"
[0m13:50:40.664844 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:50:40.665090 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: BEGIN
[0m13:50:40.665322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:40.671184 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:40.671518 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:50:40.671788 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      
  
    

  create  table "dbt_db_ex3"."public"."stg_orders"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."orders"
    
    
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        payment_method,
        shipping_address,
        shipping_cost,
        total_amount,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:50:40.675681 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.004 seconds
[0m13:50:40.676729 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:50:40.677000 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:50:40.677241 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:50:40.678033 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:40.678526 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: Close
[0m13:50:40.678966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a4fd90>]}
[0m13:50:40.679445 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model public.stg_orders ...................... [[32mSELECT 100[0m in 0.02s]
[0m13:50:40.679847 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_orders
[0m13:50:40.680128 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_products
[0m13:50:40.680442 [info ] [Thread-1  ]: 4 of 8 START sql view model public.stg_products ................................ [RUN]
[0m13:50:40.680867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_orders, now model.ecommerce_datamart.stg_products)
[0m13:50:40.681141 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_products
[0m13:50:40.683777 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_products"
[0m13:50:40.684293 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_products
[0m13:50:40.687620 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_products"
[0m13:50:40.688230 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:50:40.688470 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: BEGIN
[0m13:50:40.688691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:40.691997 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:50:40.692325 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:50:40.692588 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */

  create view "dbt_db_ex3"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price,
        category,
        coalesce(inventory_count, 0) as inventory_count,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:50:40.694105 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:50:40.696779 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:50:40.697055 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
alter table "dbt_db_ex3"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:50:40.697855 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:50:40.699140 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:50:40.699466 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:50:40.699706 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:50:40.700854 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:40.704343 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_products__dbt_backup"
[0m13:50:40.704813 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:50:40.705056 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
drop view if exists "dbt_db_ex3"."public"."stg_products__dbt_backup" cascade
[0m13:50:40.705672 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m13:50:40.706540 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: Close
[0m13:50:40.706945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a4fd90>]}
[0m13:50:40.707372 [info ] [Thread-1  ]: 4 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:50:40.707741 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_products
[0m13:50:40.708001 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers
[0m13:50:40.708400 [info ] [Thread-1  ]: 5 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m13:50:40.708699 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_products, now model.ecommerce_datamart.dim_customers)
[0m13:50:40.708936 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers
[0m13:50:40.711600 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers"
[0m13:50:40.712296 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers
[0m13:50:40.721618 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers"
[0m13:50:40.722175 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:50:40.722418 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: BEGIN
[0m13:50:40.722642 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:40.728951 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:40.729279 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:50:40.729536 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db_ex3"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        sum(total_amount) as lifetime_value
    from "dbt_db_ex3"."public"."stg_orders"
    group by 1
)

select
    c.customer_id,
    c.name,
    c.email,
    c.phone,
    c.created_at,
    coalesce(co.order_count, 0) as lifetime_orders,
    co.first_order_date,
    co.most_recent_order_date,
    coalesce(co.lifetime_value, 0) as lifetime_value,
    current_timestamp as updated_at
from customers c
left join customer_orders co using (customer_id)
  );
  
[0m13:50:40.733714 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m13:50:40.736552 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:50:40.736833 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
alter table "dbt_db_ex3"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:50:40.737552 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:50:40.738520 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:50:40.738820 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:50:40.739062 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:50:40.740012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:40.742143 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_customers__dbt_backup"
[0m13:50:40.743836 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:50:40.744101 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
drop table if exists "dbt_db_ex3"."public"."dim_customers__dbt_backup" cascade
[0m13:50:40.744671 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:50:40.745546 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: Close
[0m13:50:40.745975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a429a0>]}
[0m13:50:40.746434 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.dim_customers ......................... [[32mSELECT 10[0m in 0.04s]
[0m13:50:40.746849 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers
[0m13:50:40.747109 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_orders
[0m13:50:40.747465 [info ] [Thread-1  ]: 6 of 8 START sql table model public.fct_orders ................................. [RUN]
[0m13:50:40.747787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers, now model.ecommerce_datamart.fct_orders)
[0m13:50:40.748037 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_orders
[0m13:50:40.751416 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_orders"
[0m13:50:40.751997 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_orders
[0m13:50:40.755216 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_orders"
[0m13:50:40.755846 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:50:40.756083 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: BEGIN
[0m13:50:40.756305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:40.762243 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:40.762522 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:50:40.762815 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

order_items as (
    select
        order_id,
        count(*) as number_of_items,
        sum(quantity) as total_items,
        sum(item_total) as items_subtotal
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_date,
    o.status,
    o.payment_method,
    o.shipping_address,
    o.shipping_cost,
    o.total_amount,
    oi.number_of_items,
    oi.total_items,
    oi.items_subtotal,
    (oi.items_subtotal + o.shipping_cost) as calculated_total,
    abs(o.total_amount - (oi.items_subtotal + o.shipping_cost)) as total_amount_discrepancy,
    o.created_at,
    o.updated_at,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    extract(hour from o.order_date) as order_hour
from orders o
left join order_items oi using (order_id)
  );
  
[0m13:50:40.768286 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.005 seconds
[0m13:50:40.771109 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:50:40.771386 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
alter table "dbt_db_ex3"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:50:40.771995 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:50:40.772859 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:50:40.773130 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:50:40.773376 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:50:40.774054 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:40.776161 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_orders__dbt_backup"
[0m13:50:40.776592 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:50:40.776850 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
drop table if exists "dbt_db_ex3"."public"."fct_orders__dbt_backup" cascade
[0m13:50:40.777886 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:50:40.778852 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: Close
[0m13:50:40.779324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a429a0>]}
[0m13:50:40.779787 [info ] [Thread-1  ]: 6 of 8 OK created sql table model public.fct_orders ............................ [[32mSELECT 100[0m in 0.03s]
[0m13:50:40.780181 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_orders
[0m13:50:40.780453 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products
[0m13:50:40.780822 [info ] [Thread-1  ]: 7 of 8 START sql table model public.dim_products ............................... [RUN]
[0m13:50:40.781140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_orders, now model.ecommerce_datamart.dim_products)
[0m13:50:40.781396 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products
[0m13:50:40.784060 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products"
[0m13:50:40.784531 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products
[0m13:50:40.787356 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products"
[0m13:50:40.787844 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:50:40.788082 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: BEGIN
[0m13:50:40.788305 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:40.793699 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:40.796279 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:50:40.796548 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db_ex3"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(item_total) as total_revenue
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    p.product_id,
    p.name,
    p.price,
    p.category,
    p.inventory_count,
    p.is_active,
    p.created_at,
    coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(ps.total_revenue, 0) as total_revenue,
    case
        when p.inventory_count = 0 then 'Out of stock'
        when p.inventory_count < 10 then 'Low stock'
        else 'In stock'
    end as inventory_status,
    current_timestamp as updated_at
from products p
left join product_sales ps using (product_id)
  );
  
[0m13:50:40.800028 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.003 seconds
[0m13:50:40.803647 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:50:40.803925 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
alter table "dbt_db_ex3"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:50:40.804566 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:50:40.805783 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:50:40.806198 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:50:40.806484 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:50:40.808300 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:40.810705 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products__dbt_backup"
[0m13:50:40.811102 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:50:40.811348 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
drop table if exists "dbt_db_ex3"."public"."dim_products__dbt_backup" cascade
[0m13:50:40.811958 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:50:40.812832 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: Close
[0m13:50:40.813233 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a429a0>]}
[0m13:50:40.813675 [info ] [Thread-1  ]: 7 of 8 OK created sql table model public.dim_products .......................... [[32mSELECT 15[0m in 0.03s]
[0m13:50:40.814041 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products
[0m13:50:40.814297 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_order_items
[0m13:50:40.814631 [info ] [Thread-1  ]: 8 of 8 START sql table model public.fct_order_items ............................ [RUN]
[0m13:50:40.814913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products, now model.ecommerce_datamart.fct_order_items)
[0m13:50:40.815145 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_order_items
[0m13:50:40.817935 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_order_items"
[0m13:50:40.818496 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_order_items
[0m13:50:40.821424 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_order_items"
[0m13:50:40.821903 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:50:40.822143 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: BEGIN
[0m13:50:40.822365 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:40.826908 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:40.827184 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:50:40.827450 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp"
  
  
    as
  
  (
    with order_items as (
    select * from "dbt_db_ex3"."public"."stg_order_items"
),

orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

products as (
    select * from "dbt_db_ex3"."public"."stg_products"
)

select
    oi.order_item_id,
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.order_date,
    p.category as product_category,
    oi.quantity,
    oi.unit_price,
    oi.discount_amount,
    oi.item_total,
    (oi.unit_price * oi.quantity) as gross_item_sales_value,
    oi.discount_amount as item_discount_value,
    ((oi.unit_price * oi.quantity) - oi.item_total) as total_discount_impact,
    case
        when oi.discount_amount > 0 then true
        else false
    end as is_discounted,
    o.status as order_status,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    oi.created_at,
    current_timestamp as updated_at
from order_items oi
join orders o using (order_id)
join products p using (product_id)
  );
  
[0m13:50:40.830871 [debug] [Thread-1  ]: SQL status: SELECT 301 in 0.003 seconds
[0m13:50:40.833906 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:50:40.834243 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
alter table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m13:50:40.835585 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:40.836489 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:50:40.836762 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:50:40.837011 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:50:40.838586 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:40.841528 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_order_items__dbt_backup"
[0m13:50:40.841973 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:50:40.842231 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
drop table if exists "dbt_db_ex3"."public"."fct_order_items__dbt_backup" cascade
[0m13:50:40.843326 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:50:40.844158 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: Close
[0m13:50:40.844572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3e247a-6fbb-433c-a4c4-ab8008d8662e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c25c10>]}
[0m13:50:40.845022 [info ] [Thread-1  ]: 8 of 8 OK created sql table model public.fct_order_items ....................... [[32mSELECT 301[0m in 0.03s]
[0m13:50:40.845481 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_order_items
[0m13:50:40.846229 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:40.846456 [debug] [MainThread]: On master: BEGIN
[0m13:50:40.846657 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:40.850304 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:50:40.850567 [debug] [MainThread]: On master: COMMIT
[0m13:50:40.850782 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:40.850983 [debug] [MainThread]: On master: COMMIT
[0m13:50:40.851594 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:40.851869 [debug] [MainThread]: On master: Close
[0m13:50:40.852226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:40.852444 [debug] [MainThread]: Connection 'model.ecommerce_datamart.fct_order_items' was properly closed.
[0m13:50:40.852755 [info ] [MainThread]: 
[0m13:50:40.853009 [info ] [MainThread]: Finished running 2 incremental models, 4 table models, 2 view models in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:50:40.854028 [debug] [MainThread]: Command end result
[0m13:50:40.914041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:40.915080 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:40.919091 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:50:40.919309 [info ] [MainThread]: 
[0m13:50:40.919553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:50:40.919754 [info ] [MainThread]: 
[0m13:50:40.919962 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:50:40.920961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.125033, "process_in_blocks": "0", "process_kernel_time": 0.156038, "process_mem_max_rss": "126189568", "process_out_blocks": "0", "process_user_time": 1.664486}
[0m13:50:40.921209 [debug] [MainThread]: Command `dbt run` succeeded at 13:50:40.921162 after 1.13 seconds
[0m13:50:40.921433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd2dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbbcd0>]}
[0m13:50:40.921664 [debug] [MainThread]: Flushing usage events
[0m13:50:43.190945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:44.541564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2a280>]}


============================== 13:50:44.544098 | 450ed4d9-09ec-4ee2-b75d-9c5b9b845bc2 ==============================
[0m13:50:44.544098 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:44.544454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select core.* --store-failures', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:50:44.670561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '450ed4d9-09ec-4ee2-b75d-9c5b9b845bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5a760>]}
[0m13:50:44.717201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '450ed4d9-09ec-4ee2-b75d-9c5b9b845bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f796d0>]}
[0m13:50:44.717834 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:44.796801 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:50:44.901229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:44.901542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:44.969969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '450ed4d9-09ec-4ee2-b75d-9c5b9b845bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b3370>]}
[0m13:50:45.053121 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:45.055510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:45.069920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '450ed4d9-09ec-4ee2-b75d-9c5b9b845bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bbac0>]}
[0m13:50:45.070264 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:50:45.070478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '450ed4d9-09ec-4ee2-b75d-9c5b9b845bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd5e20>]}
[0m13:50:45.072558 [info ] [MainThread]: 
[0m13:50:45.072860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:45.073075 [info ] [MainThread]: 
[0m13:50:45.073400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:45.078085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:50:45.104212 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:50:45.104541 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:50:45.104751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:45.118635 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m13:50:45.119454 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:50:45.119859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now create_dbt_db_ex3_public_dbt_test__audit)
[0m13:50:45.120355 [debug] [ThreadPool]: Creating schema "database: "dbt_db_ex3"
schema: "public_dbt_test__audit"
"
[0m13:50:45.124168 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:45.124390 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: BEGIN
[0m13:50:45.124571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:45.129710 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.130229 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:45.130607 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "create_dbt_db_ex3_public_dbt_test__audit"} */
create schema if not exists "public_dbt_test__audit"
[0m13:50:45.131579 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m13:50:45.132225 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: COMMIT
[0m13:50:45.132447 [debug] [ThreadPool]: Using postgres connection "create_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:45.132638 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: COMMIT
[0m13:50:45.133377 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.133575 [debug] [ThreadPool]: On create_dbt_db_ex3_public_dbt_test__audit: Close
[0m13:50:45.137165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_db_ex3_public_dbt_test__audit, now list_dbt_db_ex3_public_dbt_test__audit)
[0m13:50:45.141586 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:45.141821 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: BEGIN
[0m13:50:45.142004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:45.145729 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.145991 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:50:45.146210 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public_dbt_test__audit"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:50:45.147820 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:45.148560 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: ROLLBACK
[0m13:50:45.149003 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: Close
[0m13:50:45.149374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public_dbt_test__audit, now list_dbt_db_ex3_public)
[0m13:50:45.151698 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:45.151939 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:50:45.152128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:45.156363 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.156611 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:45.156825 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:45.158580 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m13:50:45.159448 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:50:45.159872 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:50:45.166783 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:45.167018 [debug] [MainThread]: On master: BEGIN
[0m13:50:45.167197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:45.172724 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:50:45.172948 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:45.173204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:45.181390 [debug] [MainThread]: SQL status: SELECT 2 in 0.008 seconds
[0m13:50:45.182458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '450ed4d9-09ec-4ee2-b75d-9c5b9b845bc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076bbd30>]}
[0m13:50:45.182777 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:45.183241 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:45.183453 [debug] [MainThread]: On master: BEGIN
[0m13:50:45.184081 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.184282 [debug] [MainThread]: On master: COMMIT
[0m13:50:45.184472 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:45.184657 [debug] [MainThread]: On master: COMMIT
[0m13:50:45.185053 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:45.185273 [debug] [MainThread]: On master: Close
[0m13:50:45.187021 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:50:45.187355 [info ] [Thread-1  ]: 1 of 39 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m13:50:45.187688 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:50:45.187960 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:50:45.201749 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:45.202304 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:50:45.213591 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:50:45.221881 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:45.222164 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:50:45.222388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.228244 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:45.228526 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:45.228790 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex3"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m13:50:45.230639 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.231320 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:50:45.231587 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:45.231838 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:50:45.233461 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.236131 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:45.236704 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:45.236974 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:50:45.237512 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.237753 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:50:45.238009 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m13:50:45.238799 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:45.241657 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m13:50:45.242324 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m13:50:45.242729 [info ] [Thread-1  ]: 1 of 39 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.06s]
[0m13:50:45.243108 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:50:45.243374 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:50:45.243663 [info ] [Thread-1  ]: 2 of 39 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m13:50:45.243948 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:50:45.244193 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:50:45.249872 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:45.250739 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:50:45.252854 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:50:45.253377 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:45.253626 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:50:45.253856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.259838 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:45.260134 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:45.260410 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex3"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m13:50:45.262086 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:45.262799 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:50:45.263074 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:45.263321 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:50:45.264098 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.264547 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:45.265037 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:45.265298 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:50:45.266150 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:45.266390 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:50:45.266644 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m13:50:45.267574 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:45.268487 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m13:50:45.269037 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m13:50:45.269432 [info ] [Thread-1  ]: 2 of 39 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.03s]
[0m13:50:45.269804 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:50:45.270070 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:50:45.270356 [info ] [Thread-1  ]: 3 of 39 START test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True  [RUN]
[0m13:50:45.270642 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f)
[0m13:50:45.270890 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:50:45.286635 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:45.287088 [error] [Thread-1  ]: 3 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True  [[31mERROR[0m in 0.02s]
[0m13:50:45.287445 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:50:45.287722 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:50:45.288022 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:45.288307 [info ] [Thread-1  ]: 4 of 39 START test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0  [RUN]
[0m13:50:45.288722 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506)
[0m13:50:45.288969 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:50:45.294369 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:45.294706 [error] [Thread-1  ]: 4 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0  [[31mERROR[0m in 0.01s]
[0m13:50:45.295020 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:50:45.295255 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:50:45.295510 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:45.295746 [info ] [Thread-1  ]: 5 of 39 START test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True  [RUN]
[0m13:50:45.296061 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295)
[0m13:50:45.296282 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:50:45.300886 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:45.301293 [error] [Thread-1  ]: 5 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True  [[31mERROR[0m in 0.01s]
[0m13:50:45.301659 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:50:45.301925 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:50:45.302206 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:45.302471 [info ] [Thread-1  ]: 6 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True  [RUN]
[0m13:50:45.302852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767)
[0m13:50:45.303094 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:50:45.309051 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:45.309393 [error] [Thread-1  ]: 6 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True  [[31mERROR[0m in 0.01s]
[0m13:50:45.309704 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:50:45.309935 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:50:45.310158 [info ] [Thread-1  ]: 7 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True  [RUN]
[0m13:50:45.310413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507)
[0m13:50:45.310628 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:50:45.313695 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:45.315425 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:45.315703 [error] [Thread-1  ]: 7 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True  [[31mERROR[0m in 0.01s]
[0m13:50:45.315989 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:50:45.316218 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:50:45.316438 [info ] [Thread-1  ]: 8 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True  [RUN]
[0m13:50:45.316690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097)
[0m13:50:45.316906 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:50:45.317161 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:45.322166 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:45.322468 [error] [Thread-1  ]: 8 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True  [[31mERROR[0m in 0.01s]
[0m13:50:45.322769 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:50:45.322997 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:50:45.323217 [info ] [Thread-1  ]: 9 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True  [RUN]
[0m13:50:45.323471 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e)
[0m13:50:45.323688 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:50:45.326757 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:45.328447 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:45.328726 [error] [Thread-1  ]: 9 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True  [[31mERROR[0m in 0.01s]
[0m13:50:45.329016 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:50:45.329243 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:50:45.329460 [info ] [Thread-1  ]: 10 of 39 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m13:50:45.329709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:50:45.329924 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:50:45.333232 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:45.334927 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:45.335206 [error] [Thread-1  ]: 10 of 39 ERROR dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[31mERROR[0m in 0.01s]
[0m13:50:45.335493 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:50:45.335711 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:50:45.335918 [info ] [Thread-1  ]: 11 of 39 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m13:50:45.336167 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:50:45.336376 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:50:45.340762 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:45.341113 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:50:45.341474 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:50:45.343975 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:50:45.344399 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:45.344617 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:50:45.344821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.351025 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:45.351239 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:45.351454 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m13:50:45.355756 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:50:45.356347 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:50:45.356580 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:45.356789 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:50:45.357712 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.358057 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:45.358468 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:45.358677 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:50:45.359107 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.359321 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:50:45.359541 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:50:45.360144 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.361123 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:50:45.361569 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:50:45.361952 [info ] [Thread-1  ]: 11 of 39 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.03s]
[0m13:50:45.362313 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:50:45.362563 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:50:45.362824 [info ] [Thread-1  ]: 12 of 39 START test not_null_dim_customers_email ............................... [RUN]
[0m13:50:45.363096 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a)
[0m13:50:45.363319 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:50:45.366376 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:45.366825 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:50:45.368742 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:50:45.369188 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:45.369419 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:50:45.369634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.374675 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.374928 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:45.375176 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where email is null



  );
  
    
[0m13:50:45.377793 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.378463 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:50:45.378721 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:45.378956 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:50:45.379807 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.380244 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:45.380761 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:45.381015 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:50:45.381455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.381696 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:50:45.381952 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:50:45.382585 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.383547 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m13:50:45.383994 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: Close
[0m13:50:45.384414 [info ] [Thread-1  ]: 12 of 39 PASS not_null_dim_customers_email ..................................... [[32mPASS[0m in 0.02s]
[0m13:50:45.384827 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:50:45.385116 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:50:45.385436 [info ] [Thread-1  ]: 13 of 39 START test not_null_dim_customers_lifetime_orders ..................... [RUN]
[0m13:50:45.385743 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:50:45.386004 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:50:45.389391 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:45.389885 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:50:45.391944 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:50:45.392461 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:45.392719 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:50:45.392956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.397535 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.397819 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:45.398078 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m13:50:45.400444 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.401119 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:50:45.401386 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:45.401626 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:50:45.402373 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.402860 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:45.403355 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:45.403611 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:50:45.404092 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.404338 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:50:45.404596 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m13:50:45.405266 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.406231 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m13:50:45.406730 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m13:50:45.407176 [info ] [Thread-1  ]: 13 of 39 PASS not_null_dim_customers_lifetime_orders ........................... [[32mPASS[0m in 0.02s]
[0m13:50:45.407584 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:50:45.407863 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:50:45.408176 [info ] [Thread-1  ]: 14 of 39 START test not_null_dim_customers_lifetime_value ...................... [RUN]
[0m13:50:45.408485 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888)
[0m13:50:45.408735 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:50:45.414087 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:45.414678 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:50:45.416888 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
[0m13:50:45.417402 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:45.417655 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m13:50:45.417887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.422847 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.423185 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:45.423461 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where lifetime_value is null



  );
  
    
[0m13:50:45.425909 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.426672 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: COMMIT
[0m13:50:45.426944 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:45.427187 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: COMMIT
[0m13:50:45.428072 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.428509 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:45.429018 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:45.429263 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m13:50:45.429696 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.429928 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:50:45.430169 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
    
      
    ) dbt_internal_test
[0m13:50:45.430767 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.431679 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: ROLLBACK
[0m13:50:45.432125 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: Close
[0m13:50:45.432534 [info ] [Thread-1  ]: 14 of 39 PASS not_null_dim_customers_lifetime_value ............................ [[32mPASS[0m in 0.02s]
[0m13:50:45.432913 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:50:45.433175 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:50:45.433462 [info ] [Thread-1  ]: 15 of 39 START test not_null_dim_customers_name ................................ [RUN]
[0m13:50:45.433765 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888, now test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1)
[0m13:50:45.434010 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:50:45.437354 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:45.437826 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:50:45.439697 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:50:45.440124 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:45.440346 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:50:45.440561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.444256 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.444518 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:45.444745 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where name is null



  );
  
    
[0m13:50:45.448383 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:45.448993 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:50:45.449224 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:45.449442 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:50:45.450121 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:45.450500 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:45.450936 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:45.451153 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:50:45.451534 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.451743 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:50:45.451955 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m13:50:45.452498 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.453484 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m13:50:45.453936 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: Close
[0m13:50:45.454325 [info ] [Thread-1  ]: 15 of 39 PASS not_null_dim_customers_name ...................................... [[32mPASS[0m in 0.02s]
[0m13:50:45.454697 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:50:45.454961 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:50:45.455212 [info ] [Thread-1  ]: 16 of 39 START test not_null_dim_products_category ............................. [RUN]
[0m13:50:45.455534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0)
[0m13:50:45.455772 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:50:45.459111 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:45.459620 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:50:45.462890 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
[0m13:50:45.463428 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:45.463667 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: BEGIN
[0m13:50:45.463883 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.468431 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.468740 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:45.468995 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where category is null



  );
  
    
[0m13:50:45.471057 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.471731 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: COMMIT
[0m13:50:45.471987 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:45.472221 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: COMMIT
[0m13:50:45.473043 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.473471 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:45.473975 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:45.474215 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: BEGIN
[0m13:50:45.474641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.474877 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:50:45.475117 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
    
      
    ) dbt_internal_test
[0m13:50:45.475710 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.476649 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: ROLLBACK
[0m13:50:45.477544 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: Close
[0m13:50:45.478051 [info ] [Thread-1  ]: 16 of 39 PASS not_null_dim_products_category ................................... [[32mPASS[0m in 0.02s]
[0m13:50:45.478474 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:50:45.478743 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:50:45.478994 [info ] [Thread-1  ]: 17 of 39 START test not_null_dim_products_inventory_count ...................... [RUN]
[0m13:50:45.479333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0, now test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e)
[0m13:50:45.479574 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:50:45.482930 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:45.483472 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:50:45.485464 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
[0m13:50:45.485914 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:45.486150 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: BEGIN
[0m13:50:45.486367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.491491 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.491791 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:45.492057 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where inventory_count is null



  );
  
    
[0m13:50:45.494392 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.495079 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: COMMIT
[0m13:50:45.495343 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:45.495580 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: COMMIT
[0m13:50:45.496350 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.496772 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:45.497287 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:45.497523 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: BEGIN
[0m13:50:45.497954 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.498205 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:50:45.498454 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
    
      
    ) dbt_internal_test
[0m13:50:45.499082 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.500060 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: ROLLBACK
[0m13:50:45.500560 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: Close
[0m13:50:45.500978 [info ] [Thread-1  ]: 17 of 39 PASS not_null_dim_products_inventory_count ............................ [[32mPASS[0m in 0.02s]
[0m13:50:45.501369 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:50:45.501643 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:50:45.501892 [info ] [Thread-1  ]: 18 of 39 START test not_null_dim_products_name ................................. [RUN]
[0m13:50:45.502224 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e, now test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff)
[0m13:50:45.502463 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:50:45.505864 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:45.506363 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:50:45.508460 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:50:45.508980 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:45.509228 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:50:45.509457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.514512 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.514769 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:45.515013 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where name is null



  );
  
    
[0m13:50:45.517329 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.517999 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:50:45.518273 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:45.518523 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:50:45.519140 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:45.519548 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:45.520138 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:45.520392 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:50:45.520891 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.521166 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:50:45.521435 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m13:50:45.522840 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:45.523769 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m13:50:45.524580 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: Close
[0m13:50:45.524992 [info ] [Thread-1  ]: 18 of 39 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.02s]
[0m13:50:45.525381 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:50:45.525656 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:50:45.525968 [info ] [Thread-1  ]: 19 of 39 START test not_null_dim_products_price ................................ [RUN]
[0m13:50:45.526293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff, now test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed)
[0m13:50:45.526553 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:50:45.529951 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:45.530385 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:50:45.533337 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:50:45.533816 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:45.534067 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:50:45.534299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.539127 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.539398 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:45.539649 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where price is null



  );
  
    
[0m13:50:45.544365 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:50:45.545092 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:50:45.545382 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:45.545636 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:50:45.546534 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.546973 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:45.547474 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:45.547728 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:50:45.548160 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.548406 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:50:45.548661 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m13:50:45.549314 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.550272 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m13:50:45.550714 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: Close
[0m13:50:45.551127 [info ] [Thread-1  ]: 19 of 39 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.02s]
[0m13:50:45.551524 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:50:45.551799 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:50:45.552064 [info ] [Thread-1  ]: 20 of 39 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:50:45.552404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed, now test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1)
[0m13:50:45.552659 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:50:45.556135 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:45.556618 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:50:45.558707 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:50:45.559239 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:45.559493 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:50:45.559725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.564124 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.564396 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:45.564648 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where product_id is null



  );
  
    
[0m13:50:45.566715 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.567388 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:50:45.567650 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:45.567887 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:50:45.568696 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.569130 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:45.569602 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:45.569849 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:50:45.570295 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.570533 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:50:45.570777 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:50:45.571448 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.572474 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:50:45.572945 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:50:45.573376 [info ] [Thread-1  ]: 20 of 39 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.02s]
[0m13:50:45.573785 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:50:45.574066 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:50:45.574362 [info ] [Thread-1  ]: 21 of 39 START test not_null_fct_order_items_item_total ........................ [RUN]
[0m13:50:45.574764 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6)
[0m13:50:45.575046 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:50:45.578437 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:45.578910 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:50:45.581031 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
[0m13:50:45.581525 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:45.581778 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: BEGIN
[0m13:50:45.582009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.586187 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.586474 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:45.586725 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where item_total is null



  );
  
    
[0m13:50:45.588933 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.589649 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: COMMIT
[0m13:50:45.589922 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:45.590162 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: COMMIT
[0m13:50:45.590943 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.591360 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:45.591888 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:45.592128 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: BEGIN
[0m13:50:45.592669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.592906 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:50:45.593150 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
    
      
    ) dbt_internal_test
[0m13:50:45.593787 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.594712 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: ROLLBACK
[0m13:50:45.595200 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: Close
[0m13:50:45.595629 [info ] [Thread-1  ]: 21 of 39 PASS not_null_fct_order_items_item_total .............................. [[32mPASS[0m in 0.02s]
[0m13:50:45.596019 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:50:45.596288 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:50:45.596584 [info ] [Thread-1  ]: 22 of 39 START test not_null_fct_order_items_order_id .......................... [RUN]
[0m13:50:45.596897 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6, now test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02)
[0m13:50:45.597150 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:50:45.601677 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:45.602246 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:50:45.604391 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
[0m13:50:45.604883 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:45.605135 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: BEGIN
[0m13:50:45.605367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.609843 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.610146 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:45.610410 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where order_id is null



  );
  
    
[0m13:50:45.612799 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.613514 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: COMMIT
[0m13:50:45.613787 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:45.614037 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: COMMIT
[0m13:50:45.615649 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.616076 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:45.616538 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:45.616781 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: BEGIN
[0m13:50:45.617242 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.617474 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:50:45.617714 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
    
      
    ) dbt_internal_test
[0m13:50:45.618374 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.619408 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: ROLLBACK
[0m13:50:45.619869 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: Close
[0m13:50:45.620276 [info ] [Thread-1  ]: 22 of 39 PASS not_null_fct_order_items_order_id ................................ [[32mPASS[0m in 0.02s]
[0m13:50:45.620656 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:50:45.620920 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:50:45.621211 [info ] [Thread-1  ]: 23 of 39 START test not_null_fct_order_items_order_item_id ..................... [RUN]
[0m13:50:45.621500 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02, now test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55)
[0m13:50:45.621736 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:50:45.625093 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:45.625731 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:50:45.627750 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
[0m13:50:45.628215 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:45.628455 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: BEGIN
[0m13:50:45.628675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.633218 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.633562 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:45.633827 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where order_item_id is null



  );
  
    
[0m13:50:45.636578 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.637322 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: COMMIT
[0m13:50:45.637596 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:45.637837 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: COMMIT
[0m13:50:45.638511 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:45.638972 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:45.639458 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:45.639707 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: BEGIN
[0m13:50:45.640161 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.640400 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:50:45.640647 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m13:50:45.641311 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.642259 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: ROLLBACK
[0m13:50:45.642706 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: Close
[0m13:50:45.643114 [info ] [Thread-1  ]: 23 of 39 PASS not_null_fct_order_items_order_item_id ........................... [[32mPASS[0m in 0.02s]
[0m13:50:45.643497 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:50:45.643761 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:50:45.644052 [info ] [Thread-1  ]: 24 of 39 START test not_null_fct_order_items_product_id ........................ [RUN]
[0m13:50:45.644344 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55, now test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc)
[0m13:50:45.644581 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:50:45.647976 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:45.648500 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:50:45.650496 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
[0m13:50:45.651790 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:45.652042 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: BEGIN
[0m13:50:45.652266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.656668 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.656995 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:45.657256 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where product_id is null



  );
  
    
[0m13:50:45.659669 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.660349 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: COMMIT
[0m13:50:45.660605 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:45.660843 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: COMMIT
[0m13:50:45.661523 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:45.661982 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:45.662473 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:45.662720 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: BEGIN
[0m13:50:45.663371 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.663607 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:50:45.663849 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
    
      
    ) dbt_internal_test
[0m13:50:45.664502 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.665411 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: ROLLBACK
[0m13:50:45.665941 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: Close
[0m13:50:45.666347 [info ] [Thread-1  ]: 24 of 39 PASS not_null_fct_order_items_product_id .............................. [[32mPASS[0m in 0.02s]
[0m13:50:45.666725 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:50:45.666993 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:50:45.667240 [info ] [Thread-1  ]: 25 of 39 START test not_null_fct_order_items_quantity .......................... [RUN]
[0m13:50:45.667574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc, now test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03)
[0m13:50:45.667810 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:50:45.671170 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:45.671670 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:50:45.673763 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
[0m13:50:45.674249 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:45.674488 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: BEGIN
[0m13:50:45.674703 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.679436 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.679705 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:45.679958 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where quantity is null



  );
  
    
[0m13:50:45.682133 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.682807 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: COMMIT
[0m13:50:45.683067 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:45.683301 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: COMMIT
[0m13:50:45.683958 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:45.684437 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:45.684919 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:45.685170 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: BEGIN
[0m13:50:45.685603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.685837 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:50:45.686076 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
    
      
    ) dbt_internal_test
[0m13:50:45.686681 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.687599 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: ROLLBACK
[0m13:50:45.688041 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: Close
[0m13:50:45.688444 [info ] [Thread-1  ]: 25 of 39 PASS not_null_fct_order_items_quantity ................................ [[32mPASS[0m in 0.02s]
[0m13:50:45.688823 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:50:45.689083 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:50:45.689369 [info ] [Thread-1  ]: 26 of 39 START test not_null_fct_order_items_unit_price ........................ [RUN]
[0m13:50:45.689665 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03, now test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8)
[0m13:50:45.689907 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:50:45.693235 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:45.693734 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:50:45.695810 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
[0m13:50:45.696335 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:45.696583 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: BEGIN
[0m13:50:45.696811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.702565 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:45.702925 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:45.703188 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where unit_price is null



  );
  
    
[0m13:50:45.706178 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:45.706921 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: COMMIT
[0m13:50:45.707196 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:45.707437 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: COMMIT
[0m13:50:45.708242 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.708688 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:45.709187 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:45.709441 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: BEGIN
[0m13:50:45.709886 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.710130 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:50:45.710387 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
    
      
    ) dbt_internal_test
[0m13:50:45.711038 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.712046 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: ROLLBACK
[0m13:50:45.712567 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: Close
[0m13:50:45.713039 [info ] [Thread-1  ]: 26 of 39 PASS not_null_fct_order_items_unit_price .............................. [[32mPASS[0m in 0.02s]
[0m13:50:45.713472 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:50:45.713760 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:50:45.714034 [info ] [Thread-1  ]: 27 of 39 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:50:45.714411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8, now test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:50:45.714678 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:50:45.718115 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:45.718627 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:50:45.721621 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:50:45.722101 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:45.722351 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:50:45.722584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.726066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:50:45.726406 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:45.726678 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m13:50:45.728934 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.729648 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:50:45.729916 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:45.730157 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:50:45.730907 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.731332 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:45.731824 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:45.732067 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:50:45.732569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.732809 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:50:45.733059 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m13:50:45.733737 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.734642 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:50:45.735101 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:50:45.735494 [info ] [Thread-1  ]: 27 of 39 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.02s]
[0m13:50:45.735873 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:50:45.736139 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:50:45.736420 [info ] [Thread-1  ]: 28 of 39 START test not_null_fct_orders_order_date ............................. [RUN]
[0m13:50:45.736716 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362)
[0m13:50:45.736959 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:50:45.740316 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:45.740821 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:50:45.742920 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:50:45.743406 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:45.743660 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:50:45.743896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.748545 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.748839 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:45.749101 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where order_date is null



  );
  
    
[0m13:50:45.751326 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.752042 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:50:45.752306 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:45.752549 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:50:45.753312 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.753823 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:45.754301 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:45.754542 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:50:45.755471 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:45.755705 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:50:45.755946 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m13:50:45.757106 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:45.758016 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m13:50:45.758686 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: Close
[0m13:50:45.759092 [info ] [Thread-1  ]: 28 of 39 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.02s]
[0m13:50:45.759480 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:50:45.759753 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:50:45.760050 [info ] [Thread-1  ]: 29 of 39 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:50:45.760343 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0)
[0m13:50:45.760592 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:50:45.763898 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:45.764477 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:50:45.766535 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:50:45.767006 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:45.767251 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:50:45.767478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.773141 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:45.773464 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:45.773737 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where order_id is null



  );
  
    
[0m13:50:45.776706 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:45.777496 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:50:45.777772 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:45.778013 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:50:45.778890 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.779307 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:45.779867 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:45.780129 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:50:45.780590 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.780825 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:50:45.781073 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:50:45.781712 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.782615 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:50:45.783060 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:50:45.783474 [info ] [Thread-1  ]: 29 of 39 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.02s]
[0m13:50:45.783860 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:50:45.784125 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:50:45.784381 [info ] [Thread-1  ]: 30 of 39 START test not_null_fct_orders_status ................................. [RUN]
[0m13:50:45.784754 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_datamart.not_null_fct_orders_status.1455048989)
[0m13:50:45.785027 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:50:45.789301 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:45.789785 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:50:45.791733 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:50:45.792185 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:45.792423 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: BEGIN
[0m13:50:45.792639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.796758 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.797038 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:45.797290 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where status is null



  );
  
    
[0m13:50:45.799473 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.800139 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: COMMIT
[0m13:50:45.800394 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:45.800625 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: COMMIT
[0m13:50:45.801244 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:45.801658 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:45.802143 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:45.802379 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: BEGIN
[0m13:50:45.802820 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.803044 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:50:45.803283 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m13:50:45.803935 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.804930 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: ROLLBACK
[0m13:50:45.805427 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: Close
[0m13:50:45.805899 [info ] [Thread-1  ]: 30 of 39 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.02s]
[0m13:50:45.806346 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:50:45.806637 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:50:45.806950 [info ] [Thread-1  ]: 31 of 39 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m13:50:45.807319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_status.1455048989, now test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:50:45.807600 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:50:45.811189 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:45.811749 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:50:45.813836 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:50:45.814303 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:45.814537 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:50:45.814751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.818052 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:50:45.818343 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:45.818584 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m13:50:45.820870 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.821577 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:50:45.821845 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:45.822090 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:50:45.822725 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:45.823151 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:45.823639 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:45.823877 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:50:45.824695 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:45.824923 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:50:45.825165 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m13:50:45.826425 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:45.827352 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m13:50:45.827921 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m13:50:45.828340 [info ] [Thread-1  ]: 31 of 39 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.02s]
[0m13:50:45.828722 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:50:45.828999 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:50:45.829292 [info ] [Thread-1  ]: 32 of 39 START test relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [RUN]
[0m13:50:45.829588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m13:50:45.829833 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:50:45.836142 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:45.836653 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:50:45.838665 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
[0m13:50:45.839997 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:45.840242 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m13:50:45.840462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.846030 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:45.846299 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:45.846622 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
  
  
    as
  
  (
    
    
    

with child as (
    select order_id as from_field
    from "dbt_db_ex3"."public"."fct_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "dbt_db_ex3"."public"."fct_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:50:45.849196 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.849834 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: COMMIT
[0m13:50:45.850093 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:45.850332 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: COMMIT
[0m13:50:45.851759 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.852149 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:45.852621 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:45.852888 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m13:50:45.853783 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:45.854038 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:50:45.854305 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
    
      
    ) dbt_internal_test
[0m13:50:45.855606 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:45.856565 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: ROLLBACK
[0m13:50:45.857346 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: Close
[0m13:50:45.857757 [info ] [Thread-1  ]: 32 of 39 PASS relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [[32mPASS[0m in 0.03s]
[0m13:50:45.858153 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:50:45.858432 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:50:45.858730 [info ] [Thread-1  ]: 33 of 39 START test relationships_fct_order_items_product_id__product_id__ref_dim_products_  [RUN]
[0m13:50:45.859027 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m13:50:45.859281 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:50:45.893695 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:45.894303 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:50:45.896164 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
[0m13:50:45.896610 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:45.896839 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m13:50:45.897048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.902382 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:45.903435 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:45.903691 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
  
  
    as
  
  (
    
    
    

with child as (
    select product_id as from_field
    from "dbt_db_ex3"."public"."fct_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "dbt_db_ex3"."public"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:50:45.907020 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:50:45.907724 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: COMMIT
[0m13:50:45.907985 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:45.908223 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: COMMIT
[0m13:50:45.910043 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:50:45.910438 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:45.910916 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:45.911161 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m13:50:45.912150 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:45.912386 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:50:45.912635 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
    
      
    ) dbt_internal_test
[0m13:50:45.913788 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:45.914942 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: ROLLBACK
[0m13:50:45.915627 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: Close
[0m13:50:45.916595 [info ] [Thread-1  ]: 33 of 39 PASS relationships_fct_order_items_product_id__product_id__ref_dim_products_  [[32mPASS[0m in 0.06s]
[0m13:50:45.918525 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:50:45.918839 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:50:45.919115 [info ] [Thread-1  ]: 34 of 39 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m13:50:45.919459 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:50:45.919718 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:50:45.924243 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:45.924732 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:50:45.926722 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:50:45.927180 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:45.927417 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:50:45.927636 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.933502 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:45.933785 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:45.934066 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex3"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex3"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:50:45.936699 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.937347 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:50:45.937607 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:45.937847 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:50:45.939334 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.939780 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:45.940273 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:45.940544 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:50:45.941588 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:45.941844 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:50:45.942114 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m13:50:45.943352 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:45.944310 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m13:50:45.945147 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m13:50:45.945559 [info ] [Thread-1  ]: 34 of 39 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m13:50:45.945953 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:50:45.946223 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:50:45.946521 [info ] [Thread-1  ]: 35 of 39 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:50:45.946816 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:50:45.947133 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:50:45.952746 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:45.953338 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:50:45.956325 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:50:45.956883 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:45.957141 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:50:45.957376 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.964586 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:50:45.964847 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:45.965111 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m13:50:45.966828 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:45.967574 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:50:45.967861 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:45.968122 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:50:45.968955 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:45.969410 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:45.969921 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:45.970179 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:50:45.970659 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.970951 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:50:45.971228 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:50:45.971773 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.972752 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:50:45.973216 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:50:45.973640 [info ] [Thread-1  ]: 35 of 39 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m13:50:45.974059 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:50:45.974349 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:50:45.974658 [info ] [Thread-1  ]: 36 of 39 START test unique_dim_customers_email ................................. [RUN]
[0m13:50:45.974961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8)
[0m13:50:45.975215 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:50:45.978716 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:45.979194 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:50:45.981437 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:50:45.982032 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:45.982371 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:50:45.982625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:45.987115 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:45.987417 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:45.987673 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m13:50:45.989939 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:50:45.990658 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:50:45.990930 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:45.991171 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:50:45.991806 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:50:45.992255 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:45.992743 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:45.992983 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:50:45.993440 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:45.993673 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:50:45.993915 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:50:45.994522 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:45.995469 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m13:50:45.995962 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: Close
[0m13:50:45.996368 [info ] [Thread-1  ]: 36 of 39 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.02s]
[0m13:50:45.996748 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:50:45.997010 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:50:45.997301 [info ] [Thread-1  ]: 37 of 39 START test unique_dim_products_product_id ............................. [RUN]
[0m13:50:45.997595 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8, now test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985)
[0m13:50:45.997833 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:50:46.001157 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:46.001658 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:50:46.003833 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:50:46.004449 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:46.004704 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:50:46.004936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:46.009310 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:46.009617 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:46.009877 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m13:50:46.011308 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:46.012064 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:50:46.012345 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:46.012592 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:50:46.014336 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:50:46.014750 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:46.015240 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:46.015475 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:50:46.016244 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:46.016471 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:50:46.016707 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:50:46.017857 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:46.018826 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:50:46.019555 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:50:46.020009 [info ] [Thread-1  ]: 37 of 39 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m13:50:46.020412 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:50:46.020691 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:50:46.020987 [info ] [Thread-1  ]: 38 of 39 START test unique_fct_order_items_order_item_id ....................... [RUN]
[0m13:50:46.021285 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768)
[0m13:50:46.021538 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:50:46.025854 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:46.026308 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:50:46.028376 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
[0m13:50:46.028850 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:46.029101 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: BEGIN
[0m13:50:46.029333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:46.035119 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:50:46.035370 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:46.035619 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
  
  
    as
  
  (
    
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."fct_order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



  );
  
    
[0m13:50:46.037072 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:46.037765 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: COMMIT
[0m13:50:46.038043 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:46.038296 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: COMMIT
[0m13:50:46.039138 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:46.039568 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:46.040046 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:46.040301 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: BEGIN
[0m13:50:46.040756 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:50:46.041004 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:50:46.041262 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m13:50:46.041816 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:46.042830 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: ROLLBACK
[0m13:50:46.043307 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: Close
[0m13:50:46.043745 [info ] [Thread-1  ]: 38 of 39 PASS unique_fct_order_items_order_item_id ............................. [[32mPASS[0m in 0.02s]
[0m13:50:46.044151 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:50:46.044435 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:50:46.044738 [info ] [Thread-1  ]: 39 of 39 START test unique_fct_orders_order_id ................................. [RUN]
[0m13:50:46.045043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768, now test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5)
[0m13:50:46.045295 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:50:46.048665 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:46.049126 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:50:46.051189 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:50:46.051670 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:46.051917 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:50:46.052145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:46.057145 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:46.057418 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:46.057664 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m13:50:46.058943 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:50:46.059640 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:50:46.059901 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:46.060135 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:50:46.061771 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:46.062177 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:46.062645 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:46.062879 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:50:46.063745 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:50:46.063971 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:50:46.064212 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:50:46.065422 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:50:46.066388 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m13:50:46.067089 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: Close
[0m13:50:46.067503 [info ] [Thread-1  ]: 39 of 39 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m13:50:46.067897 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:50:46.068635 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:46.068867 [debug] [MainThread]: On master: BEGIN
[0m13:50:46.069070 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:46.072162 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:50:46.072427 [debug] [MainThread]: On master: COMMIT
[0m13:50:46.072646 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:46.072856 [debug] [MainThread]: On master: COMMIT
[0m13:50:46.073322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:46.073540 [debug] [MainThread]: On master: Close
[0m13:50:46.073821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:46.074025 [debug] [MainThread]: Connection 'test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m13:50:46.074271 [info ] [MainThread]: 
[0m13:50:46.074487 [info ] [MainThread]: Finished running 39 data tests in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m13:50:46.077638 [debug] [MainThread]: Command end result
[0m13:50:46.105591 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:46.106648 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:46.111879 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:50:46.112095 [info ] [MainThread]: 
[0m13:50:46.112317 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:50:46.112503 [info ] [MainThread]: 
[0m13:50:46.112724 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:46.112905 [info ] [MainThread]: 
[0m13:50:46.113151 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:46.113347 [info ] [MainThread]: 
[0m13:50:46.113564 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:46.113744 [info ] [MainThread]: 
[0m13:50:46.113955 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:46.114132 [info ] [MainThread]: 
[0m13:50:46.114337 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:46.114510 [info ] [MainThread]: 
[0m13:50:46.114717 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:46.114898 [info ] [MainThread]: 
[0m13:50:46.115103 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:46.115277 [info ] [MainThread]: 
[0m13:50:46.115481 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:50:46.115689 [info ] [MainThread]: 
[0m13:50:46.115873 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=8 SKIP=0 TOTAL=39
[0m13:50:46.116803 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.629481, "process_in_blocks": "0", "process_kernel_time": 0.179705, "process_mem_max_rss": "128368640", "process_out_blocks": "0", "process_user_time": 2.068922}
[0m13:50:46.117053 [debug] [MainThread]: Command `dbt test` failed at 13:50:46.117005 after 1.63 seconds
[0m13:50:46.117274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105db07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a03d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a0220>]}
[0m13:50:46.117496 [debug] [MainThread]: Flushing usage events
[0m13:50:47.078699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:48.143361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e4a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc2b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc2d60>]}


============================== 13:50:48.145887 | 9ec0a385-4d40-48a5-97e9-8f18d5ff02b4 ==============================
[0m13:50:48.145887 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:50:48.146274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select mart.dimensions.*', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:50:48.270507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ec0a385-4d40-48a5-97e9-8f18d5ff02b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105037b50>]}
[0m13:50:48.317014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ec0a385-4d40-48a5-97e9-8f18d5ff02b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10477a100>]}
[0m13:50:48.317629 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:48.396114 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:50:48.501652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:50:48.501959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:50:48.541566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ec0a385-4d40-48a5-97e9-8f18d5ff02b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a54f70>]}
[0m13:50:48.653684 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:48.656096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:48.665416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ec0a385-4d40-48a5-97e9-8f18d5ff02b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514a100>]}
[0m13:50:48.665769 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:50:48.666005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ec0a385-4d40-48a5-97e9-8f18d5ff02b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10514a220>]}
[0m13:50:48.667162 [info ] [MainThread]: 
[0m13:50:48.667382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:48.667572 [info ] [MainThread]: 
[0m13:50:48.667879 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:48.670518 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:50:48.697195 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:50:48.697510 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:50:48.697707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:48.711032 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m13:50:48.711876 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:50:48.713320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:50:48.717906 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:48.718184 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:50:48.718400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:50:48.725474 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:50:48.725699 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:50:48.725914 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:50:48.729424 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m13:50:48.730736 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:50:48.731531 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:50:48.736866 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:48.737135 [debug] [MainThread]: On master: BEGIN
[0m13:50:48.737436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:48.745391 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:50:48.745691 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:48.746000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:48.782371 [debug] [MainThread]: SQL status: SELECT 2 in 0.036 seconds
[0m13:50:48.783845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ec0a385-4d40-48a5-97e9-8f18d5ff02b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a54790>]}
[0m13:50:48.784252 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:48.784855 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:48.785115 [debug] [MainThread]: On master: BEGIN
[0m13:50:48.785888 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:50:48.786153 [debug] [MainThread]: On master: COMMIT
[0m13:50:48.786399 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:48.786645 [debug] [MainThread]: On master: COMMIT
[0m13:50:48.787117 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:48.787360 [debug] [MainThread]: On master: Close
[0m13:50:48.788749 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:50:48.789174 [info ] [Thread-1  ]: 1 of 3 START sql table model public.dim_customers_mart ......................... [RUN]
[0m13:50:48.789543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_customers_mart)
[0m13:50:48.789826 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:50:48.797869 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:48.798506 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:50:48.827100 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:48.827719 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:48.827954 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: BEGIN
[0m13:50:48.828166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:48.831499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:50:48.831891 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:50:48.832202 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex3"."public"."dim_customers"
),

customer_segments as (
    select
        customer_id,
        case
            when lifetime_value >= 1000000 then 'VIP'
            when lifetime_value >= 500000 then 'High Value'
            when lifetime_value >= 100000 then 'Medium Value'
            else 'Low Value'
        end as customer_segment,
        case
            when lifetime_orders >= 10 then 'Frequent'
            when lifetime_orders >= 5 then 'Regular'
            when lifetime_orders >= 2 then 'Occasional'
            else 'One-time'
        end as purchase_frequency,
        case
            when datediff('day', most_recent_order_date, current_date) <= 30 then 'Active'
            when datediff('day', most_recent_order_date, current_date) <= 90 then 'Recent'
            when datediff('day', most_recent_order_date, current_date) <= 180 then 'Lapsed'
            else 'Inactive'
        end as customer_status
    from customers
    where lifetime_orders > 0
)

select
    c.*,
    coalesce(cs.customer_segment, 'New') as customer_segment,
    coalesce(cs.purchase_frequency, 'None') as purchase_frequency,
    coalesce(cs.customer_status, 'New') as customer_status,
    case
        when cs.customer_segment = 'VIP' and cs.customer_status = 'Active' then true
        else false
    end as is_high_value_active
from customers c
left join customer_segments cs using (customer_id)
  );
  
[0m13:50:48.833178 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function datediff(unknown, timestamp without time zone, date) does not exist
LINE 34:             when datediff('day', most_recent_order_date, cur...
                          ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:50:48.836641 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: ROLLBACK
[0m13:50:48.837246 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: Close
[0m13:50:48.852332 [debug] [Thread-1  ]: Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 34:             when datediff('day', most_recent_order_date, cur...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql
[0m13:50:48.853704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec0a385-4d40-48a5-97e9-8f18d5ff02b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5b6d0>]}
[0m13:50:48.854148 [error] [Thread-1  ]: 1 of 3 ERROR creating sql table model public.dim_customers_mart ................ [[31mERROR[0m in 0.06s]
[0m13:50:48.854523 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:50:48.854774 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:50:48.855091 [debug] [Thread-4  ]: Marking all children of 'model.ecommerce_datamart.dim_customers_mart' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 34:             when datediff('day', most_recent_order_date, cur...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql.
[0m13:50:48.855389 [info ] [Thread-1  ]: 2 of 3 START sql table model public.dim_date ................................... [RUN]
[0m13:50:48.855790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now model.ecommerce_datamart.dim_date)
[0m13:50:48.856047 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:50:48.870853 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:48.871168 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:50:48.871375 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:48.875519 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:50:48.875874 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:48.876109 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:50:48.876835 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:50:48.884003 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:50:48.884642 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:50:48.887356 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_date"
[0m13:50:48.887804 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:48.888160 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

-- Generate a date series from 2020-01-01 to 2025-12-31
with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2191
    order by generated_number



),

all_periods as (

    select (
        

    cast('2020-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as date)

)

select * from filtered


),

dates as (
    select
        cast(date_day as date) as date_key,
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dow from date_day) as day_of_week,
        extract(doy from date_day) as day_of_year,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Day') as day_name,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when extract(month from date_day) in (1, 2, 3) then 'Q1'
            when extract(month from date_day) in (4, 5, 6) then 'Q2'
            when extract(month from date_day) in (7, 8, 9) then 'Q3'
            else 'Q4'
        end as quarter_name
    from date_spine
)

select * from dates
  );
  
[0m13:50:48.905294 [debug] [Thread-1  ]: SQL status: SELECT 2191 in 0.017 seconds
[0m13:50:48.913206 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:48.913518 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:50:48.914322 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:50:48.924852 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:50:48.925142 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:48.925390 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:50:48.926808 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:50:48.932004 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_date__dbt_backup"
[0m13:50:48.934894 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:50:48.935157 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
drop table if exists "dbt_db_ex3"."public"."dim_date__dbt_backup" cascade
[0m13:50:48.935905 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:50:48.937482 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:50:48.937881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec0a385-4d40-48a5-97e9-8f18d5ff02b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3b3a0>]}
[0m13:50:48.938298 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.dim_date .............................. [[32mSELECT 2191[0m in 0.08s]
[0m13:50:48.938660 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:50:48.938905 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:50:48.939260 [info ] [Thread-1  ]: 3 of 3 START sql table model public.dim_products_mart .......................... [RUN]
[0m13:50:48.939558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.dim_products_mart)
[0m13:50:48.939789 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:50:48.943261 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:50:48.943773 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:50:48.946657 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products_mart"
[0m13:50:48.947149 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:48.947389 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: BEGIN
[0m13:50:48.947609 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:50:48.952926 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:50:48.953226 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:48.953487 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex3"."public"."dim_products"
)

select
    p.*,
    case
        when total_quantity_sold > 100 then 'High Selling'
        when total_quantity_sold > 50 then 'Medium Selling'
        when total_quantity_sold > 0 then 'Low Selling'
        else 'Not Selling'
    end as sales_performance,
    case
        when total_revenue > 10000000 then 'High Revenue'
        when total_revenue > 5000000 then 'Medium Revenue'
        when total_revenue > 0 then 'Low Revenue'
        else 'No Revenue'
    end as revenue_tier,
    (total_revenue / nullif(total_quantity_sold, 0)) as average_selling_price,
    case
        when is_active = true and inventory_status != 'Out of stock' then true
        else false
    end as is_available_for_purchase,
    case
        when is_active = false then 'Discontinued'
        when inventory_status = 'Out of stock' then 'Temporarily Unavailable'
        else 'Available'
    end as availability_status
from products p
  );
  
[0m13:50:48.956338 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.003 seconds
[0m13:50:48.959028 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:48.959282 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp" rename to "dim_products_mart"
[0m13:50:48.959973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:50:48.960753 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:50:48.960991 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:48.961210 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:50:48.963220 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:50:48.965369 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products_mart__dbt_backup"
[0m13:50:48.965812 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:50:48.966072 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_products_mart__dbt_backup" cascade
[0m13:50:48.966618 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:50:48.967725 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: Close
[0m13:50:48.968205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec0a385-4d40-48a5-97e9-8f18d5ff02b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d3b3a0>]}
[0m13:50:48.968699 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public.dim_products_mart ..................... [[32mSELECT 15[0m in 0.03s]
[0m13:50:48.969105 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:50:48.969766 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:48.969985 [debug] [MainThread]: On master: BEGIN
[0m13:50:48.970173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:50:48.974427 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:50:48.974745 [debug] [MainThread]: On master: COMMIT
[0m13:50:48.974950 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:48.975150 [debug] [MainThread]: On master: COMMIT
[0m13:50:48.975696 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:50:48.975937 [debug] [MainThread]: On master: Close
[0m13:50:48.976255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:48.976481 [debug] [MainThread]: Connection 'model.ecommerce_datamart.dim_products_mart' was properly closed.
[0m13:50:48.976738 [info ] [MainThread]: 
[0m13:50:48.976969 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m13:50:48.977554 [debug] [MainThread]: Command end result
[0m13:50:49.005816 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:50:49.006912 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:50:49.011253 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:50:49.011511 [info ] [MainThread]: 
[0m13:50:49.011761 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:50:49.011971 [info ] [MainThread]: 
[0m13:50:49.012215 [error] [MainThread]:   Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  function datediff(unknown, timestamp without time zone, date) does not exist
  LINE 34:             when datediff('day', most_recent_order_date, cur...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql
[0m13:50:49.012426 [info ] [MainThread]: 
[0m13:50:49.012635 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:50:49.013669 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.920728, "process_in_blocks": "0", "process_kernel_time": 0.138988, "process_mem_max_rss": "125140992", "process_out_blocks": "0", "process_user_time": 1.525383}
[0m13:50:49.013910 [debug] [MainThread]: Command `dbt run` failed at 13:50:49.013864 after 0.92 seconds
[0m13:50:49.014140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e4a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105037b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10324e220>]}
[0m13:50:49.014366 [debug] [MainThread]: Flushing usage events
[0m13:50:50.232223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:31.350687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111846790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ee580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129ee3a0>]}


============================== 13:53:31.353784 | b2120707-8e67-4b80-9cf8-6ac1c158323e ==============================
[0m13:53:31.353784 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:53:31.354172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select mart.*', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:53:31.506914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ce6fd0>]}
[0m13:53:31.553852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112731dc0>]}
[0m13:53:31.554664 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:53:31.639532 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:53:31.773697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:53:31.774210 [debug] [MainThread]: Partial parsing: updated file: ecommerce_datamart://models/mart/facts/fct_customer_retention.sql
[0m13:53:31.774467 [debug] [MainThread]: Partial parsing: updated file: ecommerce_datamart://models/mart/dimensions/dim_customers_mart.sql
[0m13:53:32.015813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141e6130>]}
[0m13:53:32.100301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:53:32.103418 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:53:32.118430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114029850>]}
[0m13:53:32.118801 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:53:32.119026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114029580>]}
[0m13:53:32.120328 [info ] [MainThread]: 
[0m13:53:32.120554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:53:32.120745 [info ] [MainThread]: 
[0m13:53:32.121049 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:53:32.124242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:53:32.158613 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:53:32.158910 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:53:32.159106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:32.183962 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.025 seconds
[0m13:53:32.184851 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:53:32.186313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:53:32.190951 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:53:32.191247 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:53:32.191455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:53:32.195573 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:53:32.195866 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:53:32.196097 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:53:32.198986 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.003 seconds
[0m13:53:32.200038 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:53:32.200547 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:53:32.206611 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:32.206897 [debug] [MainThread]: On master: BEGIN
[0m13:53:32.207103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:32.211043 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:53:32.211321 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:32.211606 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:53:32.216714 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m13:53:32.217947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146d5850>]}
[0m13:53:32.218312 [debug] [MainThread]: On master: ROLLBACK
[0m13:53:32.218856 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:32.219077 [debug] [MainThread]: On master: BEGIN
[0m13:53:32.219804 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:53:32.220016 [debug] [MainThread]: On master: COMMIT
[0m13:53:32.220219 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:32.220415 [debug] [MainThread]: On master: COMMIT
[0m13:53:32.220827 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:53:32.221033 [debug] [MainThread]: On master: Close
[0m13:53:32.222809 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:53:32.223209 [info ] [Thread-1  ]: 1 of 9 START sql table model public.dim_customers_mart ......................... [RUN]
[0m13:53:32.223557 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_customers_mart)
[0m13:53:32.223819 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:53:32.231657 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:53:32.232241 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:53:32.260057 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:53:32.260983 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:53:32.261259 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: BEGIN
[0m13:53:32.261478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:32.268007 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:53:32.268392 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:53:32.268682 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex3"."public"."dim_customers"
),

customer_segments as (
    select
        customer_id,
        case
            when lifetime_value >= 1000000 then 'VIP'
            when lifetime_value >= 500000 then 'High Value'
            when lifetime_value >= 100000 then 'Medium Value'
            else 'Low Value'
        end as customer_segment,
        case
            when lifetime_orders >= 10 then 'Frequent'
            when lifetime_orders >= 5 then 'Regular'
            when lifetime_orders >= 2 then 'Occasional'
            else 'One-time'
        end as purchase_frequency,
        case
            when (current_date - most_recent_order_date) <= 30 then 'Active'
            when (current_date - most_recent_order_date) <= 90 then 'Recent'
            when (current_date - most_recent_order_date) <= 180 then 'Lapsed'
            else 'Inactive'
        end as customer_status
    from customers
    where lifetime_orders > 0
)

select
    c.*,
    coalesce(cs.customer_segment, 'New') as customer_segment,
    coalesce(cs.purchase_frequency, 'None') as purchase_frequency,
    coalesce(cs.customer_status, 'New') as customer_status,
    case
        when cs.customer_segment = 'VIP' and cs.customer_status = 'Active' then true
        else false
    end as is_high_value_active
from customers c
left join customer_segments cs using (customer_id)
  );
  
[0m13:53:32.270360 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: interval <= integer
LINE 34: ...     when (current_date - most_recent_order_date) <= 30 then...
                                                              ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m13:53:32.270744 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: ROLLBACK
[0m13:53:32.271340 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: Close
[0m13:53:32.287504 [debug] [Thread-1  ]: Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  operator does not exist: interval <= integer
  LINE 34: ...     when (current_date - most_recent_order_date) <= 30 then...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql
[0m13:53:32.288857 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147a2460>]}
[0m13:53:32.289287 [error] [Thread-1  ]: 1 of 9 ERROR creating sql table model public.dim_customers_mart ................ [[31mERROR[0m in 0.06s]
[0m13:53:32.289655 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:53:32.289904 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:53:32.290226 [debug] [Thread-4  ]: Marking all children of 'model.ecommerce_datamart.dim_customers_mart' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  operator does not exist: interval <= integer
  LINE 34: ...     when (current_date - most_recent_order_date) <= 30 then...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql.
[0m13:53:32.290558 [info ] [Thread-1  ]: 2 of 9 START sql table model public.dim_date ................................... [RUN]
[0m13:53:32.290957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now model.ecommerce_datamart.dim_date)
[0m13:53:32.291183 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:53:32.305209 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:53:32.305525 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:53:32.305737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:32.313160 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:53:32.313538 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:53:32.313784 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:53:32.314870 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:53:32.322996 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:53:32.323645 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:53:32.326913 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_date"
[0m13:53:32.327614 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:53:32.327956 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

-- Generate a date series from 2020-01-01 to 2025-12-31
with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2191
    order by generated_number



),

all_periods as (

    select (
        

    cast('2020-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as date)

)

select * from filtered


),

dates as (
    select
        cast(date_day as date) as date_key,
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dow from date_day) as day_of_week,
        extract(doy from date_day) as day_of_year,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Day') as day_name,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when extract(month from date_day) in (1, 2, 3) then 'Q1'
            when extract(month from date_day) in (4, 5, 6) then 'Q2'
            when extract(month from date_day) in (7, 8, 9) then 'Q3'
            else 'Q4'
        end as quarter_name
    from date_spine
)

select * from dates
  );
  
[0m13:53:32.348609 [debug] [Thread-1  ]: SQL status: SELECT 2191 in 0.020 seconds
[0m13:53:32.357281 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:53:32.357601 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m13:53:32.358489 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:32.361054 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:53:32.361330 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:53:32.362024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:32.373747 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:53:32.374093 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:53:32.374322 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:53:32.375873 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:53:32.380512 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_date__dbt_backup"
[0m13:53:32.383310 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:53:32.383571 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
drop table if exists "dbt_db_ex3"."public"."dim_date__dbt_backup" cascade
[0m13:53:32.386081 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:53:32.387720 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:53:32.388307 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147a2460>]}
[0m13:53:32.388852 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.dim_date .............................. [[32mSELECT 2191[0m in 0.10s]
[0m13:53:32.389263 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:53:32.389528 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:53:32.389826 [info ] [Thread-1  ]: 3 of 9 START sql table model public.dim_products_mart .......................... [RUN]
[0m13:53:32.390257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.dim_products_mart)
[0m13:53:32.390510 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:53:32.393258 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:53:32.393775 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:53:32.396634 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products_mart"
[0m13:53:32.397167 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:53:32.397396 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: BEGIN
[0m13:53:32.397610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:32.400907 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:53:32.401172 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:53:32.401426 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex3"."public"."dim_products"
)

select
    p.*,
    case
        when total_quantity_sold > 100 then 'High Selling'
        when total_quantity_sold > 50 then 'Medium Selling'
        when total_quantity_sold > 0 then 'Low Selling'
        else 'Not Selling'
    end as sales_performance,
    case
        when total_revenue > 10000000 then 'High Revenue'
        when total_revenue > 5000000 then 'Medium Revenue'
        when total_revenue > 0 then 'Low Revenue'
        else 'No Revenue'
    end as revenue_tier,
    (total_revenue / nullif(total_quantity_sold, 0)) as average_selling_price,
    case
        when is_active = true and inventory_status != 'Out of stock' then true
        else false
    end as is_available_for_purchase,
    case
        when is_active = false then 'Discontinued'
        when inventory_status = 'Out of stock' then 'Temporarily Unavailable'
        else 'Available'
    end as availability_status
from products p
  );
  
[0m13:53:32.404680 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.003 seconds
[0m13:53:32.408546 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:53:32.408893 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart" rename to "dim_products_mart__dbt_backup"
[0m13:53:32.409691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:32.412109 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:53:32.412358 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp" rename to "dim_products_mart"
[0m13:53:32.412878 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:32.413725 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:53:32.413975 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:53:32.414199 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:53:32.415057 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:53:32.417260 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products_mart__dbt_backup"
[0m13:53:32.417759 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:53:32.417996 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_products_mart__dbt_backup" cascade
[0m13:53:32.419477 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:53:32.420343 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: Close
[0m13:53:32.420740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111736520>]}
[0m13:53:32.421168 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.dim_products_mart ..................... [[32mSELECT 15[0m in 0.03s]
[0m13:53:32.421524 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:53:32.421777 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_customer_retention
[0m13:53:32.422134 [info ] [Thread-1  ]: 4 of 9 START sql table model public.fct_customer_retention ..................... [RUN]
[0m13:53:32.422461 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products_mart, now model.ecommerce_datamart.fct_customer_retention)
[0m13:53:32.422703 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_customer_retention
[0m13:53:32.425801 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:53:32.426309 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_customer_retention
[0m13:53:32.429256 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:53:32.429873 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:53:32.430124 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: BEGIN
[0m13:53:32.430342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:32.435297 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:53:32.435638 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:53:32.435959 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_customer_retention__dbt_tmp"
  
  
    as
  
  (
    

with customer_orders as (
    select
        customer_id,
        order_id,
        order_date,
        total_amount,
        row_number() over(partition by customer_id order by order_date) as order_sequence,
        lead(order_date) over(partition by customer_id order by order_date) as next_order_date,
        extract(day from (lead(order_date) over(partition by customer_id order by order_date) - order_date)) as days_until_next_order
    from "dbt_db_ex3"."public"."fct_orders"
),

customer_first_orders as (
    select
        customer_id,
        min(case when order_sequence = 1 then order_date end) as first_order_date,
        extract(year from min(case when order_sequence = 1 then order_date end)) as first_order_year,
        extract(month from min(case when order_sequence = 1 then order_date end)) as first_order_month,
        to_char(min(case when order_sequence = 1 then order_date end), 'YYYY-MM') as first_order_year_month
    from customer_orders
    group by 1
),

repeat_purchase_facts as (
    select
        c.customer_id,
        c.first_order_date,
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        count(distinct case when co.order_sequence > 1 then co.order_id end) as repeat_orders,
        max(co.order_sequence) as total_orders,
        sum(case when co.order_sequence > 1 then co.total_amount else 0 end) as repeat_order_revenue,
        min(case when co.order_sequence = 2 then co.order_date end) as second_order_date,
        avg(co.days_until_next_order) as avg_days_between_orders
    from customer_first_orders c
    left join customer_orders co using (customer_id)
    group by 1, 2, 3, 4, 5
),

cohort_sizes as (
    select
        first_order_year,
        first_order_month,
        first_order_year_month,
        count(distinct customer_id) as cohort_size
    from customer_first_orders
    group by 1, 2, 3
),

retention_by_month as (
    select
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        cs.cohort_size,
        date_part('month', age(date_trunc('month', o.order_date), 
                              date_trunc('month', c.first_order_date))) as months_since_first_order,
        count(distinct o.customer_id) as retained_customers,
        sum(o.total_amount) as cohort_revenue
    from customer_first_orders c
    join "dbt_db_ex3"."public"."fct_orders" o using(customer_id)
    join cohort_sizes cs 
        on c.first_order_year = cs.first_order_year 
        and c.first_order_month = cs.first_order_month
    where o.order_date > c.first_order_date
    group by 1, 2, 3, 4, 5
)

select
    r.first_order_year,
    r.first_order_month,
    r.first_order_year_month as cohort,
    r.cohort_size,
    r.months_since_first_order,
    r.retained_customers,
    r.cohort_revenue,
    (r.retained_customers::float / r.cohort_size) * 100 as retention_rate,
    (r.cohort_revenue::float / r.retained_customers) as revenue_per_retained_customer,
    sum(r.retained_customers) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_retained_customers,
    sum(r.cohort_revenue) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_cohort_revenue,
    current_timestamp as updated_at
from retention_by_month r
order by r.first_order_year, r.first_order_month, r.months_since_first_order
  );
  
[0m13:53:32.440358 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.004 seconds
[0m13:53:32.443429 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:53:32.443801 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
alter table "dbt_db_ex3"."public"."fct_customer_retention__dbt_tmp" rename to "fct_customer_retention"
[0m13:53:32.444672 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:32.445588 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: COMMIT
[0m13:53:32.445870 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:53:32.446093 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: COMMIT
[0m13:53:32.447003 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:53:32.450048 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_customer_retention__dbt_backup"
[0m13:53:32.450471 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:53:32.450705 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
drop table if exists "dbt_db_ex3"."public"."fct_customer_retention__dbt_backup" cascade
[0m13:53:32.451422 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:53:32.452262 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: Close
[0m13:53:32.452665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11473ffd0>]}
[0m13:53:32.453094 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.fct_customer_retention ................ [[32mSELECT 18[0m in 0.03s]
[0m13:53:32.453454 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_customer_retention
[0m13:53:32.453704 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_monthly_sales
[0m13:53:32.453986 [info ] [Thread-1  ]: 5 of 9 START sql incremental model public.fct_monthly_sales .................... [RUN]
[0m13:53:32.454308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_customer_retention, now model.ecommerce_datamart.fct_monthly_sales)
[0m13:53:32.454535 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_monthly_sales
[0m13:53:32.460681 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:53:32.461278 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_monthly_sales
[0m13:53:32.481984 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:53:32.482650 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:53:32.482917 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: BEGIN
[0m13:53:32.483150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:32.488524 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:53:32.488851 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:53:32.489172 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      
  
    

  create  table "dbt_db_ex3"."public"."fct_monthly_sales"
  
  
    as
  
  (
    

with monthly_order_facts as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        to_char(order_date, 'YYYY-MM') as year_month,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as unique_customers,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold,
        count(distinct case when status = 'completed' then order_id end) as completed_orders,
        count(distinct case when status = 'cancelled' then order_id end) as cancelled_orders
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1, 2, 3
),

monthly_product_category_sales as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        product_category,
        sum(item_total) as category_sales,
        count(distinct order_id) as category_orders,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2, 3
),

monthly_new_customers as (
    select
        extract(year from first_order_date) as year,
        extract(month from first_order_date) as month,
        count(distinct customer_id) as new_customers
    from "dbt_db_ex3"."public"."dim_customers"
    where first_order_date is not null
    group by 1, 2
)

select
    m.year,
    m.month,
    m.year_month,
    m.orders_count,
    m.unique_customers,
    m.total_sales_amount,
    m.total_shipping_cost,
    m.average_order_value,
    m.total_items_sold,
    m.completed_orders,
    m.cancelled_orders,
    coalesce(pc_electronics.category_sales, 0) as electronics_sales,
    coalesce(pc_clothing.category_sales, 0) as clothing_sales,
    coalesce(pc_footwear.category_sales, 0) as footwear_sales,
    coalesce(pc_accessories.category_sales, 0) as accessories_sales,
    coalesce(pc_electronics.category_items_sold, 0) as electronics_items_sold,
    coalesce(pc_clothing.category_items_sold, 0) as clothing_items_sold,
    coalesce(pc_footwear.category_items_sold, 0) as footwear_items_sold,
    coalesce(pc_accessories.category_items_sold, 0) as accessories_items_sold,
    coalesce(nc.new_customers, 0) as new_customers,
    case 
        when m.orders_count = 0 then 0
        else (m.cancelled_orders::float / m.orders_count) * 100
    end as cancellation_rate,
    case
        when lag(m.total_sales_amount) over (order by m.year, m.month) = 0 then null
        else (m.total_sales_amount - lag(m.total_sales_amount) over (order by m.year, m.month)) / 
             lag(m.total_sales_amount) over (order by m.year, m.month) * 100
    end as sales_growth_pct,
    current_timestamp as updated_at
from monthly_order_facts m
left join monthly_new_customers nc on m.year = nc.year and m.month = nc.month
left join monthly_product_category_sales pc_electronics 
    on m.year = pc_electronics.year and m.month = pc_electronics.month and pc_electronics.product_category = 'Electronics'
left join monthly_product_category_sales pc_clothing 
    on m.year = pc_clothing.year and m.month = pc_clothing.month and pc_clothing.product_category = 'Clothing'
left join monthly_product_category_sales pc_footwear 
    on m.year = pc_footwear.year and m.month = pc_footwear.month and pc_footwear.product_category = 'Footwear'
left join monthly_product_category_sales pc_accessories 
    on m.year = pc_accessories.year and m.month = pc_accessories.month and pc_accessories.product_category = 'Accessories'


  );
  
  
[0m13:53:32.496064 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.006 seconds
[0m13:53:32.497070 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:53:32.497341 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:53:32.497577 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:53:32.498353 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:53:32.498883 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: Close
[0m13:53:32.499304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a01f40>]}
[0m13:53:32.499775 [info ] [Thread-1  ]: 5 of 9 OK created sql incremental model public.fct_monthly_sales ............... [[32mSELECT 7[0m in 0.04s]
[0m13:53:32.500158 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_monthly_sales
[0m13:53:32.500422 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_daily_sales
[0m13:53:32.500777 [info ] [Thread-1  ]: 6 of 9 START sql table model public.fct_daily_sales ............................ [RUN]
[0m13:53:32.501170 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_monthly_sales, now model.ecommerce_datamart.fct_daily_sales)
[0m13:53:32.501445 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_daily_sales
[0m13:53:32.504829 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:53:32.505346 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_daily_sales
[0m13:53:32.509067 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:53:32.509733 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:53:32.509991 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: BEGIN
[0m13:53:32.510208 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:32.513878 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:53:32.514218 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:53:32.514719 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

with order_facts as (
    select
        date_trunc('day', order_date) as order_day,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as customers_count,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        sum(total_amount - shipping_cost) as total_product_revenue,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1
),

product_category_facts as (
    select
        date_trunc('day', order_date) as order_day,
        product_category,
        count(distinct order_id) as category_orders_count,
        sum(item_total) as category_revenue,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2
)

select
    d.date_key,
    d.year,
    d.month,
    d.quarter,
    d.day_of_month,
    d.day_of_week,
    d.is_weekend,
    d.month_name,
    coalesce(o.orders_count, 0) as orders_count,
    coalesce(o.customers_count, 0) as customers_count,
    coalesce(o.total_sales_amount, 0) as total_sales_amount,
    coalesce(o.total_shipping_cost, 0) as total_shipping_cost,
    coalesce(o.total_product_revenue, 0) as total_product_revenue,
    coalesce(o.average_order_value, 0) as average_order_value,
    coalesce(o.total_items_sold, 0) as total_items_sold,
    -- Metrics specific to each product category
    coalesce(pc_electronics.category_revenue, 0) as electronics_revenue,
    coalesce(pc_clothing.category_revenue, 0) as clothing_revenue,
    coalesce(pc_footwear.category_revenue, 0) as footwear_revenue,
    coalesce(pc_accessories.category_revenue, 0) as accessories_revenue,
    -- Calculated metrics
    case 
        when coalesce(o.orders_count, 0) = 0 then 0
        else coalesce(o.customers_count, 0)::float / o.orders_count 
    end as customers_per_order_ratio,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."dim_date" d
left join order_facts o on d.date_key = o.order_day
left join product_category_facts pc_electronics 
    on d.date_key = pc_electronics.order_day and pc_electronics.product_category = 'Electronics'
left join product_category_facts pc_clothing 
    on d.date_key = pc_clothing.order_day and pc_clothing.product_category = 'Clothing'
left join product_category_facts pc_footwear 
    on d.date_key = pc_footwear.order_day and pc_footwear.product_category = 'Footwear'
left join product_category_facts pc_accessories 
    on d.date_key = pc_accessories.order_day and pc_accessories.product_category = 'Accessories'
where d.date_key <= current_date
  );
  
[0m13:53:32.522332 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.007 seconds
[0m13:53:32.558414 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:53:32.558776 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
alter table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m13:53:32.560115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:32.560906 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:53:32.561140 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:53:32.561352 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:53:32.563471 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:53:32.565468 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup"
[0m13:53:32.565835 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:53:32.566065 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup" cascade
[0m13:53:32.566842 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:53:32.567620 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: Close
[0m13:53:32.567989 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a347c0>]}
[0m13:53:32.568378 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 1959[0m in 0.07s]
[0m13:53:32.568748 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_daily_sales
[0m13:53:32.569003 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_customer_retention
[0m13:53:32.569334 [info ] [Thread-1  ]: 7 of 9 START sql table model public.metric_customer_retention .................. [RUN]
[0m13:53:32.569674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_daily_sales, now model.ecommerce_datamart.metric_customer_retention)
[0m13:53:32.569933 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_customer_retention
[0m13:53:32.572529 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:53:32.573056 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_customer_retention
[0m13:53:32.575961 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:53:32.576598 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:53:32.576855 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: BEGIN
[0m13:53:32.577072 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:32.583615 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:53:32.583935 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:53:32.584212 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_customer_retention__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates customer retention metrics
-- for easier analytics consumption

select
    first_order_year,
    first_order_month,
    cohort,
    cohort_size,
    months_since_first_order,
    retained_customers,
    cohort_revenue,
    retention_rate,
    revenue_per_retained_customer,
    cumulative_retained_customers,
    cumulative_cohort_revenue,
    -- Additional calculated metrics
    (cumulative_retained_customers::float / nullif(cohort_size, 0)) * 100 as cumulative_retention_rate,
    (cumulative_cohort_revenue::float / nullif(cumulative_retained_customers, 0)) as cumulative_revenue_per_customer,
    (retained_customers::float / nullif(lag(retained_customers) over (
        partition by cohort 
        order by months_since_first_order
    ), 0)) * 100 as month_over_month_retention_change,
    case
        when months_since_first_order >= 1 and months_since_first_order <= 3 then 'Early Stage'
        when months_since_first_order > 3 and months_since_first_order <= 6 then 'Mid Stage'
        when months_since_first_order > 6 and months_since_first_order <= 12 then 'Late Stage'
        else 'Long Term'
    end as retention_stage,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_customer_retention"
  );
  
[0m13:53:32.587174 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.003 seconds
[0m13:53:32.590405 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:53:32.590772 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
alter table "dbt_db_ex3"."public"."metric_customer_retention__dbt_tmp" rename to "metric_customer_retention"
[0m13:53:32.591626 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:32.592525 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: COMMIT
[0m13:53:32.592792 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:53:32.593050 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: COMMIT
[0m13:53:32.593864 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:53:32.597060 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_customer_retention__dbt_backup"
[0m13:53:32.597473 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:53:32.597727 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
drop table if exists "dbt_db_ex3"."public"."metric_customer_retention__dbt_backup" cascade
[0m13:53:32.598365 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:53:32.599240 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: Close
[0m13:53:32.599661 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114932fd0>]}
[0m13:53:32.600111 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.metric_customer_retention ............. [[32mSELECT 18[0m in 0.03s]
[0m13:53:32.600493 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_customer_retention
[0m13:53:32.600765 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_monthly_sales
[0m13:53:32.601113 [info ] [Thread-1  ]: 8 of 9 START sql table model public.metric_monthly_sales ....................... [RUN]
[0m13:53:32.601410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_customer_retention, now model.ecommerce_datamart.metric_monthly_sales)
[0m13:53:32.601650 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_monthly_sales
[0m13:53:32.604702 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:53:32.605231 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_monthly_sales
[0m13:53:32.608201 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:53:32.608653 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:53:32.608886 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: BEGIN
[0m13:53:32.609102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:32.613991 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:53:32.614269 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:53:32.614547 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates monthly sales metrics
-- for easier analytics consumption

select
    year,
    month,
    year_month,
    orders_count,
    unique_customers,
    total_sales_amount,
    total_shipping_cost,
    average_order_value,
    total_items_sold,
    completed_orders,
    cancelled_orders,
    electronics_sales,
    clothing_sales,
    footwear_sales,
    accessories_sales,
    electronics_items_sold,
    clothing_items_sold,
    footwear_items_sold,
    accessories_items_sold,
    new_customers,
    cancellation_rate,
    sales_growth_pct,
    -- Additional calculated metrics
    case
        when lag(new_customers) over (order by year, month) = 0 then null
        else (new_customers - lag(new_customers) over (order by year, month)) / 
             nullif(lag(new_customers) over (order by year, month), 0) * 100
    end as new_customer_growth_pct,
    case 
        when unique_customers = 0 then 0 
        else total_sales_amount / unique_customers 
    end as revenue_per_customer,
    (completed_orders::float / nullif(orders_count, 0)) * 100 as completion_rate,
    case
        when total_sales_amount = 0 then 0
        else electronics_sales / total_sales_amount * 100
    end as electronics_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else clothing_sales / total_sales_amount * 100
    end as clothing_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else footwear_sales / total_sales_amount * 100
    end as footwear_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else accessories_sales / total_sales_amount * 100
    end as accessories_sales_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_monthly_sales"
  );
  
[0m13:53:32.618447 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.004 seconds
[0m13:53:32.621315 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:53:32.621592 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
alter table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp" rename to "metric_monthly_sales"
[0m13:53:32.622362 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:32.623200 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:53:32.623451 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:53:32.623673 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:53:32.624386 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:53:32.626365 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup"
[0m13:53:32.626737 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:53:32.626971 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup" cascade
[0m13:53:32.627472 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:53:32.628288 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: Close
[0m13:53:32.628789 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11477ea90>]}
[0m13:53:32.629310 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.metric_monthly_sales .................. [[32mSELECT 7[0m in 0.03s]
[0m13:53:32.629884 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_monthly_sales
[0m13:53:32.630175 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_daily_sales
[0m13:53:32.630548 [info ] [Thread-1  ]: 9 of 9 START sql table model public.metric_daily_sales ......................... [RUN]
[0m13:53:32.630878 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_monthly_sales, now model.ecommerce_datamart.metric_daily_sales)
[0m13:53:32.631115 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_daily_sales
[0m13:53:32.634776 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:53:32.635252 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_daily_sales
[0m13:53:32.638202 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:53:32.638667 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:53:32.638891 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: BEGIN
[0m13:53:32.639100 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:53:32.644295 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:53:32.644650 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:53:32.644931 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates daily sales metrics
-- for easier analytics consumption

select
    date_key,
    year,
    month,
    quarter,
    day_of_month,
    day_of_week,
    is_weekend,
    month_name,
    orders_count,
    customers_count,
    total_sales_amount,
    total_shipping_cost,
    total_product_revenue,
    average_order_value,
    total_items_sold,
    electronics_revenue,
    clothing_revenue,
    footwear_revenue,
    accessories_revenue,
    -- Additional calculated metrics
    case 
        when orders_count = 0 then 0 
        else total_sales_amount / orders_count 
    end as revenue_per_order,
    case 
        when customers_count = 0 then 0 
        else total_sales_amount / customers_count 
    end as revenue_per_customer,
    case 
        when total_sales_amount = 0 then 0 
        else electronics_revenue / total_sales_amount * 100 
    end as electronics_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else clothing_revenue / total_sales_amount * 100 
    end as clothing_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else footwear_revenue / total_sales_amount * 100 
    end as footwear_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else accessories_revenue / total_sales_amount * 100 
    end as accessories_revenue_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_daily_sales"
  );
  
[0m13:53:32.650057 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.005 seconds
[0m13:53:32.653050 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:53:32.653332 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
alter table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp" rename to "metric_daily_sales"
[0m13:53:32.654027 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:53:32.654856 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:53:32.655125 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:53:32.655388 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:53:32.658515 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:53:32.661197 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup"
[0m13:53:32.661730 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:53:32.661991 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup" cascade
[0m13:53:32.662616 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:53:32.663536 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: Close
[0m13:53:32.663997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2120707-8e67-4b80-9cf8-6ac1c158323e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a34fa0>]}
[0m13:53:32.664485 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.metric_daily_sales .................... [[32mSELECT 1959[0m in 0.03s]
[0m13:53:32.664867 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_daily_sales
[0m13:53:32.665607 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:32.665839 [debug] [MainThread]: On master: BEGIN
[0m13:53:32.666037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:32.670102 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:53:32.670409 [debug] [MainThread]: On master: COMMIT
[0m13:53:32.670613 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:32.670803 [debug] [MainThread]: On master: COMMIT
[0m13:53:32.671213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:53:32.671499 [debug] [MainThread]: On master: Close
[0m13:53:32.671808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:32.672001 [debug] [MainThread]: Connection 'model.ecommerce_datamart.metric_daily_sales' was properly closed.
[0m13:53:32.672270 [info ] [MainThread]: 
[0m13:53:32.672498 [info ] [MainThread]: Finished running 1 incremental model, 8 table models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m13:53:32.673566 [debug] [MainThread]: Command end result
[0m13:53:32.702107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:53:32.703380 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:53:32.707809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:53:32.708033 [info ] [MainThread]: 
[0m13:53:32.708272 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:53:32.708798 [info ] [MainThread]: 
[0m13:53:32.712696 [error] [MainThread]:   Database Error in model dim_customers_mart (models/mart/dimensions/dim_customers_mart.sql)
  operator does not exist: interval <= integer
  LINE 34: ...     when (current_date - most_recent_order_date) <= 30 then...
                                                                ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/ecommerce_datamart/models/mart/dimensions/dim_customers_mart.sql
[0m13:53:32.712941 [info ] [MainThread]: 
[0m13:53:32.713167 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m13:53:32.714346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.41806, "process_in_blocks": "0", "process_kernel_time": 0.227068, "process_mem_max_rss": "130957312", "process_out_blocks": "0", "process_user_time": 1.957461}
[0m13:53:32.714641 [debug] [MainThread]: Command `dbt run` failed at 13:53:32.714589 after 1.42 seconds
[0m13:53:32.714896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111846790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ad18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d27310>]}
[0m13:53:32.715156 [debug] [MainThread]: Flushing usage events
[0m13:53:33.954424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:25.374689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110042700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fad460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fad280>]}


============================== 13:54:25.377905 | bcd9cac1-e24e-40c5-913a-aec61ef55ca9 ==============================
[0m13:54:25.377905 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:54:25.378279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select mart.*', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:54:25.537874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f284c0>]}
[0m13:54:25.586166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113be8e0>]}
[0m13:54:25.587035 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:54:25.687996 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:54:25.842466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:54:25.843111 [debug] [MainThread]: Partial parsing: updated file: ecommerce_datamart://models/mart/dimensions/dim_customers_mart.sql
[0m13:54:26.135753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e0130>]}
[0m13:54:26.430001 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:54:26.434975 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:54:26.452386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f22070>]}
[0m13:54:26.453513 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:54:26.460252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f22370>]}
[0m13:54:26.463868 [info ] [MainThread]: 
[0m13:54:26.464919 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:26.465785 [info ] [MainThread]: 
[0m13:54:26.467678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:26.473625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:54:26.518096 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:54:26.518438 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:54:26.518636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:26.549456 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.031 seconds
[0m13:54:26.550317 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:54:26.551964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:54:26.558307 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:54:26.558650 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:54:26.558853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:26.563009 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:54:26.563324 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:54:26.563541 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:54:26.566289 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.003 seconds
[0m13:54:26.567313 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:54:26.567773 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:54:26.573771 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:26.574035 [debug] [MainThread]: On master: BEGIN
[0m13:54:26.574220 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:26.578377 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:54:26.578633 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:26.578891 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:26.586448 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m13:54:26.587806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f24e50>]}
[0m13:54:26.588175 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:26.588913 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:26.589144 [debug] [MainThread]: On master: BEGIN
[0m13:54:26.590166 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:54:26.590458 [debug] [MainThread]: On master: COMMIT
[0m13:54:26.590682 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:26.590885 [debug] [MainThread]: On master: COMMIT
[0m13:54:26.591657 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:54:26.592319 [debug] [MainThread]: On master: Close
[0m13:54:26.596052 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:54:26.597159 [info ] [Thread-1  ]: 1 of 9 START sql table model public.dim_customers_mart ......................... [RUN]
[0m13:54:26.597648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_customers_mart)
[0m13:54:26.597954 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:54:26.604773 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:26.605344 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:54:26.639064 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:26.639842 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:26.640149 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: BEGIN
[0m13:54:26.640386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:26.648481 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:54:26.648887 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:26.649193 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex3"."public"."dim_customers"
),

customer_segments as (
    select
        customer_id,
        case
            when lifetime_value >= 1000000 then 'VIP'
            when lifetime_value >= 500000 then 'High Value'
            when lifetime_value >= 100000 then 'Medium Value'
            else 'Low Value'
        end as customer_segment,
        case
            when lifetime_orders >= 10 then 'Frequent'
            when lifetime_orders >= 5 then 'Regular'
            when lifetime_orders >= 2 then 'Occasional'
            else 'One-time'
        end as purchase_frequency,
        case
            when extract(day from (current_date - most_recent_order_date)) <= 30 then 'Active'
            when extract(day from (current_date - most_recent_order_date)) <= 90 then 'Recent'
            when extract(day from (current_date - most_recent_order_date)) <= 180 then 'Lapsed'
            else 'Inactive'
        end as customer_status
    from customers
    where lifetime_orders > 0
)

select
    c.*,
    coalesce(cs.customer_segment, 'New') as customer_segment,
    coalesce(cs.purchase_frequency, 'None') as purchase_frequency,
    coalesce(cs.customer_status, 'New') as customer_status,
    case
        when cs.customer_segment = 'VIP' and cs.customer_status = 'Active' then true
        else false
    end as is_high_value_active
from customers c
left join customer_segments cs using (customer_id)
  );
  
[0m13:54:26.664359 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.014 seconds
[0m13:54:26.671325 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:26.671636 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */
alter table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp" rename to "dim_customers_mart"
[0m13:54:26.672504 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:26.682369 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: COMMIT
[0m13:54:26.682701 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:26.682928 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: COMMIT
[0m13:54:26.684393 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:26.688693 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_customers_mart__dbt_backup"
[0m13:54:26.691751 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:26.692124 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_customers_mart__dbt_backup" cascade
[0m13:54:26.693024 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:26.694649 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: Close
[0m13:54:26.696039 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d64f70>]}
[0m13:54:26.696546 [info ] [Thread-1  ]: 1 of 9 OK created sql table model public.dim_customers_mart .................... [[32mSELECT 10[0m in 0.10s]
[0m13:54:26.696929 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:54:26.697201 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:54:26.697572 [info ] [Thread-1  ]: 2 of 9 START sql table model public.dim_date ................................... [RUN]
[0m13:54:26.697873 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now model.ecommerce_datamart.dim_date)
[0m13:54:26.698084 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:54:26.712979 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:26.713298 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:54:26.713512 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:26.719263 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:54:26.719592 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:26.719824 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:54:26.720738 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:26.729985 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:54:26.730803 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:54:26.734087 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_date"
[0m13:54:26.734875 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:26.735207 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

-- Generate a date series from 2020-01-01 to 2025-12-31
with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2191
    order by generated_number



),

all_periods as (

    select (
        

    cast('2020-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as date)

)

select * from filtered


),

dates as (
    select
        cast(date_day as date) as date_key,
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dow from date_day) as day_of_week,
        extract(doy from date_day) as day_of_year,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Day') as day_name,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when extract(month from date_day) in (1, 2, 3) then 'Q1'
            when extract(month from date_day) in (4, 5, 6) then 'Q2'
            when extract(month from date_day) in (7, 8, 9) then 'Q3'
            else 'Q4'
        end as quarter_name
    from date_spine
)

select * from dates
  );
  
[0m13:54:26.754312 [debug] [Thread-1  ]: SQL status: SELECT 2191 in 0.019 seconds
[0m13:54:26.757641 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:26.757984 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m13:54:26.758867 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:26.761436 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:26.761699 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:54:26.762214 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:26.764634 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:54:26.764927 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:26.765156 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:54:26.766624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:26.768769 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_date__dbt_backup"
[0m13:54:26.769144 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:26.769384 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
drop table if exists "dbt_db_ex3"."public"."dim_date__dbt_backup" cascade
[0m13:54:26.771938 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:54:26.773145 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:54:26.773578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ecb370>]}
[0m13:54:26.774035 [info ] [Thread-1  ]: 2 of 9 OK created sql table model public.dim_date .............................. [[32mSELECT 2191[0m in 0.08s]
[0m13:54:26.774403 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:54:26.774653 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:54:26.775016 [info ] [Thread-1  ]: 3 of 9 START sql table model public.dim_products_mart .......................... [RUN]
[0m13:54:26.775422 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.dim_products_mart)
[0m13:54:26.775677 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:54:26.779145 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:54:26.779696 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:54:26.782742 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products_mart"
[0m13:54:26.784054 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:26.784390 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: BEGIN
[0m13:54:26.784619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:26.788122 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:54:26.788440 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:26.788703 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex3"."public"."dim_products"
)

select
    p.*,
    case
        when total_quantity_sold > 100 then 'High Selling'
        when total_quantity_sold > 50 then 'Medium Selling'
        when total_quantity_sold > 0 then 'Low Selling'
        else 'Not Selling'
    end as sales_performance,
    case
        when total_revenue > 10000000 then 'High Revenue'
        when total_revenue > 5000000 then 'Medium Revenue'
        when total_revenue > 0 then 'Low Revenue'
        else 'No Revenue'
    end as revenue_tier,
    (total_revenue / nullif(total_quantity_sold, 0)) as average_selling_price,
    case
        when is_active = true and inventory_status != 'Out of stock' then true
        else false
    end as is_available_for_purchase,
    case
        when is_active = false then 'Discontinued'
        when inventory_status = 'Out of stock' then 'Temporarily Unavailable'
        else 'Available'
    end as availability_status
from products p
  );
  
[0m13:54:26.793526 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.004 seconds
[0m13:54:26.798372 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:26.799758 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart" rename to "dim_products_mart__dbt_backup"
[0m13:54:26.800590 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:26.803019 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:26.803269 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp" rename to "dim_products_mart"
[0m13:54:26.803847 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:26.804710 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:54:26.804963 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:26.805188 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:54:26.805966 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:26.808020 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products_mart__dbt_backup"
[0m13:54:26.808946 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:26.809287 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_products_mart__dbt_backup" cascade
[0m13:54:26.811706 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:54:26.812838 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: Close
[0m13:54:26.813363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ecb370>]}
[0m13:54:26.813837 [info ] [Thread-1  ]: 3 of 9 OK created sql table model public.dim_products_mart ..................... [[32mSELECT 15[0m in 0.04s]
[0m13:54:26.814212 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:54:26.814474 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_customer_retention
[0m13:54:26.814800 [info ] [Thread-1  ]: 4 of 9 START sql table model public.fct_customer_retention ..................... [RUN]
[0m13:54:26.815090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products_mart, now model.ecommerce_datamart.fct_customer_retention)
[0m13:54:26.815317 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_customer_retention
[0m13:54:26.818395 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:54:26.818925 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_customer_retention
[0m13:54:26.822641 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:54:26.823216 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:54:26.823466 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: BEGIN
[0m13:54:26.823718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:26.829498 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:54:26.829829 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:54:26.830190 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_customer_retention__dbt_tmp"
  
  
    as
  
  (
    

with customer_orders as (
    select
        customer_id,
        order_id,
        order_date,
        total_amount,
        row_number() over(partition by customer_id order by order_date) as order_sequence,
        lead(order_date) over(partition by customer_id order by order_date) as next_order_date,
        extract(day from (lead(order_date) over(partition by customer_id order by order_date) - order_date)) as days_until_next_order
    from "dbt_db_ex3"."public"."fct_orders"
),

customer_first_orders as (
    select
        customer_id,
        min(case when order_sequence = 1 then order_date end) as first_order_date,
        extract(year from min(case when order_sequence = 1 then order_date end)) as first_order_year,
        extract(month from min(case when order_sequence = 1 then order_date end)) as first_order_month,
        to_char(min(case when order_sequence = 1 then order_date end), 'YYYY-MM') as first_order_year_month
    from customer_orders
    group by 1
),

repeat_purchase_facts as (
    select
        c.customer_id,
        c.first_order_date,
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        count(distinct case when co.order_sequence > 1 then co.order_id end) as repeat_orders,
        max(co.order_sequence) as total_orders,
        sum(case when co.order_sequence > 1 then co.total_amount else 0 end) as repeat_order_revenue,
        min(case when co.order_sequence = 2 then co.order_date end) as second_order_date,
        avg(co.days_until_next_order) as avg_days_between_orders
    from customer_first_orders c
    left join customer_orders co using (customer_id)
    group by 1, 2, 3, 4, 5
),

cohort_sizes as (
    select
        first_order_year,
        first_order_month,
        first_order_year_month,
        count(distinct customer_id) as cohort_size
    from customer_first_orders
    group by 1, 2, 3
),

retention_by_month as (
    select
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        cs.cohort_size,
        date_part('month', age(date_trunc('month', o.order_date), 
                              date_trunc('month', c.first_order_date))) as months_since_first_order,
        count(distinct o.customer_id) as retained_customers,
        sum(o.total_amount) as cohort_revenue
    from customer_first_orders c
    join "dbt_db_ex3"."public"."fct_orders" o using(customer_id)
    join cohort_sizes cs 
        on c.first_order_year = cs.first_order_year 
        and c.first_order_month = cs.first_order_month
    where o.order_date > c.first_order_date
    group by 1, 2, 3, 4, 5
)

select
    r.first_order_year,
    r.first_order_month,
    r.first_order_year_month as cohort,
    r.cohort_size,
    r.months_since_first_order,
    r.retained_customers,
    r.cohort_revenue,
    (r.retained_customers::float / r.cohort_size) * 100 as retention_rate,
    (r.cohort_revenue::float / r.retained_customers) as revenue_per_retained_customer,
    sum(r.retained_customers) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_retained_customers,
    sum(r.cohort_revenue) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_cohort_revenue,
    current_timestamp as updated_at
from retention_by_month r
order by r.first_order_year, r.first_order_month, r.months_since_first_order
  );
  
[0m13:54:26.835270 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.005 seconds
[0m13:54:26.838688 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:54:26.839046 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
alter table "dbt_db_ex3"."public"."fct_customer_retention" rename to "fct_customer_retention__dbt_backup"
[0m13:54:26.839889 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:26.842538 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:54:26.842818 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
alter table "dbt_db_ex3"."public"."fct_customer_retention__dbt_tmp" rename to "fct_customer_retention"
[0m13:54:26.843469 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:26.844457 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: COMMIT
[0m13:54:26.844754 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:54:26.845011 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: COMMIT
[0m13:54:26.846226 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:26.848454 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_customer_retention__dbt_backup"
[0m13:54:26.848866 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:54:26.849110 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
drop table if exists "dbt_db_ex3"."public"."fct_customer_retention__dbt_backup" cascade
[0m13:54:26.851845 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:54:26.853000 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: Close
[0m13:54:26.853481 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ecb370>]}
[0m13:54:26.853952 [info ] [Thread-1  ]: 4 of 9 OK created sql table model public.fct_customer_retention ................ [[32mSELECT 18[0m in 0.04s]
[0m13:54:26.854368 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_customer_retention
[0m13:54:26.854635 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_monthly_sales
[0m13:54:26.854995 [info ] [Thread-1  ]: 5 of 9 START sql incremental model public.fct_monthly_sales .................... [RUN]
[0m13:54:26.855412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_customer_retention, now model.ecommerce_datamart.fct_monthly_sales)
[0m13:54:26.855675 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_monthly_sales
[0m13:54:26.863719 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:54:26.864439 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_monthly_sales
[0m13:54:26.928739 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:54:26.929236 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

    
  
    

  create temporary table "fct_monthly_sales__dbt_tmp135426925005"
  
  
    as
  
  (
    

with monthly_order_facts as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        to_char(order_date, 'YYYY-MM') as year_month,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as unique_customers,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold,
        count(distinct case when status = 'completed' then order_id end) as completed_orders,
        count(distinct case when status = 'cancelled' then order_id end) as cancelled_orders
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1, 2, 3
),

monthly_product_category_sales as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        product_category,
        sum(item_total) as category_sales,
        count(distinct order_id) as category_orders,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2, 3
),

monthly_new_customers as (
    select
        extract(year from first_order_date) as year,
        extract(month from first_order_date) as month,
        count(distinct customer_id) as new_customers
    from "dbt_db_ex3"."public"."dim_customers"
    where first_order_date is not null
    group by 1, 2
)

select
    m.year,
    m.month,
    m.year_month,
    m.orders_count,
    m.unique_customers,
    m.total_sales_amount,
    m.total_shipping_cost,
    m.average_order_value,
    m.total_items_sold,
    m.completed_orders,
    m.cancelled_orders,
    coalesce(pc_electronics.category_sales, 0) as electronics_sales,
    coalesce(pc_clothing.category_sales, 0) as clothing_sales,
    coalesce(pc_footwear.category_sales, 0) as footwear_sales,
    coalesce(pc_accessories.category_sales, 0) as accessories_sales,
    coalesce(pc_electronics.category_items_sold, 0) as electronics_items_sold,
    coalesce(pc_clothing.category_items_sold, 0) as clothing_items_sold,
    coalesce(pc_footwear.category_items_sold, 0) as footwear_items_sold,
    coalesce(pc_accessories.category_items_sold, 0) as accessories_items_sold,
    coalesce(nc.new_customers, 0) as new_customers,
    case 
        when m.orders_count = 0 then 0
        else (m.cancelled_orders::float / m.orders_count) * 100
    end as cancellation_rate,
    case
        when lag(m.total_sales_amount) over (order by m.year, m.month) = 0 then null
        else (m.total_sales_amount - lag(m.total_sales_amount) over (order by m.year, m.month)) / 
             lag(m.total_sales_amount) over (order by m.year, m.month) * 100
    end as sales_growth_pct,
    current_timestamp as updated_at
from monthly_order_facts m
left join monthly_new_customers nc on m.year = nc.year and m.month = nc.month
left join monthly_product_category_sales pc_electronics 
    on m.year = pc_electronics.year and m.month = pc_electronics.month and pc_electronics.product_category = 'Electronics'
left join monthly_product_category_sales pc_clothing 
    on m.year = pc_clothing.year and m.month = pc_clothing.month and pc_clothing.product_category = 'Clothing'
left join monthly_product_category_sales pc_footwear 
    on m.year = pc_footwear.year and m.month = pc_footwear.month and pc_footwear.product_category = 'Footwear'
left join monthly_product_category_sales pc_accessories 
    on m.year = pc_accessories.year and m.month = pc_accessories.month and pc_accessories.product_category = 'Accessories'


where m.year || '-' || lpad(m.month::text, 2, '0') >= (select max(year || '-' || lpad(month::text, 2, '0')) from "dbt_db_ex3"."public"."fct_monthly_sales")

  );
  
  
[0m13:54:26.929709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:26.943286 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.013 seconds
[0m13:54:26.954724 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:54:26.955067 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: BEGIN
[0m13:54:26.956253 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:26.956582 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:54:26.956829 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_monthly_sales__dbt_tmp135426925005'
        
      order by ordinal_position

  
[0m13:54:26.961554 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.004 seconds
[0m13:54:26.966306 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:54:26.966635 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'fct_monthly_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:54:26.969103 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.002 seconds
[0m13:54:26.975910 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:54:26.976236 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'fct_monthly_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:54:26.978722 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.002 seconds
[0m13:54:26.989815 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:54:26.990636 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:54:26.990966 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      
        delete from "dbt_db_ex3"."public"."fct_monthly_sales" as DBT_INTERNAL_DEST
        where (year, month) in (
            select distinct year, month
            from "fct_monthly_sales__dbt_tmp135426925005" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dbt_db_ex3"."public"."fct_monthly_sales" ("year", "month", "year_month", "orders_count", "unique_customers", "total_sales_amount", "total_shipping_cost", "average_order_value", "total_items_sold", "completed_orders", "cancelled_orders", "electronics_sales", "clothing_sales", "footwear_sales", "accessories_sales", "electronics_items_sold", "clothing_items_sold", "footwear_items_sold", "accessories_items_sold", "new_customers", "cancellation_rate", "sales_growth_pct", "updated_at")
    (
        select "year", "month", "year_month", "orders_count", "unique_customers", "total_sales_amount", "total_shipping_cost", "average_order_value", "total_items_sold", "completed_orders", "cancelled_orders", "electronics_sales", "clothing_sales", "footwear_sales", "accessories_sales", "electronics_items_sold", "clothing_items_sold", "footwear_items_sold", "accessories_items_sold", "new_customers", "cancellation_rate", "sales_growth_pct", "updated_at"
        from "fct_monthly_sales__dbt_tmp135426925005"
    )
  
[0m13:54:26.992773 [debug] [Thread-1  ]: SQL status: INSERT 0 1 in 0.002 seconds
[0m13:54:26.993645 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:54:26.993894 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:54:26.994113 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:54:26.995334 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:26.995795 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: Close
[0m13:54:26.996176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f37370>]}
[0m13:54:26.996675 [info ] [Thread-1  ]: 5 of 9 OK created sql incremental model public.fct_monthly_sales ............... [[32mINSERT 0 1[0m in 0.14s]
[0m13:54:26.997142 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_monthly_sales
[0m13:54:26.997422 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_daily_sales
[0m13:54:26.997775 [info ] [Thread-1  ]: 6 of 9 START sql table model public.fct_daily_sales ............................ [RUN]
[0m13:54:26.998083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_monthly_sales, now model.ecommerce_datamart.fct_daily_sales)
[0m13:54:26.998379 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_daily_sales
[0m13:54:27.002416 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:54:27.002984 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_daily_sales
[0m13:54:27.006178 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:54:27.006751 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:54:27.006992 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: BEGIN
[0m13:54:27.007211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:27.015629 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:54:27.015995 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:54:27.016364 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

with order_facts as (
    select
        date_trunc('day', order_date) as order_day,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as customers_count,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        sum(total_amount - shipping_cost) as total_product_revenue,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1
),

product_category_facts as (
    select
        date_trunc('day', order_date) as order_day,
        product_category,
        count(distinct order_id) as category_orders_count,
        sum(item_total) as category_revenue,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2
)

select
    d.date_key,
    d.year,
    d.month,
    d.quarter,
    d.day_of_month,
    d.day_of_week,
    d.is_weekend,
    d.month_name,
    coalesce(o.orders_count, 0) as orders_count,
    coalesce(o.customers_count, 0) as customers_count,
    coalesce(o.total_sales_amount, 0) as total_sales_amount,
    coalesce(o.total_shipping_cost, 0) as total_shipping_cost,
    coalesce(o.total_product_revenue, 0) as total_product_revenue,
    coalesce(o.average_order_value, 0) as average_order_value,
    coalesce(o.total_items_sold, 0) as total_items_sold,
    -- Metrics specific to each product category
    coalesce(pc_electronics.category_revenue, 0) as electronics_revenue,
    coalesce(pc_clothing.category_revenue, 0) as clothing_revenue,
    coalesce(pc_footwear.category_revenue, 0) as footwear_revenue,
    coalesce(pc_accessories.category_revenue, 0) as accessories_revenue,
    -- Calculated metrics
    case 
        when coalesce(o.orders_count, 0) = 0 then 0
        else coalesce(o.customers_count, 0)::float / o.orders_count 
    end as customers_per_order_ratio,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."dim_date" d
left join order_facts o on d.date_key = o.order_day
left join product_category_facts pc_electronics 
    on d.date_key = pc_electronics.order_day and pc_electronics.product_category = 'Electronics'
left join product_category_facts pc_clothing 
    on d.date_key = pc_clothing.order_day and pc_clothing.product_category = 'Clothing'
left join product_category_facts pc_footwear 
    on d.date_key = pc_footwear.order_day and pc_footwear.product_category = 'Footwear'
left join product_category_facts pc_accessories 
    on d.date_key = pc_accessories.order_day and pc_accessories.product_category = 'Accessories'
where d.date_key <= current_date
  );
  
[0m13:54:27.023981 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.007 seconds
[0m13:54:27.027149 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:54:27.027442 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
alter table "dbt_db_ex3"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m13:54:27.028248 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:27.030939 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:54:27.031266 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
alter table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m13:54:27.031999 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:27.032922 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:54:27.033166 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:54:27.033384 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:54:27.034514 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:27.037091 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup"
[0m13:54:27.037635 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:54:27.037897 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup" cascade
[0m13:54:27.039541 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:27.040523 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: Close
[0m13:54:27.040958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d01040>]}
[0m13:54:27.041434 [info ] [Thread-1  ]: 6 of 9 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 1959[0m in 0.04s]
[0m13:54:27.041818 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_daily_sales
[0m13:54:27.042088 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_customer_retention
[0m13:54:27.042605 [info ] [Thread-1  ]: 7 of 9 START sql table model public.metric_customer_retention .................. [RUN]
[0m13:54:27.042936 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_daily_sales, now model.ecommerce_datamart.metric_customer_retention)
[0m13:54:27.043186 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_customer_retention
[0m13:54:27.046046 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:54:27.046586 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_customer_retention
[0m13:54:27.050740 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:54:27.051421 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:54:27.051671 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: BEGIN
[0m13:54:27.051890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:27.055603 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:54:27.055949 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:54:27.056228 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_customer_retention__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates customer retention metrics
-- for easier analytics consumption

select
    first_order_year,
    first_order_month,
    cohort,
    cohort_size,
    months_since_first_order,
    retained_customers,
    cohort_revenue,
    retention_rate,
    revenue_per_retained_customer,
    cumulative_retained_customers,
    cumulative_cohort_revenue,
    -- Additional calculated metrics
    (cumulative_retained_customers::float / nullif(cohort_size, 0)) * 100 as cumulative_retention_rate,
    (cumulative_cohort_revenue::float / nullif(cumulative_retained_customers, 0)) as cumulative_revenue_per_customer,
    (retained_customers::float / nullif(lag(retained_customers) over (
        partition by cohort 
        order by months_since_first_order
    ), 0)) * 100 as month_over_month_retention_change,
    case
        when months_since_first_order >= 1 and months_since_first_order <= 3 then 'Early Stage'
        when months_since_first_order > 3 and months_since_first_order <= 6 then 'Mid Stage'
        when months_since_first_order > 6 and months_since_first_order <= 12 then 'Late Stage'
        else 'Long Term'
    end as retention_stage,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_customer_retention"
  );
  
[0m13:54:27.059777 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.003 seconds
[0m13:54:27.062595 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:54:27.062879 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
alter table "dbt_db_ex3"."public"."metric_customer_retention" rename to "metric_customer_retention__dbt_backup"
[0m13:54:27.065515 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:54:27.068629 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:54:27.069016 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
alter table "dbt_db_ex3"."public"."metric_customer_retention__dbt_tmp" rename to "metric_customer_retention"
[0m13:54:27.070050 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:27.071237 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: COMMIT
[0m13:54:27.071729 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:54:27.071978 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: COMMIT
[0m13:54:27.073265 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:27.075689 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_customer_retention__dbt_backup"
[0m13:54:27.076083 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:54:27.076330 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
drop table if exists "dbt_db_ex3"."public"."metric_customer_retention__dbt_backup" cascade
[0m13:54:27.078058 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:27.078949 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: Close
[0m13:54:27.079330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d647c0>]}
[0m13:54:27.079768 [info ] [Thread-1  ]: 7 of 9 OK created sql table model public.metric_customer_retention ............. [[32mSELECT 18[0m in 0.04s]
[0m13:54:27.080210 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_customer_retention
[0m13:54:27.080487 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_monthly_sales
[0m13:54:27.080817 [info ] [Thread-1  ]: 8 of 9 START sql table model public.metric_monthly_sales ....................... [RUN]
[0m13:54:27.081105 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_customer_retention, now model.ecommerce_datamart.metric_monthly_sales)
[0m13:54:27.081332 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_monthly_sales
[0m13:54:27.083995 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:54:27.084490 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_monthly_sales
[0m13:54:27.088261 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:54:27.088715 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:54:27.088937 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: BEGIN
[0m13:54:27.089137 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:27.093821 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:54:27.094140 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:54:27.094427 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates monthly sales metrics
-- for easier analytics consumption

select
    year,
    month,
    year_month,
    orders_count,
    unique_customers,
    total_sales_amount,
    total_shipping_cost,
    average_order_value,
    total_items_sold,
    completed_orders,
    cancelled_orders,
    electronics_sales,
    clothing_sales,
    footwear_sales,
    accessories_sales,
    electronics_items_sold,
    clothing_items_sold,
    footwear_items_sold,
    accessories_items_sold,
    new_customers,
    cancellation_rate,
    sales_growth_pct,
    -- Additional calculated metrics
    case
        when lag(new_customers) over (order by year, month) = 0 then null
        else (new_customers - lag(new_customers) over (order by year, month)) / 
             nullif(lag(new_customers) over (order by year, month), 0) * 100
    end as new_customer_growth_pct,
    case 
        when unique_customers = 0 then 0 
        else total_sales_amount / unique_customers 
    end as revenue_per_customer,
    (completed_orders::float / nullif(orders_count, 0)) * 100 as completion_rate,
    case
        when total_sales_amount = 0 then 0
        else electronics_sales / total_sales_amount * 100
    end as electronics_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else clothing_sales / total_sales_amount * 100
    end as clothing_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else footwear_sales / total_sales_amount * 100
    end as footwear_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else accessories_sales / total_sales_amount * 100
    end as accessories_sales_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_monthly_sales"
  );
  
[0m13:54:27.097473 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.003 seconds
[0m13:54:27.100219 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:54:27.100477 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
alter table "dbt_db_ex3"."public"."metric_monthly_sales" rename to "metric_monthly_sales__dbt_backup"
[0m13:54:27.101805 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:27.104560 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:54:27.104904 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
alter table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp" rename to "metric_monthly_sales"
[0m13:54:27.106545 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:27.107421 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:54:27.107668 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:54:27.107891 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:54:27.109808 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:54:27.111886 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup"
[0m13:54:27.112294 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:54:27.112525 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup" cascade
[0m13:54:27.114061 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:27.114896 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: Close
[0m13:54:27.115288 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e87490>]}
[0m13:54:27.115706 [info ] [Thread-1  ]: 8 of 9 OK created sql table model public.metric_monthly_sales .................. [[32mSELECT 7[0m in 0.03s]
[0m13:54:27.116125 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_monthly_sales
[0m13:54:27.116772 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_daily_sales
[0m13:54:27.117163 [info ] [Thread-1  ]: 9 of 9 START sql table model public.metric_daily_sales ......................... [RUN]
[0m13:54:27.117531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_monthly_sales, now model.ecommerce_datamart.metric_daily_sales)
[0m13:54:27.117767 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_daily_sales
[0m13:54:27.120774 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:54:27.121292 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_daily_sales
[0m13:54:27.124551 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:54:27.125151 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:54:27.125392 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: BEGIN
[0m13:54:27.125610 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:27.130818 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:54:27.131159 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:54:27.131438 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates daily sales metrics
-- for easier analytics consumption

select
    date_key,
    year,
    month,
    quarter,
    day_of_month,
    day_of_week,
    is_weekend,
    month_name,
    orders_count,
    customers_count,
    total_sales_amount,
    total_shipping_cost,
    total_product_revenue,
    average_order_value,
    total_items_sold,
    electronics_revenue,
    clothing_revenue,
    footwear_revenue,
    accessories_revenue,
    -- Additional calculated metrics
    case 
        when orders_count = 0 then 0 
        else total_sales_amount / orders_count 
    end as revenue_per_order,
    case 
        when customers_count = 0 then 0 
        else total_sales_amount / customers_count 
    end as revenue_per_customer,
    case 
        when total_sales_amount = 0 then 0 
        else electronics_revenue / total_sales_amount * 100 
    end as electronics_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else clothing_revenue / total_sales_amount * 100 
    end as clothing_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else footwear_revenue / total_sales_amount * 100 
    end as footwear_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else accessories_revenue / total_sales_amount * 100 
    end as accessories_revenue_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_daily_sales"
  );
  
[0m13:54:27.138133 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.006 seconds
[0m13:54:27.142150 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:54:27.142419 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
alter table "dbt_db_ex3"."public"."metric_daily_sales" rename to "metric_daily_sales__dbt_backup"
[0m13:54:27.143300 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:27.145985 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:54:27.146259 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
alter table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp" rename to "metric_daily_sales"
[0m13:54:27.147015 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:27.147906 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:54:27.148152 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:54:27.148393 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:54:27.149841 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:27.152025 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup"
[0m13:54:27.152399 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:54:27.152630 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup" cascade
[0m13:54:27.154014 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:27.154876 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: Close
[0m13:54:27.155302 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcd9cac1-e24e-40c5-913a-aec61ef55ca9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f470d0>]}
[0m13:54:27.155760 [info ] [Thread-1  ]: 9 of 9 OK created sql table model public.metric_daily_sales .................... [[32mSELECT 1959[0m in 0.04s]
[0m13:54:27.156137 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_daily_sales
[0m13:54:27.157170 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:27.157423 [debug] [MainThread]: On master: BEGIN
[0m13:54:27.157621 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:27.160739 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:54:27.160999 [debug] [MainThread]: On master: COMMIT
[0m13:54:27.161212 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:27.161470 [debug] [MainThread]: On master: COMMIT
[0m13:54:27.161864 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:27.162097 [debug] [MainThread]: On master: Close
[0m13:54:27.162396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:27.162596 [debug] [MainThread]: Connection 'model.ecommerce_datamart.metric_daily_sales' was properly closed.
[0m13:54:27.162869 [info ] [MainThread]: 
[0m13:54:27.163098 [info ] [MainThread]: Finished running 1 incremental model, 8 table models in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m13:54:27.164183 [debug] [MainThread]: Command end result
[0m13:54:27.192750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:54:27.193877 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:54:27.198432 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:54:27.198719 [info ] [MainThread]: 
[0m13:54:27.198999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:27.199203 [info ] [MainThread]: 
[0m13:54:27.199408 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:54:27.200449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8812971, "process_in_blocks": "0", "process_kernel_time": 0.267068, "process_mem_max_rss": "128319488", "process_out_blocks": "0", "process_user_time": 2.156171}
[0m13:54:27.200696 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:27.200650 after 1.88 seconds
[0m13:54:27.200922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110042700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e66be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e66610>]}
[0m13:54:27.201154 [debug] [MainThread]: Flushing usage events
[0m13:54:29.169809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:43.535148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112339580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123393a0>]}


============================== 13:54:43.538821 | d07b104d-5fd9-4f0f-873e-9d5588d399f5 ==============================
[0m13:54:43.538821 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:54:43.539243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'version_check': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps --no-version-check', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:43.645467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd07b104d-5fd9-4f0f-873e-9d5588d399f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112339580>]}
[0m13:54:43.693710 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-5efjqpw3'
[0m13:54:43.694068 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:54:43.760662 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:54:43.762091 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:54:43.838755 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:54:43.842086 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:54:44.414186 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:54:44.418093 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:54:45.018756 [info ] [MainThread]: Installed from version 1.3.0
[0m13:54:45.019102 [info ] [MainThread]: Up to date!
[0m13:54:45.019376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd07b104d-5fd9-4f0f-873e-9d5588d399f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112408340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112408a00>]}
[0m13:54:45.019672 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:54:45.482950 [info ] [MainThread]: Installed from version 0.13.1
[0m13:54:45.483556 [info ] [MainThread]: Up to date!
[0m13:54:45.483979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd07b104d-5fd9-4f0f-873e-9d5588d399f5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124f5b80>]}
[0m13:54:45.486187 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.0153365, "process_in_blocks": "0", "process_kernel_time": 0.207188, "process_mem_max_rss": "103841792", "process_out_blocks": "0", "process_user_time": 1.104308}
[0m13:54:45.486641 [debug] [MainThread]: Command `dbt deps` succeeded at 13:54:45.486547 after 2.02 seconds
[0m13:54:45.486980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124084f0>]}
[0m13:54:45.487304 [debug] [MainThread]: Flushing usage events
[0m13:54:46.556911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:47.720031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a82790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af8280>]}


============================== 13:54:47.722523 | db3ba22c-075c-4843-98bb-a3a4a20bf121 ==============================
[0m13:54:47.722523 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:54:47.722890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:54:47.729698 [info ] [MainThread]: dbt version: 1.9.4
[0m13:54:47.729988 [info ] [MainThread]: python version: 3.9.6
[0m13:54:47.730183 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m13:54:47.730372 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m13:54:47.777617 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m13:54:47.777964 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m13:54:47.778180 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/dbt_project.yml
[0m13:54:47.778692 [info ] [MainThread]: adapter type: postgres
[0m13:54:47.778927 [info ] [MainThread]: adapter version: 1.9.0
[0m13:54:47.858511 [info ] [MainThread]: Configuration:
[0m13:54:47.858902 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:54:47.859104 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:54:47.859295 [info ] [MainThread]: Required dependencies:
[0m13:54:47.859569 [debug] [MainThread]: Executing "git --help"
[0m13:54:47.877477 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:54:47.878234 [debug] [MainThread]: STDERR: "b''"
[0m13:54:47.878489 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:54:47.878726 [info ] [MainThread]: Connection:
[0m13:54:47.879006 [info ] [MainThread]:   host: localhost
[0m13:54:47.879197 [info ] [MainThread]:   port: 5434
[0m13:54:47.879378 [info ] [MainThread]:   user: dbt_user
[0m13:54:47.879558 [info ] [MainThread]:   database: dbt_db_ex3
[0m13:54:47.879735 [info ] [MainThread]:   schema: public
[0m13:54:47.879906 [info ] [MainThread]:   connect_timeout: 10
[0m13:54:47.880077 [info ] [MainThread]:   role: None
[0m13:54:47.880247 [info ] [MainThread]:   search_path: None
[0m13:54:47.880417 [info ] [MainThread]:   keepalives_idle: 0
[0m13:54:47.880588 [info ] [MainThread]:   sslmode: None
[0m13:54:47.880758 [info ] [MainThread]:   sslcert: None
[0m13:54:47.880928 [info ] [MainThread]:   sslkey: None
[0m13:54:47.881096 [info ] [MainThread]:   sslrootcert: None
[0m13:54:47.881263 [info ] [MainThread]:   application_name: dbt
[0m13:54:47.881434 [info ] [MainThread]:   retries: 1
[0m13:54:47.881876 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:54:47.950963 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:54:47.977565 [debug] [MainThread]: Using postgres connection "debug"
[0m13:54:47.977913 [debug] [MainThread]: On debug: select 1 as id
[0m13:54:47.978147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:48.003308 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m13:54:48.003965 [debug] [MainThread]: On debug: Close
[0m13:54:48.004237 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:54:48.004509 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:54:48.005469 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.33634838, "process_in_blocks": "0", "process_kernel_time": 0.136224, "process_mem_max_rss": "113885184", "process_out_blocks": "0", "process_user_time": 1.024016}
[0m13:54:48.005765 [debug] [MainThread]: Command `dbt debug` succeeded at 13:54:48.005701 after 0.34 seconds
[0m13:54:48.005971 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:54:48.006192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a82790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f16b80>]}
[0m13:54:48.006464 [debug] [MainThread]: Flushing usage events
[0m13:54:48.962842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:50.061830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c82790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfaa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cfac70>]}


============================== 13:54:50.064666 | 16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2 ==============================
[0m13:54:50.064666 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:54:50.065045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select source:* staging.* core.*', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:50.190139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe6fd0>]}
[0m13:54:50.242687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b31dc0>]}
[0m13:54:50.243380 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:54:50.319808 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:54:50.443124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:50.443420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:50.482973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107361fd0>]}
[0m13:54:50.595454 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:54:50.598710 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:54:50.609696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067770a0>]}
[0m13:54:50.610080 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:54:50.610309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e8970>]}
[0m13:54:50.611926 [info ] [MainThread]: 
[0m13:54:50.612152 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:50.612347 [info ] [MainThread]: 
[0m13:54:50.612663 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:50.615577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:54:50.642548 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:54:50.642859 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:54:50.643061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:50.656989 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m13:54:50.657858 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:54:50.659434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:54:50.663993 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:54:50.664258 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:54:50.664480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:50.671367 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:54:50.671817 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:54:50.672041 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:54:50.674601 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m13:54:50.675914 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:54:50.676515 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:54:50.682352 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:50.682607 [debug] [MainThread]: On master: BEGIN
[0m13:54:50.682798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:50.686504 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:54:50.686809 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:50.687082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:50.691358 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:54:50.692456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107361eb0>]}
[0m13:54:50.692777 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:50.693297 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:50.693495 [debug] [MainThread]: On master: BEGIN
[0m13:54:50.694426 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:54:50.694653 [debug] [MainThread]: On master: COMMIT
[0m13:54:50.694852 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:50.695040 [debug] [MainThread]: On master: COMMIT
[0m13:54:50.695416 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:50.695641 [debug] [MainThread]: On master: Close
[0m13:54:50.697487 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:54:50.697844 [info ] [Thread-1  ]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m13:54:50.698149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.stg_customers)
[0m13:54:50.698377 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:54:50.704705 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:54:50.705251 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:54:50.729967 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_customers"
[0m13:54:50.730594 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:54:50.730817 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: BEGIN
[0m13:54:50.731029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:50.736780 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:54:50.737001 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:54:50.737218 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */

  create view "dbt_db_ex3"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email,
        coalesce(phone, 'Unknown') as phone,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:54:50.740799 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:54:50.745916 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:54:50.746183 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:54:50.747700 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:50.749818 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:54:50.750042 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:54:50.751208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:50.763028 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:54:50.763346 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:54:50.763573 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:54:50.765978 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:54:50.770942 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_customers__dbt_backup"
[0m13:54:50.773791 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:54:50.774047 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
drop view if exists "dbt_db_ex3"."public"."stg_customers__dbt_backup" cascade
[0m13:54:50.777501 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m13:54:50.779284 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: Close
[0m13:54:50.780676 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785c8e0>]}
[0m13:54:50.781117 [info ] [Thread-1  ]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.08s]
[0m13:54:50.781501 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:54:50.781764 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_order_items
[0m13:54:50.782118 [info ] [Thread-1  ]: 2 of 8 START sql incremental model public.stg_order_items ...................... [RUN]
[0m13:54:50.782434 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_customers, now model.ecommerce_datamart.stg_order_items)
[0m13:54:50.782683 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_order_items
[0m13:54:50.789214 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_order_items"
[0m13:54:50.789947 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_order_items
[0m13:54:50.817732 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:54:50.818133 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

    
  
    

  create temporary table "stg_order_items__dbt_tmp135450808432"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."order_items"
    
    
    where created_at >= (select max(created_at) from "dbt_db_ex3"."public"."stg_order_items")
    
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity,
        coalesce(unit_price, 0) as unit_price,
        coalesce(discount_amount, 0) as discount_amount,
        (quantity * unit_price) - coalesce(discount_amount, 0) as item_total,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:54:50.818417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:50.829529 [debug] [Thread-1  ]: SQL status: SELECT 301 in 0.011 seconds
[0m13:54:50.840754 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:54:50.841107 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: BEGIN
[0m13:54:50.842225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:50.842494 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:54:50.842749 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_items__dbt_tmp135450808432'
        
      order by ordinal_position

  
[0m13:54:50.849321 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.006 seconds
[0m13:54:50.853784 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:54:50.854089 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_items'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:54:50.856224 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.002 seconds
[0m13:54:50.862281 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:54:50.862600 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_items'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:54:50.866286 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m13:54:50.877262 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_order_items"
[0m13:54:50.877906 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:54:50.878188 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      
        
        
        delete from "dbt_db_ex3"."public"."stg_order_items" as DBT_INTERNAL_DEST
        where (order_item_id) in (
            select distinct order_item_id
            from "stg_order_items__dbt_tmp135450808432" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dbt_db_ex3"."public"."stg_order_items" ("order_item_id", "order_id", "product_id", "quantity", "unit_price", "discount_amount", "item_total", "created_at", "updated_at")
    (
        select "order_item_id", "order_id", "product_id", "quantity", "unit_price", "discount_amount", "item_total", "created_at", "updated_at"
        from "stg_order_items__dbt_tmp135450808432"
    )
  
[0m13:54:50.881087 [debug] [Thread-1  ]: SQL status: INSERT 0 301 in 0.003 seconds
[0m13:54:50.881957 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:54:50.882207 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:54:50.882437 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:54:50.883993 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:50.884479 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: Close
[0m13:54:50.884872 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b73520>]}
[0m13:54:50.885315 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model public.stg_order_items ................. [[32mINSERT 0 301[0m in 0.10s]
[0m13:54:50.885773 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_order_items
[0m13:54:50.886045 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_orders
[0m13:54:50.886403 [info ] [Thread-1  ]: 3 of 8 START sql incremental model public.stg_orders ........................... [RUN]
[0m13:54:50.886711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_order_items, now model.ecommerce_datamart.stg_orders)
[0m13:54:50.886958 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_orders
[0m13:54:50.890320 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_orders"
[0m13:54:50.890994 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_orders
[0m13:54:50.895347 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:54:50.895636 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

    
  
    

  create temporary table "stg_orders__dbt_tmp135450894090"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."orders"
    
    
    where created_at >= (select max(created_at) from "dbt_db_ex3"."public"."stg_orders")
    
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        payment_method,
        shipping_address,
        shipping_cost,
        total_amount,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:54:50.895879 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:50.901822 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.006 seconds
[0m13:54:50.904610 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:54:50.904892 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: BEGIN
[0m13:54:50.905469 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:50.905712 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:54:50.905944 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders__dbt_tmp135450894090'
        
      order by ordinal_position

  
[0m13:54:50.909801 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m13:54:50.912790 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:54:50.913169 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:54:50.915435 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.002 seconds
[0m13:54:50.918362 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:54:50.918650 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:54:50.920500 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.002 seconds
[0m13:54:50.922024 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_orders"
[0m13:54:50.922601 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:54:50.922882 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      
        
        
        delete from "dbt_db_ex3"."public"."stg_orders" as DBT_INTERNAL_DEST
        where (order_id) in (
            select distinct order_id
            from "stg_orders__dbt_tmp135450894090" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dbt_db_ex3"."public"."stg_orders" ("order_id", "customer_id", "order_date", "status", "payment_method", "shipping_address", "shipping_cost", "total_amount", "created_at", "updated_at")
    (
        select "order_id", "customer_id", "order_date", "status", "payment_method", "shipping_address", "shipping_cost", "total_amount", "created_at", "updated_at"
        from "stg_orders__dbt_tmp135450894090"
    )
  
[0m13:54:50.923956 [debug] [Thread-1  ]: SQL status: INSERT 0 100 in 0.001 seconds
[0m13:54:50.924840 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:54:50.925100 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:54:50.925474 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:54:50.926347 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:50.926910 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: Close
[0m13:54:50.927337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107825430>]}
[0m13:54:50.927795 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model public.stg_orders ...................... [[32mINSERT 0 100[0m in 0.04s]
[0m13:54:50.928185 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_orders
[0m13:54:50.928461 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_products
[0m13:54:50.928829 [info ] [Thread-1  ]: 4 of 8 START sql view model public.stg_products ................................ [RUN]
[0m13:54:50.929252 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_orders, now model.ecommerce_datamart.stg_products)
[0m13:54:50.929525 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_products
[0m13:54:50.932166 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_products"
[0m13:54:50.932678 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_products
[0m13:54:50.936649 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_products"
[0m13:54:50.937174 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:54:50.937411 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: BEGIN
[0m13:54:50.937629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:50.943065 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:54:50.943405 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:54:50.943651 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */

  create view "dbt_db_ex3"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price,
        category,
        coalesce(inventory_count, 0) as inventory_count,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:54:50.945160 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:54:50.947971 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:54:50.948230 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
alter table "dbt_db_ex3"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:54:50.948920 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:50.951236 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:54:50.951482 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
alter table "dbt_db_ex3"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:54:50.952071 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:50.953031 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:54:50.953297 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:54:50.953523 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:54:50.955338 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:54:50.957524 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_products__dbt_backup"
[0m13:54:50.957905 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:54:50.958138 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
drop view if exists "dbt_db_ex3"."public"."stg_products__dbt_backup" cascade
[0m13:54:50.960147 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m13:54:50.960998 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: Close
[0m13:54:50.961390 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b97520>]}
[0m13:54:50.961819 [info ] [Thread-1  ]: 4 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:54:50.962190 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_products
[0m13:54:50.962452 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers
[0m13:54:50.962819 [info ] [Thread-1  ]: 5 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m13:54:50.963181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_products, now model.ecommerce_datamart.dim_customers)
[0m13:54:50.963438 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers
[0m13:54:50.966228 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers"
[0m13:54:50.966748 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers
[0m13:54:50.976936 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers"
[0m13:54:50.977486 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:54:50.977723 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: BEGIN
[0m13:54:50.977938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:50.984166 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:54:50.984498 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:54:50.984747 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db_ex3"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        sum(total_amount) as lifetime_value
    from "dbt_db_ex3"."public"."stg_orders"
    group by 1
)

select
    c.customer_id,
    c.name,
    c.email,
    c.phone,
    c.created_at,
    coalesce(co.order_count, 0) as lifetime_orders,
    co.first_order_date,
    co.most_recent_order_date,
    coalesce(co.lifetime_value, 0) as lifetime_value,
    current_timestamp as updated_at
from customers c
left join customer_orders co using (customer_id)
  );
  
[0m13:54:50.988677 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m13:54:50.994728 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:54:50.995073 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
alter table "dbt_db_ex3"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:54:50.995919 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:50.998495 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:54:50.998762 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
alter table "dbt_db_ex3"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:54:50.999396 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:51.000270 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:54:51.000525 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:54:51.000761 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:54:51.001807 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:51.003970 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_customers__dbt_backup"
[0m13:54:51.006183 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:54:51.006518 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
drop table if exists "dbt_db_ex3"."public"."dim_customers__dbt_backup" cascade
[0m13:54:51.008086 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:51.008980 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: Close
[0m13:54:51.009393 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b97520>]}
[0m13:54:51.009841 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.dim_customers ......................... [[32mSELECT 10[0m in 0.05s]
[0m13:54:51.010222 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers
[0m13:54:51.010485 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_orders
[0m13:54:51.010793 [info ] [Thread-1  ]: 6 of 8 START sql table model public.fct_orders ................................. [RUN]
[0m13:54:51.011137 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers, now model.ecommerce_datamart.fct_orders)
[0m13:54:51.011380 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_orders
[0m13:54:51.014065 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_orders"
[0m13:54:51.014535 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_orders
[0m13:54:51.018537 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_orders"
[0m13:54:51.019452 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:54:51.019754 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: BEGIN
[0m13:54:51.020080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:51.026250 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:54:51.026584 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:54:51.026850 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

order_items as (
    select
        order_id,
        count(*) as number_of_items,
        sum(quantity) as total_items,
        sum(item_total) as items_subtotal
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_date,
    o.status,
    o.payment_method,
    o.shipping_address,
    o.shipping_cost,
    o.total_amount,
    oi.number_of_items,
    oi.total_items,
    oi.items_subtotal,
    (oi.items_subtotal + o.shipping_cost) as calculated_total,
    abs(o.total_amount - (oi.items_subtotal + o.shipping_cost)) as total_amount_discrepancy,
    o.created_at,
    o.updated_at,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    extract(hour from o.order_date) as order_hour
from orders o
left join order_items oi using (order_id)
  );
  
[0m13:54:51.030216 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.003 seconds
[0m13:54:51.033664 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:54:51.034025 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
alter table "dbt_db_ex3"."public"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:54:51.034884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:51.037359 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:54:51.037614 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
alter table "dbt_db_ex3"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:54:51.038222 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:51.039083 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:54:51.039341 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:54:51.039574 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:54:51.040645 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:51.043059 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_orders__dbt_backup"
[0m13:54:51.043517 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:54:51.043773 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
drop table if exists "dbt_db_ex3"."public"."fct_orders__dbt_backup" cascade
[0m13:54:51.045461 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:51.046520 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: Close
[0m13:54:51.046958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782e160>]}
[0m13:54:51.047495 [info ] [Thread-1  ]: 6 of 8 OK created sql table model public.fct_orders ............................ [[32mSELECT 100[0m in 0.04s]
[0m13:54:51.047880 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_orders
[0m13:54:51.048153 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products
[0m13:54:51.048531 [info ] [Thread-1  ]: 7 of 8 START sql table model public.dim_products ............................... [RUN]
[0m13:54:51.048856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_orders, now model.ecommerce_datamart.dim_products)
[0m13:54:51.049101 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products
[0m13:54:51.051952 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products"
[0m13:54:51.052448 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products
[0m13:54:51.056492 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products"
[0m13:54:51.057150 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:54:51.057388 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: BEGIN
[0m13:54:51.057600 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:51.062983 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:54:51.063316 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:54:51.063576 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db_ex3"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(item_total) as total_revenue
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    p.product_id,
    p.name,
    p.price,
    p.category,
    p.inventory_count,
    p.is_active,
    p.created_at,
    coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(ps.total_revenue, 0) as total_revenue,
    case
        when p.inventory_count = 0 then 'Out of stock'
        when p.inventory_count < 10 then 'Low stock'
        else 'In stock'
    end as inventory_status,
    current_timestamp as updated_at
from products p
left join product_sales ps using (product_id)
  );
  
[0m13:54:51.069031 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.005 seconds
[0m13:54:51.073069 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:54:51.073394 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
alter table "dbt_db_ex3"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m13:54:51.074175 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:51.076689 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:54:51.076950 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
alter table "dbt_db_ex3"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:54:51.077518 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:51.078422 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:54:51.078684 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:54:51.078921 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:54:51.079966 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:51.082233 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products__dbt_backup"
[0m13:54:51.082664 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:54:51.082917 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
drop table if exists "dbt_db_ex3"."public"."dim_products__dbt_backup" cascade
[0m13:54:51.084438 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:51.085428 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: Close
[0m13:54:51.085873 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782e160>]}
[0m13:54:51.086338 [info ] [Thread-1  ]: 7 of 8 OK created sql table model public.dim_products .......................... [[32mSELECT 15[0m in 0.04s]
[0m13:54:51.086734 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products
[0m13:54:51.087002 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_order_items
[0m13:54:51.087369 [info ] [Thread-1  ]: 8 of 8 START sql table model public.fct_order_items ............................ [RUN]
[0m13:54:51.087686 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products, now model.ecommerce_datamart.fct_order_items)
[0m13:54:51.087937 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_order_items
[0m13:54:51.090744 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_order_items"
[0m13:54:51.091240 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_order_items
[0m13:54:51.094187 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_order_items"
[0m13:54:51.094708 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:54:51.094939 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: BEGIN
[0m13:54:51.095154 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:51.099756 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:54:51.100092 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:54:51.100746 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp"
  
  
    as
  
  (
    with order_items as (
    select * from "dbt_db_ex3"."public"."stg_order_items"
),

orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

products as (
    select * from "dbt_db_ex3"."public"."stg_products"
)

select
    oi.order_item_id,
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.order_date,
    p.category as product_category,
    oi.quantity,
    oi.unit_price,
    oi.discount_amount,
    oi.item_total,
    (oi.unit_price * oi.quantity) as gross_item_sales_value,
    oi.discount_amount as item_discount_value,
    ((oi.unit_price * oi.quantity) - oi.item_total) as total_discount_impact,
    case
        when oi.discount_amount > 0 then true
        else false
    end as is_discounted,
    o.status as order_status,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    oi.created_at,
    current_timestamp as updated_at
from order_items oi
join orders o using (order_id)
join products p using (product_id)
  );
  
[0m13:54:51.107732 [debug] [Thread-1  ]: SQL status: SELECT 301 in 0.006 seconds
[0m13:54:51.115101 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:54:51.116100 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
alter table "dbt_db_ex3"."public"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m13:54:51.117783 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:51.159041 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:54:51.159395 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
alter table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m13:54:51.160618 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:51.161714 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:54:51.161991 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:54:51.162216 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:54:51.168668 [debug] [Thread-1  ]: SQL status: COMMIT in 0.006 seconds
[0m13:54:51.171027 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_order_items__dbt_backup"
[0m13:54:51.171517 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:54:51.171781 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
drop table if exists "dbt_db_ex3"."public"."fct_order_items__dbt_backup" cascade
[0m13:54:51.181547 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.009 seconds
[0m13:54:51.209354 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: Close
[0m13:54:51.218086 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16b21a2e-1f3a-4ced-9059-ea10ac3cd7e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b8b5b0>]}
[0m13:54:51.231777 [info ] [Thread-1  ]: 8 of 8 OK created sql table model public.fct_order_items ....................... [[32mSELECT 301[0m in 0.13s]
[0m13:54:51.235106 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_order_items
[0m13:54:51.236032 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:51.236277 [debug] [MainThread]: On master: BEGIN
[0m13:54:51.236471 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:51.247031 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:54:51.249099 [debug] [MainThread]: On master: COMMIT
[0m13:54:51.250003 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:51.250759 [debug] [MainThread]: On master: COMMIT
[0m13:54:51.252789 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:54:51.253850 [debug] [MainThread]: On master: Close
[0m13:54:51.254840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:51.255549 [debug] [MainThread]: Connection 'model.ecommerce_datamart.fct_order_items' was properly closed.
[0m13:54:51.256025 [info ] [MainThread]: 
[0m13:54:51.256282 [info ] [MainThread]: Finished running 2 incremental models, 4 table models, 2 view models in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m13:54:51.257215 [debug] [MainThread]: Command end result
[0m13:54:51.283793 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:54:51.284958 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:54:51.289591 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:54:51.289869 [info ] [MainThread]: 
[0m13:54:51.290120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:51.290334 [info ] [MainThread]: 
[0m13:54:51.290552 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:54:51.291662 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2815439, "process_in_blocks": "0", "process_kernel_time": 0.163531, "process_mem_max_rss": "126713856", "process_out_blocks": "0", "process_user_time": 1.76419}
[0m13:54:51.291916 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:51.291867 after 1.28 seconds
[0m13:54:51.292154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c82790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030015e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106777580>]}
[0m13:54:51.292399 [debug] [MainThread]: Flushing usage events
[0m13:54:52.586851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:53.660232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e16d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e16f70>]}


============================== 13:54:53.662751 | 2c5df69f-b9d5-463e-ace0-ecf9dbff9b09 ==============================
[0m13:54:53.662751 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:54:53.663101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select core.* --store-failures', 'send_anonymous_usage_stats': 'True'}
[0m13:54:53.785424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c5df69f-b9d5-463e-ace0-ecf9dbff9b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105170970>]}
[0m13:54:53.831801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c5df69f-b9d5-463e-ace0-ecf9dbff9b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105129cd0>]}
[0m13:54:53.832396 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:54:53.907888 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:54:54.012979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:54.013284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:54.083001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c5df69f-b9d5-463e-ace0-ecf9dbff9b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059e2cd0>]}
[0m13:54:54.168224 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:54:54.170890 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:54:54.185201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c5df69f-b9d5-463e-ace0-ecf9dbff9b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bffd0>]}
[0m13:54:54.185566 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:54:54.185784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5df69f-b9d5-463e-ace0-ecf9dbff9b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10488aa60>]}
[0m13:54:54.187886 [info ] [MainThread]: 
[0m13:54:54.188106 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:54.188290 [info ] [MainThread]: 
[0m13:54:54.188584 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:54.192910 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:54:54.218538 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:54:54.218821 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:54:54.219007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:54.234755 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m13:54:54.235684 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:54:54.239558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:54:54.244121 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:54:54.244360 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:54:54.244555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:54.250328 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:54:54.250637 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:54:54.250857 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:54:54.253830 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m13:54:54.255039 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:54:54.255899 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:54:54.256278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now list_dbt_db_ex3_public_dbt_test__audit)
[0m13:54:54.259980 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:54:54.260220 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: BEGIN
[0m13:54:54.260424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:54.265942 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:54:54.266226 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:54:54.266425 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public_dbt_test__audit"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:54:54.268478 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:54:54.269587 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: ROLLBACK
[0m13:54:54.270031 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: Close
[0m13:54:54.278972 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:54.279228 [debug] [MainThread]: On master: BEGIN
[0m13:54:54.279407 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:54.284248 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:54:54.284484 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:54.284733 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:54.288183 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:54:54.289268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c5df69f-b9d5-463e-ace0-ecf9dbff9b09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aaf880>]}
[0m13:54:54.289585 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:54.290030 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:54.290233 [debug] [MainThread]: On master: BEGIN
[0m13:54:54.290827 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.291025 [debug] [MainThread]: On master: COMMIT
[0m13:54:54.291213 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:54.291391 [debug] [MainThread]: On master: COMMIT
[0m13:54:54.291775 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:54.291969 [debug] [MainThread]: On master: Close
[0m13:54:54.293555 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:54:54.293836 [info ] [Thread-1  ]: 1 of 39 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m13:54:54.294145 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public_dbt_test__audit, now test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:54:54.294379 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:54:54.306874 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:54:54.307868 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:54:54.321144 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:54:54.324375 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:54:54.324634 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m13:54:54.324866 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.332514 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m13:54:54.334409 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:54:54.342652 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:54:54.343185 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:54:54.344192 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:54.344472 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:54:54.344739 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex3"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m13:54:54.347757 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:54:54.348841 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:54:54.349594 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:54:54.349879 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:54:54.351558 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.354401 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:54:54.355151 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:54:54.355413 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:54:54.356079 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.356350 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:54:54.356611 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m13:54:54.357562 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:54.360447 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m13:54:54.361312 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m13:54:54.361735 [info ] [Thread-1  ]: 1 of 39 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.07s]
[0m13:54:54.362098 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:54:54.362360 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:54:54.362650 [info ] [Thread-1  ]: 2 of 39 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m13:54:54.362921 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:54:54.363152 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:54:54.368336 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:54:54.368915 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:54:54.373644 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:54:54.374156 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:54:54.374421 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m13:54:54.374664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.391405 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.017 seconds
[0m13:54:54.392264 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:54:54.392840 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:54:54.393086 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:54:54.394024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:54.394278 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:54:54.394524 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex3"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m13:54:54.397661 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:54:54.398371 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:54:54.398638 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:54:54.398871 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:54:54.400455 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.400936 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:54:54.401436 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:54:54.401712 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:54:54.402357 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.402591 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:54:54.402838 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m13:54:54.403840 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:54.404777 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m13:54:54.405388 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m13:54:54.405792 [info ] [Thread-1  ]: 2 of 39 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.04s]
[0m13:54:54.406148 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:54:54.406408 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:54:54.406722 [info ] [Thread-1  ]: 3 of 39 START test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True  [RUN]
[0m13:54:54.407119 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f)
[0m13:54:54.407422 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:54:54.430079 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:54.430623 [error] [Thread-1  ]: 3 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True  [[31mERROR[0m in 0.02s]
[0m13:54:54.430992 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:54:54.431259 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:54:54.431504 [info ] [Thread-1  ]: 4 of 39 START test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0  [RUN]
[0m13:54:54.431891 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506)
[0m13:54:54.432268 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:54:54.432554 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:54:54.440800 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:54.441298 [error] [Thread-1  ]: 4 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0  [[31mERROR[0m in 0.01s]
[0m13:54:54.441648 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:54:54.441910 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:54:54.442157 [info ] [Thread-1  ]: 5 of 39 START test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True  [RUN]
[0m13:54:54.442493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295)
[0m13:54:54.442804 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:54:54.443067 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:54:54.449867 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:54.450379 [error] [Thread-1  ]: 5 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True  [[31mERROR[0m in 0.01s]
[0m13:54:54.450761 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:54:54.451039 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:54:54.451294 [info ] [Thread-1  ]: 6 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True  [RUN]
[0m13:54:54.451628 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767)
[0m13:54:54.451877 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:54:54.456110 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:54:54.462092 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:54.462544 [error] [Thread-1  ]: 6 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True  [[31mERROR[0m in 0.01s]
[0m13:54:54.462891 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:54:54.463160 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:54:54.463408 [info ] [Thread-1  ]: 7 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True  [RUN]
[0m13:54:54.463733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507)
[0m13:54:54.463976 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:54:54.464279 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:54:54.470152 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:54.470579 [error] [Thread-1  ]: 7 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True  [[31mERROR[0m in 0.01s]
[0m13:54:54.470919 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:54:54.471178 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:54:54.471668 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:54:54.471420 [info ] [Thread-1  ]: 8 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True  [RUN]
[0m13:54:54.472161 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097)
[0m13:54:54.472431 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:54:54.478262 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:54.478703 [error] [Thread-1  ]: 8 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True  [[31mERROR[0m in 0.01s]
[0m13:54:54.479058 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:54:54.479316 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:54:54.479798 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:54:54.479561 [info ] [Thread-1  ]: 9 of 39 START test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True  [RUN]
[0m13:54:54.480341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e)
[0m13:54:54.480622 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:54:54.486361 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:54.486832 [error] [Thread-1  ]: 9 of 39 ERROR dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True  [[31mERROR[0m in 0.01s]
[0m13:54:54.487237 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:54:54.487506 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:54:54.487762 [info ] [Thread-1  ]: 10 of 39 START test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [RUN]
[0m13:54:54.488079 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:54:54.488431 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:54:54.488717 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:54:54.495725 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:54.496154 [error] [Thread-1  ]: 10 of 39 ERROR dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_  [[31mERROR[0m in 0.01s]
[0m13:54:54.496496 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:54:54.496756 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:54:54.496994 [info ] [Thread-1  ]: 11 of 39 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m13:54:54.497319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:54:54.497640 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:54:54.497903 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:54:54.503494 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:54:54.504123 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:54:54.508239 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:54:54.508667 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:54:54.508912 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m13:54:54.509143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.513986 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.514901 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:54:54.515439 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:54:54.515688 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:54:54.516487 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:54.516741 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:54:54.516985 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m13:54:54.519904 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:54:54.520735 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:54:54.521011 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:54:54.521237 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:54:54.523784 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:54:54.524315 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:54:54.524837 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:54:54.525078 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:54:54.525649 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.525964 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:54:54.526267 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:54:54.527470 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:54.528785 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:54:54.529615 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:54:54.530225 [info ] [Thread-1  ]: 11 of 39 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.03s]
[0m13:54:54.530638 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:54:54.530910 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:54:54.531161 [info ] [Thread-1  ]: 12 of 39 START test not_null_dim_customers_email ............................... [RUN]
[0m13:54:54.531546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a)
[0m13:54:54.531834 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:54:54.535303 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:54:54.535912 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:54:54.541085 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:54:54.541563 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:54:54.541814 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m13:54:54.542048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.547122 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.548021 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:54:54.548549 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:54:54.548792 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:54:54.549495 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.549777 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:54:54.550026 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where email is null



  );
  
    
[0m13:54:54.552531 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.553356 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:54:54.553632 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:54:54.553868 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:54:54.555042 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.555503 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:54:54.556020 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:54:54.556252 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:54:54.556802 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.557677 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:54:54.557934 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:54:54.558669 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.562456 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m13:54:54.563089 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: Close
[0m13:54:54.563551 [info ] [Thread-1  ]: 12 of 39 PASS not_null_dim_customers_email ..................................... [[32mPASS[0m in 0.03s]
[0m13:54:54.563936 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:54:54.564197 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:54:54.564442 [info ] [Thread-1  ]: 13 of 39 START test not_null_dim_customers_lifetime_orders ..................... [RUN]
[0m13:54:54.564777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:54:54.565068 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:54:54.568600 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:54:54.569175 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:54:54.573297 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:54:54.573833 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:54:54.574101 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m13:54:54.574339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.578615 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:54:54.579820 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:54:54.580490 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:54:54.580743 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:54:54.581483 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.581748 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:54:54.581992 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m13:54:54.584570 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.585290 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:54:54.585554 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:54:54.585779 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:54:54.587079 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.587574 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:54:54.588266 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:54:54.588516 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:54:54.589133 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.589403 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:54:54.589648 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m13:54:54.590405 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:54.591395 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m13:54:54.591961 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m13:54:54.592438 [info ] [Thread-1  ]: 13 of 39 PASS not_null_dim_customers_lifetime_orders ........................... [[32mPASS[0m in 0.03s]
[0m13:54:54.592825 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:54:54.593149 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:54:54.593444 [info ] [Thread-1  ]: 14 of 39 START test not_null_dim_customers_lifetime_value ...................... [RUN]
[0m13:54:54.593984 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888)
[0m13:54:54.594255 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:54:54.597667 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:54:54.598223 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:54:54.603299 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
[0m13:54:54.603764 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:54:54.604017 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value" cascade
[0m13:54:54.604248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.609219 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.610138 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
[0m13:54:54.610922 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:54:54.611204 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m13:54:54.612024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:54.612306 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:54:54.612556 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where lifetime_value is null



  );
  
    
[0m13:54:54.615616 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:54:54.616355 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: COMMIT
[0m13:54:54.616627 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:54:54.616862 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: COMMIT
[0m13:54:54.618027 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.618482 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:54:54.619001 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:54:54.619237 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m13:54:54.619948 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.620222 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:54:54.620467 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
    
      
    ) dbt_internal_test
[0m13:54:54.621278 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:54.622312 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: ROLLBACK
[0m13:54:54.623006 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: Close
[0m13:54:54.623550 [info ] [Thread-1  ]: 14 of 39 PASS not_null_dim_customers_lifetime_value ............................ [[32mPASS[0m in 0.03s]
[0m13:54:54.623946 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:54:54.624213 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:54:54.624459 [info ] [Thread-1  ]: 15 of 39 START test not_null_dim_customers_name ................................ [RUN]
[0m13:54:54.624890 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888, now test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1)
[0m13:54:54.625128 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:54:54.628517 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:54:54.629071 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:54:54.633168 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:54:54.633878 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:54:54.634178 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m13:54:54.634423 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.638840 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:54:54.639764 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:54:54.640394 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:54:54.640652 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:54:54.641420 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:54.641679 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:54:54.641921 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where name is null



  );
  
    
[0m13:54:54.644452 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.645192 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:54:54.645464 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:54:54.645719 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:54:54.646911 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.647441 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:54:54.647985 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:54:54.648239 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:54:54.648773 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.649000 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:54:54.649230 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m13:54:54.649971 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.650940 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m13:54:54.651437 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: Close
[0m13:54:54.651889 [info ] [Thread-1  ]: 15 of 39 PASS not_null_dim_customers_name ...................................... [[32mPASS[0m in 0.03s]
[0m13:54:54.652298 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:54:54.652564 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:54:54.652965 [info ] [Thread-1  ]: 16 of 39 START test not_null_dim_products_category ............................. [RUN]
[0m13:54:54.653292 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0)
[0m13:54:54.653527 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:54:54.657776 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:54:54.658281 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:54:54.662652 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
[0m13:54:54.663145 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:54:54.663399 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category" cascade
[0m13:54:54.663630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.667951 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:54:54.668779 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
[0m13:54:54.669263 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:54:54.669491 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: BEGIN
[0m13:54:54.670002 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.670227 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:54:54.670454 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where category is null



  );
  
    
[0m13:54:54.672779 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.673484 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: COMMIT
[0m13:54:54.673781 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:54:54.674008 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: COMMIT
[0m13:54:54.674961 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.675411 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:54:54.675926 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:54:54.676159 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: BEGIN
[0m13:54:54.676621 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.676883 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:54:54.677117 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
    
      
    ) dbt_internal_test
[0m13:54:54.677758 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.678667 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: ROLLBACK
[0m13:54:54.679184 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: Close
[0m13:54:54.679595 [info ] [Thread-1  ]: 16 of 39 PASS not_null_dim_products_category ................................... [[32mPASS[0m in 0.03s]
[0m13:54:54.679959 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:54:54.680213 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:54:54.680489 [info ] [Thread-1  ]: 17 of 39 START test not_null_dim_products_inventory_count ...................... [RUN]
[0m13:54:54.680777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0, now test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e)
[0m13:54:54.681005 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:54:54.684190 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:54:54.684714 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:54:54.688748 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
[0m13:54:54.689189 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:54:54.689435 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count" cascade
[0m13:54:54.689658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.693255 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:54:54.694031 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
[0m13:54:54.694561 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:54:54.694792 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: BEGIN
[0m13:54:54.695341 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.695567 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:54:54.695792 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where inventory_count is null



  );
  
    
[0m13:54:54.700174 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:54:54.700978 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: COMMIT
[0m13:54:54.701274 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:54:54.701558 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: COMMIT
[0m13:54:54.702867 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.703354 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:54:54.703904 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:54:54.704146 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: BEGIN
[0m13:54:54.704711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.704964 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:54:54.705203 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
    
      
    ) dbt_internal_test
[0m13:54:54.705894 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.706821 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: ROLLBACK
[0m13:54:54.707259 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: Close
[0m13:54:54.707682 [info ] [Thread-1  ]: 17 of 39 PASS not_null_dim_products_inventory_count ............................ [[32mPASS[0m in 0.03s]
[0m13:54:54.708054 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:54:54.708311 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:54:54.708600 [info ] [Thread-1  ]: 18 of 39 START test not_null_dim_products_name ................................. [RUN]
[0m13:54:54.708906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e, now test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff)
[0m13:54:54.709144 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:54:54.713208 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:54:54.713763 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:54:54.717510 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:54:54.717889 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:54:54.718126 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m13:54:54.718348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.723229 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.723963 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:54:54.724434 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:54:54.724661 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:54:54.725126 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.725346 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:54:54.725569 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where name is null



  );
  
    
[0m13:54:54.729590 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:54:54.730255 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:54:54.730517 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:54:54.730743 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:54:54.732033 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.732467 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:54:54.733091 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:54:54.733332 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:54:54.733742 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.733961 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:54:54.734186 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m13:54:54.734779 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.735665 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m13:54:54.736115 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: Close
[0m13:54:54.736577 [info ] [Thread-1  ]: 18 of 39 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.03s]
[0m13:54:54.737034 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:54:54.737342 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:54:54.737619 [info ] [Thread-1  ]: 19 of 39 START test not_null_dim_products_price ................................ [RUN]
[0m13:54:54.738301 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff, now test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed)
[0m13:54:54.738600 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:54:54.742174 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:54:54.742722 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:54:54.746411 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:54:54.746782 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:54:54.747011 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m13:54:54.747231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.752554 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.753496 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:54:54.755125 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:54:54.755388 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:54:54.756058 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.756282 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:54:54.756506 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where price is null



  );
  
    
[0m13:54:54.759160 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.759787 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:54:54.760035 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:54:54.760256 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:54:54.761224 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.761608 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:54:54.762058 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:54:54.762280 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:54:54.762724 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.762980 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:54:54.763222 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m13:54:54.763789 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.764661 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m13:54:54.765110 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: Close
[0m13:54:54.765488 [info ] [Thread-1  ]: 19 of 39 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.03s]
[0m13:54:54.765842 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:54:54.766091 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:54:54.766358 [info ] [Thread-1  ]: 20 of 39 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:54:54.766633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed, now test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1)
[0m13:54:54.766895 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:54:54.770082 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:54:54.770583 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:54:54.774295 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:54:54.774676 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:54:54.774915 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m13:54:54.775141 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.780510 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.781305 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:54:54.781800 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:54:54.782037 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:54:54.782465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.782685 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:54:54.782911 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where product_id is null



  );
  
    
[0m13:54:54.785287 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.785947 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:54:54.786213 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:54:54.786451 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:54:54.787483 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.787920 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:54:54.788419 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:54:54.788658 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:54:54.789076 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.789336 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:54:54.789588 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:54:54.790215 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.791145 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:54:54.791576 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:54:54.791977 [info ] [Thread-1  ]: 20 of 39 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.03s]
[0m13:54:54.792355 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:54:54.792621 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:54:54.792989 [info ] [Thread-1  ]: 21 of 39 START test not_null_fct_order_items_item_total ........................ [RUN]
[0m13:54:54.793328 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6)
[0m13:54:54.793591 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:54:54.797298 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:54:54.797839 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:54:54.802625 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
[0m13:54:54.803026 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:54:54.803268 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total" cascade
[0m13:54:54.803498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.808026 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:54:54.808800 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
[0m13:54:54.843101 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:54:54.843434 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: BEGIN
[0m13:54:54.844843 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:54.845053 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:54:54.845268 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where item_total is null



  );
  
    
[0m13:54:54.850964 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:54:54.851537 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: COMMIT
[0m13:54:54.851756 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:54:54.851963 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: COMMIT
[0m13:54:54.853210 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.853655 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:54:54.854149 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:54:54.854375 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: BEGIN
[0m13:54:54.854895 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.855121 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:54:54.855348 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
    
      
    ) dbt_internal_test
[0m13:54:54.856025 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.856958 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: ROLLBACK
[0m13:54:54.857501 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: Close
[0m13:54:54.857894 [info ] [Thread-1  ]: 21 of 39 PASS not_null_fct_order_items_item_total .............................. [[32mPASS[0m in 0.06s]
[0m13:54:54.858253 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:54:54.858507 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:54:54.858779 [info ] [Thread-1  ]: 22 of 39 START test not_null_fct_order_items_order_id .......................... [RUN]
[0m13:54:54.859050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6, now test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02)
[0m13:54:54.859268 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:54:54.862744 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:54:54.863301 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:54:54.867018 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
[0m13:54:54.867401 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:54:54.867631 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id" cascade
[0m13:54:54.867852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.873033 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.873822 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
[0m13:54:54.874335 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:54:54.874568 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: BEGIN
[0m13:54:54.875356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:54.875634 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:54:54.875879 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where order_id is null



  );
  
    
[0m13:54:54.878532 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.879222 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: COMMIT
[0m13:54:54.879482 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:54:54.879712 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: COMMIT
[0m13:54:54.880466 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.880951 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:54:54.881445 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:54:54.881669 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: BEGIN
[0m13:54:54.882070 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.882286 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:54:54.882518 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
    
      
    ) dbt_internal_test
[0m13:54:54.883120 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.883974 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: ROLLBACK
[0m13:54:54.884412 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: Close
[0m13:54:54.884786 [info ] [Thread-1  ]: 22 of 39 PASS not_null_fct_order_items_order_id ................................ [[32mPASS[0m in 0.03s]
[0m13:54:54.885141 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:54:54.885389 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:54:54.885670 [info ] [Thread-1  ]: 23 of 39 START test not_null_fct_order_items_order_item_id ..................... [RUN]
[0m13:54:54.885963 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02, now test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55)
[0m13:54:54.886195 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:54:54.889515 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:54:54.890215 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:54:54.894793 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
[0m13:54:54.895181 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:54:54.895424 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id" cascade
[0m13:54:54.895652 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.900687 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.901630 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
[0m13:54:54.902171 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:54:54.902432 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: BEGIN
[0m13:54:54.903028 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.903252 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:54:54.903483 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where order_item_id is null



  );
  
    
[0m13:54:54.905859 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.906518 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: COMMIT
[0m13:54:54.906791 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:54:54.907035 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: COMMIT
[0m13:54:54.908075 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.908504 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:54:54.908991 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:54:54.909231 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: BEGIN
[0m13:54:54.909657 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.909894 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:54:54.910140 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m13:54:54.910808 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.911739 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: ROLLBACK
[0m13:54:54.912191 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: Close
[0m13:54:54.912596 [info ] [Thread-1  ]: 23 of 39 PASS not_null_fct_order_items_order_item_id ........................... [[32mPASS[0m in 0.03s]
[0m13:54:54.912978 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:54:54.913244 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:54:54.913549 [info ] [Thread-1  ]: 24 of 39 START test not_null_fct_order_items_product_id ........................ [RUN]
[0m13:54:54.913948 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55, now test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc)
[0m13:54:54.914233 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:54:54.917674 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:54:54.918232 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:54:54.922083 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
[0m13:54:54.922461 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:54:54.922701 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id" cascade
[0m13:54:54.922927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.927847 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.928703 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
[0m13:54:54.929308 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:54:54.929564 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: BEGIN
[0m13:54:54.930083 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.930320 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:54:54.930555 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where product_id is null



  );
  
    
[0m13:54:54.932782 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.933392 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: COMMIT
[0m13:54:54.933634 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:54:54.933870 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: COMMIT
[0m13:54:54.934725 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.935138 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:54:54.935618 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:54:54.935857 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: BEGIN
[0m13:54:54.936268 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.936501 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:54:54.936746 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
    
      
    ) dbt_internal_test
[0m13:54:54.937412 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.938357 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: ROLLBACK
[0m13:54:54.938787 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: Close
[0m13:54:54.939431 [info ] [Thread-1  ]: 24 of 39 PASS not_null_fct_order_items_product_id .............................. [[32mPASS[0m in 0.03s]
[0m13:54:54.940118 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:54:54.940499 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:54:54.941060 [info ] [Thread-1  ]: 25 of 39 START test not_null_fct_order_items_quantity .......................... [RUN]
[0m13:54:54.941437 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc, now test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03)
[0m13:54:54.941695 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:54:54.945139 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:54:54.945615 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:54:54.950293 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
[0m13:54:54.950681 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:54:54.950922 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity" cascade
[0m13:54:54.951149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.956552 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.957299 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
[0m13:54:54.957810 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:54:54.958063 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: BEGIN
[0m13:54:54.958527 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.958784 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:54:54.959037 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where quantity is null



  );
  
    
[0m13:54:54.961130 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.961770 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: COMMIT
[0m13:54:54.962028 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:54:54.962263 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: COMMIT
[0m13:54:54.963132 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.963542 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:54:54.964013 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:54:54.964257 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: BEGIN
[0m13:54:54.964661 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.964890 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:54:54.965134 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
    
      
    ) dbt_internal_test
[0m13:54:54.965766 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.966682 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: ROLLBACK
[0m13:54:54.967236 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: Close
[0m13:54:54.967711 [info ] [Thread-1  ]: 25 of 39 PASS not_null_fct_order_items_quantity ................................ [[32mPASS[0m in 0.03s]
[0m13:54:54.968125 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:54:54.968415 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:54:54.968731 [info ] [Thread-1  ]: 26 of 39 START test not_null_fct_order_items_unit_price ........................ [RUN]
[0m13:54:54.969059 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03, now test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8)
[0m13:54:54.969309 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:54:54.972826 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:54:54.973375 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:54:54.977218 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
[0m13:54:54.977597 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:54:54.977838 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price" cascade
[0m13:54:54.978065 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:54.983000 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:54.983841 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
[0m13:54:54.984411 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:54:54.984653 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: BEGIN
[0m13:54:54.985184 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.985420 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:54:54.985655 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where unit_price is null



  );
  
    
[0m13:54:54.987806 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:54.988449 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: COMMIT
[0m13:54:54.988720 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:54:54.988962 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: COMMIT
[0m13:54:54.989749 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:54.990164 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:54:54.990646 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:54:54.990884 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: BEGIN
[0m13:54:54.991295 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:54.991535 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:54:54.991781 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
    
      
    ) dbt_internal_test
[0m13:54:54.992464 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:54.993433 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: ROLLBACK
[0m13:54:54.993980 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: Close
[0m13:54:54.994410 [info ] [Thread-1  ]: 26 of 39 PASS not_null_fct_order_items_unit_price .............................. [[32mPASS[0m in 0.03s]
[0m13:54:54.994804 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:54:54.995073 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:54:54.995327 [info ] [Thread-1  ]: 27 of 39 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:54:54.995664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8, now test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:54:54.995906 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:54:54.999293 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:54:54.999789 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:54:55.004424 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:54:55.004806 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:54:55.005045 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m13:54:55.005271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.009962 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:55.010782 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:54:55.011292 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:54:55.011521 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:54:55.013375 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:55.013749 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:54:55.014012 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m13:54:55.016812 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:54:55.017533 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:54:55.017795 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:54:55.018025 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:54:55.019199 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.019753 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:54:55.020354 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:54:55.020641 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:54:55.021280 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.021529 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:54:55.021777 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m13:54:55.022519 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:55.023496 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:54:55.023988 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:54:55.024418 [info ] [Thread-1  ]: 27 of 39 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.03s]
[0m13:54:55.024806 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:54:55.025072 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:54:55.025365 [info ] [Thread-1  ]: 28 of 39 START test not_null_fct_orders_order_date ............................. [RUN]
[0m13:54:55.025661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362)
[0m13:54:55.025905 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:54:55.029357 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:54:55.029870 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:54:55.033555 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:54:55.033954 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:54:55.034202 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m13:54:55.034431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.038904 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:54:55.039709 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:54:55.040321 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:54:55.040577 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:54:55.041081 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.041331 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:54:55.041579 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where order_date is null



  );
  
    
[0m13:54:55.043798 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:55.044441 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:54:55.044703 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:54:55.044938 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:54:55.045846 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.046327 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:54:55.046964 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:54:55.047230 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:54:55.047884 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.048138 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:54:55.048385 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m13:54:55.049257 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:55.050283 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m13:54:55.050915 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: Close
[0m13:54:55.051328 [info ] [Thread-1  ]: 28 of 39 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.03s]
[0m13:54:55.051701 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:54:55.051964 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:54:55.052243 [info ] [Thread-1  ]: 29 of 39 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:54:55.052524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0)
[0m13:54:55.052760 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:54:55.057090 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:54:55.057797 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:54:55.061653 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:54:55.062044 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:54:55.062281 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m13:54:55.062504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.068957 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:54:55.069755 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:54:55.070266 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:54:55.070514 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:54:55.071147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.071396 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:54:55.071646 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where order_id is null



  );
  
    
[0m13:54:55.074210 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:55.075040 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:54:55.075327 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:54:55.075572 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:54:55.076942 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.077479 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:54:55.078034 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:54:55.078289 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:54:55.078862 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.079111 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:54:55.079447 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:54:55.080274 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:55.081319 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:54:55.081853 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:54:55.082288 [info ] [Thread-1  ]: 29 of 39 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.03s]
[0m13:54:55.082676 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:54:55.082940 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:54:55.083192 [info ] [Thread-1  ]: 30 of 39 START test not_null_fct_orders_status ................................. [RUN]
[0m13:54:55.083563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_datamart.not_null_fct_orders_status.1455048989)
[0m13:54:55.083827 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:54:55.087298 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:54:55.087838 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:54:55.091801 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:54:55.092184 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:54:55.092422 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m13:54:55.092649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.096678 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:54:55.097513 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:54:55.098101 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:54:55.098352 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: BEGIN
[0m13:54:55.098907 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.099182 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:54:55.099440 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where status is null



  );
  
    
[0m13:54:55.101973 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:55.102657 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: COMMIT
[0m13:54:55.102917 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:54:55.103153 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: COMMIT
[0m13:54:55.104132 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.104558 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:54:55.105066 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:54:55.105309 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: BEGIN
[0m13:54:55.105763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.105991 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:54:55.106239 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m13:54:55.106872 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:55.107785 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: ROLLBACK
[0m13:54:55.108277 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: Close
[0m13:54:55.108673 [info ] [Thread-1  ]: 30 of 39 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.03s]
[0m13:54:55.109047 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:54:55.109311 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:54:55.109596 [info ] [Thread-1  ]: 31 of 39 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m13:54:55.109882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_status.1455048989, now test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:54:55.110122 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:54:55.114701 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:54:55.115545 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:54:55.122548 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:54:55.122958 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:54:55.123215 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m13:54:55.123457 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.128638 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:55.129436 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:54:55.129952 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:54:55.130202 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:54:55.130762 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.131001 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:54:55.131249 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m13:54:55.133477 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:55.134163 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:54:55.134438 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:54:55.134690 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:54:55.135655 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.136097 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:54:55.136630 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:54:55.136882 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:54:55.137667 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:55.137912 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:54:55.138168 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m13:54:55.139222 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:55.140214 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m13:54:55.140831 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m13:54:55.141330 [info ] [Thread-1  ]: 31 of 39 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.03s]
[0m13:54:55.141761 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:54:55.142069 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:54:55.142415 [info ] [Thread-1  ]: 32 of 39 START test relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [RUN]
[0m13:54:55.142819 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m13:54:55.143114 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:54:55.149598 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:54:55.150120 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:54:55.154966 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
[0m13:54:55.155388 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:54:55.155638 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79" cascade
[0m13:54:55.155877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.162680 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m13:54:55.163437 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
[0m13:54:55.163940 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:54:55.164196 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m13:54:55.164748 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.165007 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:54:55.165274 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
  
  
    as
  
  (
    
    
    

with child as (
    select order_id as from_field
    from "dbt_db_ex3"."public"."fct_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "dbt_db_ex3"."public"."fct_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:54:55.166548 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:54:55.167210 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: COMMIT
[0m13:54:55.167487 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:54:55.167774 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: COMMIT
[0m13:54:55.169759 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:54:55.170199 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:54:55.170721 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:54:55.170974 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m13:54:55.171812 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:54:55.172053 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:54:55.172317 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
    
      
    ) dbt_internal_test
[0m13:54:55.173500 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:55.174491 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: ROLLBACK
[0m13:54:55.175130 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: Close
[0m13:54:55.175550 [info ] [Thread-1  ]: 32 of 39 PASS relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [[32mPASS[0m in 0.03s]
[0m13:54:55.175952 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:54:55.176236 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:54:55.176544 [info ] [Thread-1  ]: 33 of 39 START test relationships_fct_order_items_product_id__product_id__ref_dim_products_  [RUN]
[0m13:54:55.176845 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m13:54:55.177110 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:54:55.181646 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:54:55.182129 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:54:55.186080 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
[0m13:54:55.186500 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:54:55.186764 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50" cascade
[0m13:54:55.187013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.192834 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:54:55.193620 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
[0m13:54:55.194143 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:54:55.194403 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m13:54:55.194966 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.195260 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:54:55.195548 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
  
  
    as
  
  (
    
    
    

with child as (
    select product_id as from_field
    from "dbt_db_ex3"."public"."fct_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "dbt_db_ex3"."public"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:54:55.196782 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:54:55.197450 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: COMMIT
[0m13:54:55.197723 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:54:55.197970 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: COMMIT
[0m13:54:55.198778 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.199191 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:54:55.199701 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:54:55.199963 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m13:54:55.200409 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.200661 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:54:55.200925 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
    
      
    ) dbt_internal_test
[0m13:54:55.201656 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:55.202646 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: ROLLBACK
[0m13:54:55.203110 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: Close
[0m13:54:55.203557 [info ] [Thread-1  ]: 33 of 39 PASS relationships_fct_order_items_product_id__product_id__ref_dim_products_  [[32mPASS[0m in 0.03s]
[0m13:54:55.203949 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:54:55.204221 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:54:55.204518 [info ] [Thread-1  ]: 34 of 39 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m13:54:55.204813 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:54:55.205060 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:54:55.209594 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:54:55.210127 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:54:55.214833 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:54:55.215239 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:54:55.215485 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m13:54:55.215722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.221721 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:54:55.222588 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:54:55.223116 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:54:55.223373 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:54:55.224109 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.224378 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:54:55.224652 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex3"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex3"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:54:55.225944 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:54:55.226608 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:54:55.226869 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:54:55.227111 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:54:55.227977 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.228442 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:54:55.229160 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:54:55.229437 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:54:55.229945 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.230186 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:54:55.230439 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m13:54:55.231186 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:55.232139 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m13:54:55.232790 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m13:54:55.233202 [info ] [Thread-1  ]: 34 of 39 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m13:54:55.233576 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:54:55.233861 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:54:55.234163 [info ] [Thread-1  ]: 35 of 39 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:54:55.234475 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:54:55.234724 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:54:55.239441 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:54:55.239903 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:54:55.243546 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:54:55.243918 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:54:55.244155 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m13:54:55.244379 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.251029 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m13:54:55.251870 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:54:55.252362 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:54:55.252607 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:54:55.253216 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.253452 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:54:55.253698 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m13:54:55.254903 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:54:55.255558 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:54:55.255820 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:54:55.256059 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:54:55.257049 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.257457 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:54:55.257939 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:54:55.258174 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:54:55.258624 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.258865 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:54:55.259112 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:54:55.260067 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:55.261075 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:54:55.261565 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:54:55.261984 [info ] [Thread-1  ]: 35 of 39 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m13:54:55.262362 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:54:55.262628 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:54:55.262916 [info ] [Thread-1  ]: 36 of 39 START test unique_dim_customers_email ................................. [RUN]
[0m13:54:55.263209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8)
[0m13:54:55.263452 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:54:55.266812 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:54:55.267318 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:54:55.272071 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:54:55.272449 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:54:55.272689 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m13:54:55.272917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.278616 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:54:55.279398 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:54:55.279902 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:54:55.280150 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:54:55.280747 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.281001 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:54:55.281279 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m13:54:55.283836 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:54:55.284509 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:54:55.284773 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:54:55.285012 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:54:55.285964 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.286424 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:54:55.286932 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:54:55.287172 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:54:55.287727 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.287971 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:54:55.288218 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:54:55.288786 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:55.289727 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m13:54:55.290234 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: Close
[0m13:54:55.290661 [info ] [Thread-1  ]: 36 of 39 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.03s]
[0m13:54:55.291060 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:54:55.291339 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:54:55.291647 [info ] [Thread-1  ]: 37 of 39 START test unique_dim_products_product_id ............................. [RUN]
[0m13:54:55.291952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8, now test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985)
[0m13:54:55.292203 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:54:55.295637 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:54:55.296150 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:54:55.300035 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:54:55.300462 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:54:55.300744 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m13:54:55.300990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.306648 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:54:55.307476 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:54:55.308075 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:54:55.308329 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:54:55.308828 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.309074 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:54:55.309322 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m13:54:55.310524 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:54:55.311140 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:54:55.311392 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:54:55.311626 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:54:55.312487 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.312886 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:54:55.313403 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:54:55.313666 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:54:55.314182 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.314446 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:54:55.314696 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:54:55.315433 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:55.316428 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:54:55.316953 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:54:55.317450 [info ] [Thread-1  ]: 37 of 39 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m13:54:55.317845 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:54:55.318113 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:54:55.318431 [info ] [Thread-1  ]: 38 of 39 START test unique_fct_order_items_order_item_id ....................... [RUN]
[0m13:54:55.318758 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768)
[0m13:54:55.319013 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:54:55.322421 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:54:55.322902 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:54:55.327480 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
[0m13:54:55.327868 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:54:55.328102 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id" cascade
[0m13:54:55.328329 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.334482 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:54:55.335211 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
[0m13:54:55.335693 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:54:55.335942 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: BEGIN
[0m13:54:55.336507 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.336749 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:54:55.337001 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
  
  
    as
  
  (
    
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."fct_order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



  );
  
    
[0m13:54:55.338334 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:54:55.338990 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: COMMIT
[0m13:54:55.339256 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:54:55.339495 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: COMMIT
[0m13:54:55.340479 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.340946 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:54:55.341452 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:54:55.341692 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: BEGIN
[0m13:54:55.342163 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.342393 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:54:55.342635 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m13:54:55.343234 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:55.344182 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: ROLLBACK
[0m13:54:55.344610 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: Close
[0m13:54:55.345016 [info ] [Thread-1  ]: 38 of 39 PASS unique_fct_order_items_order_item_id ............................. [[32mPASS[0m in 0.03s]
[0m13:54:55.345395 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:54:55.345661 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:54:55.345985 [info ] [Thread-1  ]: 39 of 39 START test unique_fct_orders_order_id ................................. [RUN]
[0m13:54:55.346298 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768, now test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5)
[0m13:54:55.346545 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:54:55.349864 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:54:55.350377 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:54:55.354166 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:54:55.354544 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:54:55.354773 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m13:54:55.354993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:55.360094 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:54:55.360890 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:54:55.361464 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:54:55.361710 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:54:55.362258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.362498 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:54:55.362741 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m13:54:55.363858 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:54:55.364488 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:54:55.364748 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:54:55.364986 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:54:55.365813 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:55.366215 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:54:55.366730 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:54:55.366967 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:54:55.367459 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:54:55.367695 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:54:55.367931 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:54:55.368516 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:54:55.369431 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m13:54:55.369898 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: Close
[0m13:54:55.370293 [info ] [Thread-1  ]: 39 of 39 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m13:54:55.370672 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:54:55.371495 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.371722 [debug] [MainThread]: On master: BEGIN
[0m13:54:55.371920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:55.376302 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:54:55.376573 [debug] [MainThread]: On master: COMMIT
[0m13:54:55.376785 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:55.376980 [debug] [MainThread]: On master: COMMIT
[0m13:54:55.377418 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:55.377642 [debug] [MainThread]: On master: Close
[0m13:54:55.377922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:55.378120 [debug] [MainThread]: Connection 'test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m13:54:55.378378 [info ] [MainThread]: 
[0m13:54:55.378606 [info ] [MainThread]: Finished running 39 data tests in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m13:54:55.381914 [debug] [MainThread]: Command end result
[0m13:54:55.410509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:54:55.411626 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:54:55.416875 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:54:55.417107 [info ] [MainThread]: 
[0m13:54:55.417339 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:54:55.417530 [info ] [MainThread]: 
[0m13:54:55.417755 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:55.417938 [info ] [MainThread]: 
[0m13:54:55.418150 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:55.418329 [info ] [MainThread]: 
[0m13:54:55.418538 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:55.418716 [info ] [MainThread]: 
[0m13:54:55.418926 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:55.419107 [info ] [MainThread]: 
[0m13:54:55.419330 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:55.419518 [info ] [MainThread]: 
[0m13:54:55.419740 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:55.419922 [info ] [MainThread]: 
[0m13:54:55.420125 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:55.420324 [info ] [MainThread]: 
[0m13:54:55.420587 [error] [MainThread]:   Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:54:55.420843 [info ] [MainThread]: 
[0m13:54:55.421060 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=8 SKIP=0 TOTAL=39
[0m13:54:55.422032 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.8126627, "process_in_blocks": "0", "process_kernel_time": 0.174084, "process_mem_max_rss": "127598592", "process_out_blocks": "0", "process_user_time": 2.161188}
[0m13:54:55.422282 [debug] [MainThread]: Command `dbt test` failed at 13:54:55.422234 after 1.81 seconds
[0m13:54:55.422510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f8d00>]}
[0m13:54:55.422744 [debug] [MainThread]: Flushing usage events
[0m13:54:56.395609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:57.495885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063ae20>]}


============================== 13:54:57.498829 | e0052b4b-9e1c-428e-9e39-5f24ac24c5e9 ==============================
[0m13:54:57.498829 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:54:57.499218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select mart.dimensions.*', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:54:57.636686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0052b4b-9e1c-428e-9e39-5f24ac24c5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ef640>]}
[0m13:54:57.683736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0052b4b-9e1c-428e-9e39-5f24ac24c5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110602eb0>]}
[0m13:54:57.684343 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:54:57.759451 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:54:57.865733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:57.866030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:57.906086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0052b4b-9e1c-428e-9e39-5f24ac24c5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113cdfa0>]}
[0m13:54:58.020426 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:54:58.023830 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:54:58.033687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0052b4b-9e1c-428e-9e39-5f24ac24c5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110995580>]}
[0m13:54:58.034072 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:54:58.034306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0052b4b-9e1c-428e-9e39-5f24ac24c5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113906d0>]}
[0m13:54:58.035552 [info ] [MainThread]: 
[0m13:54:58.035807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:58.036001 [info ] [MainThread]: 
[0m13:54:58.036322 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:58.038972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:54:58.066146 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:54:58.066440 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:54:58.066632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:58.081676 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.015 seconds
[0m13:54:58.082551 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:54:58.083994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:54:58.088664 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:54:58.088925 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:54:58.089114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:58.094909 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:54:58.095262 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:54:58.095632 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:54:58.098322 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m13:54:58.099590 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:54:58.100064 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:54:58.106188 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.106456 [debug] [MainThread]: On master: BEGIN
[0m13:54:58.106648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:58.110395 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:54:58.110656 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.110920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:58.115035 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:54:58.116167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0052b4b-9e1c-428e-9e39-5f24ac24c5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109d44f0>]}
[0m13:54:58.116525 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:58.117128 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.117358 [debug] [MainThread]: On master: BEGIN
[0m13:54:58.118153 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:54:58.118399 [debug] [MainThread]: On master: COMMIT
[0m13:54:58.118601 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.118788 [debug] [MainThread]: On master: COMMIT
[0m13:54:58.119304 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:58.119519 [debug] [MainThread]: On master: Close
[0m13:54:58.120756 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:54:58.121139 [info ] [Thread-1  ]: 1 of 3 START sql table model public.dim_customers_mart ......................... [RUN]
[0m13:54:58.121460 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_customers_mart)
[0m13:54:58.121699 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:54:58.128593 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:58.129159 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:54:58.155437 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:58.156082 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:58.156306 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: BEGIN
[0m13:54:58.156515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:58.164240 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:54:58.164521 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:58.164778 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex3"."public"."dim_customers"
),

customer_segments as (
    select
        customer_id,
        case
            when lifetime_value >= 1000000 then 'VIP'
            when lifetime_value >= 500000 then 'High Value'
            when lifetime_value >= 100000 then 'Medium Value'
            else 'Low Value'
        end as customer_segment,
        case
            when lifetime_orders >= 10 then 'Frequent'
            when lifetime_orders >= 5 then 'Regular'
            when lifetime_orders >= 2 then 'Occasional'
            else 'One-time'
        end as purchase_frequency,
        case
            when extract(day from (current_date - most_recent_order_date)) <= 30 then 'Active'
            when extract(day from (current_date - most_recent_order_date)) <= 90 then 'Recent'
            when extract(day from (current_date - most_recent_order_date)) <= 180 then 'Lapsed'
            else 'Inactive'
        end as customer_status
    from customers
    where lifetime_orders > 0
)

select
    c.*,
    coalesce(cs.customer_segment, 'New') as customer_segment,
    coalesce(cs.purchase_frequency, 'None') as purchase_frequency,
    coalesce(cs.customer_status, 'New') as customer_status,
    case
        when cs.customer_segment = 'VIP' and cs.customer_status = 'Active' then true
        else false
    end as is_high_value_active
from customers c
left join customer_segments cs using (customer_id)
  );
  
[0m13:54:58.169714 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.005 seconds
[0m13:54:58.177778 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:58.178125 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */
alter table "dbt_db_ex3"."public"."dim_customers_mart" rename to "dim_customers_mart__dbt_backup"
[0m13:54:58.179155 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:58.181674 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:58.181981 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */
alter table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp" rename to "dim_customers_mart"
[0m13:54:58.183365 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:58.194330 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: COMMIT
[0m13:54:58.194594 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:58.194847 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: COMMIT
[0m13:54:58.196580 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:58.201097 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_customers_mart__dbt_backup"
[0m13:54:58.203767 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:54:58.204011 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_customers_mart__dbt_backup" cascade
[0m13:54:58.208186 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:54:58.209962 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: Close
[0m13:54:58.211397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0052b4b-9e1c-428e-9e39-5f24ac24c5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e4730>]}
[0m13:54:58.211838 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.dim_customers_mart .................... [[32mSELECT 10[0m in 0.09s]
[0m13:54:58.212222 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:54:58.212485 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:54:58.212824 [info ] [Thread-1  ]: 2 of 3 START sql table model public.dim_date ................................... [RUN]
[0m13:54:58.213117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now model.ecommerce_datamart.dim_date)
[0m13:54:58.213356 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:54:58.227861 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:58.228192 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:54:58.228409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:58.235641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:54:58.235946 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:58.236193 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:54:58.237132 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:54:58.245247 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:54:58.245767 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:54:58.249580 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_date"
[0m13:54:58.250090 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:58.250416 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

-- Generate a date series from 2020-01-01 to 2025-12-31
with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2191
    order by generated_number



),

all_periods as (

    select (
        

    cast('2020-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as date)

)

select * from filtered


),

dates as (
    select
        cast(date_day as date) as date_key,
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dow from date_day) as day_of_week,
        extract(doy from date_day) as day_of_year,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Day') as day_name,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when extract(month from date_day) in (1, 2, 3) then 'Q1'
            when extract(month from date_day) in (4, 5, 6) then 'Q2'
            when extract(month from date_day) in (7, 8, 9) then 'Q3'
            else 'Q4'
        end as quarter_name
    from date_spine
)

select * from dates
  );
  
[0m13:54:58.269419 [debug] [Thread-1  ]: SQL status: SELECT 2191 in 0.019 seconds
[0m13:54:58.272857 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:58.273153 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m13:54:58.273883 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:58.276653 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:58.276941 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:54:58.277607 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:58.278530 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:54:58.278807 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:58.279056 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:54:58.280236 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:58.282562 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_date__dbt_backup"
[0m13:54:58.282982 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:54:58.283250 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
drop table if exists "dbt_db_ex3"."public"."dim_date__dbt_backup" cascade
[0m13:54:58.284770 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:58.285680 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:54:58.286126 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0052b4b-9e1c-428e-9e39-5f24ac24c5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107729160>]}
[0m13:54:58.286595 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.dim_date .............................. [[32mSELECT 2191[0m in 0.07s]
[0m13:54:58.287014 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:54:58.287299 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:54:58.287671 [info ] [Thread-1  ]: 3 of 3 START sql table model public.dim_products_mart .......................... [RUN]
[0m13:54:58.288025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.dim_products_mart)
[0m13:54:58.288345 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:54:58.291642 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:54:58.292241 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:54:58.295553 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products_mart"
[0m13:54:58.296074 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:58.296326 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: BEGIN
[0m13:54:58.296556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:54:58.299989 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:54:58.301229 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:58.301566 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex3"."public"."dim_products"
)

select
    p.*,
    case
        when total_quantity_sold > 100 then 'High Selling'
        when total_quantity_sold > 50 then 'Medium Selling'
        when total_quantity_sold > 0 then 'Low Selling'
        else 'Not Selling'
    end as sales_performance,
    case
        when total_revenue > 10000000 then 'High Revenue'
        when total_revenue > 5000000 then 'Medium Revenue'
        when total_revenue > 0 then 'Low Revenue'
        else 'No Revenue'
    end as revenue_tier,
    (total_revenue / nullif(total_quantity_sold, 0)) as average_selling_price,
    case
        when is_active = true and inventory_status != 'Out of stock' then true
        else false
    end as is_available_for_purchase,
    case
        when is_active = false then 'Discontinued'
        when inventory_status = 'Out of stock' then 'Temporarily Unavailable'
        else 'Available'
    end as availability_status
from products p
  );
  
[0m13:54:58.305396 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.003 seconds
[0m13:54:58.308449 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:58.308747 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart" rename to "dim_products_mart__dbt_backup"
[0m13:54:58.309669 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:58.312359 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:58.312784 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp" rename to "dim_products_mart"
[0m13:54:58.313526 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:58.314444 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:54:58.314700 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:58.314927 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:54:58.316017 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:54:58.318307 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products_mart__dbt_backup"
[0m13:54:58.318693 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:54:58.318953 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_products_mart__dbt_backup" cascade
[0m13:54:58.320211 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:54:58.321049 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: Close
[0m13:54:58.321439 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0052b4b-9e1c-428e-9e39-5f24ac24c5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107729160>]}
[0m13:54:58.321856 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public.dim_products_mart ..................... [[32mSELECT 15[0m in 0.03s]
[0m13:54:58.322218 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:54:58.322879 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.323102 [debug] [MainThread]: On master: BEGIN
[0m13:54:58.323294 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:58.326820 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:54:58.327086 [debug] [MainThread]: On master: COMMIT
[0m13:54:58.327284 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.327471 [debug] [MainThread]: On master: COMMIT
[0m13:54:58.327858 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:58.328196 [debug] [MainThread]: On master: Close
[0m13:54:58.328527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:58.328722 [debug] [MainThread]: Connection 'model.ecommerce_datamart.dim_products_mart' was properly closed.
[0m13:54:58.328974 [info ] [MainThread]: 
[0m13:54:58.329200 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m13:54:58.329788 [debug] [MainThread]: Command end result
[0m13:54:58.357522 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:54:58.358605 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:54:58.362442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:54:58.362652 [info ] [MainThread]: 
[0m13:54:58.362913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:58.363118 [info ] [MainThread]: 
[0m13:54:58.363332 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:54:58.364369 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.91970444, "process_in_blocks": "0", "process_kernel_time": 0.143079, "process_mem_max_rss": "125517824", "process_out_blocks": "0", "process_user_time": 1.543628}
[0m13:54:58.364618 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:58.364568 after 0.92 seconds
[0m13:54:58.364851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110995580>]}
[0m13:54:58.365094 [debug] [MainThread]: Flushing usage events
[0m13:54:59.700696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:00.842450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073ae80>]}


============================== 13:55:00.845000 | fdaf7d52-56b1-4bc0-81b8-5268960bfbac ==============================
[0m13:55:00.845000 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:55:00.845376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select mart.facts.*', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:55:00.969897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdaf7d52-56b1-4bc0-81b8-5268960bfbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a45fa0>]}
[0m13:55:01.016709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdaf7d52-56b1-4bc0-81b8-5268960bfbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ca190>]}
[0m13:55:01.017321 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:01.095267 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:55:01.202337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:01.202625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:01.242129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdaf7d52-56b1-4bc0-81b8-5268960bfbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111561ee0>]}
[0m13:55:01.354633 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:55:01.357274 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:55:01.366618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdaf7d52-56b1-4bc0-81b8-5268960bfbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111524580>]}
[0m13:55:01.366957 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:55:01.367191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdaf7d52-56b1-4bc0-81b8-5268960bfbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155ce50>]}
[0m13:55:01.368318 [info ] [MainThread]: 
[0m13:55:01.368560 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:01.368838 [info ] [MainThread]: 
[0m13:55:01.369174 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:01.371870 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:55:01.404597 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:55:01.404906 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:55:01.405114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:01.418748 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m13:55:01.419576 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:55:01.421014 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:55:01.425478 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:01.425778 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:55:01.425972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:01.432184 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:55:01.432815 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:01.433083 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:01.437229 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.004 seconds
[0m13:55:01.438583 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:55:01.439237 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:55:01.444832 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:01.445091 [debug] [MainThread]: On master: BEGIN
[0m13:55:01.445288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:01.449085 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:55:01.449399 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:01.449673 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:01.453533 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:55:01.454587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdaf7d52-56b1-4bc0-81b8-5268960bfbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ca4f0>]}
[0m13:55:01.454901 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:01.455377 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:01.455609 [debug] [MainThread]: On master: BEGIN
[0m13:55:01.456242 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:55:01.456452 [debug] [MainThread]: On master: COMMIT
[0m13:55:01.456643 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:01.456842 [debug] [MainThread]: On master: COMMIT
[0m13:55:01.457298 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:01.457520 [debug] [MainThread]: On master: Close
[0m13:55:01.458743 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_customer_retention
[0m13:55:01.459155 [info ] [Thread-1  ]: 1 of 3 START sql table model public.fct_customer_retention ..................... [RUN]
[0m13:55:01.459498 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.fct_customer_retention)
[0m13:55:01.459762 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_customer_retention
[0m13:55:01.467294 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:01.467916 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_customer_retention
[0m13:55:01.494555 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:01.495152 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:01.495383 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: BEGIN
[0m13:55:01.495591 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:01.504375 [debug] [Thread-1  ]: SQL status: BEGIN in 0.009 seconds
[0m13:55:01.504699 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:01.505019 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_customer_retention__dbt_tmp"
  
  
    as
  
  (
    

with customer_orders as (
    select
        customer_id,
        order_id,
        order_date,
        total_amount,
        row_number() over(partition by customer_id order by order_date) as order_sequence,
        lead(order_date) over(partition by customer_id order by order_date) as next_order_date,
        extract(day from (lead(order_date) over(partition by customer_id order by order_date) - order_date)) as days_until_next_order
    from "dbt_db_ex3"."public"."fct_orders"
),

customer_first_orders as (
    select
        customer_id,
        min(case when order_sequence = 1 then order_date end) as first_order_date,
        extract(year from min(case when order_sequence = 1 then order_date end)) as first_order_year,
        extract(month from min(case when order_sequence = 1 then order_date end)) as first_order_month,
        to_char(min(case when order_sequence = 1 then order_date end), 'YYYY-MM') as first_order_year_month
    from customer_orders
    group by 1
),

repeat_purchase_facts as (
    select
        c.customer_id,
        c.first_order_date,
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        count(distinct case when co.order_sequence > 1 then co.order_id end) as repeat_orders,
        max(co.order_sequence) as total_orders,
        sum(case when co.order_sequence > 1 then co.total_amount else 0 end) as repeat_order_revenue,
        min(case when co.order_sequence = 2 then co.order_date end) as second_order_date,
        avg(co.days_until_next_order) as avg_days_between_orders
    from customer_first_orders c
    left join customer_orders co using (customer_id)
    group by 1, 2, 3, 4, 5
),

cohort_sizes as (
    select
        first_order_year,
        first_order_month,
        first_order_year_month,
        count(distinct customer_id) as cohort_size
    from customer_first_orders
    group by 1, 2, 3
),

retention_by_month as (
    select
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        cs.cohort_size,
        date_part('month', age(date_trunc('month', o.order_date), 
                              date_trunc('month', c.first_order_date))) as months_since_first_order,
        count(distinct o.customer_id) as retained_customers,
        sum(o.total_amount) as cohort_revenue
    from customer_first_orders c
    join "dbt_db_ex3"."public"."fct_orders" o using(customer_id)
    join cohort_sizes cs 
        on c.first_order_year = cs.first_order_year 
        and c.first_order_month = cs.first_order_month
    where o.order_date > c.first_order_date
    group by 1, 2, 3, 4, 5
)

select
    r.first_order_year,
    r.first_order_month,
    r.first_order_year_month as cohort,
    r.cohort_size,
    r.months_since_first_order,
    r.retained_customers,
    r.cohort_revenue,
    (r.retained_customers::float / r.cohort_size) * 100 as retention_rate,
    (r.cohort_revenue::float / r.retained_customers) as revenue_per_retained_customer,
    sum(r.retained_customers) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_retained_customers,
    sum(r.cohort_revenue) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_cohort_revenue,
    current_timestamp as updated_at
from retention_by_month r
order by r.first_order_year, r.first_order_month, r.months_since_first_order
  );
  
[0m13:55:01.511197 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.006 seconds
[0m13:55:01.519720 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:01.520083 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
alter table "dbt_db_ex3"."public"."fct_customer_retention" rename to "fct_customer_retention__dbt_backup"
[0m13:55:01.520937 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:01.523586 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:01.523867 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
alter table "dbt_db_ex3"."public"."fct_customer_retention__dbt_tmp" rename to "fct_customer_retention"
[0m13:55:01.524601 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:01.536008 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: COMMIT
[0m13:55:01.536301 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:01.536530 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: COMMIT
[0m13:55:01.538518 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:55:01.542985 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_customer_retention__dbt_backup"
[0m13:55:01.545826 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:01.546083 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
drop table if exists "dbt_db_ex3"."public"."fct_customer_retention__dbt_backup" cascade
[0m13:55:01.549706 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:55:01.551402 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: Close
[0m13:55:01.552602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdaf7d52-56b1-4bc0-81b8-5268960bfbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a65790>]}
[0m13:55:01.553047 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.fct_customer_retention ................ [[32mSELECT 18[0m in 0.09s]
[0m13:55:01.553435 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_customer_retention
[0m13:55:01.553701 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_daily_sales
[0m13:55:01.554052 [info ] [Thread-1  ]: 2 of 3 START sql table model public.fct_daily_sales ............................ [RUN]
[0m13:55:01.554360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_customer_retention, now model.ecommerce_datamart.fct_daily_sales)
[0m13:55:01.554608 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_daily_sales
[0m13:55:01.557847 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:01.558331 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_daily_sales
[0m13:55:01.561295 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:01.561757 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:01.561990 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: BEGIN
[0m13:55:01.562209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:01.567336 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:55:01.567620 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:01.567941 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

with order_facts as (
    select
        date_trunc('day', order_date) as order_day,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as customers_count,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        sum(total_amount - shipping_cost) as total_product_revenue,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1
),

product_category_facts as (
    select
        date_trunc('day', order_date) as order_day,
        product_category,
        count(distinct order_id) as category_orders_count,
        sum(item_total) as category_revenue,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2
)

select
    d.date_key,
    d.year,
    d.month,
    d.quarter,
    d.day_of_month,
    d.day_of_week,
    d.is_weekend,
    d.month_name,
    coalesce(o.orders_count, 0) as orders_count,
    coalesce(o.customers_count, 0) as customers_count,
    coalesce(o.total_sales_amount, 0) as total_sales_amount,
    coalesce(o.total_shipping_cost, 0) as total_shipping_cost,
    coalesce(o.total_product_revenue, 0) as total_product_revenue,
    coalesce(o.average_order_value, 0) as average_order_value,
    coalesce(o.total_items_sold, 0) as total_items_sold,
    -- Metrics specific to each product category
    coalesce(pc_electronics.category_revenue, 0) as electronics_revenue,
    coalesce(pc_clothing.category_revenue, 0) as clothing_revenue,
    coalesce(pc_footwear.category_revenue, 0) as footwear_revenue,
    coalesce(pc_accessories.category_revenue, 0) as accessories_revenue,
    -- Calculated metrics
    case 
        when coalesce(o.orders_count, 0) = 0 then 0
        else coalesce(o.customers_count, 0)::float / o.orders_count 
    end as customers_per_order_ratio,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."dim_date" d
left join order_facts o on d.date_key = o.order_day
left join product_category_facts pc_electronics 
    on d.date_key = pc_electronics.order_day and pc_electronics.product_category = 'Electronics'
left join product_category_facts pc_clothing 
    on d.date_key = pc_clothing.order_day and pc_clothing.product_category = 'Clothing'
left join product_category_facts pc_footwear 
    on d.date_key = pc_footwear.order_day and pc_footwear.product_category = 'Footwear'
left join product_category_facts pc_accessories 
    on d.date_key = pc_accessories.order_day and pc_accessories.product_category = 'Accessories'
where d.date_key <= current_date
  );
  
[0m13:55:01.575440 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.007 seconds
[0m13:55:01.579385 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:01.579679 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
alter table "dbt_db_ex3"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m13:55:01.580353 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:01.582983 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:01.583283 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
alter table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m13:55:01.584163 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:01.585152 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:55:01.585417 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:01.585655 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:55:01.586801 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:55:01.588969 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup"
[0m13:55:01.589356 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:01.589605 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup" cascade
[0m13:55:01.591091 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:55:01.591982 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: Close
[0m13:55:01.592393 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdaf7d52-56b1-4bc0-81b8-5268960bfbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b20a0>]}
[0m13:55:01.592850 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 1959[0m in 0.04s]
[0m13:55:01.593227 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_daily_sales
[0m13:55:01.593493 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:01.593843 [info ] [Thread-1  ]: 3 of 3 START sql incremental model public.fct_monthly_sales .................... [RUN]
[0m13:55:01.594141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_daily_sales, now model.ecommerce_datamart.fct_monthly_sales)
[0m13:55:01.594382 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:01.602009 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:01.602533 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:01.624730 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:01.625165 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

    
  
    

  create temporary table "fct_monthly_sales__dbt_tmp135501620797"
  
  
    as
  
  (
    

with monthly_order_facts as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        to_char(order_date, 'YYYY-MM') as year_month,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as unique_customers,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold,
        count(distinct case when status = 'completed' then order_id end) as completed_orders,
        count(distinct case when status = 'cancelled' then order_id end) as cancelled_orders
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1, 2, 3
),

monthly_product_category_sales as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        product_category,
        sum(item_total) as category_sales,
        count(distinct order_id) as category_orders,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2, 3
),

monthly_new_customers as (
    select
        extract(year from first_order_date) as year,
        extract(month from first_order_date) as month,
        count(distinct customer_id) as new_customers
    from "dbt_db_ex3"."public"."dim_customers"
    where first_order_date is not null
    group by 1, 2
)

select
    m.year,
    m.month,
    m.year_month,
    m.orders_count,
    m.unique_customers,
    m.total_sales_amount,
    m.total_shipping_cost,
    m.average_order_value,
    m.total_items_sold,
    m.completed_orders,
    m.cancelled_orders,
    coalesce(pc_electronics.category_sales, 0) as electronics_sales,
    coalesce(pc_clothing.category_sales, 0) as clothing_sales,
    coalesce(pc_footwear.category_sales, 0) as footwear_sales,
    coalesce(pc_accessories.category_sales, 0) as accessories_sales,
    coalesce(pc_electronics.category_items_sold, 0) as electronics_items_sold,
    coalesce(pc_clothing.category_items_sold, 0) as clothing_items_sold,
    coalesce(pc_footwear.category_items_sold, 0) as footwear_items_sold,
    coalesce(pc_accessories.category_items_sold, 0) as accessories_items_sold,
    coalesce(nc.new_customers, 0) as new_customers,
    case 
        when m.orders_count = 0 then 0
        else (m.cancelled_orders::float / m.orders_count) * 100
    end as cancellation_rate,
    case
        when lag(m.total_sales_amount) over (order by m.year, m.month) = 0 then null
        else (m.total_sales_amount - lag(m.total_sales_amount) over (order by m.year, m.month)) / 
             lag(m.total_sales_amount) over (order by m.year, m.month) * 100
    end as sales_growth_pct,
    current_timestamp as updated_at
from monthly_order_facts m
left join monthly_new_customers nc on m.year = nc.year and m.month = nc.month
left join monthly_product_category_sales pc_electronics 
    on m.year = pc_electronics.year and m.month = pc_electronics.month and pc_electronics.product_category = 'Electronics'
left join monthly_product_category_sales pc_clothing 
    on m.year = pc_clothing.year and m.month = pc_clothing.month and pc_clothing.product_category = 'Clothing'
left join monthly_product_category_sales pc_footwear 
    on m.year = pc_footwear.year and m.month = pc_footwear.month and pc_footwear.product_category = 'Footwear'
left join monthly_product_category_sales pc_accessories 
    on m.year = pc_accessories.year and m.month = pc_accessories.month and pc_accessories.product_category = 'Accessories'


where m.year || '-' || lpad(m.month::text, 2, '0') >= (select max(year || '-' || lpad(month::text, 2, '0')) from "dbt_db_ex3"."public"."fct_monthly_sales")

  );
  
  
[0m13:55:01.625502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:01.637321 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.012 seconds
[0m13:55:01.649192 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:01.649677 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: BEGIN
[0m13:55:01.650387 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:55:01.650652 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:01.650904 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_monthly_sales__dbt_tmp135501620797'
        
      order by ordinal_position

  
[0m13:55:01.656323 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.005 seconds
[0m13:55:01.661120 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:01.661459 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'fct_monthly_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:55:01.664015 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.002 seconds
[0m13:55:01.670753 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:01.671102 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'fct_monthly_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:55:01.674303 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.003 seconds
[0m13:55:01.686458 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:01.687100 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:01.687383 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      
        delete from "dbt_db_ex3"."public"."fct_monthly_sales" as DBT_INTERNAL_DEST
        where (year, month) in (
            select distinct year, month
            from "fct_monthly_sales__dbt_tmp135501620797" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dbt_db_ex3"."public"."fct_monthly_sales" ("year", "month", "year_month", "orders_count", "unique_customers", "total_sales_amount", "total_shipping_cost", "average_order_value", "total_items_sold", "completed_orders", "cancelled_orders", "electronics_sales", "clothing_sales", "footwear_sales", "accessories_sales", "electronics_items_sold", "clothing_items_sold", "footwear_items_sold", "accessories_items_sold", "new_customers", "cancellation_rate", "sales_growth_pct", "updated_at")
    (
        select "year", "month", "year_month", "orders_count", "unique_customers", "total_sales_amount", "total_shipping_cost", "average_order_value", "total_items_sold", "completed_orders", "cancelled_orders", "electronics_sales", "clothing_sales", "footwear_sales", "accessories_sales", "electronics_items_sold", "clothing_items_sold", "footwear_items_sold", "accessories_items_sold", "new_customers", "cancellation_rate", "sales_growth_pct", "updated_at"
        from "fct_monthly_sales__dbt_tmp135501620797"
    )
  
[0m13:55:01.688521 [debug] [Thread-1  ]: SQL status: INSERT 0 1 in 0.001 seconds
[0m13:55:01.689397 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:55:01.689652 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:01.689873 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:55:01.690631 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:55:01.691157 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: Close
[0m13:55:01.691557 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdaf7d52-56b1-4bc0-81b8-5268960bfbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b20a0>]}
[0m13:55:01.691980 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model public.fct_monthly_sales ............... [[32mINSERT 0 1[0m in 0.10s]
[0m13:55:01.692347 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:01.693040 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:01.693283 [debug] [MainThread]: On master: BEGIN
[0m13:55:01.693479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:01.696700 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:55:01.696980 [debug] [MainThread]: On master: COMMIT
[0m13:55:01.697194 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:01.697395 [debug] [MainThread]: On master: COMMIT
[0m13:55:01.697777 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:01.698010 [debug] [MainThread]: On master: Close
[0m13:55:01.698308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:01.698551 [debug] [MainThread]: Connection 'model.ecommerce_datamart.fct_monthly_sales' was properly closed.
[0m13:55:01.698820 [info ] [MainThread]: 
[0m13:55:01.699053 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m13:55:01.699647 [debug] [MainThread]: Command end result
[0m13:55:01.728043 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:55:01.729179 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:55:01.733639 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:55:01.733901 [info ] [MainThread]: 
[0m13:55:01.734162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:01.734388 [info ] [MainThread]: 
[0m13:55:01.734611 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:55:01.735582 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9434334, "process_in_blocks": "0", "process_kernel_time": 0.162845, "process_mem_max_rss": "126402560", "process_out_blocks": "0", "process_user_time": 1.591594}
[0m13:55:01.735823 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:01.735778 after 0.94 seconds
[0m13:55:01.736048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a92cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a97c0>]}
[0m13:55:01.736275 [debug] [MainThread]: Flushing usage events
[0m13:55:03.632336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:04.773072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e2ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e2e80>]}


============================== 13:55:04.775900 | 504665a8-e468-4238-9984-e934c9dc6254 ==============================
[0m13:55:04.775900 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:55:04.776282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select mart.metrics.*', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:55:04.904934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '504665a8-e468-4238-9984-e934c9dc6254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863dfa0>]}
[0m13:55:04.951591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '504665a8-e468-4238-9984-e934c9dc6254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108271190>]}
[0m13:55:04.952194 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:05.030754 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:55:05.136766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:05.137054 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:05.176817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '504665a8-e468-4238-9984-e934c9dc6254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109075ee0>]}
[0m13:55:05.310660 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:55:05.313940 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:55:05.324619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '504665a8-e468-4238-9984-e934c9dc6254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109038580>]}
[0m13:55:05.325024 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:55:05.325264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '504665a8-e468-4238-9984-e934c9dc6254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109077f40>]}
[0m13:55:05.326515 [info ] [MainThread]: 
[0m13:55:05.326760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:05.326956 [info ] [MainThread]: 
[0m13:55:05.327283 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:05.330143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:55:05.358413 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:55:05.358815 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:55:05.359027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:05.376888 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.018 seconds
[0m13:55:05.377875 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:55:05.379664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:55:05.385088 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:05.385402 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:55:05.385600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:05.390163 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:55:05.390490 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:05.390717 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:05.392994 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m13:55:05.394239 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:55:05.394894 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:55:05.401300 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:05.401597 [debug] [MainThread]: On master: BEGIN
[0m13:55:05.401793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:05.407741 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:55:05.408043 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:05.408318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:05.413064 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:55:05.414251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '504665a8-e468-4238-9984-e934c9dc6254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109443760>]}
[0m13:55:05.414581 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:05.415195 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:05.415407 [debug] [MainThread]: On master: BEGIN
[0m13:55:05.416286 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:55:05.416557 [debug] [MainThread]: On master: COMMIT
[0m13:55:05.416768 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:05.416966 [debug] [MainThread]: On master: COMMIT
[0m13:55:05.417529 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:05.417756 [debug] [MainThread]: On master: Close
[0m13:55:05.419140 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_customer_retention
[0m13:55:05.419613 [info ] [Thread-1  ]: 1 of 3 START sql table model public.metric_customer_retention .................. [RUN]
[0m13:55:05.419972 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.metric_customer_retention)
[0m13:55:05.420214 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_customer_retention
[0m13:55:05.427339 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:55:05.427945 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_customer_retention
[0m13:55:05.457476 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:55:05.458149 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:55:05.458410 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: BEGIN
[0m13:55:05.458638 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:05.464206 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:55:05.464613 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:55:05.464947 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_customer_retention__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates customer retention metrics
-- for easier analytics consumption

select
    first_order_year,
    first_order_month,
    cohort,
    cohort_size,
    months_since_first_order,
    retained_customers,
    cohort_revenue,
    retention_rate,
    revenue_per_retained_customer,
    cumulative_retained_customers,
    cumulative_cohort_revenue,
    -- Additional calculated metrics
    (cumulative_retained_customers::float / nullif(cohort_size, 0)) * 100 as cumulative_retention_rate,
    (cumulative_cohort_revenue::float / nullif(cumulative_retained_customers, 0)) as cumulative_revenue_per_customer,
    (retained_customers::float / nullif(lag(retained_customers) over (
        partition by cohort 
        order by months_since_first_order
    ), 0)) * 100 as month_over_month_retention_change,
    case
        when months_since_first_order >= 1 and months_since_first_order <= 3 then 'Early Stage'
        when months_since_first_order > 3 and months_since_first_order <= 6 then 'Mid Stage'
        when months_since_first_order > 6 and months_since_first_order <= 12 then 'Late Stage'
        else 'Long Term'
    end as retention_stage,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_customer_retention"
  );
  
[0m13:55:05.472955 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.008 seconds
[0m13:55:05.481471 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:55:05.481837 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
alter table "dbt_db_ex3"."public"."metric_customer_retention" rename to "metric_customer_retention__dbt_backup"
[0m13:55:05.483132 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:05.485762 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:55:05.486074 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
alter table "dbt_db_ex3"."public"."metric_customer_retention__dbt_tmp" rename to "metric_customer_retention"
[0m13:55:05.487247 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:05.499017 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: COMMIT
[0m13:55:05.499378 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:55:05.499623 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: COMMIT
[0m13:55:05.502412 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:55:05.507358 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_customer_retention__dbt_backup"
[0m13:55:05.510403 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:55:05.510730 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
drop table if exists "dbt_db_ex3"."public"."metric_customer_retention__dbt_backup" cascade
[0m13:55:05.513807 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:55:05.515619 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: Close
[0m13:55:05.516937 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504665a8-e468-4238-9984-e934c9dc6254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109478790>]}
[0m13:55:05.517478 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.metric_customer_retention ............. [[32mSELECT 18[0m in 0.10s]
[0m13:55:05.517867 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_customer_retention
[0m13:55:05.518132 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_daily_sales
[0m13:55:05.518491 [info ] [Thread-1  ]: 2 of 3 START sql table model public.metric_daily_sales ......................... [RUN]
[0m13:55:05.518883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_customer_retention, now model.ecommerce_datamart.metric_daily_sales)
[0m13:55:05.519138 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_daily_sales
[0m13:55:05.522056 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:55:05.522587 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_daily_sales
[0m13:55:05.525955 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:55:05.526566 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:55:05.526809 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: BEGIN
[0m13:55:05.527027 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:05.532559 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:55:05.532950 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:55:05.533238 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates daily sales metrics
-- for easier analytics consumption

select
    date_key,
    year,
    month,
    quarter,
    day_of_month,
    day_of_week,
    is_weekend,
    month_name,
    orders_count,
    customers_count,
    total_sales_amount,
    total_shipping_cost,
    total_product_revenue,
    average_order_value,
    total_items_sold,
    electronics_revenue,
    clothing_revenue,
    footwear_revenue,
    accessories_revenue,
    -- Additional calculated metrics
    case 
        when orders_count = 0 then 0 
        else total_sales_amount / orders_count 
    end as revenue_per_order,
    case 
        when customers_count = 0 then 0 
        else total_sales_amount / customers_count 
    end as revenue_per_customer,
    case 
        when total_sales_amount = 0 then 0 
        else electronics_revenue / total_sales_amount * 100 
    end as electronics_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else clothing_revenue / total_sales_amount * 100 
    end as clothing_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else footwear_revenue / total_sales_amount * 100 
    end as footwear_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else accessories_revenue / total_sales_amount * 100 
    end as accessories_revenue_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_daily_sales"
  );
  
[0m13:55:05.541674 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.008 seconds
[0m13:55:05.545987 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:55:05.546376 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
alter table "dbt_db_ex3"."public"."metric_daily_sales" rename to "metric_daily_sales__dbt_backup"
[0m13:55:05.547480 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:05.550453 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:55:05.550774 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
alter table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp" rename to "metric_daily_sales"
[0m13:55:05.551665 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:05.552667 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:55:05.552977 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:55:05.553208 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:55:05.555110 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:55:05.557423 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup"
[0m13:55:05.558040 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:55:05.558316 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup" cascade
[0m13:55:05.561194 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:55:05.562171 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: Close
[0m13:55:05.562592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504665a8-e468-4238-9984-e934c9dc6254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735b0a0>]}
[0m13:55:05.563027 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.metric_daily_sales .................... [[32mSELECT 1959[0m in 0.04s]
[0m13:55:05.563396 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_daily_sales
[0m13:55:05.563653 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_monthly_sales
[0m13:55:05.564008 [info ] [Thread-1  ]: 3 of 3 START sql table model public.metric_monthly_sales ....................... [RUN]
[0m13:55:05.564335 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_daily_sales, now model.ecommerce_datamart.metric_monthly_sales)
[0m13:55:05.564585 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_monthly_sales
[0m13:55:05.567434 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:55:05.567875 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_monthly_sales
[0m13:55:05.571121 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:55:05.571766 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:55:05.572011 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: BEGIN
[0m13:55:05.572234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:05.577550 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:55:05.577875 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:55:05.578154 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates monthly sales metrics
-- for easier analytics consumption

select
    year,
    month,
    year_month,
    orders_count,
    unique_customers,
    total_sales_amount,
    total_shipping_cost,
    average_order_value,
    total_items_sold,
    completed_orders,
    cancelled_orders,
    electronics_sales,
    clothing_sales,
    footwear_sales,
    accessories_sales,
    electronics_items_sold,
    clothing_items_sold,
    footwear_items_sold,
    accessories_items_sold,
    new_customers,
    cancellation_rate,
    sales_growth_pct,
    -- Additional calculated metrics
    case
        when lag(new_customers) over (order by year, month) = 0 then null
        else (new_customers - lag(new_customers) over (order by year, month)) / 
             nullif(lag(new_customers) over (order by year, month), 0) * 100
    end as new_customer_growth_pct,
    case 
        when unique_customers = 0 then 0 
        else total_sales_amount / unique_customers 
    end as revenue_per_customer,
    (completed_orders::float / nullif(orders_count, 0)) * 100 as completion_rate,
    case
        when total_sales_amount = 0 then 0
        else electronics_sales / total_sales_amount * 100
    end as electronics_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else clothing_sales / total_sales_amount * 100
    end as clothing_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else footwear_sales / total_sales_amount * 100
    end as footwear_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else accessories_sales / total_sales_amount * 100
    end as accessories_sales_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_monthly_sales"
  );
  
[0m13:55:05.583930 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.005 seconds
[0m13:55:05.587750 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:55:05.588077 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
alter table "dbt_db_ex3"."public"."metric_monthly_sales" rename to "metric_monthly_sales__dbt_backup"
[0m13:55:05.588843 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:05.591196 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:55:05.591444 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
alter table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp" rename to "metric_monthly_sales"
[0m13:55:05.592028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:05.592865 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:55:05.593107 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:55:05.593325 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:55:05.594238 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:55:05.596339 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup"
[0m13:55:05.596738 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:55:05.596973 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup" cascade
[0m13:55:05.598536 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:55:05.599453 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: Close
[0m13:55:05.599839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '504665a8-e468-4238-9984-e934c9dc6254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10735b0a0>]}
[0m13:55:05.600261 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public.metric_monthly_sales .................. [[32mSELECT 7[0m in 0.04s]
[0m13:55:05.600665 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_monthly_sales
[0m13:55:05.601484 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:05.601734 [debug] [MainThread]: On master: BEGIN
[0m13:55:05.601930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:05.605215 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:55:05.605511 [debug] [MainThread]: On master: COMMIT
[0m13:55:05.605711 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:05.605896 [debug] [MainThread]: On master: COMMIT
[0m13:55:05.606327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:05.606619 [debug] [MainThread]: On master: Close
[0m13:55:05.606967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:05.607169 [debug] [MainThread]: Connection 'model.ecommerce_datamart.metric_monthly_sales' was properly closed.
[0m13:55:05.607425 [info ] [MainThread]: 
[0m13:55:05.607651 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m13:55:05.608228 [debug] [MainThread]: Command end result
[0m13:55:05.636270 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:55:05.637457 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:55:05.642783 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:55:05.643090 [info ] [MainThread]: 
[0m13:55:05.643362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:05.643569 [info ] [MainThread]: 
[0m13:55:05.643784 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:55:05.644944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.92515934, "process_in_blocks": "0", "process_kernel_time": 0.148887, "process_mem_max_rss": "125468672", "process_out_blocks": "0", "process_user_time": 1.569155}
[0m13:55:05.645367 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:05.645247 after 0.93 seconds
[0m13:55:05.645926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075dc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106868730>]}
[0m13:55:05.646247 [debug] [MainThread]: Flushing usage events
[0m13:55:06.914963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:08.010673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10343d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b6fa0>]}


============================== 13:55:08.013491 | e8928472-b602-4fac-9785-45f2faef76dd ==============================
[0m13:55:08.013491 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:55:08.013871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select mart.* --store-failures', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:08.143530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8928472-b602-4fac-9785-45f2faef76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103751fd0>]}
[0m13:55:08.191061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8928472-b602-4fac-9785-45f2faef76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104273130>]}
[0m13:55:08.191669 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:08.267127 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:55:08.375691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:08.375997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:08.447107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8928472-b602-4fac-9785-45f2faef76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c4ca0>]}
[0m13:55:08.534071 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:55:08.536608 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:55:08.551638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8928472-b602-4fac-9785-45f2faef76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104779550>]}
[0m13:55:08.552008 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:55:08.552229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8928472-b602-4fac-9785-45f2faef76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f2b2b0>]}
[0m13:55:08.553480 [info ] [MainThread]: 
[0m13:55:08.553707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:08.553891 [info ] [MainThread]: 
[0m13:55:08.554186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:08.556843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:55:08.583290 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:55:08.583587 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:55:08.583778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:08.597453 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m13:55:08.598685 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:55:08.602395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:55:08.606721 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:08.606960 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:55:08.607144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:08.612929 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:55:08.613312 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:08.613621 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:08.617368 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m13:55:08.618557 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:55:08.619556 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:55:08.619916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now list_dbt_db_ex3_public_dbt_test__audit)
[0m13:55:08.621668 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:55:08.621873 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: BEGIN
[0m13:55:08.622056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:08.627029 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:55:08.627374 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:55:08.627615 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public_dbt_test__audit"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:55:08.629620 [debug] [ThreadPool]: SQL status: SELECT 31 in 0.002 seconds
[0m13:55:08.630807 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: ROLLBACK
[0m13:55:08.631307 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: Close
[0m13:55:08.640264 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.640606 [debug] [MainThread]: On master: BEGIN
[0m13:55:08.640793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:08.645606 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:55:08.645882 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.646148 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:08.649462 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:55:08.650512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8928472-b602-4fac-9785-45f2faef76dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104815a60>]}
[0m13:55:08.650821 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:08.651336 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.651587 [debug] [MainThread]: On master: BEGIN
[0m13:55:08.652397 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:55:08.652699 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.652939 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.653139 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.653595 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:08.653818 [debug] [MainThread]: On master: Close
[0m13:55:08.655096 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.assert_metrics_consistency
[0m13:55:08.655388 [info ] [Thread-1  ]: 1 of 4 START test assert_metrics_consistency ................................... [RUN]
[0m13:55:08.655707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public_dbt_test__audit, now test.ecommerce_datamart.assert_metrics_consistency)
[0m13:55:08.655943 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.assert_metrics_consistency
[0m13:55:08.662364 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:55:08.663000 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.assert_metrics_consistency
[0m13:55:08.673543 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency"
[0m13:55:08.702771 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:55:08.703157 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: BEGIN
[0m13:55:08.703382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:08.757419 [debug] [Thread-1  ]: SQL status: BEGIN in 0.054 seconds
[0m13:55:08.757801 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:55:08.758101 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_metrics_consistency"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency"
  
  
    as
  
  (
    /*
  Custom test to verify consistency between daily and monthly metrics aggregations.
  This test ensures the sum of daily metrics for a month matches the monthly metrics.
*/

with daily_metrics as (
    select
        extract(year from date_key) as year,
        extract(month from date_key) as month,
        sum(total_sales_amount) as daily_sum_sales,
        sum(orders_count) as daily_sum_orders,
        sum(customers_count) as daily_sum_customers
    from "dbt_db_ex3"."public"."metric_daily_sales"
    group by 1, 2
),

monthly_metrics as (
    select
        year,
        month,
        total_sales_amount as monthly_sales,
        orders_count as monthly_orders,
        unique_customers as monthly_customers
    from "dbt_db_ex3"."public"."metric_monthly_sales"
),

compared as (
    select
        d.year,
        d.month,
        d.daily_sum_sales,
        m.monthly_sales,
        abs(d.daily_sum_sales - m.monthly_sales) as sales_difference,
        d.daily_sum_orders,
        m.monthly_orders,
        abs(d.daily_sum_orders - m.monthly_orders) as orders_difference,
        d.daily_sum_customers,
        m.monthly_customers,
        abs(d.daily_sum_customers - m.monthly_customers) as customers_difference
    from daily_metrics d
    join monthly_metrics m 
        on d.year = m.year 
        and d.month = m.month
)

select * 
from compared 
where 
    sales_difference > 0.01 or -- Allow small rounding differences
    orders_difference > 0 or
    customers_difference > 0
  );
  
    
[0m13:55:08.764063 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.006 seconds
[0m13:55:08.766906 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: COMMIT
[0m13:55:08.768737 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:55:08.772997 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: COMMIT
[0m13:55:08.778067 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:55:08.780643 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:55:08.781302 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:55:08.781535 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: BEGIN
[0m13:55:08.782070 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:55:08.782329 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:55:08.782558 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_metrics_consistency"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency"
    
      
    ) dbt_internal_test
[0m13:55:08.783216 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:55:08.785947 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: ROLLBACK
[0m13:55:08.786657 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: Close
[0m13:55:08.787153 [error] [Thread-1  ]: 1 of 4 FAIL 7 assert_metrics_consistency ....................................... [[31mFAIL 7[0m in 0.13s]
[0m13:55:08.787548 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.assert_metrics_consistency
[0m13:55:08.787812 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:55:08.788101 [info ] [Thread-1  ]: 2 of 4 START test assert_retention_rate_decreases .............................. [RUN]
[0m13:55:08.788468 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.assert_metrics_consistency, now test.ecommerce_datamart.assert_retention_rate_decreases)
[0m13:55:08.788744 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:55:08.791286 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:55:08.791763 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:55:08.793858 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases"
[0m13:55:08.794964 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:55:08.795198 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: BEGIN
[0m13:55:08.795404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:08.798920 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:55:08.799272 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:55:08.799549 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_retention_rate_decreases"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases"
  
  
    as
  
  (
    /*
  Custom test to verify that retention rates generally decrease over time
  for any given cohort. This is a typical pattern in retention analysis.
*/

with retention_rates as (
    select
        cohort,
        months_since_first_order,
        retention_rate,
        lead(retention_rate) over (
            partition by cohort
            order by months_since_first_order
        ) as next_month_retention_rate
    from "dbt_db_ex3"."public"."metric_customer_retention"
    where months_since_first_order > 0
),

potential_issues as (
    select
        cohort,
        months_since_first_order,
        retention_rate,
        next_month_retention_rate,
        next_month_retention_rate - retention_rate as retention_rate_change
    from retention_rates
    where
        -- Check for months where retention rate increased by more than 20 percentage points
        -- Some increase can happen due to seasonality, delayed purchases, etc.
        -- but large unexpected increases should be investigated
        next_month_retention_rate is not null
        and next_month_retention_rate > retention_rate
        and (next_month_retention_rate - retention_rate) > 20
)

select * from potential_issues
  );
  
    
[0m13:55:08.802562 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m13:55:08.803206 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: COMMIT
[0m13:55:08.803449 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:55:08.803663 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: COMMIT
[0m13:55:08.804385 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:55:08.804794 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:55:08.805226 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:55:08.805442 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: BEGIN
[0m13:55:08.805921 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:55:08.806177 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:55:08.806415 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_retention_rate_decreases"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases"
    
      
    ) dbt_internal_test
[0m13:55:08.806957 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:55:08.807782 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: ROLLBACK
[0m13:55:08.808208 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: Close
[0m13:55:08.808586 [error] [Thread-1  ]: 2 of 4 FAIL 1 assert_retention_rate_decreases .................................. [[31mFAIL 1[0m in 0.02s]
[0m13:55:08.808948 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:55:08.809206 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:55:08.809480 [info ] [Thread-1  ]: 3 of 4 START test not_null_metric_daily_sales_date_key ......................... [RUN]
[0m13:55:08.809756 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.assert_retention_rate_decreases, now test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875)
[0m13:55:08.809976 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:55:08.816776 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:55:08.817378 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:55:08.819480 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_metric_daily_sales_date_key"
[0m13:55:08.819923 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:55:08.820149 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: BEGIN
[0m13:55:08.820358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:08.824213 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:55:08.824636 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:55:08.824989 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_metric_daily_sales_date_key"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."metric_daily_sales"
where date_key is null



  );
  
    
[0m13:55:08.827696 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:55:08.828347 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: COMMIT
[0m13:55:08.828593 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:55:08.828810 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: COMMIT
[0m13:55:08.829385 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:55:08.829790 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:55:08.830326 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:55:08.830546 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: BEGIN
[0m13:55:08.830949 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:55:08.831166 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:55:08.831386 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_metric_daily_sales_date_key"
    
      
    ) dbt_internal_test
[0m13:55:08.831942 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:55:08.832879 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: ROLLBACK
[0m13:55:08.833294 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: Close
[0m13:55:08.833710 [info ] [Thread-1  ]: 3 of 4 PASS not_null_metric_daily_sales_date_key ............................... [[32mPASS[0m in 0.02s]
[0m13:55:08.834091 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:55:08.834351 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:55:08.834650 [info ] [Thread-1  ]: 4 of 4 START test unique_metric_daily_sales_date_key ........................... [RUN]
[0m13:55:08.834983 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875, now test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea)
[0m13:55:08.835225 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:55:08.839835 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:55:08.840363 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:55:08.842492 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_metric_daily_sales_date_key"
[0m13:55:08.842973 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:55:08.843211 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: BEGIN
[0m13:55:08.843429 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:08.846600 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:55:08.846898 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:55:08.847137 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_metric_daily_sales_date_key"
  
  
    as
  
  (
    
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."metric_daily_sales"
where date_key is not null
group by date_key
having count(*) > 1



  );
  
    
[0m13:55:08.848825 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:55:08.849471 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: COMMIT
[0m13:55:08.849722 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:55:08.849941 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: COMMIT
[0m13:55:08.850704 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:55:08.851100 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:55:08.851589 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:55:08.851808 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: BEGIN
[0m13:55:08.852274 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:55:08.852500 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:55:08.852732 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_metric_daily_sales_date_key"
    
      
    ) dbt_internal_test
[0m13:55:08.853274 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:55:08.854128 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: ROLLBACK
[0m13:55:08.854539 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: Close
[0m13:55:08.854936 [info ] [Thread-1  ]: 4 of 4 PASS unique_metric_daily_sales_date_key ................................. [[32mPASS[0m in 0.02s]
[0m13:55:08.855296 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:55:08.856018 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.856231 [debug] [MainThread]: On master: BEGIN
[0m13:55:08.856418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:08.859466 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:55:08.859739 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.859943 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.860133 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.860514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:08.860741 [debug] [MainThread]: On master: Close
[0m13:55:08.861017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:08.861206 [debug] [MainThread]: Connection 'test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea' was properly closed.
[0m13:55:08.861427 [info ] [MainThread]: 
[0m13:55:08.861646 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m13:55:08.862295 [debug] [MainThread]: Command end result
[0m13:55:08.889756 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:55:08.890853 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:55:08.895375 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:55:08.895596 [info ] [MainThread]: 
[0m13:55:08.895837 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:55:08.896034 [info ] [MainThread]: 
[0m13:55:08.896262 [error] [MainThread]: [31mFailure in test assert_metrics_consistency (tests/assert_metrics_consistency.sql)[0m
[0m13:55:08.896483 [error] [MainThread]:   Got 7 results, configured to fail if != 0
[0m13:55:08.896658 [info ] [MainThread]: 
[0m13:55:08.896869 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_datamart/tests/assert_metrics_consistency.sql
[0m13:55:08.897046 [info ] [MainThread]: 
[0m13:55:08.897253 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency"
  --------------------------------------------------------------------------------
[0m13:55:08.897436 [info ] [MainThread]: 
[0m13:55:08.897647 [error] [MainThread]: [31mFailure in test assert_retention_rate_decreases (tests/assert_retention_rate_decreases.sql)[0m
[0m13:55:08.897864 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:55:08.898036 [info ] [MainThread]: 
[0m13:55:08.898238 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_datamart/tests/assert_retention_rate_decreases.sql
[0m13:55:08.898408 [info ] [MainThread]: 
[0m13:55:08.898608 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------------
  select * from "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases"
  -------------------------------------------------------------------------------------
[0m13:55:08.898787 [info ] [MainThread]: 
[0m13:55:08.898978 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m13:55:08.899886 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.9400113, "process_in_blocks": "0", "process_kernel_time": 0.147407, "process_mem_max_rss": "125878272", "process_out_blocks": "0", "process_user_time": 1.52474}
[0m13:55:08.900139 [debug] [MainThread]: Command `dbt test` failed at 13:55:08.900093 after 0.94 seconds
[0m13:55:08.900371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10343d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036ea7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10568cd90>]}
[0m13:55:08.900598 [debug] [MainThread]: Flushing usage events
[0m13:55:09.852912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:11.011614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103783790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fad30>]}


============================== 13:55:11.014955 | e8c3803a-e1f9-4225-a629-607d129bb0fc ==============================
[0m13:55:11.014955 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:55:11.015426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:11.164321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8c3803a-e1f9-4225-a629-607d129bb0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104941280>]}
[0m13:55:11.226100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8c3803a-e1f9-4225-a629-607d129bb0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045db430>]}
[0m13:55:11.227265 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:11.314960 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:55:11.438543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:11.438851 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:11.482802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c3803a-e1f9-4225-a629-607d129bb0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053859a0>]}
[0m13:55:11.611914 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:55:11.615628 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:55:11.627006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8c3803a-e1f9-4225-a629-607d129bb0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105312940>]}
[0m13:55:11.627535 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:55:11.627815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c3803a-e1f9-4225-a629-607d129bb0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516c310>]}
[0m13:55:11.630405 [info ] [MainThread]: 
[0m13:55:11.630867 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:11.631132 [info ] [MainThread]: 
[0m13:55:11.631565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:11.636312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3_public'
[0m13:55:11.683461 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:11.683953 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:55:11.684245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:11.709752 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m13:55:11.710345 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:11.710836 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:11.713410 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m13:55:11.714799 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:55:11.715860 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:55:11.723209 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:11.723529 [debug] [MainThread]: On master: BEGIN
[0m13:55:11.723715 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:11.727562 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:55:11.727874 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:11.728144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:11.731930 [debug] [MainThread]: SQL status: SELECT 2 in 0.003 seconds
[0m13:55:11.733121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c3803a-e1f9-4225-a629-607d129bb0fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102049cd0>]}
[0m13:55:11.733547 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:11.734244 [debug] [MainThread]: On master: Close
[0m13:55:11.735818 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:55:11.736203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_date)
[0m13:55:11.736438 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:55:11.755425 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:55:11.755779 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:55:11.756010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:11.760702 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:55:11.761077 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:55:11.761333 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:55:11.762335 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:55:11.771132 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:55:11.771786 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:55:11.772077 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: ROLLBACK
[0m13:55:11.773099 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:55:11.773678 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:55:11.773965 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:55:11.774458 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.stg_customers)
[0m13:55:11.774838 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:55:11.777586 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:55:11.778188 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:55:11.778743 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:55:11.779003 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_order_items
[0m13:55:11.779313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_customers, now model.ecommerce_datamart.stg_order_items)
[0m13:55:11.779569 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_order_items
[0m13:55:11.786744 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_order_items"
[0m13:55:11.787482 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_order_items
[0m13:55:11.788123 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_order_items
[0m13:55:11.788400 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_orders
[0m13:55:11.788729 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_order_items, now model.ecommerce_datamart.stg_orders)
[0m13:55:11.788992 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_orders
[0m13:55:11.793941 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_orders"
[0m13:55:11.794535 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_orders
[0m13:55:11.794986 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_orders
[0m13:55:11.795239 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_products
[0m13:55:11.795627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_orders, now model.ecommerce_datamart.stg_products)
[0m13:55:11.795906 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_products
[0m13:55:11.798539 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_products"
[0m13:55:11.799262 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_products
[0m13:55:11.799921 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_products
[0m13:55:11.800205 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers
[0m13:55:11.800610 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_products, now model.ecommerce_datamart.dim_customers)
[0m13:55:11.800969 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers
[0m13:55:11.803783 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers"
[0m13:55:11.804347 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers
[0m13:55:11.804829 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers
[0m13:55:11.805088 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_orders
[0m13:55:11.805439 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers, now model.ecommerce_datamart.fct_orders)
[0m13:55:11.805838 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_orders
[0m13:55:11.808582 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_orders"
[0m13:55:11.809199 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_orders
[0m13:55:11.809688 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_orders
[0m13:55:11.809950 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products
[0m13:55:11.810414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_orders, now model.ecommerce_datamart.dim_products)
[0m13:55:11.810664 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products
[0m13:55:11.813622 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products"
[0m13:55:11.814178 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products
[0m13:55:11.814640 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products
[0m13:55:11.814891 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_order_items
[0m13:55:11.815146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products, now model.ecommerce_datamart.fct_order_items)
[0m13:55:11.815444 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_order_items
[0m13:55:11.818441 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_order_items"
[0m13:55:11.818885 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_order_items
[0m13:55:11.819314 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_order_items
[0m13:55:11.819565 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:55:11.820111 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_order_items, now model.ecommerce_datamart.dim_customers_mart)
[0m13:55:11.820354 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:55:11.823760 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:55:11.824255 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:55:11.824681 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:55:11.824935 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:55:11.825221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f)
[0m13:55:11.825456 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:55:11.844999 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:11.845537 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:55:11.845860 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:55:11.846144 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:11.846454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:55:11.846770 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:55:11.853026 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:11.853730 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:55:11.854109 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:55:11.854418 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:11.854781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:55:11.855150 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:55:11.862353 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:55:11.862945 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:55:11.863478 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:55:11.863745 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:55:11.864041 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a)
[0m13:55:11.864277 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:55:11.867732 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:55:11.868335 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:55:11.868872 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:55:11.869153 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:55:11.869474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:55:11.869727 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:55:11.874179 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:55:11.874881 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:55:11.875357 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:55:11.875615 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:55:11.875948 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888)
[0m13:55:11.876237 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:55:11.879819 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:55:11.880438 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:55:11.880934 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:55:11.881205 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:55:11.881535 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888, now test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1)
[0m13:55:11.881800 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:55:11.885195 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:55:11.886038 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:55:11.886685 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:55:11.886982 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:55:11.887411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:55:11.887795 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:55:11.892895 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:55:11.893710 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:55:11.894215 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:55:11.894481 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:55:11.894788 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8)
[0m13:55:11.895025 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:55:11.898207 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:55:11.898816 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:55:11.899308 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:55:11.899562 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_customer_retention
[0m13:55:11.899907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8, now model.ecommerce_datamart.fct_customer_retention)
[0m13:55:11.900157 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_customer_retention
[0m13:55:11.903396 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:11.903940 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_customer_retention
[0m13:55:11.904395 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_customer_retention
[0m13:55:11.904652 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:55:11.904966 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_customer_retention, now test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:55:11.905168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:11.905428 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:55:11.905634 [debug] [MainThread]: Connection 'test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339' was properly closed.
[0m13:55:11.914458 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:55:11.914882 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
    'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:11.916211 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.9645509, "process_in_blocks": "0", "process_kernel_time": 0.172489, "process_mem_max_rss": "124878848", "process_out_blocks": "0", "process_user_time": 1.655104}
[0m13:55:11.916551 [debug] [MainThread]: Command `dbt compile` failed at 13:55:11.916488 after 0.96 seconds
[0m13:55:11.916806 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:55:11.917096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103783790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1008c1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a09880>]}
[0m13:55:11.917593 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:55:11.917892 [debug] [MainThread]: Flushing usage events
[0m13:55:11.918158 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:55:11.918764 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e'
[0m13:55:11.919022 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:55:11.925478 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:11.926523 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:55:11.926864 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:55:11.927166 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:11.927753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e, now test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:55:11.928136 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:55:11.931603 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:55:11.932718 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:55:11.933348 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:55:11.933664 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:55:11.933998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362)
[0m13:55:11.934331 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:55:11.938247 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:55:11.938818 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:55:11.939253 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:55:11.939527 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:55:11.939885 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0)
[0m13:55:11.940117 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:55:11.943135 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:55:11.943623 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:55:11.944023 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:55:11.944256 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:55:11.944491 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_datamart.not_null_fct_orders_status.1455048989)
[0m13:55:11.944709 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:55:11.948585 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:55:11.949166 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:55:11.949624 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:55:11.949871 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:55:11.950149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_status.1455048989, now test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:55:11.950379 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:55:11.953252 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:55:11.953669 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:55:11.954069 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:55:11.954310 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:55:11.954604 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:55:11.954846 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:55:11.960500 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:55:11.961084 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:55:11.961543 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:55:11.961795 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:55:11.964597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5)
[0m13:55:11.964844 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:55:11.967928 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:55:11.970271 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:55:11.970699 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:55:11.970939 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:55:11.971216 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5, now model.ecommerce_datamart.dim_products_mart)
[0m13:55:11.971442 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:55:11.974362 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:55:11.974872 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:55:11.975319 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:55:11.975568 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:55:11.975860 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products_mart, now test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:55:11.976093 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:55:11.981189 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:55:11.981669 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:55:11.982103 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:55:11.982352 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:55:11.982640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506)
[0m13:55:11.982878 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:55:11.988264 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:11.988720 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:55:11.989016 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:55:11.989302 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:11.989596 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295)
[0m13:55:11.989908 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:55:11.994880 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:11.995278 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:55:11.995566 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:55:11.995825 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:11.996100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295, now test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0)
[0m13:55:11.996390 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:55:11.999346 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:55:11.999788 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:55:12.000337 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:55:12.000577 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:55:12.000815 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0, now test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e)
[0m13:55:12.001036 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:55:12.003983 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:55:12.004411 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:55:12.004810 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:55:12.005045 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:55:12.005307 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e, now test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff)
[0m13:55:12.005529 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:55:12.008295 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:55:12.008684 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:55:12.009071 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:55:12.009303 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:55:12.009585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff, now test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed)
[0m13:55:12.009803 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:55:12.013621 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:55:12.014267 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:55:12.014722 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:55:12.014974 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:55:12.015264 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed, now test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1)
[0m13:55:12.015494 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:55:12.018541 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:55:12.018973 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:55:12.019389 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:55:12.019629 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:55:12.019924 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985)
[0m13:55:12.020181 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:55:12.023083 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:55:12.023485 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:55:12.023890 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:55:12.024136 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_daily_sales
[0m13:55:12.024401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985, now model.ecommerce_datamart.fct_daily_sales)
[0m13:55:12.024624 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_daily_sales
[0m13:55:12.028062 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:12.028737 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_daily_sales
[0m13:55:12.029316 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_daily_sales
[0m13:55:12.029634 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:12.029991 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_daily_sales, now model.ecommerce_datamart.fct_monthly_sales)
[0m13:55:12.030245 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:12.034671 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:12.035243 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:12.035711 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:12.035974 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:55:12.036292 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_monthly_sales, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767)
[0m13:55:12.036529 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:55:12.042222 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:12.042726 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:55:12.043039 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:55:12.043335 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:12.043648 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507)
[0m13:55:12.043985 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:55:12.050669 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:12.051123 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:55:12.051424 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:55:12.051704 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:12.051996 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097)
[0m13:55:12.052320 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:55:12.058212 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:12.058667 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:55:12.058968 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:55:12.059245 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:12.059546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097, now test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6)
[0m13:55:12.059892 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:55:12.063129 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:55:12.063586 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:55:12.064024 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:55:12.064275 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:55:12.064586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6, now test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02)
[0m13:55:12.064859 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:55:12.068190 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:55:12.068731 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:55:12.069182 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:55:12.069436 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:55:12.069729 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02, now test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55)
[0m13:55:12.069964 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:55:12.073209 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:55:12.073810 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:55:12.074287 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:55:12.074538 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:55:12.074838 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55, now test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc)
[0m13:55:12.075074 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:55:12.078719 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:55:12.079173 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:55:12.079618 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:55:12.080089 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:55:12.080658 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc, now test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03)
[0m13:55:12.080908 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:55:12.084026 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:55:12.084481 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:55:12.084935 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:55:12.085186 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:55:12.085473 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03, now test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8)
[0m13:55:12.085706 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:55:12.088838 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:55:12.089270 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:55:12.089694 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:55:12.089943 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:55:12.090225 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8, now test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m13:55:12.090458 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:55:12.094801 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:55:12.095349 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:55:12.095802 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:55:12.096060 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:55:12.096352 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m13:55:12.096587 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:55:12.100661 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:55:12.101242 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:55:12.101687 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:55:12.101940 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:55:12.102251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768)
[0m13:55:12.102534 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:55:12.105579 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:55:12.106017 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:55:12.106449 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:55:12.893134 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:14.044542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138be760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a3bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a3bf70>]}


============================== 13:55:14.047171 | 133ea9cd-6008-4b55-aaee-2b7866878650 ==============================
[0m13:55:14.047171 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:55:14.047564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ls --resource-type model --output json', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:14.170164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '133ea9cd-6008-4b55-aaee-2b7866878650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cad580>]}
[0m13:55:14.216355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '133ea9cd-6008-4b55-aaee-2b7866878650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f12ee0>]}
[0m13:55:14.217032 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:14.292184 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:55:14.399142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:14.399430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:14.442900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '133ea9cd-6008-4b55-aaee-2b7866878650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158dca00>]}
[0m13:55:14.561315 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:55:14.564163 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:55:14.573347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '133ea9cd-6008-4b55-aaee-2b7866878650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158a9e50>]}
[0m13:55:14.573715 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:55:14.573950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '133ea9cd-6008-4b55-aaee-2b7866878650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115868940>]}
[0m13:55:14.575094 [info ] [MainThread]: {"name": "dim_customers", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/core/dim_customers.sql", "unique_id": "model.ecommerce_datamart.dim_customers", "alias": "dim_customers", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["core", "dimensions"], "meta": {"owner": "Analytics Team", "contains_pii": true}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["core", "dimensions"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.stg_customers", "model.ecommerce_datamart.stg_orders"]}}
[0m13:55:14.575442 [info ] [MainThread]: {"name": "dim_customers_mart", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/dimensions/dim_customers_mart.sql", "unique_id": "model.ecommerce_datamart.dim_customers_mart", "alias": "dim_customers_mart", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "dimensions", "datamart", "dimensions"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "dimensions"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.dim_customers"]}}
[0m13:55:14.575742 [info ] [MainThread]: {"name": "dim_date", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/dimensions/dim_date.sql", "unique_id": "model.ecommerce_datamart.dim_date", "alias": "dim_date", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "dimensions", "datamart", "dimensions"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "dimensions"], "depends_on": {"macros": ["macro.dbt_utils.date_spine"], "nodes": []}}
[0m13:55:14.576031 [info ] [MainThread]: {"name": "dim_products", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/core/dim_products.sql", "unique_id": "model.ecommerce_datamart.dim_products", "alias": "dim_products", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["core", "dimensions"], "meta": {"owner": "Product Team"}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["core", "dimensions"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.stg_products", "model.ecommerce_datamart.stg_order_items"]}}
[0m13:55:14.576314 [info ] [MainThread]: {"name": "dim_products_mart", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/dimensions/dim_products_mart.sql", "unique_id": "model.ecommerce_datamart.dim_products_mart", "alias": "dim_products_mart", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "dimensions", "datamart", "dimensions"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "dimensions"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.dim_products"]}}
[0m13:55:14.576582 [info ] [MainThread]: {"name": "fct_customer_retention", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/facts/fct_customer_retention.sql", "unique_id": "model.ecommerce_datamart.fct_customer_retention", "alias": "fct_customer_retention", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "facts", "datamart", "facts"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "facts"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_orders"]}}
[0m13:55:14.576847 [info ] [MainThread]: {"name": "fct_daily_sales", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/facts/fct_daily_sales.sql", "unique_id": "model.ecommerce_datamart.fct_daily_sales", "alias": "fct_daily_sales", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "facts", "datamart", "facts"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "facts"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_orders", "model.ecommerce_datamart.fct_order_items", "model.ecommerce_datamart.dim_date"]}}
[0m13:55:14.577118 [info ] [MainThread]: {"name": "fct_monthly_sales", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/facts/fct_monthly_sales.sql", "unique_id": "model.ecommerce_datamart.fct_monthly_sales", "alias": "fct_monthly_sales", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "facts", "datamart", "facts"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["year", "month"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "facts"], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.ecommerce_datamart.fct_orders", "model.ecommerce_datamart.fct_order_items", "model.ecommerce_datamart.dim_customers"]}}
[0m13:55:14.577396 [info ] [MainThread]: {"name": "fct_order_items", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/core/fct_order_items.sql", "unique_id": "model.ecommerce_datamart.fct_order_items", "alias": "fct_order_items", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["core", "facts"], "meta": {"owner": "Sales Team", "update_frequency": "daily"}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["core", "facts"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.stg_order_items", "model.ecommerce_datamart.stg_orders", "model.ecommerce_datamart.stg_products"]}}
[0m13:55:14.577668 [info ] [MainThread]: {"name": "fct_orders", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/core/fct_orders.sql", "unique_id": "model.ecommerce_datamart.fct_orders", "alias": "fct_orders", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["core", "facts"], "meta": {"owner": "Sales Team", "update_frequency": "daily"}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["core", "facts"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.stg_orders", "model.ecommerce_datamart.stg_order_items"]}}
[0m13:55:14.577934 [info ] [MainThread]: {"name": "metric_customer_retention", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/metrics/metric_customer_retention.sql", "unique_id": "model.ecommerce_datamart.metric_customer_retention", "alias": "metric_customer_retention", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "metrics", "datamart", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "metrics"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_customer_retention"]}}
[0m13:55:14.578205 [info ] [MainThread]: {"name": "metric_daily_sales", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/metrics/metric_daily_sales.sql", "unique_id": "model.ecommerce_datamart.metric_daily_sales", "alias": "metric_daily_sales", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "metrics", "datamart", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "metrics"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_daily_sales"]}}
[0m13:55:14.578479 [info ] [MainThread]: {"name": "metric_monthly_sales", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/metrics/metric_monthly_sales.sql", "unique_id": "model.ecommerce_datamart.metric_monthly_sales", "alias": "metric_monthly_sales", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "metrics", "datamart", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "metrics"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_monthly_sales"]}}
[0m13:55:14.578739 [info ] [MainThread]: {"name": "stg_customers", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/staging/stg_customers.sql", "unique_id": "model.ecommerce_datamart.stg_customers", "alias": "stg_customers", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": [], "nodes": ["source.ecommerce_datamart.ecommerce_raw.customers"]}}
[0m13:55:14.579009 [info ] [MainThread]: {"name": "stg_order_items", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/staging/stg_order_items.sql", "unique_id": "model.ecommerce_datamart.stg_order_items", "alias": "stg_order_items", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "order_item_id", "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.ecommerce_datamart.ecommerce_raw.order_items"]}}
[0m13:55:14.579264 [info ] [MainThread]: {"name": "stg_orders", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/staging/stg_orders.sql", "unique_id": "model.ecommerce_datamart.stg_orders", "alias": "stg_orders", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "order_id", "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.ecommerce_datamart.ecommerce_raw.orders"]}}
[0m13:55:14.579532 [info ] [MainThread]: {"name": "stg_products", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/staging/stg_products.sql", "unique_id": "model.ecommerce_datamart.stg_products", "alias": "stg_products", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": [], "nodes": ["source.ecommerce_datamart.ecommerce_raw.products"]}}
[0m13:55:14.580516 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.5870115, "process_in_blocks": "0", "process_kernel_time": 0.124472, "process_mem_max_rss": "114458624", "process_out_blocks": "0", "process_user_time": 1.330026}
[0m13:55:14.580771 [debug] [MainThread]: Command `dbt ls` succeeded at 13:55:14.580721 after 0.59 seconds
[0m13:55:14.580994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138be760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f43970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b982b0>]}
[0m13:55:14.581214 [debug] [MainThread]: Flushing usage events
[0m13:55:15.626410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:16.797811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f22790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8b040>]}


============================== 13:55:16.800785 | b4f9d39d-5d9e-4aab-968f-1e0b1a516743 ==============================
[0m13:55:16.800785 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:55:16.801325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:16.940686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f9d39d-5d9e-4aab-968f-1e0b1a516743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10272dee0>]}
[0m13:55:16.992006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f9d39d-5d9e-4aab-968f-1e0b1a516743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050acd90>]}
[0m13:55:16.992698 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:17.082469 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:55:17.203006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:17.203310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:17.274376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4f9d39d-5d9e-4aab-968f-1e0b1a516743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105343820>]}
[0m13:55:17.286226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4f9d39d-5d9e-4aab-968f-1e0b1a516743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105976730>]}
[0m13:55:17.286682 [info ] [MainThread]: Found 17 models, 43 data tests, 4 sources, 591 macros
[0m13:55:17.286929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f9d39d-5d9e-4aab-968f-1e0b1a516743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105976610>]}
[0m13:55:17.289113 [info ] [MainThread]: 
[0m13:55:17.289355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:17.289549 [info ] [MainThread]: 
[0m13:55:17.289872 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:17.293832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3_public'
[0m13:55:17.325093 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:17.325414 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:55:17.325619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:17.340449 [debug] [ThreadPool]: SQL status: BEGIN in 0.015 seconds
[0m13:55:17.340815 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:55:17.341052 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:17.346213 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.005 seconds
[0m13:55:17.347306 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:55:17.347888 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:55:17.353716 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:17.354015 [debug] [MainThread]: On master: BEGIN
[0m13:55:17.354206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:17.359201 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:55:17.359509 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:17.359766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:17.364490 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:55:17.365785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f9d39d-5d9e-4aab-968f-1e0b1a516743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590d6d0>]}
[0m13:55:17.366081 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:17.366596 [debug] [MainThread]: On master: Close
[0m13:55:17.367892 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:55:17.368241 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_date)
[0m13:55:17.368479 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:55:17.386973 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:55:17.387344 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:55:17.387571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:17.392525 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:55:17.392856 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:55:17.393087 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:55:17.393804 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:55:17.401640 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:55:17.402334 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:55:17.402614 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: ROLLBACK
[0m13:55:17.403483 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:55:17.403910 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:55:17.404154 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:55:17.404443 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.stg_customers)
[0m13:55:17.404671 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:55:17.407632 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:55:17.408432 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:55:17.411207 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:55:17.419433 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_order_items
[0m13:55:17.424976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_customers, now model.ecommerce_datamart.stg_order_items)
[0m13:55:17.426635 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_order_items
[0m13:55:17.473764 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_order_items"
[0m13:55:17.474447 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_order_items
[0m13:55:17.474928 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_order_items
[0m13:55:17.475213 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_orders
[0m13:55:17.475481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_order_items, now model.ecommerce_datamart.stg_orders)
[0m13:55:17.475720 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_orders
[0m13:55:17.485005 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_orders"
[0m13:55:17.487098 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_orders
[0m13:55:17.488607 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_orders
[0m13:55:17.489148 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_products
[0m13:55:17.489466 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_orders, now model.ecommerce_datamart.stg_products)
[0m13:55:17.489699 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_products
[0m13:55:17.492069 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_products"
[0m13:55:17.492537 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_products
[0m13:55:17.492949 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_products
[0m13:55:17.493174 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers
[0m13:55:17.493485 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_products, now model.ecommerce_datamart.dim_customers)
[0m13:55:17.493752 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers
[0m13:55:17.496121 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers"
[0m13:55:17.496465 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers
[0m13:55:17.496845 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers
[0m13:55:17.497066 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_orders
[0m13:55:17.497372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers, now model.ecommerce_datamart.fct_orders)
[0m13:55:17.497622 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_orders
[0m13:55:17.500034 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_orders"
[0m13:55:17.500393 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_orders
[0m13:55:17.500775 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_orders
[0m13:55:17.501003 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products
[0m13:55:17.501276 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_orders, now model.ecommerce_datamart.dim_products)
[0m13:55:17.501583 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products
[0m13:55:17.504507 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products"
[0m13:55:17.504881 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products
[0m13:55:17.505267 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products
[0m13:55:17.505490 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_order_items
[0m13:55:17.505876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products, now model.ecommerce_datamart.fct_order_items)
[0m13:55:17.506109 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_order_items
[0m13:55:17.508487 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_order_items"
[0m13:55:17.508865 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_order_items
[0m13:55:17.509231 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_order_items
[0m13:55:17.509448 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:55:17.509741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_order_items, now model.ecommerce_datamart.dim_customers_mart)
[0m13:55:17.510180 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:55:17.512538 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:55:17.512905 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:55:17.513305 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:55:17.513547 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:55:17.513800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f)
[0m13:55:17.514016 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:55:17.529477 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:17.529821 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f
[0m13:55:17.530092 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:55:17.530364 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:17.530628 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_customers_lifetime_value__0__True.f13a1bef3f, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53)
[0m13:55:17.530924 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:55:17.536762 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:17.537166 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53
[0m13:55:17.537446 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:55:17.537718 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:17.537995 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_.dde122cf53, now test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:55:17.538291 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:55:17.544663 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:55:17.545137 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:55:17.545522 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:55:17.545747 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:55:17.545976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a)
[0m13:55:17.546186 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:55:17.548906 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:55:17.549302 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:55:17.549675 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:55:17.549894 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:55:17.550144 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:55:17.550358 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:55:17.553009 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:55:17.553356 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:55:17.553723 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:55:17.553944 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:55:17.554208 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888)
[0m13:55:17.554446 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:55:17.557139 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:55:17.557540 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:55:17.557920 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:55:17.558144 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:55:17.558393 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888, now test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1)
[0m13:55:17.558604 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:55:17.561327 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:55:17.561730 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:55:17.562142 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:55:17.562364 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:55:17.562618 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:55:17.562835 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:55:17.567059 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:55:17.567484 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:55:17.567873 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:55:17.568106 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:55:17.568386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8)
[0m13:55:17.568622 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:55:17.572062 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:55:17.572445 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:55:17.572816 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:55:17.573040 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_customer_retention
[0m13:55:17.573291 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8, now model.ecommerce_datamart.fct_customer_retention)
[0m13:55:17.573503 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_customer_retention
[0m13:55:17.576168 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:55:17.576516 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_customer_retention
[0m13:55:17.576883 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_customer_retention
[0m13:55:17.577108 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:55:17.577371 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_customer_retention, now test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:55:17.577559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:17.577782 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:55:17.577956 [debug] [MainThread]: Connection 'test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339' was properly closed.
[0m13:55:17.584225 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:55:17.584595 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in test dbt_expectations_expect_column_values_to_match_regex_dim_customers_email___a_z0_9___a_z0_9_a_z_2_ (models/core/schema.yml)
    'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:17.585100 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:55:17.585974 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.8486079, "process_in_blocks": "0", "process_kernel_time": 0.161528, "process_mem_max_rss": "124551168", "process_out_blocks": "0", "process_user_time": 1.543476}
[0m13:55:17.586386 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:55:17.586657 [debug] [MainThread]: Command `dbt docs generate` failed at 13:55:17.586606 after 0.85 seconds
[0m13:55:17.586902 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:55:17.587168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f22790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105976c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f09790>]}
[0m13:55:17.587474 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e'
[0m13:55:17.587771 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:55:17.587965 [debug] [MainThread]: Flushing usage events
[0m13:55:17.593478 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:17.593969 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e
[0m13:55:17.594275 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:55:17.594553 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:17.594886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_orders_total_amount__0__True.28ff28a82e, now test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:55:17.595350 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:55:17.598548 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:55:17.599450 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:55:17.599896 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:55:17.600379 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:55:17.600667 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362)
[0m13:55:17.600897 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:55:17.605024 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:55:17.606031 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:55:17.606472 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:55:17.606711 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:55:17.607019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0)
[0m13:55:17.607282 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:55:17.610108 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:55:17.610497 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:55:17.610886 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:55:17.611181 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:55:17.611554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_datamart.not_null_fct_orders_status.1455048989)
[0m13:55:17.611818 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:55:17.614635 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:55:17.615042 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:55:17.615494 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:55:17.615752 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:55:17.616056 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_status.1455048989, now test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:55:17.616289 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:55:17.619365 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:55:17.619865 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:55:17.620273 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:55:17.620507 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:55:17.620787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:55:17.621004 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:55:17.626381 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:55:17.626760 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:55:17.627146 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:55:17.627372 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:55:17.627624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5)
[0m13:55:17.627838 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:55:17.631335 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:55:17.631751 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:55:17.632152 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:55:17.632395 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:55:17.632673 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5, now model.ecommerce_datamart.dim_products_mart)
[0m13:55:17.632923 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:55:17.635339 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:55:17.635689 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:55:17.636071 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:55:17.636302 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:55:17.636562 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products_mart, now test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:55:17.636785 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:55:17.640853 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:55:17.641223 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:55:17.641605 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:55:17.641835 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:55:17.642113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506)
[0m13:55:17.642344 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:55:17.647201 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:17.647554 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506
[0m13:55:17.647830 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:55:17.648095 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0 (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:17.648349 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_inventory_count__10000__0.0545537506, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295)
[0m13:55:17.648639 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:55:17.653115 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:17.653453 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295
[0m13:55:17.653724 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:55:17.653980 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:17.654223 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_dim_products_price__0__True.11acc3e295, now test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0)
[0m13:55:17.654500 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:55:17.657278 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:55:17.657690 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:55:17.658070 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:55:17.658295 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:55:17.658519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0, now test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e)
[0m13:55:17.658728 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:55:17.662237 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:55:17.662623 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:55:17.662999 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:55:17.663228 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:55:17.663474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e, now test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff)
[0m13:55:17.663688 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:55:17.666356 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:55:17.666693 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:55:17.667064 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:55:17.667288 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:55:17.667535 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff, now test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed)
[0m13:55:17.667750 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:55:17.670411 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:55:17.672392 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:55:17.672774 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:55:17.673007 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:55:17.673280 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed, now test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1)
[0m13:55:17.673517 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:55:17.676216 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:55:17.677635 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:55:17.678000 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:55:17.678227 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:55:17.678472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985)
[0m13:55:17.678685 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:55:17.681318 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:55:17.681665 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:55:17.682045 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:55:17.682276 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_daily_sales
[0m13:55:17.682523 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985, now model.ecommerce_datamart.fct_daily_sales)
[0m13:55:17.682732 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_daily_sales
[0m13:55:17.685463 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:55:17.685792 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_daily_sales
[0m13:55:17.686161 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_daily_sales
[0m13:55:17.686381 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:17.686636 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_daily_sales, now model.ecommerce_datamart.fct_monthly_sales)
[0m13:55:17.686853 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:17.691022 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:55:17.691371 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:17.691743 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_monthly_sales
[0m13:55:17.691973 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:55:17.692232 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_monthly_sales, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767)
[0m13:55:17.692453 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:55:17.697296 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:17.697647 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767
[0m13:55:17.697917 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:55:17.698179 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:17.698434 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_item_total__0__True.b986958767, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507)
[0m13:55:17.698727 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:55:17.703339 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:17.703712 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507
[0m13:55:17.703993 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:55:17.704242 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:17.704511 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_quantity__1__True.d428857507, now test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097)
[0m13:55:17.704897 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:55:17.710567 [debug] [Thread-1  ]: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:55:17.711014 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097
[0m13:55:17.711305 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:55:17.711580 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097, now test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6)
[0m13:55:17.711805 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:55:17.714786 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:55:17.715132 [debug] [Thread-4  ]: Marking all children of 'test.ecommerce_datamart.dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True.aa0c658097' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_expectations_expect_column_values_to_be_between_fct_order_items_unit_price__0__True (models/core/schema.yml)
  'dbt_expectations' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:55:17.715564 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:55:17.715938 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:55:17.716162 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:55:17.716389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6, now test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02)
[0m13:55:17.716599 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:55:17.720061 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:55:17.720422 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:55:17.720791 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:55:17.721012 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:55:17.721256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02, now test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55)
[0m13:55:17.721467 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:55:17.724173 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:55:17.724541 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:55:17.724920 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:55:17.725148 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:55:17.725413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55, now test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc)
[0m13:55:17.725639 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:55:17.728297 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:55:17.728653 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:55:17.729022 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:55:17.729243 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:55:17.729488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc, now test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03)
[0m13:55:17.729702 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:55:17.732332 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:55:17.732664 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:55:17.733037 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:55:17.733265 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:55:17.733519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03, now test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8)
[0m13:55:17.733743 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:55:17.736511 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:55:17.736879 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:55:17.737260 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:55:17.737488 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:55:17.737753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8, now test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m13:55:17.738002 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:55:17.741592 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:55:17.741956 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:55:17.742335 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:55:17.742562 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:55:17.742810 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m13:55:17.743031 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:55:17.747442 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:55:17.747804 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:55:17.748188 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:55:17.748414 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:55:17.748683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768)
[0m13:55:17.748936 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:55:17.751595 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:55:17.751948 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:55:17.752327 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:55:18.610542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:40.210508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11948c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad39460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad39280>]}


============================== 13:56:40.213799 | e58b2e73-e17e-4538-8e79-4e1c2e28121b ==============================
[0m13:56:40.213799 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:56:40.214433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --no-version-check', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:40.329561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e58b2e73-e17e-4538-8e79-4e1c2e28121b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad39190>]}
[0m13:56:40.375746 [debug] [MainThread]: Set downloads directory='/var/folders/ch/fmvg17wn41d7pj3kkrwn98w40000gp/T/dbt-downloads-u7lxuwhv'
[0m13:56:40.376081 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:56:40.431118 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:56:40.433379 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:56:40.463615 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:56:40.467221 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m13:56:40.547723 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m13:56:40.549957 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:56:41.574888 [info ] [MainThread]: Installed from version 1.3.0
[0m13:56:41.575311 [info ] [MainThread]: Up to date!
[0m13:56:41.575639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e58b2e73-e17e-4538-8e79-4e1c2e28121b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11addfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11addf850>]}
[0m13:56:41.576490 [info ] [MainThread]: Installing dbt-labs/codegen
[0m13:56:42.038654 [info ] [MainThread]: Installed from version 0.13.1
[0m13:56:42.038982 [info ] [MainThread]: Up to date!
[0m13:56:42.039234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e58b2e73-e17e-4538-8e79-4e1c2e28121b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aef4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aef4280>]}
[0m13:56:42.040844 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8872068, "process_in_blocks": "0", "process_kernel_time": 0.218967, "process_mem_max_rss": "103858176", "process_out_blocks": "0", "process_user_time": 1.094826}
[0m13:56:42.041161 [debug] [MainThread]: Command `dbt deps` succeeded at 13:56:42.041098 after 1.89 seconds
[0m13:56:42.041437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11948c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118018e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119712070>]}
[0m13:56:42.041689 [debug] [MainThread]: Flushing usage events
[0m13:56:43.061281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:44.162523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103463790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d8280>]}


============================== 13:56:44.165182 | 310ce6f8-37c0-4c5e-8619-4d8150206e76 ==============================
[0m13:56:44.165182 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:56:44.165566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:44.173529 [info ] [MainThread]: dbt version: 1.9.4
[0m13:56:44.173850 [info ] [MainThread]: python version: 3.9.6
[0m13:56:44.174054 [info ] [MainThread]: python path: /Library/Developer/CommandLineTools/usr/bin/python3
[0m13:56:44.174254 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m13:56:44.224298 [info ] [MainThread]: Using profiles dir at /Users/user/.dbt
[0m13:56:44.224655 [info ] [MainThread]: Using profiles.yml file at /Users/user/.dbt/profiles.yml
[0m13:56:44.224853 [info ] [MainThread]: Using dbt_project.yml file at /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/dbt_project.yml
[0m13:56:44.225420 [info ] [MainThread]: adapter type: postgres
[0m13:56:44.225652 [info ] [MainThread]: adapter version: 1.9.0
[0m13:56:44.312237 [info ] [MainThread]: Configuration:
[0m13:56:44.312581 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:56:44.312777 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:56:44.312961 [info ] [MainThread]: Required dependencies:
[0m13:56:44.313232 [debug] [MainThread]: Executing "git --help"
[0m13:56:44.329942 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:56:44.331410 [debug] [MainThread]: STDERR: "b''"
[0m13:56:44.331722 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:56:44.332464 [info ] [MainThread]: Connection:
[0m13:56:44.336147 [info ] [MainThread]:   host: localhost
[0m13:56:44.340058 [info ] [MainThread]:   port: 5434
[0m13:56:44.341815 [info ] [MainThread]:   user: dbt_user
[0m13:56:44.343145 [info ] [MainThread]:   database: dbt_db_ex3
[0m13:56:44.351004 [info ] [MainThread]:   schema: public
[0m13:56:44.358588 [info ] [MainThread]:   connect_timeout: 10
[0m13:56:44.365796 [info ] [MainThread]:   role: None
[0m13:56:44.378638 [info ] [MainThread]:   search_path: None
[0m13:56:44.391109 [info ] [MainThread]:   keepalives_idle: 0
[0m13:56:44.401774 [info ] [MainThread]:   sslmode: None
[0m13:56:44.402147 [info ] [MainThread]:   sslcert: None
[0m13:56:44.402615 [info ] [MainThread]:   sslkey: None
[0m13:56:44.403233 [info ] [MainThread]:   sslrootcert: None
[0m13:56:44.403529 [info ] [MainThread]:   application_name: dbt
[0m13:56:44.403737 [info ] [MainThread]:   retries: 1
[0m13:56:44.404472 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:56:44.496713 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:56:44.527863 [debug] [MainThread]: Using postgres connection "debug"
[0m13:56:44.528276 [debug] [MainThread]: On debug: select 1 as id
[0m13:56:44.528526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:44.556081 [debug] [MainThread]: SQL status: SELECT 1 in 0.027 seconds
[0m13:56:44.556800 [debug] [MainThread]: On debug: Close
[0m13:56:44.557032 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:56:44.557268 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:56:44.558376 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.44942224, "process_in_blocks": "0", "process_kernel_time": 0.1635, "process_mem_max_rss": "114262016", "process_out_blocks": "0", "process_user_time": 1.073278}
[0m13:56:44.558690 [debug] [MainThread]: Command `dbt debug` succeeded at 13:56:44.558619 after 0.45 seconds
[0m13:56:44.558911 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:56:44.559136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103463790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f8eb0>]}
[0m13:56:44.559402 [debug] [MainThread]: Flushing usage events
[0m13:56:45.523969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:46.668580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d82ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d82e80>]}


============================== 13:56:46.671616 | 5e0223fa-b6c9-4a0a-b3eb-903ac2be5146 ==============================
[0m13:56:46.671616 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:56:46.672010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select source:* staging.* core.*', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:56:46.811559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071010a0>]}
[0m13:56:46.863333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106839f10>]}
[0m13:56:46.863987 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:56:46.960455 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:56:47.123921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:56:47.124912 [debug] [MainThread]: Partial parsing: updated file: ecommerce_datamart://models/core/schema.yml
[0m13:56:47.641719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df59a0>]}
[0m13:56:47.733378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:56:47.736448 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:56:47.746974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad8670>]}
[0m13:56:47.747377 [info ] [MainThread]: Found 17 models, 35 data tests, 4 sources, 591 macros
[0m13:56:47.747611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad8e20>]}
[0m13:56:47.749259 [info ] [MainThread]: 
[0m13:56:47.749518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:47.749716 [info ] [MainThread]: 
[0m13:56:47.750029 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:47.753084 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:56:47.857462 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:56:47.857787 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:56:47.858003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:47.873628 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m13:56:47.874544 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:56:47.876128 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:56:47.881201 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:56:47.881494 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:56:47.881682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:47.887929 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:56:47.888196 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:56:47.888410 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:56:47.892747 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.004 seconds
[0m13:56:47.893984 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:56:47.894613 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:56:47.900702 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:47.900970 [debug] [MainThread]: On master: BEGIN
[0m13:56:47.901154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:47.905400 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:56:47.905730 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:47.905987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:56:47.911585 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m13:56:47.912728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107acd790>]}
[0m13:56:47.913035 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:47.913583 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:47.913791 [debug] [MainThread]: On master: BEGIN
[0m13:56:47.914518 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:56:47.918131 [debug] [MainThread]: On master: COMMIT
[0m13:56:47.918375 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:47.918564 [debug] [MainThread]: On master: COMMIT
[0m13:56:47.919105 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:47.919305 [debug] [MainThread]: On master: Close
[0m13:56:47.921058 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:56:47.921416 [info ] [Thread-1  ]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m13:56:47.921728 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.stg_customers)
[0m13:56:47.921955 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:56:47.928516 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:56:47.929167 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:56:47.964587 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_customers"
[0m13:56:47.965260 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:56:47.965505 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: BEGIN
[0m13:56:47.965725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:47.971572 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:56:47.971923 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:56:47.972174 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */

  create view "dbt_db_ex3"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        trim(lower(email)) as email,
        coalesce(phone, 'Unknown') as phone,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:56:47.978416 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:56:47.984133 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:56:47.984484 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:56:47.985704 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:47.988388 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:56:47.988681 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
alter table "dbt_db_ex3"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:56:47.990031 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:48.002468 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:56:48.002817 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:56:48.003044 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: COMMIT
[0m13:56:48.006072 [debug] [Thread-1  ]: SQL status: COMMIT in 0.003 seconds
[0m13:56:48.011269 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_customers__dbt_backup"
[0m13:56:48.015155 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_customers"
[0m13:56:48.015517 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_customers"} */
drop view if exists "dbt_db_ex3"."public"."stg_customers__dbt_backup" cascade
[0m13:56:48.018602 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m13:56:48.020451 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_customers: Close
[0m13:56:48.021911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083076a0>]}
[0m13:56:48.022517 [info ] [Thread-1  ]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m13:56:48.022913 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:56:48.023183 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_order_items
[0m13:56:48.023540 [info ] [Thread-1  ]: 2 of 8 START sql incremental model public.stg_order_items ...................... [RUN]
[0m13:56:48.023869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_customers, now model.ecommerce_datamart.stg_order_items)
[0m13:56:48.024105 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_order_items
[0m13:56:48.075563 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_order_items"
[0m13:56:48.076199 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_order_items
[0m13:56:48.106583 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:56:48.106952 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

    
  
    

  create temporary table "stg_order_items__dbt_tmp135648095464"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."order_items"
    
    
    where created_at >= (select max(created_at) from "dbt_db_ex3"."public"."stg_order_items")
    
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        greatest(quantity, 1) as quantity,
        coalesce(unit_price, 0) as unit_price,
        coalesce(discount_amount, 0) as discount_amount,
        (quantity * unit_price) - coalesce(discount_amount, 0) as item_total,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:56:48.107210 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:48.119090 [debug] [Thread-1  ]: SQL status: SELECT 301 in 0.012 seconds
[0m13:56:48.130505 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:56:48.130857 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: BEGIN
[0m13:56:48.131948 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:56:48.132201 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:56:48.132436 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_items__dbt_tmp135648095464'
        
      order by ordinal_position

  
[0m13:56:48.139052 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.006 seconds
[0m13:56:48.143684 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:56:48.144140 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_items'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:56:48.147065 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.003 seconds
[0m13:56:48.155083 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:56:48.155553 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_order_items'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:56:48.157952 [debug] [Thread-1  ]: SQL status: SELECT 9 in 0.002 seconds
[0m13:56:48.169360 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_order_items"
[0m13:56:48.170144 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:56:48.170455 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_order_items"} */

      
        
        
        delete from "dbt_db_ex3"."public"."stg_order_items" as DBT_INTERNAL_DEST
        where (order_item_id) in (
            select distinct order_item_id
            from "stg_order_items__dbt_tmp135648095464" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dbt_db_ex3"."public"."stg_order_items" ("order_item_id", "order_id", "product_id", "quantity", "unit_price", "discount_amount", "item_total", "created_at", "updated_at")
    (
        select "order_item_id", "order_id", "product_id", "quantity", "unit_price", "discount_amount", "item_total", "created_at", "updated_at"
        from "stg_order_items__dbt_tmp135648095464"
    )
  
[0m13:56:48.173010 [debug] [Thread-1  ]: SQL status: INSERT 0 301 in 0.002 seconds
[0m13:56:48.173955 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:56:48.174206 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_order_items"
[0m13:56:48.174420 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: COMMIT
[0m13:56:48.176479 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:56:48.176999 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_order_items: Close
[0m13:56:48.177429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619fe50>]}
[0m13:56:48.177902 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model public.stg_order_items ................. [[32mINSERT 0 301[0m in 0.15s]
[0m13:56:48.178265 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_order_items
[0m13:56:48.178520 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_orders
[0m13:56:48.178871 [info ] [Thread-1  ]: 3 of 8 START sql incremental model public.stg_orders ........................... [RUN]
[0m13:56:48.179200 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_order_items, now model.ecommerce_datamart.stg_orders)
[0m13:56:48.179445 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_orders
[0m13:56:48.183070 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_orders"
[0m13:56:48.183859 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_orders
[0m13:56:48.187396 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:56:48.187704 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

    
  
    

  create temporary table "stg_orders__dbt_tmp135648186208"
  
  
    as
  
  (
    

with source as (
    select * from "dbt_db_ex3"."public"."orders"
    
    
    where created_at >= (select max(created_at) from "dbt_db_ex3"."public"."stg_orders")
    
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        payment_method,
        shipping_address,
        shipping_cost,
        total_amount,
        created_at,
        updated_at
    from source
)

select * from staged
  );
  
  
[0m13:56:48.187945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:48.194587 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.007 seconds
[0m13:56:48.197413 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:56:48.197740 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: BEGIN
[0m13:56:48.198676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:56:48.199111 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:56:48.199467 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders__dbt_tmp135648186208'
        
      order by ordinal_position

  
[0m13:56:48.205056 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.005 seconds
[0m13:56:48.208119 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:56:48.208449 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:56:48.211961 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m13:56:48.216168 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:56:48.216729 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'stg_orders'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:56:48.219415 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.002 seconds
[0m13:56:48.221043 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_orders"
[0m13:56:48.221696 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:56:48.221967 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_orders"} */

      
        
        
        delete from "dbt_db_ex3"."public"."stg_orders" as DBT_INTERNAL_DEST
        where (order_id) in (
            select distinct order_id
            from "stg_orders__dbt_tmp135648186208" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dbt_db_ex3"."public"."stg_orders" ("order_id", "customer_id", "order_date", "status", "payment_method", "shipping_address", "shipping_cost", "total_amount", "created_at", "updated_at")
    (
        select "order_id", "customer_id", "order_date", "status", "payment_method", "shipping_address", "shipping_cost", "total_amount", "created_at", "updated_at"
        from "stg_orders__dbt_tmp135648186208"
    )
  
[0m13:56:48.223411 [debug] [Thread-1  ]: SQL status: INSERT 0 100 in 0.001 seconds
[0m13:56:48.224585 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:56:48.224932 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_orders"
[0m13:56:48.225163 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: COMMIT
[0m13:56:48.226563 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:48.227126 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_orders: Close
[0m13:56:48.227531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619fe50>]}
[0m13:56:48.227989 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model public.stg_orders ...................... [[32mINSERT 0 100[0m in 0.05s]
[0m13:56:48.228372 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_orders
[0m13:56:48.228635 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_products
[0m13:56:48.228941 [info ] [Thread-1  ]: 4 of 8 START sql view model public.stg_products ................................ [RUN]
[0m13:56:48.229286 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_orders, now model.ecommerce_datamart.stg_products)
[0m13:56:48.229611 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_products
[0m13:56:48.232665 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_products"
[0m13:56:48.233186 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_products
[0m13:56:48.237030 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.stg_products"
[0m13:56:48.237686 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:56:48.238026 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: BEGIN
[0m13:56:48.238268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:48.243046 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:56:48.243430 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:56:48.243691 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */

  create view "dbt_db_ex3"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db_ex3"."public"."products"
),

staged as (
    select
        product_id,
        name,
        coalesce(price, 0) as price,
        category,
        coalesce(inventory_count, 0) as inventory_count,
        is_active,
        created_at,
        updated_at
    from source
)

select * from staged
  );
[0m13:56:48.245695 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:56:48.248741 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:56:48.249014 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
alter table "dbt_db_ex3"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:56:48.249952 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:48.252776 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:56:48.253091 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
alter table "dbt_db_ex3"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:56:48.253836 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:48.254639 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:56:48.254861 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:56:48.255066 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: COMMIT
[0m13:56:48.255857 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:48.257912 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."stg_products__dbt_backup"
[0m13:56:48.258278 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.stg_products"
[0m13:56:48.258501 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.stg_products"} */
drop view if exists "dbt_db_ex3"."public"."stg_products__dbt_backup" cascade
[0m13:56:48.259506 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m13:56:48.260322 [debug] [Thread-1  ]: On model.ecommerce_datamart.stg_products: Close
[0m13:56:48.260711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3a070>]}
[0m13:56:48.261132 [info ] [Thread-1  ]: 4 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.03s]
[0m13:56:48.261519 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_products
[0m13:56:48.261976 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers
[0m13:56:48.262417 [info ] [Thread-1  ]: 5 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m13:56:48.262747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_products, now model.ecommerce_datamart.dim_customers)
[0m13:56:48.262989 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers
[0m13:56:48.266730 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers"
[0m13:56:48.267336 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers
[0m13:56:48.276584 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers"
[0m13:56:48.277251 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:56:48.277483 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: BEGIN
[0m13:56:48.277690 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:48.285032 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:56:48.285379 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:56:48.285627 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db_ex3"."public"."stg_customers"
),

customer_orders as (
    select
        customer_id,
        count(*) as order_count,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        sum(total_amount) as lifetime_value
    from "dbt_db_ex3"."public"."stg_orders"
    group by 1
)

select
    c.customer_id,
    c.name,
    c.email,
    c.phone,
    c.created_at,
    coalesce(co.order_count, 0) as lifetime_orders,
    co.first_order_date,
    co.most_recent_order_date,
    coalesce(co.lifetime_value, 0) as lifetime_value,
    current_timestamp as updated_at
from customers c
left join customer_orders co using (customer_id)
  );
  
[0m13:56:48.289528 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.004 seconds
[0m13:56:48.294843 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:56:48.295124 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
alter table "dbt_db_ex3"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m13:56:48.295927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:48.298268 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:56:48.298508 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
alter table "dbt_db_ex3"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:56:48.299114 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:56:48.299906 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:56:48.300144 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:56:48.300356 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: COMMIT
[0m13:56:48.301061 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m13:56:48.303123 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_customers__dbt_backup"
[0m13:56:48.304702 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers"
[0m13:56:48.304950 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers"} */
drop table if exists "dbt_db_ex3"."public"."dim_customers__dbt_backup" cascade
[0m13:56:48.308375 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:56:48.309241 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers: Close
[0m13:56:48.309634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083073a0>]}
[0m13:56:48.310062 [info ] [Thread-1  ]: 5 of 8 OK created sql table model public.dim_customers ......................... [[32mSELECT 10[0m in 0.05s]
[0m13:56:48.310423 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers
[0m13:56:48.310683 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_orders
[0m13:56:48.310976 [info ] [Thread-1  ]: 6 of 8 START sql table model public.fct_orders ................................. [RUN]
[0m13:56:48.311352 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers, now model.ecommerce_datamart.fct_orders)
[0m13:56:48.311598 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_orders
[0m13:56:48.315151 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_orders"
[0m13:56:48.315661 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_orders
[0m13:56:48.319018 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_orders"
[0m13:56:48.319653 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:56:48.319900 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: BEGIN
[0m13:56:48.320443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:48.325055 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:56:48.325366 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:56:48.325631 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

order_items as (
    select
        order_id,
        count(*) as number_of_items,
        sum(quantity) as total_items,
        sum(item_total) as items_subtotal
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    o.order_id,
    o.customer_id,
    o.order_date,
    o.status,
    o.payment_method,
    o.shipping_address,
    o.shipping_cost,
    o.total_amount,
    oi.number_of_items,
    oi.total_items,
    oi.items_subtotal,
    (oi.items_subtotal + o.shipping_cost) as calculated_total,
    abs(o.total_amount - (oi.items_subtotal + o.shipping_cost)) as total_amount_discrepancy,
    o.created_at,
    o.updated_at,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    extract(hour from o.order_date) as order_hour
from orders o
left join order_items oi using (order_id)
  );
  
[0m13:56:48.329516 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.004 seconds
[0m13:56:48.332660 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:56:48.333049 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
alter table "dbt_db_ex3"."public"."fct_orders" rename to "fct_orders__dbt_backup"
[0m13:56:48.333871 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:48.337370 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:56:48.337677 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
alter table "dbt_db_ex3"."public"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m13:56:48.338476 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:48.339334 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:56:48.339579 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:56:48.339797 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: COMMIT
[0m13:56:48.340788 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:48.342892 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_orders__dbt_backup"
[0m13:56:48.343275 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_orders"
[0m13:56:48.343515 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_orders"} */
drop table if exists "dbt_db_ex3"."public"."fct_orders__dbt_backup" cascade
[0m13:56:48.346759 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:56:48.347721 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_orders: Close
[0m13:56:48.348145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c49af0>]}
[0m13:56:48.348605 [info ] [Thread-1  ]: 6 of 8 OK created sql table model public.fct_orders ............................ [[32mSELECT 100[0m in 0.04s]
[0m13:56:48.348985 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_orders
[0m13:56:48.349282 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products
[0m13:56:48.349648 [info ] [Thread-1  ]: 7 of 8 START sql table model public.dim_products ............................... [RUN]
[0m13:56:48.349978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_orders, now model.ecommerce_datamart.dim_products)
[0m13:56:48.350227 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products
[0m13:56:48.353840 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products"
[0m13:56:48.354371 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products
[0m13:56:48.357724 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products"
[0m13:56:48.358396 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:56:48.358646 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: BEGIN
[0m13:56:48.358861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:48.363988 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:56:48.364340 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:56:48.364608 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db_ex3"."public"."stg_products"
),

product_sales as (
    select
        product_id,
        sum(quantity) as total_quantity_sold,
        sum(item_total) as total_revenue
    from "dbt_db_ex3"."public"."stg_order_items"
    group by 1
)

select
    p.product_id,
    p.name,
    p.price,
    p.category,
    p.inventory_count,
    p.is_active,
    p.created_at,
    coalesce(ps.total_quantity_sold, 0) as total_quantity_sold,
    coalesce(ps.total_revenue, 0) as total_revenue,
    case
        when p.inventory_count = 0 then 'Out of stock'
        when p.inventory_count < 10 then 'Low stock'
        else 'In stock'
    end as inventory_status,
    current_timestamp as updated_at
from products p
left join product_sales ps using (product_id)
  );
  
[0m13:56:48.367396 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.003 seconds
[0m13:56:48.370288 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:56:48.370613 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
alter table "dbt_db_ex3"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m13:56:48.371483 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:48.373998 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:56:48.374247 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
alter table "dbt_db_ex3"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m13:56:48.374756 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:56:48.375559 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:56:48.375798 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:56:48.376015 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: COMMIT
[0m13:56:48.376847 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:48.378870 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products__dbt_backup"
[0m13:56:48.379222 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products"
[0m13:56:48.379450 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products"} */
drop table if exists "dbt_db_ex3"."public"."dim_products__dbt_backup" cascade
[0m13:56:48.380629 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:56:48.381417 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products: Close
[0m13:56:48.381827 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a9c40>]}
[0m13:56:48.382277 [info ] [Thread-1  ]: 7 of 8 OK created sql table model public.dim_products .......................... [[32mSELECT 15[0m in 0.03s]
[0m13:56:48.382637 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products
[0m13:56:48.382926 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_order_items
[0m13:56:48.383288 [info ] [Thread-1  ]: 8 of 8 START sql table model public.fct_order_items ............................ [RUN]
[0m13:56:48.383611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products, now model.ecommerce_datamart.fct_order_items)
[0m13:56:48.383849 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_order_items
[0m13:56:48.386671 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_order_items"
[0m13:56:48.387183 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_order_items
[0m13:56:48.391083 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_order_items"
[0m13:56:48.391593 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:56:48.391823 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: BEGIN
[0m13:56:48.392040 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:48.397305 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:56:48.397627 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:56:48.397894 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp"
  
  
    as
  
  (
    with order_items as (
    select * from "dbt_db_ex3"."public"."stg_order_items"
),

orders as (
    select * from "dbt_db_ex3"."public"."stg_orders"
),

products as (
    select * from "dbt_db_ex3"."public"."stg_products"
)

select
    oi.order_item_id,
    oi.order_id,
    oi.product_id,
    o.customer_id,
    o.order_date,
    p.category as product_category,
    oi.quantity,
    oi.unit_price,
    oi.discount_amount,
    oi.item_total,
    (oi.unit_price * oi.quantity) as gross_item_sales_value,
    oi.discount_amount as item_discount_value,
    ((oi.unit_price * oi.quantity) - oi.item_total) as total_discount_impact,
    case
        when oi.discount_amount > 0 then true
        else false
    end as is_discounted,
    o.status as order_status,
    date_trunc('day', o.order_date) as order_day,
    date_trunc('week', o.order_date) as order_week,
    date_trunc('month', o.order_date) as order_month,
    oi.created_at,
    current_timestamp as updated_at
from order_items oi
join orders o using (order_id)
join products p using (product_id)
  );
  
[0m13:56:48.403028 [debug] [Thread-1  ]: SQL status: SELECT 301 in 0.005 seconds
[0m13:56:48.406021 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:56:48.406290 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
alter table "dbt_db_ex3"."public"."fct_order_items" rename to "fct_order_items__dbt_backup"
[0m13:56:48.407016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:56:48.409474 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:56:48.409730 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
alter table "dbt_db_ex3"."public"."fct_order_items__dbt_tmp" rename to "fct_order_items"
[0m13:56:48.410569 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:48.411656 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:56:48.411967 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:56:48.412200 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: COMMIT
[0m13:56:48.413358 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:48.415462 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_order_items__dbt_backup"
[0m13:56:48.415835 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_order_items"
[0m13:56:48.416073 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_order_items"} */
drop table if exists "dbt_db_ex3"."public"."fct_order_items__dbt_backup" cascade
[0m13:56:48.417466 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:56:48.418345 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_order_items: Close
[0m13:56:48.418743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0223fa-b6c9-4a0a-b3eb-903ac2be5146', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108481ca0>]}
[0m13:56:48.419171 [info ] [Thread-1  ]: 8 of 8 OK created sql table model public.fct_order_items ....................... [[32mSELECT 301[0m in 0.04s]
[0m13:56:48.419528 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_order_items
[0m13:56:48.420262 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:48.420497 [debug] [MainThread]: On master: BEGIN
[0m13:56:48.420682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:48.425184 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:56:48.425538 [debug] [MainThread]: On master: COMMIT
[0m13:56:48.426247 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:48.426807 [debug] [MainThread]: On master: COMMIT
[0m13:56:48.427359 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:48.427587 [debug] [MainThread]: On master: Close
[0m13:56:48.427875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:48.428059 [debug] [MainThread]: Connection 'model.ecommerce_datamart.fct_order_items' was properly closed.
[0m13:56:48.428333 [info ] [MainThread]: 
[0m13:56:48.428551 [info ] [MainThread]: Finished running 2 incremental models, 4 table models, 2 view models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m13:56:48.429487 [debug] [MainThread]: Command end result
[0m13:56:48.460554 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:56:48.461758 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:56:48.466170 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:56:48.466413 [info ] [MainThread]: 
[0m13:56:48.466663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:48.466865 [info ] [MainThread]: 
[0m13:56:48.467072 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:56:48.468156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8610685, "process_in_blocks": "0", "process_kernel_time": 0.198752, "process_mem_max_rss": "135495680", "process_out_blocks": "0", "process_user_time": 2.286307}
[0m13:56:48.468401 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:48.468355 after 1.86 seconds
[0m13:56:48.468622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f097f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106839f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ad8670>]}
[0m13:56:48.468855 [debug] [MainThread]: Flushing usage events
[0m13:56:49.680790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:50.836991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfbe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfb220>]}


============================== 13:56:50.839458 | e8c80af1-1f96-4e26-bca0-0934574fbb9d ==============================
[0m13:56:50.839458 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:56:50.839806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select core.* --store-failures', 'send_anonymous_usage_stats': 'True'}
[0m13:56:50.959801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8c80af1-1f96-4e26-bca0-0934574fbb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107202f40>]}
[0m13:56:51.006185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8c80af1-1f96-4e26-bca0-0934574fbb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e9d90>]}
[0m13:56:51.006811 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:56:51.081903 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:56:51.186080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:51.186364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:51.252073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c80af1-1f96-4e26-bca0-0934574fbb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5feb0>]}
[0m13:56:51.340158 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:56:51.342531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:56:51.356367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8c80af1-1f96-4e26-bca0-0934574fbb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f9c40>]}
[0m13:56:51.356731 [info ] [MainThread]: Found 17 models, 35 data tests, 4 sources, 591 macros
[0m13:56:51.356952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c80af1-1f96-4e26-bca0-0934574fbb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509d1f0>]}
[0m13:56:51.358819 [info ] [MainThread]: 
[0m13:56:51.359038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:51.359217 [info ] [MainThread]: 
[0m13:56:51.359504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:51.363375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:56:51.388244 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:56:51.388513 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:56:51.388700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:51.401498 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m13:56:51.402352 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:56:51.405498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public_dbt_test__audit)
[0m13:56:51.409949 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:56:51.410204 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: BEGIN
[0m13:56:51.410404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:51.415274 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:56:51.415549 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:56:51.415773 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public_dbt_test__audit"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:56:51.417745 [debug] [ThreadPool]: SQL status: SELECT 35 in 0.002 seconds
[0m13:56:51.419135 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: ROLLBACK
[0m13:56:51.419605 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: Close
[0m13:56:51.419979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public_dbt_test__audit, now list_dbt_db_ex3_public)
[0m13:56:51.421821 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:56:51.424639 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:56:51.424839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:51.428743 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:56:51.428985 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:56:51.429199 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:56:51.431374 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m13:56:51.433055 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:56:51.433558 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:56:51.441219 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:51.441462 [debug] [MainThread]: On master: BEGIN
[0m13:56:51.441653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:51.445666 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:56:51.445905 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:51.446165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:56:51.451124 [debug] [MainThread]: SQL status: SELECT 2 in 0.005 seconds
[0m13:56:51.452248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c80af1-1f96-4e26-bca0-0934574fbb9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d12be0>]}
[0m13:56:51.452584 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:51.453132 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:51.453391 [debug] [MainThread]: On master: BEGIN
[0m13:56:51.454202 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:56:51.454431 [debug] [MainThread]: On master: COMMIT
[0m13:56:51.454649 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:51.454860 [debug] [MainThread]: On master: COMMIT
[0m13:56:51.455328 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:51.455565 [debug] [MainThread]: On master: Close
[0m13:56:51.457258 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:56:51.457587 [info ] [Thread-1  ]: 1 of 31 START test accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [RUN]
[0m13:56:51.457920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:56:51.458188 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:56:51.471504 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:56:51.472034 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:56:51.485552 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:56:51.488793 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:56:51.489092 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680" cascade
[0m13:56:51.489336 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.495876 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:56:51.498082 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
[0m13:56:51.506459 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:56:51.506750 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:56:51.507718 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:56:51.507979 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:56:51.508236 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        category as value_field,
        count(*) as n_records

    from "dbt_db_ex3"."public"."dim_products"
    group by category

)

select *
from all_values
where value_field not in (
    'Electronics','Clothing','Footwear','Accessories'
)



  );
  
    
[0m13:56:51.511260 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:56:51.511878 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:56:51.512147 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:56:51.512394 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: COMMIT
[0m13:56:51.514205 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:56:51.516810 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:56:51.517558 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:56:51.517824 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: BEGIN
[0m13:56:51.518528 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.518786 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:56:51.519050 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_dim_products_d7178e429849cd46479b7235b8b9a680"
    
      
    ) dbt_internal_test
[0m13:56:51.520079 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:51.522913 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: ROLLBACK
[0m13:56:51.523664 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd: Close
[0m13:56:51.524083 [info ] [Thread-1  ]: 1 of 31 PASS accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories  [[32mPASS[0m in 0.07s]
[0m13:56:51.524471 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:56:51.524739 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:56:51.525033 [info ] [Thread-1  ]: 2 of 31 START test accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [RUN]
[0m13:56:51.525325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:56:51.525574 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:56:51.530411 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:56:51.530873 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:56:51.534656 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:56:51.535034 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:56:51.535292 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff" cascade
[0m13:56:51.535529 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.542319 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m13:56:51.543065 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
[0m13:56:51.543623 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:56:51.543876 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:56:51.544496 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.544734 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:56:51.544995 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
  
  
    as
  
  (
    
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "dbt_db_ex3"."public"."fct_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'completed','processing','cancelled','refunded'
)



  );
  
    
[0m13:56:51.547703 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.548335 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:56:51.548604 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:56:51.548856 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: COMMIT
[0m13:56:51.550220 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.550633 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:56:51.551136 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:56:51.551402 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: BEGIN
[0m13:56:51.551994 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.552248 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:56:51.552517 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."accepted_values_fct_orders_d8be01b9c84037793261c45fe0e078ff"
    
      
    ) dbt_internal_test
[0m13:56:51.553417 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:51.554372 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: ROLLBACK
[0m13:56:51.555059 [debug] [Thread-1  ]: On test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339: Close
[0m13:56:51.555474 [info ] [Thread-1  ]: 2 of 31 PASS accepted_values_fct_orders_status__completed__processing__cancelled__refunded  [[32mPASS[0m in 0.03s]
[0m13:56:51.555873 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:56:51.556152 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:56:51.556448 [info ] [Thread-1  ]: 3 of 31 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m13:56:51.556751 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:56:51.557011 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:56:51.562508 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:51.563028 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:56:51.567776 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:56:51.568186 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:51.568453 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id" cascade
[0m13:56:51.568703 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.574887 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:56:51.575621 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
[0m13:56:51.576105 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:51.576354 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:56:51.576941 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.577224 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:51.577492 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where customer_id is null



  );
  
    
[0m13:56:51.580766 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:56:51.581452 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:56:51.581731 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:51.581988 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: COMMIT
[0m13:56:51.583026 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.583488 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:51.584025 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:51.584297 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m13:56:51.584767 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.585037 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:56:51.585308 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:56:51.585935 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.586936 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m13:56:51.587430 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m13:56:51.587862 [info ] [Thread-1  ]: 3 of 31 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.03s]
[0m13:56:51.588270 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:56:51.588551 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:56:51.588874 [info ] [Thread-1  ]: 4 of 31 START test not_null_dim_customers_email ................................ [RUN]
[0m13:56:51.589227 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a)
[0m13:56:51.589503 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:56:51.593003 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:56:51.593503 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:56:51.597519 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:56:51.597921 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:56:51.598182 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email" cascade
[0m13:56:51.598423 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.603733 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:56:51.604520 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
[0m13:56:51.604998 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:56:51.605242 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:56:51.605734 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.605972 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:56:51.606212 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where email is null



  );
  
    
[0m13:56:51.608496 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.609190 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:56:51.609474 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:56:51.609733 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: COMMIT
[0m13:56:51.610786 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.611218 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:56:51.611721 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:56:51.611977 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: BEGIN
[0m13:56:51.612436 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.612694 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:56:51.612957 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:56:51.613591 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.614551 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: ROLLBACK
[0m13:56:51.615002 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a: Close
[0m13:56:51.615424 [info ] [Thread-1  ]: 4 of 31 PASS not_null_dim_customers_email ...................................... [[32mPASS[0m in 0.03s]
[0m13:56:51.615830 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:56:51.616109 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:56:51.616381 [info ] [Thread-1  ]: 5 of 31 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m13:56:51.616728 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:56:51.616990 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:56:51.620375 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:51.620861 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:56:51.625624 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:56:51.626030 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:51.626288 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders" cascade
[0m13:56:51.626532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.631403 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:56:51.632153 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
[0m13:56:51.632652 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:51.632913 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:56:51.633430 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.633676 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:51.633927 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where lifetime_orders is null



  );
  
    
[0m13:56:51.636173 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.636815 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:56:51.637097 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:51.637339 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: COMMIT
[0m13:56:51.638496 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.638913 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:51.639404 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:51.639661 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m13:56:51.640133 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.640381 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:56:51.640642 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_orders"
    
      
    ) dbt_internal_test
[0m13:56:51.641302 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.642323 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m13:56:51.642806 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m13:56:51.643232 [info ] [Thread-1  ]: 5 of 31 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.03s]
[0m13:56:51.643614 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:56:51.643879 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:56:51.644176 [info ] [Thread-1  ]: 6 of 31 START test not_null_dim_customers_lifetime_value ....................... [RUN]
[0m13:56:51.644479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888)
[0m13:56:51.644728 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:56:51.648065 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:56:51.648683 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:56:51.652687 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
[0m13:56:51.653124 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:56:51.653363 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value" cascade
[0m13:56:51.653592 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.658776 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:56:51.659498 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
[0m13:56:51.659980 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:56:51.660228 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m13:56:51.660756 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.661018 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:56:51.661278 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where lifetime_value is null



  );
  
    
[0m13:56:51.663596 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.664223 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: COMMIT
[0m13:56:51.664481 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:56:51.664720 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: COMMIT
[0m13:56:51.665561 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.665971 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:56:51.666444 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:56:51.666690 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m13:56:51.667285 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.667525 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:56:51.667772 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_lifetime_value"
    
      
    ) dbt_internal_test
[0m13:56:51.668801 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:51.669748 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: ROLLBACK
[0m13:56:51.670326 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888: Close
[0m13:56:51.670736 [info ] [Thread-1  ]: 6 of 31 PASS not_null_dim_customers_lifetime_value ............................. [[32mPASS[0m in 0.03s]
[0m13:56:51.671131 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:56:51.671406 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:56:51.671702 [info ] [Thread-1  ]: 7 of 31 START test not_null_dim_customers_name ................................. [RUN]
[0m13:56:51.672004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888, now test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1)
[0m13:56:51.672260 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:56:51.676385 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:56:51.676852 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:56:51.681188 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:56:51.681669 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:56:51.681934 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name" cascade
[0m13:56:51.682179 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.686151 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:51.687088 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
[0m13:56:51.687649 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:56:51.687913 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:56:51.688688 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.688993 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:56:51.689265 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_customers"
where name is null



  );
  
    
[0m13:56:51.692580 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:56:51.693310 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:56:51.693586 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:56:51.693834 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: COMMIT
[0m13:56:51.695195 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.695687 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:56:51.696220 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:56:51.696482 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: BEGIN
[0m13:56:51.696966 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.697211 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:56:51.697460 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_customers_name"
    
      
    ) dbt_internal_test
[0m13:56:51.698236 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:51.699197 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: ROLLBACK
[0m13:56:51.699748 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1: Close
[0m13:56:51.700518 [info ] [Thread-1  ]: 7 of 31 PASS not_null_dim_customers_name ....................................... [[32mPASS[0m in 0.03s]
[0m13:56:51.701128 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:56:51.701438 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:56:51.701741 [info ] [Thread-1  ]: 8 of 31 START test not_null_dim_products_category .............................. [RUN]
[0m13:56:51.702063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0)
[0m13:56:51.702326 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:56:51.705790 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:56:51.706324 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:56:51.710384 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
[0m13:56:51.710810 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:56:51.711061 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category" cascade
[0m13:56:51.711299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.716847 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:56:51.717730 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
[0m13:56:51.718235 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:56:51.718475 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: BEGIN
[0m13:56:51.718955 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.719197 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:56:51.719435 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where category is null



  );
  
    
[0m13:56:51.721961 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.722623 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: COMMIT
[0m13:56:51.722891 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:56:51.723134 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: COMMIT
[0m13:56:51.723940 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.724341 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:56:51.724832 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:56:51.725071 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: BEGIN
[0m13:56:51.725521 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.725763 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:56:51.726012 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_category"
    
      
    ) dbt_internal_test
[0m13:56:51.726583 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.727500 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: ROLLBACK
[0m13:56:51.727922 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0: Close
[0m13:56:51.728343 [info ] [Thread-1  ]: 8 of 31 PASS not_null_dim_products_category .................................... [[32mPASS[0m in 0.03s]
[0m13:56:51.728725 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:56:51.728989 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:56:51.729321 [info ] [Thread-1  ]: 9 of 31 START test not_null_dim_products_inventory_count ....................... [RUN]
[0m13:56:51.729627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0, now test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e)
[0m13:56:51.729876 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:56:51.734125 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:56:51.734637 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:56:51.738374 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
[0m13:56:51.738747 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:56:51.738990 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count" cascade
[0m13:56:51.739221 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.743046 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:51.743802 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
[0m13:56:51.744287 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:56:51.744563 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: BEGIN
[0m13:56:51.745223 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.745534 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:56:51.745801 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where inventory_count is null



  );
  
    
[0m13:56:51.748213 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.748806 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: COMMIT
[0m13:56:51.749038 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:56:51.749250 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: COMMIT
[0m13:56:51.751225 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.755467 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:56:51.755945 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:56:51.756167 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: BEGIN
[0m13:56:51.756654 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.756897 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:56:51.757128 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_inventory_count"
    
      
    ) dbt_internal_test
[0m13:56:51.757755 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.758622 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: ROLLBACK
[0m13:56:51.759046 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e: Close
[0m13:56:51.759425 [info ] [Thread-1  ]: 9 of 31 PASS not_null_dim_products_inventory_count ............................. [[32mPASS[0m in 0.03s]
[0m13:56:51.759784 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:56:51.760032 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:56:51.760301 [info ] [Thread-1  ]: 10 of 31 START test not_null_dim_products_name ................................. [RUN]
[0m13:56:51.760573 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e, now test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff)
[0m13:56:51.760801 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:56:51.763949 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:56:51.764403 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:56:51.768099 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:56:51.769186 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:56:51.769430 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name" cascade
[0m13:56:51.769658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.773342 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:51.774122 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
[0m13:56:51.774602 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:56:51.774840 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:56:51.775319 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.775563 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:56:51.775800 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where name is null



  );
  
    
[0m13:56:51.777818 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.778413 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:56:51.778659 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:56:51.778882 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: COMMIT
[0m13:56:51.779942 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.780365 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:56:51.780970 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:56:51.781202 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: BEGIN
[0m13:56:51.781643 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.781862 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:56:51.782090 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_name"
    
      
    ) dbt_internal_test
[0m13:56:51.782699 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.783568 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: ROLLBACK
[0m13:56:51.784005 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff: Close
[0m13:56:51.784384 [info ] [Thread-1  ]: 10 of 31 PASS not_null_dim_products_name ....................................... [[32mPASS[0m in 0.02s]
[0m13:56:51.784734 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:56:51.784980 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:56:51.785249 [info ] [Thread-1  ]: 11 of 31 START test not_null_dim_products_price ................................ [RUN]
[0m13:56:51.785562 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff, now test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed)
[0m13:56:51.785799 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:56:51.788946 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:56:51.789441 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:56:51.793122 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:56:51.793499 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:56:51.793735 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price" cascade
[0m13:56:51.793960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.797706 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:51.798552 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
[0m13:56:51.799056 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:56:51.799297 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:56:51.799804 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.800027 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:56:51.800262 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where price is null



  );
  
    
[0m13:56:51.802138 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.802735 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:56:51.802977 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:56:51.803197 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: COMMIT
[0m13:56:51.804133 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.804555 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:56:51.805014 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:56:51.805251 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: BEGIN
[0m13:56:51.805715 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.805932 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:56:51.806157 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_price"
    
      
    ) dbt_internal_test
[0m13:56:51.806748 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.807609 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m13:56:51.808038 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed: Close
[0m13:56:51.808444 [info ] [Thread-1  ]: 11 of 31 PASS not_null_dim_products_price ...................................... [[32mPASS[0m in 0.02s]
[0m13:56:51.808821 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:56:51.809091 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:56:51.809405 [info ] [Thread-1  ]: 12 of 31 START test not_null_dim_products_product_id ........................... [RUN]
[0m13:56:51.809724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed, now test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1)
[0m13:56:51.809980 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:56:51.813342 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:56:51.813843 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:56:51.818272 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:56:51.818648 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:56:51.818888 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id" cascade
[0m13:56:51.819113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.823188 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:51.824034 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
[0m13:56:51.824507 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:56:51.824742 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:56:51.825204 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.825452 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:56:51.825690 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."dim_products"
where product_id is null



  );
  
    
[0m13:56:51.827525 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.828125 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:56:51.828382 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:56:51.828617 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: COMMIT
[0m13:56:51.829573 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.830006 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:56:51.830515 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:56:51.830770 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m13:56:51.831212 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.831464 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:56:51.831712 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:56:51.832332 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.833249 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m13:56:51.833708 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1: Close
[0m13:56:51.834111 [info ] [Thread-1  ]: 12 of 31 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.02s]
[0m13:56:51.834494 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:56:51.834759 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:56:51.835061 [info ] [Thread-1  ]: 13 of 31 START test not_null_fct_order_items_item_total ........................ [RUN]
[0m13:56:51.835385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6)
[0m13:56:51.835643 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:56:51.839017 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:56:51.839532 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:56:51.843226 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
[0m13:56:51.843599 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:56:51.843837 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total" cascade
[0m13:56:51.844060 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.847841 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:51.848553 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
[0m13:56:51.849013 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:56:51.849242 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: BEGIN
[0m13:56:51.849706 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.849947 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:56:51.850198 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where item_total is null



  );
  
    
[0m13:56:51.852481 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:51.853129 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: COMMIT
[0m13:56:51.853392 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:56:51.853632 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: COMMIT
[0m13:56:51.854695 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.855111 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:56:51.855576 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:56:51.855816 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: BEGIN
[0m13:56:51.856284 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.856517 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:56:51.856760 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_item_total"
    
      
    ) dbt_internal_test
[0m13:56:51.857417 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.858461 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: ROLLBACK
[0m13:56:51.858951 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6: Close
[0m13:56:51.859364 [info ] [Thread-1  ]: 13 of 31 PASS not_null_fct_order_items_item_total .............................. [[32mPASS[0m in 0.02s]
[0m13:56:51.859752 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:56:51.860021 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:56:51.860318 [info ] [Thread-1  ]: 14 of 31 START test not_null_fct_order_items_order_id .......................... [RUN]
[0m13:56:51.860624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6, now test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02)
[0m13:56:51.860876 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:56:51.864133 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:56:51.864587 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:56:51.901980 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
[0m13:56:51.902473 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:56:51.902731 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id" cascade
[0m13:56:51.902967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.909118 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:56:51.909940 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
[0m13:56:51.910435 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:56:51.910675 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: BEGIN
[0m13:56:51.911395 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.911621 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:56:51.911851 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where order_id is null



  );
  
    
[0m13:56:51.915798 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:56:51.916503 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: COMMIT
[0m13:56:51.916763 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:56:51.916993 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: COMMIT
[0m13:56:51.918212 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.918741 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:56:51.919279 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:56:51.919576 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: BEGIN
[0m13:56:51.926658 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m13:56:51.927420 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:56:51.928042 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_id"
    
      
    ) dbt_internal_test
[0m13:56:51.931146 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m13:56:51.932710 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: ROLLBACK
[0m13:56:51.933955 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02: Close
[0m13:56:51.934980 [info ] [Thread-1  ]: 14 of 31 PASS not_null_fct_order_items_order_id ................................ [[32mPASS[0m in 0.07s]
[0m13:56:51.935426 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:56:51.935715 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:56:51.936040 [info ] [Thread-1  ]: 15 of 31 START test not_null_fct_order_items_order_item_id ..................... [RUN]
[0m13:56:51.936380 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02, now test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55)
[0m13:56:51.936619 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:56:51.939804 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:56:51.940432 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:56:51.944359 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
[0m13:56:51.944813 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:56:51.945062 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id" cascade
[0m13:56:51.945294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.950619 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:56:51.951447 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
[0m13:56:51.951942 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:56:51.952173 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: BEGIN
[0m13:56:51.952805 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.953052 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:56:51.953295 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where order_item_id is null



  );
  
    
[0m13:56:51.957671 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:56:51.958377 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: COMMIT
[0m13:56:51.958637 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:56:51.958862 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: COMMIT
[0m13:56:51.960119 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.960569 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:56:51.961018 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:56:51.961252 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: BEGIN
[0m13:56:51.961739 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.961974 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:56:51.962202 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m13:56:51.962878 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:51.963832 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: ROLLBACK
[0m13:56:51.964304 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55: Close
[0m13:56:51.964739 [info ] [Thread-1  ]: 15 of 31 PASS not_null_fct_order_items_order_item_id ........................... [[32mPASS[0m in 0.03s]
[0m13:56:51.965123 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:56:51.965387 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:56:51.965672 [info ] [Thread-1  ]: 16 of 31 START test not_null_fct_order_items_product_id ........................ [RUN]
[0m13:56:51.965966 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55, now test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc)
[0m13:56:51.966193 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:56:51.969470 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:56:51.969979 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:56:51.974694 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
[0m13:56:51.975128 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:56:51.975378 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id" cascade
[0m13:56:51.975606 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:51.980675 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:56:51.981482 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
[0m13:56:51.982067 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:56:51.982312 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: BEGIN
[0m13:56:51.982879 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.983120 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:56:51.983357 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where product_id is null



  );
  
    
[0m13:56:51.986273 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:56:51.987082 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: COMMIT
[0m13:56:51.987367 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:56:51.987605 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: COMMIT
[0m13:56:51.988825 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:51.989337 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:56:51.989880 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:56:51.990124 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: BEGIN
[0m13:56:51.990802 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:51.991070 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:56:51.991320 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_product_id"
    
      
    ) dbt_internal_test
[0m13:56:51.992138 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:51.993143 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: ROLLBACK
[0m13:56:51.993789 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc: Close
[0m13:56:51.994265 [info ] [Thread-1  ]: 16 of 31 PASS not_null_fct_order_items_product_id .............................. [[32mPASS[0m in 0.03s]
[0m13:56:51.994708 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:56:51.995012 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:56:51.995273 [info ] [Thread-1  ]: 17 of 31 START test not_null_fct_order_items_quantity .......................... [RUN]
[0m13:56:51.995985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc, now test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03)
[0m13:56:51.996311 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:56:52.066279 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:56:52.067706 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:56:52.073442 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
[0m13:56:52.074715 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:56:52.075294 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity" cascade
[0m13:56:52.075563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.087968 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.012 seconds
[0m13:56:52.088875 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
[0m13:56:52.089414 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:56:52.089668 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: BEGIN
[0m13:56:52.090377 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.090673 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:56:52.090925 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where quantity is null



  );
  
    
[0m13:56:52.096143 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:56:52.097971 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: COMMIT
[0m13:56:52.098310 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:56:52.098551 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: COMMIT
[0m13:56:52.100895 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:56:52.101663 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:56:52.102248 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:56:52.102502 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: BEGIN
[0m13:56:52.103373 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:56:52.103634 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:56:52.103874 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_quantity"
    
      
    ) dbt_internal_test
[0m13:56:52.104879 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:52.106107 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: ROLLBACK
[0m13:56:52.107013 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03: Close
[0m13:56:52.107855 [info ] [Thread-1  ]: 17 of 31 PASS not_null_fct_order_items_quantity ................................ [[32mPASS[0m in 0.11s]
[0m13:56:52.108291 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:56:52.108570 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:56:52.108962 [info ] [Thread-1  ]: 18 of 31 START test not_null_fct_order_items_unit_price ........................ [RUN]
[0m13:56:52.109333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03, now test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8)
[0m13:56:52.109590 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:56:52.113562 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:56:52.114251 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:56:52.119894 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
[0m13:56:52.120459 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:56:52.120841 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price" cascade
[0m13:56:52.121106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.127255 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:56:52.128289 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
[0m13:56:52.128960 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:56:52.129283 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: BEGIN
[0m13:56:52.130130 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:56:52.130458 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:56:52.130854 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_order_items"
where unit_price is null



  );
  
    
[0m13:56:52.135182 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:56:52.136008 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: COMMIT
[0m13:56:52.136320 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:56:52.136566 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: COMMIT
[0m13:56:52.138216 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.138829 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:56:52.139411 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:56:52.139704 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: BEGIN
[0m13:56:52.140394 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.140652 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:56:52.140895 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_order_items_unit_price"
    
      
    ) dbt_internal_test
[0m13:56:52.141646 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:52.142633 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: ROLLBACK
[0m13:56:52.143333 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8: Close
[0m13:56:52.144271 [info ] [Thread-1  ]: 18 of 31 PASS not_null_fct_order_items_unit_price .............................. [[32mPASS[0m in 0.03s]
[0m13:56:52.145193 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:56:52.145567 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:56:52.145867 [info ] [Thread-1  ]: 19 of 31 START test not_null_fct_orders_customer_id ............................ [RUN]
[0m13:56:52.146201 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8, now test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:56:52.146445 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:56:52.149951 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:56:52.150523 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:56:52.154475 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:56:52.154921 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:56:52.155170 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id" cascade
[0m13:56:52.155403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.160224 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:56:52.161113 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
[0m13:56:52.161635 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:56:52.161881 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:56:52.162617 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.162871 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:56:52.163105 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where customer_id is null



  );
  
    
[0m13:56:52.166157 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.003 seconds
[0m13:56:52.166940 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:56:52.167223 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:56:52.167458 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: COMMIT
[0m13:56:52.168651 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.169129 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:56:52.169665 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:56:52.169909 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m13:56:52.170573 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.170810 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:56:52.171040 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_customer_id"
    
      
    ) dbt_internal_test
[0m13:56:52.171811 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:52.172787 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m13:56:52.173310 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m13:56:52.173762 [info ] [Thread-1  ]: 19 of 31 PASS not_null_fct_orders_customer_id .................................. [[32mPASS[0m in 0.03s]
[0m13:56:52.174142 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:56:52.174404 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:56:52.174702 [info ] [Thread-1  ]: 20 of 31 START test not_null_fct_orders_order_date ............................. [RUN]
[0m13:56:52.175019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362)
[0m13:56:52.175261 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:56:52.179545 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:56:52.180119 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:56:52.184274 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:56:52.184828 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:56:52.185105 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date" cascade
[0m13:56:52.185404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.191039 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:56:52.192000 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
[0m13:56:52.192530 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:56:52.192776 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:56:52.193481 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.193733 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:56:52.193968 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where order_date is null



  );
  
    
[0m13:56:52.198307 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.004 seconds
[0m13:56:52.199111 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:56:52.199386 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:56:52.199624 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: COMMIT
[0m13:56:52.200982 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.201483 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:56:52.202022 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:56:52.202265 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: BEGIN
[0m13:56:52.202842 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.203090 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:56:52.203334 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_date"
    
      
    ) dbt_internal_test
[0m13:56:52.204164 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:52.205237 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: ROLLBACK
[0m13:56:52.205926 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362: Close
[0m13:56:52.206446 [info ] [Thread-1  ]: 20 of 31 PASS not_null_fct_orders_order_date ................................... [[32mPASS[0m in 0.03s]
[0m13:56:52.206847 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:56:52.207113 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:56:52.207365 [info ] [Thread-1  ]: 21 of 31 START test not_null_fct_orders_order_id ............................... [RUN]
[0m13:56:52.207815 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0)
[0m13:56:52.208081 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:56:52.211466 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:56:52.212168 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:56:52.216248 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:56:52.216718 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:56:52.216964 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id" cascade
[0m13:56:52.217192 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.221634 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:52.222490 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
[0m13:56:52.223011 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:56:52.223254 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:56:52.223877 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.224142 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:56:52.224387 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where order_id is null



  );
  
    
[0m13:56:52.226882 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:52.227618 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:56:52.227883 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:56:52.228110 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: COMMIT
[0m13:56:52.229409 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.229867 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:56:52.230398 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:56:52.230637 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m13:56:52.231199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.231443 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:56:52.231677 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:56:52.232452 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:52.234501 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m13:56:52.235104 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0: Close
[0m13:56:52.235551 [info ] [Thread-1  ]: 21 of 31 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.03s]
[0m13:56:52.235922 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:56:52.236182 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:56:52.236481 [info ] [Thread-1  ]: 22 of 31 START test not_null_fct_orders_status ................................. [RUN]
[0m13:56:52.236851 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_datamart.not_null_fct_orders_status.1455048989)
[0m13:56:52.237100 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:56:52.240381 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:56:52.240915 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:56:52.244955 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:56:52.245433 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:56:52.245686 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status" cascade
[0m13:56:52.245926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.250349 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:52.251197 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
[0m13:56:52.251709 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:56:52.251955 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: BEGIN
[0m13:56:52.252600 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.252881 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:56:52.253131 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where status is null



  );
  
    
[0m13:56:52.257976 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.005 seconds
[0m13:56:52.258729 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: COMMIT
[0m13:56:52.259000 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:56:52.259231 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: COMMIT
[0m13:56:52.260368 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.260853 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:56:52.261391 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:56:52.261630 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: BEGIN
[0m13:56:52.262244 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.262521 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:56:52.262774 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_status"
    
      
    ) dbt_internal_test
[0m13:56:52.263640 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:52.264635 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: ROLLBACK
[0m13:56:52.265261 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_status.1455048989: Close
[0m13:56:52.265740 [info ] [Thread-1  ]: 22 of 31 PASS not_null_fct_orders_status ....................................... [[32mPASS[0m in 0.03s]
[0m13:56:52.266132 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:56:52.266395 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:56:52.266676 [info ] [Thread-1  ]: 23 of 31 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m13:56:52.267102 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_status.1455048989, now test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:56:52.267358 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:56:52.270760 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:56:52.271277 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:56:52.276258 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:56:52.276724 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:56:52.276980 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount" cascade
[0m13:56:52.277219 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.281634 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:52.282488 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
[0m13:56:52.283093 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:56:52.283343 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:56:52.283990 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.284273 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:56:52.284521 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."fct_orders"
where total_amount is null



  );
  
    
[0m13:56:52.286975 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:52.287713 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:56:52.287973 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:56:52.288196 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: COMMIT
[0m13:56:52.290561 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:56:52.291026 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:56:52.291496 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:56:52.291734 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m13:56:52.292237 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.292466 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:56:52.292688 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_fct_orders_total_amount"
    
      
    ) dbt_internal_test
[0m13:56:52.293418 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:52.294353 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m13:56:52.294888 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m13:56:52.295292 [info ] [Thread-1  ]: 23 of 31 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.03s]
[0m13:56:52.295653 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:56:52.295912 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:56:52.296157 [info ] [Thread-1  ]: 24 of 31 START test relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [RUN]
[0m13:56:52.296441 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m13:56:52.296675 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:56:52.302535 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:56:52.303043 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:56:52.306796 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
[0m13:56:52.307207 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:56:52.307450 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79" cascade
[0m13:56:52.307677 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.311754 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:52.312625 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
[0m13:56:52.313133 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:56:52.313378 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m13:56:52.313951 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.314187 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:56:52.314432 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
  
  
    as
  
  (
    
    
    

with child as (
    select order_id as from_field
    from "dbt_db_ex3"."public"."fct_order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "dbt_db_ex3"."public"."fct_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:56:52.315738 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:56:52.316398 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: COMMIT
[0m13:56:52.316654 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:56:52.316880 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: COMMIT
[0m13:56:52.317787 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.318177 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:56:52.318658 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:56:52.318892 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: BEGIN
[0m13:56:52.319399 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.319626 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:56:52.319859 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_6605ef9332585c82f278ac817835eb79"
    
      
    ) dbt_internal_test
[0m13:56:52.320653 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:52.321700 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: ROLLBACK
[0m13:56:52.322233 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec: Close
[0m13:56:52.322644 [info ] [Thread-1  ]: 24 of 31 PASS relationships_fct_order_items_order_id__order_id__ref_fct_orders_  [[32mPASS[0m in 0.03s]
[0m13:56:52.323008 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:56:52.323260 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:56:52.323538 [info ] [Thread-1  ]: 25 of 31 START test relationships_fct_order_items_product_id__product_id__ref_dim_products_  [RUN]
[0m13:56:52.323818 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m13:56:52.324049 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:56:52.328062 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:56:52.328531 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:56:52.332994 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
[0m13:56:52.333432 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:56:52.333684 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50" cascade
[0m13:56:52.333917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.337571 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:52.338334 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
[0m13:56:52.338820 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:56:52.339076 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m13:56:52.339633 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.339860 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:56:52.340103 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
  
  
    as
  
  (
    
    
    

with child as (
    select product_id as from_field
    from "dbt_db_ex3"."public"."fct_order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "dbt_db_ex3"."public"."dim_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:56:52.341413 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:56:52.342008 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: COMMIT
[0m13:56:52.342255 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:56:52.342478 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: COMMIT
[0m13:56:52.343596 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.343989 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:56:52.344539 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:56:52.344798 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: BEGIN
[0m13:56:52.345511 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.345815 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:56:52.346071 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_order_items_b0f28835da40fb8b0928f9f26aa86d50"
    
      
    ) dbt_internal_test
[0m13:56:52.346754 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:52.347728 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: ROLLBACK
[0m13:56:52.348192 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1: Close
[0m13:56:52.348600 [info ] [Thread-1  ]: 25 of 31 PASS relationships_fct_order_items_product_id__product_id__ref_dim_products_  [[32mPASS[0m in 0.02s]
[0m13:56:52.348966 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:56:52.349220 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:56:52.349498 [info ] [Thread-1  ]: 26 of 31 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m13:56:52.349778 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:56:52.350012 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:56:52.354127 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:52.354648 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:56:52.358293 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:56:52.358727 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:52.358989 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c" cascade
[0m13:56:52.359229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.363641 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:52.364502 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
[0m13:56:52.365044 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:52.365275 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:56:52.365805 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.366062 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:52.366359 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
  
  
    as
  
  (
    
    
    

with child as (
    select customer_id as from_field
    from "dbt_db_ex3"."public"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db_ex3"."public"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  );
  
    
[0m13:56:52.367655 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:56:52.368250 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:56:52.368493 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:52.368721 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: COMMIT
[0m13:56:52.369448 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.369817 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:52.375491 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:52.379436 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m13:56:52.379981 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.380239 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:56:52.380501 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."relationships_fct_orders_0c6c6d9e6f30dfb9b653557ebf38e47c"
    
      
    ) dbt_internal_test
[0m13:56:52.381185 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:52.382180 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m13:56:52.382661 [debug] [Thread-1  ]: On test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m13:56:52.383078 [info ] [Thread-1  ]: 26 of 31 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.03s]
[0m13:56:52.383470 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:56:52.383743 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:56:52.383994 [info ] [Thread-1  ]: 27 of 31 START test unique_dim_customers_customer_id ........................... [RUN]
[0m13:56:52.384344 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:56:52.384610 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:56:52.389541 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:52.390048 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:56:52.394859 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:56:52.395272 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:52.395529 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id" cascade
[0m13:56:52.395758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.399576 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:52.400338 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
[0m13:56:52.400830 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:52.401078 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:56:52.401583 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.401803 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:52.402033 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
  
  
    as
  
  (
    
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  );
  
    
[0m13:56:52.403112 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:56:52.403696 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:56:52.403942 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:52.404173 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: COMMIT
[0m13:56:52.405010 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.405404 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:52.405890 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:52.406133 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m13:56:52.406609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.406848 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:56:52.407094 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_customer_id"
    
      
    ) dbt_internal_test
[0m13:56:52.407664 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:52.408621 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m13:56:52.409092 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m13:56:52.409492 [info ] [Thread-1  ]: 27 of 31 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m13:56:52.409869 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:56:52.410132 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:56:52.410428 [info ] [Thread-1  ]: 28 of 31 START test unique_dim_customers_email ................................. [RUN]
[0m13:56:52.410743 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8)
[0m13:56:52.410993 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:56:52.414252 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:56:52.414721 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:56:52.418278 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:56:52.418649 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:56:52.418887 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email" cascade
[0m13:56:52.419110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.422936 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:52.423737 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
[0m13:56:52.424199 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:56:52.424432 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:56:52.424964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.425194 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:56:52.425430 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
  
  
    as
  
  (
    
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_customers"
where email is not null
group by email
having count(*) > 1



  );
  
    
[0m13:56:52.427727 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:56:52.428322 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:56:52.428563 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:56:52.428781 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: COMMIT
[0m13:56:52.429555 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.429981 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:56:52.430473 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:56:52.430717 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: BEGIN
[0m13:56:52.431201 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.431437 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:56:52.431681 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_customers_email"
    
      
    ) dbt_internal_test
[0m13:56:52.432261 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:52.433169 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: ROLLBACK
[0m13:56:52.433632 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8: Close
[0m13:56:52.434029 [info ] [Thread-1  ]: 28 of 31 PASS unique_dim_customers_email ....................................... [[32mPASS[0m in 0.02s]
[0m13:56:52.434415 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:56:52.434689 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:56:52.434985 [info ] [Thread-1  ]: 29 of 31 START test unique_dim_products_product_id ............................. [RUN]
[0m13:56:52.435277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8, now test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985)
[0m13:56:52.435521 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:56:52.439758 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:56:52.440303 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:56:52.443915 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:56:52.444285 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:56:52.444520 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id" cascade
[0m13:56:52.444747 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.448824 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:56:52.449608 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
[0m13:56:52.450115 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:56:52.450367 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:56:52.450904 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.451125 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:56:52.451353 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
  
  
    as
  
  (
    
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  );
  
    
[0m13:56:52.452420 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:56:52.453036 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:56:52.453306 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:56:52.453551 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: COMMIT
[0m13:56:52.454640 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.455038 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:56:52.455527 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:56:52.455771 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m13:56:52.456253 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.456488 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:56:52.456731 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_dim_products_product_id"
    
      
    ) dbt_internal_test
[0m13:56:52.457292 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:52.458210 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m13:56:52.458694 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985: Close
[0m13:56:52.459090 [info ] [Thread-1  ]: 29 of 31 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m13:56:52.459475 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:56:52.459740 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:56:52.460090 [info ] [Thread-1  ]: 30 of 31 START test unique_fct_order_items_order_item_id ....................... [RUN]
[0m13:56:52.460427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768)
[0m13:56:52.460689 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:56:52.463961 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:56:52.464392 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:56:52.468180 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
[0m13:56:52.468609 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:56:52.468848 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id" cascade
[0m13:56:52.469076 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.473990 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:56:52.474815 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
[0m13:56:52.475393 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:56:52.475633 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: BEGIN
[0m13:56:52.476162 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.476391 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:56:52.476623 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
  
  
    as
  
  (
    
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."fct_order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



  );
  
    
[0m13:56:52.477859 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:56:52.478475 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: COMMIT
[0m13:56:52.478720 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:56:52.478939 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: COMMIT
[0m13:56:52.479746 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.480137 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:56:52.480601 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:56:52.480824 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: BEGIN
[0m13:56:52.481250 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.481470 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:56:52.481698 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_order_items_order_item_id"
    
      
    ) dbt_internal_test
[0m13:56:52.482217 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:52.483117 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: ROLLBACK
[0m13:56:52.483972 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768: Close
[0m13:56:52.484342 [info ] [Thread-1  ]: 30 of 31 PASS unique_fct_order_items_order_item_id ............................. [[32mPASS[0m in 0.02s]
[0m13:56:52.484688 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:56:52.484933 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:56:52.485201 [info ] [Thread-1  ]: 31 of 31 START test unique_fct_orders_order_id ................................. [RUN]
[0m13:56:52.485463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768, now test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5)
[0m13:56:52.485684 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:56:52.489723 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:56:52.490171 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:56:52.493757 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:56:52.494130 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:56:52.494357 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id" cascade
[0m13:56:52.494572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:52.499706 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:56:52.500467 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
[0m13:56:52.500938 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:56:52.501172 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:56:52.501630 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.501851 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:56:52.502080 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
  
  
    as
  
  (
    
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  );
  
    
[0m13:56:52.503169 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:56:52.503734 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:56:52.503995 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:56:52.504228 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: COMMIT
[0m13:56:52.505276 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:52.505715 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:56:52.506256 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:56:52.506502 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m13:56:52.506977 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:56:52.507210 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:56:52.507451 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_fct_orders_order_id"
    
      
    ) dbt_internal_test
[0m13:56:52.507982 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:56:52.508871 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m13:56:52.509300 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5: Close
[0m13:56:52.509698 [info ] [Thread-1  ]: 31 of 31 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m13:56:52.510074 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:56:52.510820 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:52.511038 [debug] [MainThread]: On master: BEGIN
[0m13:56:52.511233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:52.514580 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:56:52.514835 [debug] [MainThread]: On master: COMMIT
[0m13:56:52.515046 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:52.515246 [debug] [MainThread]: On master: COMMIT
[0m13:56:52.515654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:52.515873 [debug] [MainThread]: On master: Close
[0m13:56:52.516155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:52.516350 [debug] [MainThread]: Connection 'test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m13:56:52.516603 [info ] [MainThread]: 
[0m13:56:52.516835 [info ] [MainThread]: Finished running 31 data tests in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m13:56:52.519606 [debug] [MainThread]: Command end result
[0m13:56:52.546077 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:56:52.547183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:56:52.552288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:56:52.552516 [info ] [MainThread]: 
[0m13:56:52.552756 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:52.552968 [info ] [MainThread]: 
[0m13:56:52.553166 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
[0m13:56:52.554092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7668055, "process_in_blocks": "0", "process_kernel_time": 0.179278, "process_mem_max_rss": "128450560", "process_out_blocks": "0", "process_user_time": 2.098253}
[0m13:56:52.554341 [debug] [MainThread]: Command `dbt test` succeeded at 13:56:52.554294 after 1.77 seconds
[0m13:56:52.554571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d497c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10674e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107385550>]}
[0m13:56:52.554793 [debug] [MainThread]: Flushing usage events
[0m13:56:53.498788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:54.602602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2eca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2ee80>]}


============================== 13:56:54.605265 | e7a6b6c3-2616-4fea-8386-bd54b6a9d00c ==============================
[0m13:56:54.605265 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:56:54.605688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select mart.dimensions.*', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:54.730027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7a6b6c3-2616-4fea-8386-bd54b6a9d00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105189fa0>]}
[0m13:56:54.781761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7a6b6c3-2616-4fea-8386-bd54b6a9d00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dbd190>]}
[0m13:56:54.782404 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:56:54.863648 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:56:54.973824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:54.974135 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:55.015210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7a6b6c3-2616-4fea-8386-bd54b6a9d00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba5130>]}
[0m13:56:55.129202 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:56:55.131807 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:56:55.141094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7a6b6c3-2616-4fea-8386-bd54b6a9d00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d89d60>]}
[0m13:56:55.141481 [info ] [MainThread]: Found 17 models, 35 data tests, 4 sources, 591 macros
[0m13:56:55.141713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a6b6c3-2616-4fea-8386-bd54b6a9d00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051be0a0>]}
[0m13:56:55.142849 [info ] [MainThread]: 
[0m13:56:55.143079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:55.143271 [info ] [MainThread]: 
[0m13:56:55.143582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:55.146420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:56:55.173802 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:56:55.174123 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:56:55.174316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:55.190244 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m13:56:55.191120 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:56:55.192580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:56:55.196981 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:56:55.197232 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:56:55.197417 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:55.202913 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:56:55.203263 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:56:55.203492 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:56:55.205594 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m13:56:55.207502 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:56:55.208201 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:56:55.214243 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:55.214546 [debug] [MainThread]: On master: BEGIN
[0m13:56:55.214907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:55.250835 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m13:56:55.251474 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:55.252089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:56:55.256523 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:56:55.263946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7a6b6c3-2616-4fea-8386-bd54b6a9d00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba50d0>]}
[0m13:56:55.264346 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:55.265477 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:55.265872 [debug] [MainThread]: On master: BEGIN
[0m13:56:55.266747 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:56:55.266978 [debug] [MainThread]: On master: COMMIT
[0m13:56:55.267182 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:55.267366 [debug] [MainThread]: On master: COMMIT
[0m13:56:55.267797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:55.267995 [debug] [MainThread]: On master: Close
[0m13:56:55.269336 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:56:55.269718 [info ] [Thread-1  ]: 1 of 3 START sql table model public.dim_customers_mart ......................... [RUN]
[0m13:56:55.270048 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_customers_mart)
[0m13:56:55.270279 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:56:55.277427 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:56:55.278399 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:56:55.307855 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:56:55.308531 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:56:55.308768 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: BEGIN
[0m13:56:55.308983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:55.312897 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:56:55.313242 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:56:55.313524 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "dbt_db_ex3"."public"."dim_customers"
),

customer_segments as (
    select
        customer_id,
        case
            when lifetime_value >= 1000000 then 'VIP'
            when lifetime_value >= 500000 then 'High Value'
            when lifetime_value >= 100000 then 'Medium Value'
            else 'Low Value'
        end as customer_segment,
        case
            when lifetime_orders >= 10 then 'Frequent'
            when lifetime_orders >= 5 then 'Regular'
            when lifetime_orders >= 2 then 'Occasional'
            else 'One-time'
        end as purchase_frequency,
        case
            when extract(day from (current_date - most_recent_order_date)) <= 30 then 'Active'
            when extract(day from (current_date - most_recent_order_date)) <= 90 then 'Recent'
            when extract(day from (current_date - most_recent_order_date)) <= 180 then 'Lapsed'
            else 'Inactive'
        end as customer_status
    from customers
    where lifetime_orders > 0
)

select
    c.*,
    coalesce(cs.customer_segment, 'New') as customer_segment,
    coalesce(cs.purchase_frequency, 'None') as purchase_frequency,
    coalesce(cs.customer_status, 'New') as customer_status,
    case
        when cs.customer_segment = 'VIP' and cs.customer_status = 'Active' then true
        else false
    end as is_high_value_active
from customers c
left join customer_segments cs using (customer_id)
  );
  
[0m13:56:55.316939 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.003 seconds
[0m13:56:55.325218 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:56:55.325549 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */
alter table "dbt_db_ex3"."public"."dim_customers_mart" rename to "dim_customers_mart__dbt_backup"
[0m13:56:55.326433 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:55.328956 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:56:55.329238 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */
alter table "dbt_db_ex3"."public"."dim_customers_mart__dbt_tmp" rename to "dim_customers_mart"
[0m13:56:55.330157 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:55.341883 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: COMMIT
[0m13:56:55.342239 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:56:55.342469 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: COMMIT
[0m13:56:55.344443 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m13:56:55.349291 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_customers_mart__dbt_backup"
[0m13:56:55.352116 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_customers_mart"
[0m13:56:55.352386 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_customers_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_customers_mart__dbt_backup" cascade
[0m13:56:55.355704 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m13:56:55.357459 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_customers_mart: Close
[0m13:56:55.358828 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a6b6c3-2616-4fea-8386-bd54b6a9d00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f61820>]}
[0m13:56:55.359544 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.dim_customers_mart .................... [[32mSELECT 10[0m in 0.09s]
[0m13:56:55.360250 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:56:55.360553 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:56:55.360921 [info ] [Thread-1  ]: 2 of 3 START sql table model public.dim_date ................................... [RUN]
[0m13:56:55.361261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now model.ecommerce_datamart.dim_date)
[0m13:56:55.361494 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:56:55.382588 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:56:55.382915 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:56:55.383131 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:55.389519 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:56:55.389879 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:56:55.390109 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:56:55.391054 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:56:55.398400 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:56:55.398971 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:56:55.402714 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_date"
[0m13:56:55.403271 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:56:55.403586 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

-- Generate a date series from 2020-01-01 to 2025-12-31
with date_spine as (
    





with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
     + 
    
    p9.generated_number * power(2, 9)
     + 
    
    p10.generated_number * power(2, 10)
     + 
    
    p11.generated_number * power(2, 11)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
     cross join 
    
    p as p9
     cross join 
    
    p as p10
     cross join 
    
    p as p11
    
    

    )

    select *
    from unioned
    where generated_number <= 2191
    order by generated_number



),

all_periods as (

    select (
        

    cast('2020-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-12-31' as date)

)

select * from filtered


),

dates as (
    select
        cast(date_day as date) as date_key,
        date_day,
        extract(year from date_day) as year,
        extract(month from date_day) as month,
        extract(day from date_day) as day_of_month,
        extract(quarter from date_day) as quarter,
        extract(week from date_day) as week_of_year,
        extract(dow from date_day) as day_of_week,
        extract(doy from date_day) as day_of_year,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Day') as day_name,
        case
            when extract(dow from date_day) in (0, 6) then true
            else false
        end as is_weekend,
        case
            when extract(month from date_day) in (1, 2, 3) then 'Q1'
            when extract(month from date_day) in (4, 5, 6) then 'Q2'
            when extract(month from date_day) in (7, 8, 9) then 'Q3'
            else 'Q4'
        end as quarter_name
    from date_spine
)

select * from dates
  );
  
[0m13:56:55.420087 [debug] [Thread-1  ]: SQL status: SELECT 2191 in 0.016 seconds
[0m13:56:55.422862 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:56:55.423123 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date" rename to "dim_date__dbt_backup"
[0m13:56:55.423826 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:56:55.426410 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:56:55.426726 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
alter table "dbt_db_ex3"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:56:55.427509 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:55.428450 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:56:55.428726 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:56:55.428983 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: COMMIT
[0m13:56:55.430462 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:55.432821 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_date__dbt_backup"
[0m13:56:55.433224 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:56:55.433475 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */
drop table if exists "dbt_db_ex3"."public"."dim_date__dbt_backup" cascade
[0m13:56:55.435194 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:56:55.436102 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:56:55.436529 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a6b6c3-2616-4fea-8386-bd54b6a9d00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea70a0>]}
[0m13:56:55.437009 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.dim_date .............................. [[32mSELECT 2191[0m in 0.08s]
[0m13:56:55.437414 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:56:55.437698 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:56:55.438107 [info ] [Thread-1  ]: 3 of 3 START sql table model public.dim_products_mart .......................... [RUN]
[0m13:56:55.438569 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.dim_products_mart)
[0m13:56:55.438840 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:56:55.441795 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:56:55.442370 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:56:55.445550 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.dim_products_mart"
[0m13:56:55.446032 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:56:55.446276 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: BEGIN
[0m13:56:55.446504 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:55.450427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:56:55.450888 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:56:55.451200 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */

  
    

  create  table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "dbt_db_ex3"."public"."dim_products"
)

select
    p.*,
    case
        when total_quantity_sold > 100 then 'High Selling'
        when total_quantity_sold > 50 then 'Medium Selling'
        when total_quantity_sold > 0 then 'Low Selling'
        else 'Not Selling'
    end as sales_performance,
    case
        when total_revenue > 10000000 then 'High Revenue'
        when total_revenue > 5000000 then 'Medium Revenue'
        when total_revenue > 0 then 'Low Revenue'
        else 'No Revenue'
    end as revenue_tier,
    (total_revenue / nullif(total_quantity_sold, 0)) as average_selling_price,
    case
        when is_active = true and inventory_status != 'Out of stock' then true
        else false
    end as is_available_for_purchase,
    case
        when is_active = false then 'Discontinued'
        when inventory_status = 'Out of stock' then 'Temporarily Unavailable'
        else 'Available'
    end as availability_status
from products p
  );
  
[0m13:56:55.454469 [debug] [Thread-1  ]: SQL status: SELECT 15 in 0.003 seconds
[0m13:56:55.458443 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:56:55.458766 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart" rename to "dim_products_mart__dbt_backup"
[0m13:56:55.459576 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:55.461982 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:56:55.462234 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
alter table "dbt_db_ex3"."public"."dim_products_mart__dbt_tmp" rename to "dim_products_mart"
[0m13:56:55.462793 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:56:55.463584 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:56:55.463820 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:56:55.464041 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: COMMIT
[0m13:56:55.465094 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:55.467287 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."dim_products_mart__dbt_backup"
[0m13:56:55.467726 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_products_mart"
[0m13:56:55.467972 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_products_mart"} */
drop table if exists "dbt_db_ex3"."public"."dim_products_mart__dbt_backup" cascade
[0m13:56:55.469327 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:56:55.470161 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_products_mart: Close
[0m13:56:55.470552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7a6b6c3-2616-4fea-8386-bd54b6a9d00c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea70a0>]}
[0m13:56:55.470975 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public.dim_products_mart ..................... [[32mSELECT 15[0m in 0.03s]
[0m13:56:55.471332 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:56:55.472002 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:55.472237 [debug] [MainThread]: On master: BEGIN
[0m13:56:55.472434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:55.477015 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:56:55.477308 [debug] [MainThread]: On master: COMMIT
[0m13:56:55.477508 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:55.477698 [debug] [MainThread]: On master: COMMIT
[0m13:56:55.478114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:55.478347 [debug] [MainThread]: On master: Close
[0m13:56:55.478646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:55.478837 [debug] [MainThread]: Connection 'model.ecommerce_datamart.dim_products_mart' was properly closed.
[0m13:56:55.479091 [info ] [MainThread]: 
[0m13:56:55.479316 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m13:56:55.479914 [debug] [MainThread]: Command end result
[0m13:56:55.510201 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:56:55.544443 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:56:55.574869 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:56:55.575222 [info ] [MainThread]: 
[0m13:56:55.575512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:55.575720 [info ] [MainThread]: 
[0m13:56:55.575934 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:56:55.577215 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0264542, "process_in_blocks": "0", "process_kernel_time": 0.154363, "process_mem_max_rss": "125796352", "process_out_blocks": "0", "process_user_time": 1.571965}
[0m13:56:55.577536 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:55.577484 after 1.03 seconds
[0m13:56:55.577783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104124910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105189fa0>]}
[0m13:56:55.579622 [debug] [MainThread]: Flushing usage events
[0m13:56:56.809097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:57.916541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f82700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efab50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efad30>]}


============================== 13:56:57.919065 | fb6b6377-2e4d-4f13-9178-05d29ce9ecef ==============================
[0m13:56:57.919065 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:56:57.919438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select mart.facts.*', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:58.044523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb6b6377-2e4d-4f13-9178-05d29ce9ecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072159a0>]}
[0m13:56:58.091214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb6b6377-2e4d-4f13-9178-05d29ce9ecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3f580>]}
[0m13:56:58.091826 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:56:58.168082 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:56:58.273622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:58.273918 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:58.313244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb6b6377-2e4d-4f13-9178-05d29ce9ecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f45130>]}
[0m13:56:58.423128 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:56:58.425514 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:56:58.434281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb6b6377-2e4d-4f13-9178-05d29ce9ecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107284a90>]}
[0m13:56:58.434624 [info ] [MainThread]: Found 17 models, 35 data tests, 4 sources, 591 macros
[0m13:56:58.434854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6b6377-2e4d-4f13-9178-05d29ce9ecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c999a0>]}
[0m13:56:58.435960 [info ] [MainThread]: 
[0m13:56:58.436186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:56:58.436377 [info ] [MainThread]: 
[0m13:56:58.436678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:56:58.439277 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:56:58.465523 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:56:58.465840 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:56:58.466036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:58.479814 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m13:56:58.480677 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:56:58.482160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:56:58.486272 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:56:58.486493 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:56:58.486676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:58.494721 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:56:58.495359 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:56:58.495588 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:56:58.498938 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m13:56:58.500839 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:56:58.501536 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:56:58.507451 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:58.507710 [debug] [MainThread]: On master: BEGIN
[0m13:56:58.507915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:58.512942 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:56:58.513180 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:58.513456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:56:58.517365 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:56:58.518437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb6b6377-2e4d-4f13-9178-05d29ce9ecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107239eb0>]}
[0m13:56:58.518759 [debug] [MainThread]: On master: ROLLBACK
[0m13:56:58.519212 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:58.519420 [debug] [MainThread]: On master: BEGIN
[0m13:56:58.520089 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:56:58.520371 [debug] [MainThread]: On master: COMMIT
[0m13:56:58.520607 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:58.520822 [debug] [MainThread]: On master: COMMIT
[0m13:56:58.521294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:56:58.521533 [debug] [MainThread]: On master: Close
[0m13:56:58.522819 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_customer_retention
[0m13:56:58.523226 [info ] [Thread-1  ]: 1 of 3 START sql table model public.fct_customer_retention ..................... [RUN]
[0m13:56:58.523566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.fct_customer_retention)
[0m13:56:58.523827 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_customer_retention
[0m13:56:58.531219 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:56:58.531874 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_customer_retention
[0m13:56:58.558215 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:56:58.558828 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:56:58.559062 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: BEGIN
[0m13:56:58.559275 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:58.564630 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:56:58.564872 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:56:58.565198 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_customer_retention__dbt_tmp"
  
  
    as
  
  (
    

with customer_orders as (
    select
        customer_id,
        order_id,
        order_date,
        total_amount,
        row_number() over(partition by customer_id order by order_date) as order_sequence,
        lead(order_date) over(partition by customer_id order by order_date) as next_order_date,
        extract(day from (lead(order_date) over(partition by customer_id order by order_date) - order_date)) as days_until_next_order
    from "dbt_db_ex3"."public"."fct_orders"
),

customer_first_orders as (
    select
        customer_id,
        min(case when order_sequence = 1 then order_date end) as first_order_date,
        extract(year from min(case when order_sequence = 1 then order_date end)) as first_order_year,
        extract(month from min(case when order_sequence = 1 then order_date end)) as first_order_month,
        to_char(min(case when order_sequence = 1 then order_date end), 'YYYY-MM') as first_order_year_month
    from customer_orders
    group by 1
),

repeat_purchase_facts as (
    select
        c.customer_id,
        c.first_order_date,
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        count(distinct case when co.order_sequence > 1 then co.order_id end) as repeat_orders,
        max(co.order_sequence) as total_orders,
        sum(case when co.order_sequence > 1 then co.total_amount else 0 end) as repeat_order_revenue,
        min(case when co.order_sequence = 2 then co.order_date end) as second_order_date,
        avg(co.days_until_next_order) as avg_days_between_orders
    from customer_first_orders c
    left join customer_orders co using (customer_id)
    group by 1, 2, 3, 4, 5
),

cohort_sizes as (
    select
        first_order_year,
        first_order_month,
        first_order_year_month,
        count(distinct customer_id) as cohort_size
    from customer_first_orders
    group by 1, 2, 3
),

retention_by_month as (
    select
        c.first_order_year,
        c.first_order_month,
        c.first_order_year_month,
        cs.cohort_size,
        date_part('month', age(date_trunc('month', o.order_date), 
                              date_trunc('month', c.first_order_date))) as months_since_first_order,
        count(distinct o.customer_id) as retained_customers,
        sum(o.total_amount) as cohort_revenue
    from customer_first_orders c
    join "dbt_db_ex3"."public"."fct_orders" o using(customer_id)
    join cohort_sizes cs 
        on c.first_order_year = cs.first_order_year 
        and c.first_order_month = cs.first_order_month
    where o.order_date > c.first_order_date
    group by 1, 2, 3, 4, 5
)

select
    r.first_order_year,
    r.first_order_month,
    r.first_order_year_month as cohort,
    r.cohort_size,
    r.months_since_first_order,
    r.retained_customers,
    r.cohort_revenue,
    (r.retained_customers::float / r.cohort_size) * 100 as retention_rate,
    (r.cohort_revenue::float / r.retained_customers) as revenue_per_retained_customer,
    sum(r.retained_customers) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_retained_customers,
    sum(r.cohort_revenue) over (
        partition by r.first_order_year, r.first_order_month
        order by r.months_since_first_order
        rows between unbounded preceding and current row
    ) as cumulative_cohort_revenue,
    current_timestamp as updated_at
from retention_by_month r
order by r.first_order_year, r.first_order_month, r.months_since_first_order
  );
  
[0m13:56:58.571909 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.006 seconds
[0m13:56:58.581301 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:56:58.581708 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
alter table "dbt_db_ex3"."public"."fct_customer_retention" rename to "fct_customer_retention__dbt_backup"
[0m13:56:58.608402 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:58.621506 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:56:58.657564 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
alter table "dbt_db_ex3"."public"."fct_customer_retention__dbt_tmp" rename to "fct_customer_retention"
[0m13:56:58.660152 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:56:58.673660 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: COMMIT
[0m13:56:58.674007 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:56:58.674246 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: COMMIT
[0m13:56:58.675336 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:58.680119 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_customer_retention__dbt_backup"
[0m13:56:58.685185 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_customer_retention"
[0m13:56:58.685587 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_customer_retention"} */
drop table if exists "dbt_db_ex3"."public"."fct_customer_retention__dbt_backup" cascade
[0m13:56:58.687855 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:56:58.691194 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_customer_retention: Close
[0m13:56:58.692799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b6377-2e4d-4f13-9178-05d29ce9ecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108301760>]}
[0m13:56:58.693598 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.fct_customer_retention ................ [[32mSELECT 18[0m in 0.17s]
[0m13:56:58.694428 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_customer_retention
[0m13:56:58.695265 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_daily_sales
[0m13:56:58.695758 [info ] [Thread-1  ]: 2 of 3 START sql table model public.fct_daily_sales ............................ [RUN]
[0m13:56:58.696277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_customer_retention, now model.ecommerce_datamart.fct_daily_sales)
[0m13:56:58.696541 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_daily_sales
[0m13:56:58.703686 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:56:58.704665 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_daily_sales
[0m13:56:58.709365 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:56:58.710008 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:56:58.710263 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: BEGIN
[0m13:56:58.710490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:58.715982 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:56:58.717447 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:56:58.717864 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

with order_facts as (
    select
        date_trunc('day', order_date) as order_day,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as customers_count,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        sum(total_amount - shipping_cost) as total_product_revenue,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1
),

product_category_facts as (
    select
        date_trunc('day', order_date) as order_day,
        product_category,
        count(distinct order_id) as category_orders_count,
        sum(item_total) as category_revenue,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2
)

select
    d.date_key,
    d.year,
    d.month,
    d.quarter,
    d.day_of_month,
    d.day_of_week,
    d.is_weekend,
    d.month_name,
    coalesce(o.orders_count, 0) as orders_count,
    coalesce(o.customers_count, 0) as customers_count,
    coalesce(o.total_sales_amount, 0) as total_sales_amount,
    coalesce(o.total_shipping_cost, 0) as total_shipping_cost,
    coalesce(o.total_product_revenue, 0) as total_product_revenue,
    coalesce(o.average_order_value, 0) as average_order_value,
    coalesce(o.total_items_sold, 0) as total_items_sold,
    -- Metrics specific to each product category
    coalesce(pc_electronics.category_revenue, 0) as electronics_revenue,
    coalesce(pc_clothing.category_revenue, 0) as clothing_revenue,
    coalesce(pc_footwear.category_revenue, 0) as footwear_revenue,
    coalesce(pc_accessories.category_revenue, 0) as accessories_revenue,
    -- Calculated metrics
    case 
        when coalesce(o.orders_count, 0) = 0 then 0
        else coalesce(o.customers_count, 0)::float / o.orders_count 
    end as customers_per_order_ratio,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."dim_date" d
left join order_facts o on d.date_key = o.order_day
left join product_category_facts pc_electronics 
    on d.date_key = pc_electronics.order_day and pc_electronics.product_category = 'Electronics'
left join product_category_facts pc_clothing 
    on d.date_key = pc_clothing.order_day and pc_clothing.product_category = 'Clothing'
left join product_category_facts pc_footwear 
    on d.date_key = pc_footwear.order_day and pc_footwear.product_category = 'Footwear'
left join product_category_facts pc_accessories 
    on d.date_key = pc_accessories.order_day and pc_accessories.product_category = 'Accessories'
where d.date_key <= current_date
  );
  
[0m13:56:58.727808 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.009 seconds
[0m13:56:58.731867 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:56:58.732198 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
alter table "dbt_db_ex3"."public"."fct_daily_sales" rename to "fct_daily_sales__dbt_backup"
[0m13:56:58.733279 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:58.736202 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:56:58.736508 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
alter table "dbt_db_ex3"."public"."fct_daily_sales__dbt_tmp" rename to "fct_daily_sales"
[0m13:56:58.737287 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:56:58.738183 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:56:58.738440 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:56:58.738678 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: COMMIT
[0m13:56:58.739850 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:58.742144 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup"
[0m13:56:58.742572 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_daily_sales"
[0m13:56:58.742833 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."fct_daily_sales__dbt_backup" cascade
[0m13:56:58.744575 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:56:58.745720 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_daily_sales: Close
[0m13:56:58.746245 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b6377-2e4d-4f13-9178-05d29ce9ecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612e4f0>]}
[0m13:56:58.746766 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.fct_daily_sales ....................... [[32mSELECT 1959[0m in 0.05s]
[0m13:56:58.747177 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_daily_sales
[0m13:56:58.747460 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_monthly_sales
[0m13:56:58.747844 [info ] [Thread-1  ]: 3 of 3 START sql incremental model public.fct_monthly_sales .................... [RUN]
[0m13:56:58.748361 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_daily_sales, now model.ecommerce_datamart.fct_monthly_sales)
[0m13:56:58.748631 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_monthly_sales
[0m13:56:58.757841 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:56:58.758426 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_monthly_sales
[0m13:56:58.781736 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:56:58.782211 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

    
  
    

  create temporary table "fct_monthly_sales__dbt_tmp135658777247"
  
  
    as
  
  (
    

with monthly_order_facts as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        to_char(order_date, 'YYYY-MM') as year_month,
        count(distinct order_id) as orders_count,
        count(distinct customer_id) as unique_customers,
        sum(total_amount) as total_sales_amount,
        sum(shipping_cost) as total_shipping_cost,
        avg(total_amount) as average_order_value,
        sum(total_items) as total_items_sold,
        count(distinct case when status = 'completed' then order_id end) as completed_orders,
        count(distinct case when status = 'cancelled' then order_id end) as cancelled_orders
    from "dbt_db_ex3"."public"."fct_orders"
    group by 1, 2, 3
),

monthly_product_category_sales as (
    select
        extract(year from order_date) as year,
        extract(month from order_date) as month,
        product_category,
        sum(item_total) as category_sales,
        count(distinct order_id) as category_orders,
        sum(quantity) as category_items_sold
    from "dbt_db_ex3"."public"."fct_order_items"
    group by 1, 2, 3
),

monthly_new_customers as (
    select
        extract(year from first_order_date) as year,
        extract(month from first_order_date) as month,
        count(distinct customer_id) as new_customers
    from "dbt_db_ex3"."public"."dim_customers"
    where first_order_date is not null
    group by 1, 2
)

select
    m.year,
    m.month,
    m.year_month,
    m.orders_count,
    m.unique_customers,
    m.total_sales_amount,
    m.total_shipping_cost,
    m.average_order_value,
    m.total_items_sold,
    m.completed_orders,
    m.cancelled_orders,
    coalesce(pc_electronics.category_sales, 0) as electronics_sales,
    coalesce(pc_clothing.category_sales, 0) as clothing_sales,
    coalesce(pc_footwear.category_sales, 0) as footwear_sales,
    coalesce(pc_accessories.category_sales, 0) as accessories_sales,
    coalesce(pc_electronics.category_items_sold, 0) as electronics_items_sold,
    coalesce(pc_clothing.category_items_sold, 0) as clothing_items_sold,
    coalesce(pc_footwear.category_items_sold, 0) as footwear_items_sold,
    coalesce(pc_accessories.category_items_sold, 0) as accessories_items_sold,
    coalesce(nc.new_customers, 0) as new_customers,
    case 
        when m.orders_count = 0 then 0
        else (m.cancelled_orders::float / m.orders_count) * 100
    end as cancellation_rate,
    case
        when lag(m.total_sales_amount) over (order by m.year, m.month) = 0 then null
        else (m.total_sales_amount - lag(m.total_sales_amount) over (order by m.year, m.month)) / 
             lag(m.total_sales_amount) over (order by m.year, m.month) * 100
    end as sales_growth_pct,
    current_timestamp as updated_at
from monthly_order_facts m
left join monthly_new_customers nc on m.year = nc.year and m.month = nc.month
left join monthly_product_category_sales pc_electronics 
    on m.year = pc_electronics.year and m.month = pc_electronics.month and pc_electronics.product_category = 'Electronics'
left join monthly_product_category_sales pc_clothing 
    on m.year = pc_clothing.year and m.month = pc_clothing.month and pc_clothing.product_category = 'Clothing'
left join monthly_product_category_sales pc_footwear 
    on m.year = pc_footwear.year and m.month = pc_footwear.month and pc_footwear.product_category = 'Footwear'
left join monthly_product_category_sales pc_accessories 
    on m.year = pc_accessories.year and m.month = pc_accessories.month and pc_accessories.product_category = 'Accessories'


where m.year || '-' || lpad(m.month::text, 2, '0') >= (select max(year || '-' || lpad(month::text, 2, '0')) from "dbt_db_ex3"."public"."fct_monthly_sales")

  );
  
  
[0m13:56:58.782563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:56:58.791046 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.008 seconds
[0m13:56:58.802423 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:56:58.803142 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: BEGIN
[0m13:56:58.804034 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:56:58.804302 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:56:58.804542 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'fct_monthly_sales__dbt_tmp135658777247'
        
      order by ordinal_position

  
[0m13:56:58.808408 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.004 seconds
[0m13:56:58.813180 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:56:58.813530 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'fct_monthly_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:56:58.816100 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.002 seconds
[0m13:56:58.823381 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:56:58.823749 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dbt_db_ex3".INFORMATION_SCHEMA.columns
      where table_name = 'fct_monthly_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m13:56:58.828628 [debug] [Thread-1  ]: SQL status: SELECT 23 in 0.005 seconds
[0m13:56:58.839984 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:56:58.840572 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:56:58.840856 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.fct_monthly_sales"} */

      
        delete from "dbt_db_ex3"."public"."fct_monthly_sales" as DBT_INTERNAL_DEST
        where (year, month) in (
            select distinct year, month
            from "fct_monthly_sales__dbt_tmp135658777247" as DBT_INTERNAL_SOURCE
        );

    

    insert into "dbt_db_ex3"."public"."fct_monthly_sales" ("year", "month", "year_month", "orders_count", "unique_customers", "total_sales_amount", "total_shipping_cost", "average_order_value", "total_items_sold", "completed_orders", "cancelled_orders", "electronics_sales", "clothing_sales", "footwear_sales", "accessories_sales", "electronics_items_sold", "clothing_items_sold", "footwear_items_sold", "accessories_items_sold", "new_customers", "cancellation_rate", "sales_growth_pct", "updated_at")
    (
        select "year", "month", "year_month", "orders_count", "unique_customers", "total_sales_amount", "total_shipping_cost", "average_order_value", "total_items_sold", "completed_orders", "cancelled_orders", "electronics_sales", "clothing_sales", "footwear_sales", "accessories_sales", "electronics_items_sold", "clothing_items_sold", "footwear_items_sold", "accessories_items_sold", "new_customers", "cancellation_rate", "sales_growth_pct", "updated_at"
        from "fct_monthly_sales__dbt_tmp135658777247"
    )
  
[0m13:56:58.842715 [debug] [Thread-1  ]: SQL status: INSERT 0 1 in 0.002 seconds
[0m13:56:58.843608 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:56:58.843863 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.fct_monthly_sales"
[0m13:56:58.844088 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: COMMIT
[0m13:56:58.845456 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:56:58.845956 [debug] [Thread-1  ]: On model.ecommerce_datamart.fct_monthly_sales: Close
[0m13:56:58.846368 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb6b6377-2e4d-4f13-9178-05d29ce9ecef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612e4f0>]}
[0m13:56:58.846802 [info ] [Thread-1  ]: 3 of 3 OK created sql incremental model public.fct_monthly_sales ............... [[32mINSERT 0 1[0m in 0.10s]
[0m13:56:58.847174 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_monthly_sales
[0m13:56:58.847952 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:58.848227 [debug] [MainThread]: On master: BEGIN
[0m13:56:58.848434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:56:58.853319 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:56:58.853647 [debug] [MainThread]: On master: COMMIT
[0m13:56:58.853872 [debug] [MainThread]: Using postgres connection "master"
[0m13:56:58.854083 [debug] [MainThread]: On master: COMMIT
[0m13:56:58.855626 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:56:58.856198 [debug] [MainThread]: On master: Close
[0m13:56:58.856696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:58.856918 [debug] [MainThread]: Connection 'model.ecommerce_datamart.fct_monthly_sales' was properly closed.
[0m13:56:58.857209 [info ] [MainThread]: 
[0m13:56:58.857460 [info ] [MainThread]: Finished running 1 incremental model, 2 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:56:58.858157 [debug] [MainThread]: Command end result
[0m13:56:58.886359 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:56:58.887598 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:56:58.892203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:56:58.892461 [info ] [MainThread]: 
[0m13:56:58.892712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:58.892920 [info ] [MainThread]: 
[0m13:56:58.893174 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:56:58.894277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0294496, "process_in_blocks": "0", "process_kernel_time": 0.142705, "process_mem_max_rss": "125714432", "process_out_blocks": "0", "process_user_time": 1.610921}
[0m13:56:58.894579 [debug] [MainThread]: Command `dbt run` succeeded at 13:56:58.894512 after 1.03 seconds
[0m13:56:58.894892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f82700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106101b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072159a0>]}
[0m13:56:58.895213 [debug] [MainThread]: Flushing usage events
[0m13:57:00.143734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:01.763970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052496d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fad00>]}


============================== 13:57:01.771080 | 1dd81fbb-8642-4a1e-bb16-6b335e37db52 ==============================
[0m13:57:01.771080 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:57:01.771671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select mart.metrics.*', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:57:01.945546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dd81fbb-8642-4a1e-bb16-6b335e37db52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103651cd0>]}
[0m13:57:02.003471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dd81fbb-8642-4a1e-bb16-6b335e37db52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c53970>]}
[0m13:57:02.004308 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:57:02.083110 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:57:02.198295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:02.198595 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:02.241841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dd81fbb-8642-4a1e-bb16-6b335e37db52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107145130>]}
[0m13:57:02.385190 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:57:02.388720 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:57:02.398691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dd81fbb-8642-4a1e-bb16-6b335e37db52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6c790>]}
[0m13:57:02.399312 [info ] [MainThread]: Found 17 models, 35 data tests, 4 sources, 591 macros
[0m13:57:02.399625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd81fbb-8642-4a1e-bb16-6b335e37db52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e23d00>]}
[0m13:57:02.400910 [info ] [MainThread]: 
[0m13:57:02.401161 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:02.401362 [info ] [MainThread]: 
[0m13:57:02.401790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:02.404519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:57:02.435831 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:57:02.436135 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:57:02.436439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:02.452262 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.016 seconds
[0m13:57:02.453135 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:57:02.454601 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:57:02.459041 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:57:02.459308 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:57:02.459536 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:02.464933 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:57:02.465277 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:57:02.465493 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:57:02.467871 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.002 seconds
[0m13:57:02.469430 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:57:02.469963 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:57:02.475561 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:02.475809 [debug] [MainThread]: On master: BEGIN
[0m13:57:02.475995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:02.480167 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:57:02.480451 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:02.480712 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:02.485093 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:57:02.486194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd81fbb-8642-4a1e-bb16-6b335e37db52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107521130>]}
[0m13:57:02.486498 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:02.487005 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:02.487208 [debug] [MainThread]: On master: BEGIN
[0m13:57:02.487870 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:57:02.488114 [debug] [MainThread]: On master: COMMIT
[0m13:57:02.488325 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:02.488522 [debug] [MainThread]: On master: COMMIT
[0m13:57:02.488915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:57:02.489120 [debug] [MainThread]: On master: Close
[0m13:57:02.490507 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_customer_retention
[0m13:57:02.490880 [info ] [Thread-1  ]: 1 of 3 START sql table model public.metric_customer_retention .................. [RUN]
[0m13:57:02.491179 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.metric_customer_retention)
[0m13:57:02.491407 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_customer_retention
[0m13:57:02.498121 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:02.498709 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_customer_retention
[0m13:57:02.525226 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:02.525827 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:02.526056 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: BEGIN
[0m13:57:02.526265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:02.532688 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:57:02.532945 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:02.533210 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_customer_retention__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates customer retention metrics
-- for easier analytics consumption

select
    first_order_year,
    first_order_month,
    cohort,
    cohort_size,
    months_since_first_order,
    retained_customers,
    cohort_revenue,
    retention_rate,
    revenue_per_retained_customer,
    cumulative_retained_customers,
    cumulative_cohort_revenue,
    -- Additional calculated metrics
    (cumulative_retained_customers::float / nullif(cohort_size, 0)) * 100 as cumulative_retention_rate,
    (cumulative_cohort_revenue::float / nullif(cumulative_retained_customers, 0)) as cumulative_revenue_per_customer,
    (retained_customers::float / nullif(lag(retained_customers) over (
        partition by cohort 
        order by months_since_first_order
    ), 0)) * 100 as month_over_month_retention_change,
    case
        when months_since_first_order >= 1 and months_since_first_order <= 3 then 'Early Stage'
        when months_since_first_order > 3 and months_since_first_order <= 6 then 'Mid Stage'
        when months_since_first_order > 6 and months_since_first_order <= 12 then 'Late Stage'
        else 'Long Term'
    end as retention_stage,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_customer_retention"
  );
  
[0m13:57:02.539227 [debug] [Thread-1  ]: SQL status: SELECT 18 in 0.006 seconds
[0m13:57:02.547319 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:02.547651 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
alter table "dbt_db_ex3"."public"."metric_customer_retention" rename to "metric_customer_retention__dbt_backup"
[0m13:57:02.548623 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:02.551368 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:02.551681 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
alter table "dbt_db_ex3"."public"."metric_customer_retention__dbt_tmp" rename to "metric_customer_retention"
[0m13:57:02.552398 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:02.564065 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: COMMIT
[0m13:57:02.564425 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:02.564668 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: COMMIT
[0m13:57:02.565846 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:57:02.570560 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_customer_retention__dbt_backup"
[0m13:57:02.573410 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:02.573676 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_customer_retention"} */
drop table if exists "dbt_db_ex3"."public"."metric_customer_retention__dbt_backup" cascade
[0m13:57:02.576390 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:57:02.578165 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_customer_retention: Close
[0m13:57:02.579504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd81fbb-8642-4a1e-bb16-6b335e37db52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107501730>]}
[0m13:57:02.580641 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.metric_customer_retention ............. [[32mSELECT 18[0m in 0.09s]
[0m13:57:02.581163 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_customer_retention
[0m13:57:02.581439 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_daily_sales
[0m13:57:02.581791 [info ] [Thread-1  ]: 2 of 3 START sql table model public.metric_daily_sales ......................... [RUN]
[0m13:57:02.582119 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_customer_retention, now model.ecommerce_datamart.metric_daily_sales)
[0m13:57:02.582359 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_daily_sales
[0m13:57:02.585824 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:02.586474 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_daily_sales
[0m13:57:02.590412 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:02.591064 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:02.591313 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: BEGIN
[0m13:57:02.591540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:02.595391 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:57:02.595747 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:02.596037 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates daily sales metrics
-- for easier analytics consumption

select
    date_key,
    year,
    month,
    quarter,
    day_of_month,
    day_of_week,
    is_weekend,
    month_name,
    orders_count,
    customers_count,
    total_sales_amount,
    total_shipping_cost,
    total_product_revenue,
    average_order_value,
    total_items_sold,
    electronics_revenue,
    clothing_revenue,
    footwear_revenue,
    accessories_revenue,
    -- Additional calculated metrics
    case 
        when orders_count = 0 then 0 
        else total_sales_amount / orders_count 
    end as revenue_per_order,
    case 
        when customers_count = 0 then 0 
        else total_sales_amount / customers_count 
    end as revenue_per_customer,
    case 
        when total_sales_amount = 0 then 0 
        else electronics_revenue / total_sales_amount * 100 
    end as electronics_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else clothing_revenue / total_sales_amount * 100 
    end as clothing_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else footwear_revenue / total_sales_amount * 100 
    end as footwear_revenue_pct,
    case 
        when total_sales_amount = 0 then 0 
        else accessories_revenue / total_sales_amount * 100 
    end as accessories_revenue_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_daily_sales"
  );
  
[0m13:57:02.604917 [debug] [Thread-1  ]: SQL status: SELECT 1959 in 0.009 seconds
[0m13:57:02.609065 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:02.609369 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
alter table "dbt_db_ex3"."public"."metric_daily_sales" rename to "metric_daily_sales__dbt_backup"
[0m13:57:02.610164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:02.612778 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:02.613082 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
alter table "dbt_db_ex3"."public"."metric_daily_sales__dbt_tmp" rename to "metric_daily_sales"
[0m13:57:02.613927 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:02.615926 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:57:02.616738 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:02.617430 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: COMMIT
[0m13:57:02.619157 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:57:02.621934 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup"
[0m13:57:02.622369 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:02.622629 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_daily_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_daily_sales__dbt_backup" cascade
[0m13:57:02.624729 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.002 seconds
[0m13:57:02.625663 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_daily_sales: Close
[0m13:57:02.626083 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd81fbb-8642-4a1e-bb16-6b335e37db52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c77c0>]}
[0m13:57:02.626552 [info ] [Thread-1  ]: 2 of 3 OK created sql table model public.metric_daily_sales .................... [[32mSELECT 1959[0m in 0.04s]
[0m13:57:02.626945 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_daily_sales
[0m13:57:02.627215 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:02.627611 [info ] [Thread-1  ]: 3 of 3 START sql table model public.metric_monthly_sales ....................... [RUN]
[0m13:57:02.627958 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_daily_sales, now model.ecommerce_datamart.metric_monthly_sales)
[0m13:57:02.628223 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:02.631210 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:02.631724 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:02.635030 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:02.635545 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:02.635778 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: BEGIN
[0m13:57:02.635993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:02.639800 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m13:57:02.640149 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:02.640446 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */

  
    

  create  table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp"
  
  
    as
  
  (
    

-- This is a materialized view that consolidates monthly sales metrics
-- for easier analytics consumption

select
    year,
    month,
    year_month,
    orders_count,
    unique_customers,
    total_sales_amount,
    total_shipping_cost,
    average_order_value,
    total_items_sold,
    completed_orders,
    cancelled_orders,
    electronics_sales,
    clothing_sales,
    footwear_sales,
    accessories_sales,
    electronics_items_sold,
    clothing_items_sold,
    footwear_items_sold,
    accessories_items_sold,
    new_customers,
    cancellation_rate,
    sales_growth_pct,
    -- Additional calculated metrics
    case
        when lag(new_customers) over (order by year, month) = 0 then null
        else (new_customers - lag(new_customers) over (order by year, month)) / 
             nullif(lag(new_customers) over (order by year, month), 0) * 100
    end as new_customer_growth_pct,
    case 
        when unique_customers = 0 then 0 
        else total_sales_amount / unique_customers 
    end as revenue_per_customer,
    (completed_orders::float / nullif(orders_count, 0)) * 100 as completion_rate,
    case
        when total_sales_amount = 0 then 0
        else electronics_sales / total_sales_amount * 100
    end as electronics_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else clothing_sales / total_sales_amount * 100
    end as clothing_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else footwear_sales / total_sales_amount * 100
    end as footwear_sales_pct,
    case
        when total_sales_amount = 0 then 0
        else accessories_sales / total_sales_amount * 100
    end as accessories_sales_pct,
    current_timestamp as updated_at
from "dbt_db_ex3"."public"."fct_monthly_sales"
  );
  
[0m13:57:02.644235 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.003 seconds
[0m13:57:02.648095 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:02.648412 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
alter table "dbt_db_ex3"."public"."metric_monthly_sales" rename to "metric_monthly_sales__dbt_backup"
[0m13:57:02.649323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:57:02.651716 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:02.651967 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
alter table "dbt_db_ex3"."public"."metric_monthly_sales__dbt_tmp" rename to "metric_monthly_sales"
[0m13:57:02.652491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:57:02.653270 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:57:02.653504 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:02.653720 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: COMMIT
[0m13:57:02.654647 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:57:02.656810 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup"
[0m13:57:02.657195 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:02.657435 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.metric_monthly_sales"} */
drop table if exists "dbt_db_ex3"."public"."metric_monthly_sales__dbt_backup" cascade
[0m13:57:02.658927 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:57:02.659808 [debug] [Thread-1  ]: On model.ecommerce_datamart.metric_monthly_sales: Close
[0m13:57:02.660218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd81fbb-8642-4a1e-bb16-6b335e37db52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c77c0>]}
[0m13:57:02.660659 [info ] [Thread-1  ]: 3 of 3 OK created sql table model public.metric_monthly_sales .................. [[32mSELECT 7[0m in 0.03s]
[0m13:57:02.661021 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:02.661658 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:02.661866 [debug] [MainThread]: On master: BEGIN
[0m13:57:02.662050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:02.665832 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:57:02.666082 [debug] [MainThread]: On master: COMMIT
[0m13:57:02.666283 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:02.666472 [debug] [MainThread]: On master: COMMIT
[0m13:57:02.666850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:57:02.667105 [debug] [MainThread]: On master: Close
[0m13:57:02.667658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:02.668135 [debug] [MainThread]: Connection 'model.ecommerce_datamart.metric_monthly_sales' was properly closed.
[0m13:57:02.668591 [info ] [MainThread]: 
[0m13:57:02.668858 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:57:02.669566 [debug] [MainThread]: Command end result
[0m13:57:02.698924 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:57:02.700062 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:57:02.704030 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:57:02.704254 [info ] [MainThread]: 
[0m13:57:02.704506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:02.704711 [info ] [MainThread]: 
[0m13:57:02.704930 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:57:02.705959 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0304011, "process_in_blocks": "0", "process_kernel_time": 0.215357, "process_mem_max_rss": "121782272", "process_out_blocks": "0", "process_user_time": 1.723506}
[0m13:57:02.706199 [debug] [MainThread]: Command `dbt run` succeeded at 13:57:02.706155 after 1.03 seconds
[0m13:57:02.706424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052496d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106256b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6c790>]}
[0m13:57:02.706652 [debug] [MainThread]: Flushing usage events
[0m13:57:03.902047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:05.033153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffafd0>]}


============================== 13:57:05.035759 | 2c58d1e8-e0b3-4719-8bbe-14c542b24584 ==============================
[0m13:57:05.035759 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:57:05.036115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select mart.* --store-failures', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:05.161946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c58d1e8-e0b3-4719-8bbe-14c542b24584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107367f70>]}
[0m13:57:05.209079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c58d1e8-e0b3-4719-8bbe-14c542b24584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbfb20>]}
[0m13:57:05.209703 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:57:05.318433 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:57:05.426193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:05.426506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:05.493022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c58d1e8-e0b3-4719-8bbe-14c542b24584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757beb0>]}
[0m13:57:05.576229 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:57:05.578704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:57:05.593069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c58d1e8-e0b3-4719-8bbe-14c542b24584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808eb80>]}
[0m13:57:05.593444 [info ] [MainThread]: Found 17 models, 35 data tests, 4 sources, 591 macros
[0m13:57:05.593664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c58d1e8-e0b3-4719-8bbe-14c542b24584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e72d60>]}
[0m13:57:05.594797 [info ] [MainThread]: 
[0m13:57:05.595020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:05.595199 [info ] [MainThread]: 
[0m13:57:05.595488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:05.598311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3'
[0m13:57:05.628084 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3"
[0m13:57:05.628378 [debug] [ThreadPool]: On list_dbt_db_ex3: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3"} */

    select distinct nspname from pg_namespace
  
[0m13:57:05.628571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:05.655333 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m13:57:05.656408 [debug] [ThreadPool]: On list_dbt_db_ex3: Close
[0m13:57:05.660541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3, now list_dbt_db_ex3_public)
[0m13:57:05.665889 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:57:05.666204 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:57:05.666418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:05.672320 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:57:05.672692 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:57:05.672949 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:57:05.675760 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.003 seconds
[0m13:57:05.677007 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:57:05.677600 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:57:05.678086 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now list_dbt_db_ex3_public_dbt_test__audit)
[0m13:57:05.681973 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:57:05.682226 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: BEGIN
[0m13:57:05.682418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:05.686560 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:57:05.686856 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public_dbt_test__audit"
[0m13:57:05.687089 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public_dbt_test__audit"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_dbt_test__audit'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_dbt_test__audit'
  
[0m13:57:05.689190 [debug] [ThreadPool]: SQL status: SELECT 35 in 0.002 seconds
[0m13:57:05.690476 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: ROLLBACK
[0m13:57:05.690966 [debug] [ThreadPool]: On list_dbt_db_ex3_public_dbt_test__audit: Close
[0m13:57:05.700632 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:05.700954 [debug] [MainThread]: On master: BEGIN
[0m13:57:05.701147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:05.707365 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:57:05.708940 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:05.709241 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:05.716530 [debug] [MainThread]: SQL status: SELECT 2 in 0.007 seconds
[0m13:57:05.717757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c58d1e8-e0b3-4719-8bbe-14c542b24584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cffd00>]}
[0m13:57:05.718106 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:05.718654 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:05.718887 [debug] [MainThread]: On master: BEGIN
[0m13:57:05.719614 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:57:05.719878 [debug] [MainThread]: On master: COMMIT
[0m13:57:05.720108 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:05.720325 [debug] [MainThread]: On master: COMMIT
[0m13:57:05.720777 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:57:05.721012 [debug] [MainThread]: On master: Close
[0m13:57:05.722355 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:05.722661 [info ] [Thread-1  ]: 1 of 4 START test assert_metrics_consistency ................................... [RUN]
[0m13:57:05.722988 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public_dbt_test__audit, now test.ecommerce_datamart.assert_metrics_consistency)
[0m13:57:05.723244 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:05.730070 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:05.730589 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:05.745365 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency"
[0m13:57:05.748185 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:05.748434 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_metrics_consistency"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency" cascade
[0m13:57:05.748658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:05.757101 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m13:57:05.758811 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency"
[0m13:57:05.766879 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:05.767155 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: BEGIN
[0m13:57:05.768172 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m13:57:05.768402 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:05.768671 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_metrics_consistency"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency"
  
  
    as
  
  (
    /*
  Custom test to verify consistency between daily and monthly metrics aggregations.
  This test ensures the sum of daily metrics for a month matches the monthly metrics.
*/

with daily_metrics as (
    select
        extract(year from date_key) as year,
        extract(month from date_key) as month,
        sum(total_sales_amount) as daily_sum_sales,
        sum(orders_count) as daily_sum_orders,
        sum(customers_count) as daily_sum_customers
    from "dbt_db_ex3"."public"."metric_daily_sales"
    group by 1, 2
),

monthly_metrics as (
    select
        year,
        month,
        total_sales_amount as monthly_sales,
        orders_count as monthly_orders,
        unique_customers as monthly_customers
    from "dbt_db_ex3"."public"."metric_monthly_sales"
),

compared as (
    select
        d.year,
        d.month,
        d.daily_sum_sales,
        m.monthly_sales,
        abs(d.daily_sum_sales - m.monthly_sales) as sales_difference,
        d.daily_sum_orders,
        m.monthly_orders,
        abs(d.daily_sum_orders - m.monthly_orders) as orders_difference,
        d.daily_sum_customers,
        m.monthly_customers,
        abs(d.daily_sum_customers - m.monthly_customers) as customers_difference
    from daily_metrics d
    join monthly_metrics m 
        on d.year = m.year 
        and d.month = m.month
)

select * 
from compared 
where 
    sales_difference > 0.01 or -- Allow small rounding differences
    orders_difference > 0 or
    customers_difference > 0
  );
  
    
[0m13:57:05.775342 [debug] [Thread-1  ]: SQL status: SELECT 7 in 0.006 seconds
[0m13:57:05.776037 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: COMMIT
[0m13:57:05.776321 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:05.776579 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: COMMIT
[0m13:57:05.777612 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:57:05.780327 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:05.780839 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:05.781091 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: BEGIN
[0m13:57:05.781575 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:57:05.781807 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:05.782050 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_metrics_consistency"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency"
    
      
    ) dbt_internal_test
[0m13:57:05.782682 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:57:05.785545 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: ROLLBACK
[0m13:57:05.786063 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_metrics_consistency: Close
[0m13:57:05.786476 [error] [Thread-1  ]: 1 of 4 FAIL 7 assert_metrics_consistency ....................................... [[31mFAIL 7[0m in 0.06s]
[0m13:57:05.786873 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:05.787145 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:05.787429 [info ] [Thread-1  ]: 2 of 4 START test assert_retention_rate_decreases .............................. [RUN]
[0m13:57:05.787723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.assert_metrics_consistency, now test.ecommerce_datamart.assert_retention_rate_decreases)
[0m13:57:05.787964 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:05.791353 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:05.791864 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:05.796197 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases"
[0m13:57:05.796691 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:05.796959 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_retention_rate_decreases"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases" cascade
[0m13:57:05.797198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:05.803361 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.006 seconds
[0m13:57:05.804242 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases"
[0m13:57:05.804771 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:05.805034 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: BEGIN
[0m13:57:05.805628 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:57:05.805910 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:05.806208 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_retention_rate_decreases"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases"
  
  
    as
  
  (
    /*
  Custom test to verify that retention rates generally decrease over time
  for any given cohort. This is a typical pattern in retention analysis.
*/

with retention_rates as (
    select
        cohort,
        months_since_first_order,
        retention_rate,
        lead(retention_rate) over (
            partition by cohort
            order by months_since_first_order
        ) as next_month_retention_rate
    from "dbt_db_ex3"."public"."metric_customer_retention"
    where months_since_first_order > 0
),

potential_issues as (
    select
        cohort,
        months_since_first_order,
        retention_rate,
        next_month_retention_rate,
        next_month_retention_rate - retention_rate as retention_rate_change
    from retention_rates
    where
        -- Check for months where retention rate increased by more than 20 percentage points
        -- Some increase can happen due to seasonality, delayed purchases, etc.
        -- but large unexpected increases should be investigated
        next_month_retention_rate is not null
        and next_month_retention_rate > retention_rate
        and (next_month_retention_rate - retention_rate) > 20
)

select * from potential_issues
  );
  
    
[0m13:57:05.809858 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m13:57:05.810568 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: COMMIT
[0m13:57:05.810842 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:05.811095 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: COMMIT
[0m13:57:05.812074 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:57:05.812530 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:05.813040 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:05.813297 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: BEGIN
[0m13:57:05.813782 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:57:05.814030 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:05.814291 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.assert_retention_rate_decreases"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases"
    
      
    ) dbt_internal_test
[0m13:57:05.814884 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:57:05.815843 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: ROLLBACK
[0m13:57:05.816300 [debug] [Thread-1  ]: On test.ecommerce_datamart.assert_retention_rate_decreases: Close
[0m13:57:05.816714 [error] [Thread-1  ]: 2 of 4 FAIL 1 assert_retention_rate_decreases .................................. [[31mFAIL 1[0m in 0.03s]
[0m13:57:05.817133 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:05.817426 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:05.817732 [info ] [Thread-1  ]: 3 of 4 START test not_null_metric_daily_sales_date_key ......................... [RUN]
[0m13:57:05.818047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.assert_retention_rate_decreases, now test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875)
[0m13:57:05.818312 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:05.825900 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:05.826418 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:05.830386 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_metric_daily_sales_date_key"
[0m13:57:05.830765 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:05.831008 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."not_null_metric_daily_sales_date_key" cascade
[0m13:57:05.831234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:05.835534 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:57:05.836356 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."not_null_metric_daily_sales_date_key"
[0m13:57:05.836886 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:05.837148 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: BEGIN
[0m13:57:05.837657 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:57:05.837909 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:05.838159 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."not_null_metric_daily_sales_date_key"
  
  
    as
  
  (
    
    
    



select *
from "dbt_db_ex3"."public"."metric_daily_sales"
where date_key is null



  );
  
    
[0m13:57:05.840925 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.002 seconds
[0m13:57:05.841574 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: COMMIT
[0m13:57:05.841833 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:05.842069 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: COMMIT
[0m13:57:05.843101 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:57:05.843551 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:05.844053 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:05.844304 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: BEGIN
[0m13:57:05.844777 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:57:05.845025 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:05.845270 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."not_null_metric_daily_sales_date_key"
    
      
    ) dbt_internal_test
[0m13:57:05.845967 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:57:05.846923 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: ROLLBACK
[0m13:57:05.847403 [debug] [Thread-1  ]: On test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875: Close
[0m13:57:05.847806 [info ] [Thread-1  ]: 3 of 4 PASS not_null_metric_daily_sales_date_key ............................... [[32mPASS[0m in 0.03s]
[0m13:57:05.848189 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:05.848456 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:05.848748 [info ] [Thread-1  ]: 4 of 4 START test unique_metric_daily_sales_date_key ........................... [RUN]
[0m13:57:05.849043 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875, now test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea)
[0m13:57:05.849288 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:05.855107 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:05.855837 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:05.859810 [debug] [Thread-1  ]: Applying DROP to: "dbt_db_ex3"."public_dbt_test__audit"."unique_metric_daily_sales_date_key"
[0m13:57:05.860191 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:05.860437 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"} */
drop table if exists "dbt_db_ex3"."public_dbt_test__audit"."unique_metric_daily_sales_date_key" cascade
[0m13:57:05.860666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:05.864202 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m13:57:05.864959 [debug] [Thread-1  ]: Applying CREATE to: "dbt_db_ex3"."public_dbt_test__audit"."unique_metric_daily_sales_date_key"
[0m13:57:05.865459 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:05.865707 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: BEGIN
[0m13:57:05.866207 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:57:05.866453 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:05.866692 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"} */

        
  
    

  create  table "dbt_db_ex3"."public_dbt_test__audit"."unique_metric_daily_sales_date_key"
  
  
    as
  
  (
    
    
    

select
    date_key as unique_field,
    count(*) as n_records

from "dbt_db_ex3"."public"."metric_daily_sales"
where date_key is not null
group by date_key
having count(*) > 1



  );
  
    
[0m13:57:05.868436 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.001 seconds
[0m13:57:05.869039 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: COMMIT
[0m13:57:05.869294 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:05.869528 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: COMMIT
[0m13:57:05.870385 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:57:05.870834 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:05.871351 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:05.871605 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: BEGIN
[0m13:57:05.872143 [debug] [Thread-1  ]: SQL status: BEGIN in 0.000 seconds
[0m13:57:05.872379 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:05.872624 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        select *
        from "dbt_db_ex3"."public_dbt_test__audit"."unique_metric_daily_sales_date_key"
    
      
    ) dbt_internal_test
[0m13:57:05.873261 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.000 seconds
[0m13:57:05.874248 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: ROLLBACK
[0m13:57:05.874732 [debug] [Thread-1  ]: On test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea: Close
[0m13:57:05.875141 [info ] [Thread-1  ]: 4 of 4 PASS unique_metric_daily_sales_date_key ................................. [[32mPASS[0m in 0.03s]
[0m13:57:05.875519 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:05.876214 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:05.876435 [debug] [MainThread]: On master: BEGIN
[0m13:57:05.876631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:05.880005 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:57:05.880286 [debug] [MainThread]: On master: COMMIT
[0m13:57:05.880500 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:05.880702 [debug] [MainThread]: On master: COMMIT
[0m13:57:05.881098 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:57:05.881326 [debug] [MainThread]: On master: Close
[0m13:57:05.881633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:05.881834 [debug] [MainThread]: Connection 'test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea' was properly closed.
[0m13:57:05.882060 [info ] [MainThread]: 
[0m13:57:05.882286 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m13:57:05.882936 [debug] [MainThread]: Command end result
[0m13:57:05.909362 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:57:05.910422 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:57:05.914894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:57:05.915112 [info ] [MainThread]: 
[0m13:57:05.915357 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:57:05.915556 [info ] [MainThread]: 
[0m13:57:05.915785 [error] [MainThread]: [31mFailure in test assert_metrics_consistency (tests/assert_metrics_consistency.sql)[0m
[0m13:57:05.916001 [error] [MainThread]:   Got 7 results, configured to fail if != 0
[0m13:57:05.916173 [info ] [MainThread]: 
[0m13:57:05.916378 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_datamart/tests/assert_metrics_consistency.sql
[0m13:57:05.916551 [info ] [MainThread]: 
[0m13:57:05.916756 [info ] [MainThread]:   See test failures:
  --------------------------------------------------------------------------------
  select * from "dbt_db_ex3"."public_dbt_test__audit"."assert_metrics_consistency"
  --------------------------------------------------------------------------------
[0m13:57:05.916948 [info ] [MainThread]: 
[0m13:57:05.917162 [error] [MainThread]: [31mFailure in test assert_retention_rate_decreases (tests/assert_retention_rate_decreases.sql)[0m
[0m13:57:05.917376 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:57:05.917544 [info ] [MainThread]: 
[0m13:57:05.917744 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_datamart/tests/assert_retention_rate_decreases.sql
[0m13:57:05.917913 [info ] [MainThread]: 
[0m13:57:05.918112 [info ] [MainThread]:   See test failures:
  -------------------------------------------------------------------------------------
  select * from "dbt_db_ex3"."public_dbt_test__audit"."assert_retention_rate_decreases"
  -------------------------------------------------------------------------------------
[0m13:57:05.918289 [info ] [MainThread]: 
[0m13:57:05.918477 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m13:57:05.919411 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.94297403, "process_in_blocks": "0", "process_kernel_time": 0.166457, "process_mem_max_rss": "125861888", "process_out_blocks": "0", "process_user_time": 1.561398}
[0m13:57:05.919667 [debug] [MainThread]: Command `dbt test` failed at 13:57:05.919618 after 0.94 seconds
[0m13:57:05.919895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108513ee0>]}
[0m13:57:05.920120 [debug] [MainThread]: Flushing usage events
[0m13:57:06.893064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:07.994859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f76730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104deeb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104deed60>]}


============================== 13:57:07.997992 | 182b9075-9c80-4eac-8896-ddfb2c566735 ==============================
[0m13:57:07.997992 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:57:07.998473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:57:08.130034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '182b9075-9c80-4eac-8896-ddfb2c566735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105146a30>]}
[0m13:57:08.175834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '182b9075-9c80-4eac-8896-ddfb2c566735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105146e80>]}
[0m13:57:08.176387 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:57:08.250561 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:57:08.357649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:08.357939 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:08.397276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '182b9075-9c80-4eac-8896-ddfb2c566735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b65130>]}
[0m13:57:08.506902 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:57:08.509274 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:57:08.517824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '182b9075-9c80-4eac-8896-ddfb2c566735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517e190>]}
[0m13:57:08.518152 [info ] [MainThread]: Found 17 models, 35 data tests, 4 sources, 591 macros
[0m13:57:08.518377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '182b9075-9c80-4eac-8896-ddfb2c566735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517e0a0>]}
[0m13:57:08.520297 [info ] [MainThread]: 
[0m13:57:08.520525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:08.520719 [info ] [MainThread]: 
[0m13:57:08.521026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:08.524271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3_public'
[0m13:57:08.554501 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:57:08.554790 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:57:08.554982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:08.566904 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:57:08.567198 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:57:08.567406 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:57:08.572795 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.005 seconds
[0m13:57:08.573785 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:57:08.574397 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:57:08.579841 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:08.580089 [debug] [MainThread]: On master: BEGIN
[0m13:57:08.580276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:08.585911 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:57:08.586202 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:08.586465 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:08.590676 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:57:08.591811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '182b9075-9c80-4eac-8896-ddfb2c566735', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10283dcd0>]}
[0m13:57:08.592110 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:08.592575 [debug] [MainThread]: On master: Close
[0m13:57:08.593795 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:57:08.594094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_date)
[0m13:57:08.594327 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:57:08.613544 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:57:08.613816 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:57:08.614030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:08.622030 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m13:57:08.622314 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:57:08.622542 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:57:08.623388 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:57:08.631308 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:57:08.631856 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:57:08.632135 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: ROLLBACK
[0m13:57:08.632646 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:57:08.633155 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:57:08.633443 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:57:08.633720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.stg_customers)
[0m13:57:08.633970 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:57:08.636624 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:57:08.637138 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:57:08.637560 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:57:08.637807 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_order_items
[0m13:57:08.638081 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_customers, now model.ecommerce_datamart.stg_order_items)
[0m13:57:08.638306 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_order_items
[0m13:57:08.644873 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_order_items"
[0m13:57:08.645435 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_order_items
[0m13:57:08.645881 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_order_items
[0m13:57:08.646124 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_orders
[0m13:57:08.646413 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_order_items, now model.ecommerce_datamart.stg_orders)
[0m13:57:08.646638 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_orders
[0m13:57:08.649696 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_orders"
[0m13:57:08.650074 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_orders
[0m13:57:08.650466 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_orders
[0m13:57:08.650697 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_products
[0m13:57:08.650994 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_orders, now model.ecommerce_datamart.stg_products)
[0m13:57:08.651226 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_products
[0m13:57:08.654008 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_products"
[0m13:57:08.654403 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_products
[0m13:57:08.654788 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_products
[0m13:57:08.655022 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers
[0m13:57:08.655289 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_products, now model.ecommerce_datamart.dim_customers)
[0m13:57:08.655542 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers
[0m13:57:08.657889 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers"
[0m13:57:08.658287 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers
[0m13:57:08.658719 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers
[0m13:57:08.659123 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_orders
[0m13:57:08.659534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers, now model.ecommerce_datamart.fct_orders)
[0m13:57:08.660123 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_orders
[0m13:57:08.663037 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_orders"
[0m13:57:08.663653 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_orders
[0m13:57:08.664114 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_orders
[0m13:57:08.664354 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products
[0m13:57:08.664678 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_orders, now model.ecommerce_datamart.dim_products)
[0m13:57:08.665055 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products
[0m13:57:08.667806 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products"
[0m13:57:08.668298 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products
[0m13:57:08.668732 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products
[0m13:57:08.668976 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_order_items
[0m13:57:08.669270 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products, now model.ecommerce_datamart.fct_order_items)
[0m13:57:08.669593 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_order_items
[0m13:57:08.672309 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_order_items"
[0m13:57:08.672798 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_order_items
[0m13:57:08.673236 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_order_items
[0m13:57:08.673480 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:57:08.673971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_order_items, now model.ecommerce_datamart.dim_customers_mart)
[0m13:57:08.674205 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:57:08.676802 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:57:08.677297 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:57:08.677734 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:57:08.677979 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:57:08.678257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:57:08.678481 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:57:08.686940 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:57:08.687365 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:57:08.687762 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:57:08.687991 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:57:08.688251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a)
[0m13:57:08.688465 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:57:08.691113 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:57:08.691462 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:57:08.691843 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:57:08.692069 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:57:08.692313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:57:08.692532 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:57:08.695245 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:57:08.695588 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:57:08.695961 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:57:08.696185 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:57:08.696430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888)
[0m13:57:08.696643 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:57:08.699303 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:57:08.699685 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:57:08.700071 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:57:08.700294 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:57:08.700538 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888, now test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1)
[0m13:57:08.700750 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:57:08.703349 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:57:08.703671 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:57:08.704041 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:57:08.704263 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:57:08.704527 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:57:08.704768 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:57:08.709318 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:57:08.709675 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:57:08.710056 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:57:08.710281 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:57:08.710556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8)
[0m13:57:08.710780 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:57:08.713428 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:57:08.713774 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:57:08.714151 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:57:08.714377 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_customer_retention
[0m13:57:08.714620 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8, now model.ecommerce_datamart.fct_customer_retention)
[0m13:57:08.714833 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_customer_retention
[0m13:57:08.717450 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:57:08.717787 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_customer_retention
[0m13:57:08.718156 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_customer_retention
[0m13:57:08.718384 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:57:08.718641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_customer_retention, now test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:57:08.718893 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:57:08.725066 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:57:08.725412 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:57:08.725795 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:57:08.726023 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:57:08.726262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:57:08.726509 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:57:08.729162 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:57:08.729527 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:57:08.729919 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:57:08.730148 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:57:08.730394 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362)
[0m13:57:08.730608 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:57:08.733266 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:57:08.733620 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:57:08.733993 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:57:08.734218 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:57:08.734462 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0)
[0m13:57:08.734675 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:57:08.738068 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:57:08.738464 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:57:08.738858 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:57:08.739082 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:57:08.739331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_datamart.not_null_fct_orders_status.1455048989)
[0m13:57:08.739545 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:57:08.742183 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:57:08.742508 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:57:08.742878 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:57:08.743101 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:57:08.743344 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_status.1455048989, now test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:57:08.743558 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:57:08.746165 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:57:08.746563 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:57:08.746947 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:57:08.747176 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:57:08.747431 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:57:08.747650 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:57:08.753040 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:57:08.753482 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:57:08.753913 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:57:08.754163 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:57:08.754452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5)
[0m13:57:08.754696 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:57:08.757630 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:57:08.758094 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:57:08.758532 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:57:08.758780 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:57:08.759071 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5, now model.ecommerce_datamart.dim_products_mart)
[0m13:57:08.759304 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:57:08.762812 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:57:08.763278 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:57:08.763704 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:57:08.763972 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:57:08.764257 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products_mart, now test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:57:08.764489 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:57:08.768896 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:57:08.769354 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:57:08.769768 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:57:08.770004 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:57:08.770282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0)
[0m13:57:08.770520 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:57:08.773279 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:57:08.773623 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:57:08.774004 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:57:08.774233 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:57:08.774486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0, now test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e)
[0m13:57:08.774702 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:57:08.777456 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:57:08.777812 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:57:08.778185 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:57:08.778409 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:57:08.778655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e, now test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff)
[0m13:57:08.778869 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:57:08.781627 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:57:08.782853 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:57:08.783253 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:57:08.786976 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:57:08.787237 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff, now test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed)
[0m13:57:08.787452 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:57:08.790248 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:57:08.790629 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:57:08.791013 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:57:08.791247 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:57:08.791500 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed, now test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1)
[0m13:57:08.791725 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:57:08.795371 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:57:08.795751 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:57:08.796149 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:57:08.796384 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:57:08.796641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985)
[0m13:57:08.796865 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:57:08.799666 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:57:08.800033 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:57:08.800419 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:57:08.800658 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_daily_sales
[0m13:57:08.800911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985, now model.ecommerce_datamart.fct_daily_sales)
[0m13:57:08.801133 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_daily_sales
[0m13:57:08.804006 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:57:08.804369 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_daily_sales
[0m13:57:08.804746 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_daily_sales
[0m13:57:08.804971 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_monthly_sales
[0m13:57:08.805230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_daily_sales, now model.ecommerce_datamart.fct_monthly_sales)
[0m13:57:08.805475 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_monthly_sales
[0m13:57:08.808869 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:57:08.809214 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_monthly_sales
[0m13:57:08.809589 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_monthly_sales
[0m13:57:08.809819 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:57:08.810070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_monthly_sales, now test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6)
[0m13:57:08.810306 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:57:08.812990 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:57:08.813320 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:57:08.813691 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:57:08.813915 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:57:08.814158 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6, now test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02)
[0m13:57:08.814373 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:57:08.817879 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:57:08.818238 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:57:08.818615 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:57:08.818843 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:57:08.819089 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02, now test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55)
[0m13:57:08.819304 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:57:08.821958 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:57:08.822307 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:57:08.822696 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:57:08.822922 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:57:08.823166 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55, now test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc)
[0m13:57:08.823383 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:57:08.826033 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:57:08.826367 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:57:08.826741 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:57:08.826969 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:57:08.827212 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc, now test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03)
[0m13:57:08.827425 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:57:08.830076 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:57:08.830404 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:57:08.830792 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:57:08.831027 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:57:08.831284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03, now test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8)
[0m13:57:08.831510 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:57:08.834135 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:57:08.834475 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:57:08.834851 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:57:08.835077 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:57:08.835322 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8, now test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m13:57:08.835538 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:57:08.839231 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:57:08.839587 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:57:08.839972 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:57:08.840207 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:57:08.840455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m13:57:08.840677 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:57:08.845061 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:57:08.845414 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:57:08.845797 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:57:08.846023 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:57:08.846269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768)
[0m13:57:08.846486 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:57:08.849096 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:57:08.849431 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:57:08.849808 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:57:08.850036 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_customer_retention
[0m13:57:08.850281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768, now model.ecommerce_datamart.metric_customer_retention)
[0m13:57:08.850498 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_customer_retention
[0m13:57:08.852801 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:08.853142 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_customer_retention
[0m13:57:08.853516 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_customer_retention
[0m13:57:08.853742 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_daily_sales
[0m13:57:08.853993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_customer_retention, now model.ecommerce_datamart.metric_daily_sales)
[0m13:57:08.854239 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_daily_sales
[0m13:57:08.856592 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:08.856929 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_daily_sales
[0m13:57:08.857316 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_daily_sales
[0m13:57:08.857549 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:08.857802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_daily_sales, now model.ecommerce_datamart.metric_monthly_sales)
[0m13:57:08.858020 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:08.860438 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:08.860776 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:08.861150 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:08.861376 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:08.861628 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_monthly_sales, now test.ecommerce_datamart.assert_retention_rate_decreases)
[0m13:57:08.861859 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:08.863977 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:08.864318 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:08.864698 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:08.864925 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:08.865166 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.assert_retention_rate_decreases, now test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875)
[0m13:57:08.865380 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:08.868807 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:08.869150 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:08.869526 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:08.869761 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:08.870010 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875, now test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea)
[0m13:57:08.870235 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:08.872846 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:08.873190 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:08.873563 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:08.873788 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:08.874030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea, now test.ecommerce_datamart.assert_metrics_consistency)
[0m13:57:08.874246 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:08.876507 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:08.876838 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:08.877214 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:08.877698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:08.877885 [debug] [MainThread]: Connection 'test.ecommerce_datamart.assert_metrics_consistency' was properly closed.
[0m13:57:08.881602 [debug] [MainThread]: Command end result
[0m13:57:08.906625 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:57:08.907581 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:57:08.913067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:57:08.914105 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.98194396, "process_in_blocks": "0", "process_kernel_time": 0.157955, "process_mem_max_rss": "125681664", "process_out_blocks": "0", "process_user_time": 1.656561}
[0m13:57:08.914374 [debug] [MainThread]: Command `dbt compile` succeeded at 13:57:08.914321 after 0.98 seconds
[0m13:57:08.914616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f76730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105844580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058443a0>]}
[0m13:57:08.914864 [debug] [MainThread]: Flushing usage events
[0m13:57:09.917520 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:11.094691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c93d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c93f70>]}


============================== 13:57:11.097490 | 89a7b8c2-f341-443f-9241-28bb2648541d ==============================
[0m13:57:11.097490 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:57:11.097877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ls --resource-type model --output json', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:57:11.235062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89a7b8c2-f341-443f-9241-28bb2648541d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102626580>]}
[0m13:57:11.281141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89a7b8c2-f341-443f-9241-28bb2648541d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516aee0>]}
[0m13:57:11.281715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:57:11.355471 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:57:11.463081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:11.463366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:11.503081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89a7b8c2-f341-443f-9241-28bb2648541d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a08130>]}
[0m13:57:11.619161 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:57:11.622139 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:57:11.631612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89a7b8c2-f341-443f-9241-28bb2648541d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b2490>]}
[0m13:57:11.632026 [info ] [MainThread]: Found 17 models, 35 data tests, 4 sources, 591 macros
[0m13:57:11.632270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89a7b8c2-f341-443f-9241-28bb2648541d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f48e0>]}
[0m13:57:11.633221 [info ] [MainThread]: {"name": "dim_customers", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/core/dim_customers.sql", "unique_id": "model.ecommerce_datamart.dim_customers", "alias": "dim_customers", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["core", "dimensions"], "meta": {"owner": "Analytics Team", "contains_pii": true}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["core", "dimensions"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.stg_customers", "model.ecommerce_datamart.stg_orders"]}}
[0m13:57:11.633571 [info ] [MainThread]: {"name": "dim_customers_mart", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/dimensions/dim_customers_mart.sql", "unique_id": "model.ecommerce_datamart.dim_customers_mart", "alias": "dim_customers_mart", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "dimensions", "datamart", "dimensions"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "dimensions"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.dim_customers"]}}
[0m13:57:11.633864 [info ] [MainThread]: {"name": "dim_date", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/dimensions/dim_date.sql", "unique_id": "model.ecommerce_datamart.dim_date", "alias": "dim_date", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "dimensions", "datamart", "dimensions"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "dimensions"], "depends_on": {"macros": ["macro.dbt_utils.date_spine"], "nodes": []}}
[0m13:57:11.634153 [info ] [MainThread]: {"name": "dim_products", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/core/dim_products.sql", "unique_id": "model.ecommerce_datamart.dim_products", "alias": "dim_products", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["core", "dimensions"], "meta": {"owner": "Product Team"}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["core", "dimensions"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.stg_products", "model.ecommerce_datamart.stg_order_items"]}}
[0m13:57:11.634439 [info ] [MainThread]: {"name": "dim_products_mart", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/dimensions/dim_products_mart.sql", "unique_id": "model.ecommerce_datamart.dim_products_mart", "alias": "dim_products_mart", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "dimensions", "datamart", "dimensions"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "dimensions"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.dim_products"]}}
[0m13:57:11.634719 [info ] [MainThread]: {"name": "fct_customer_retention", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/facts/fct_customer_retention.sql", "unique_id": "model.ecommerce_datamart.fct_customer_retention", "alias": "fct_customer_retention", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "facts", "datamart", "facts"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "facts"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_orders"]}}
[0m13:57:11.635000 [info ] [MainThread]: {"name": "fct_daily_sales", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/facts/fct_daily_sales.sql", "unique_id": "model.ecommerce_datamart.fct_daily_sales", "alias": "fct_daily_sales", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "facts", "datamart", "facts"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "facts"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_orders", "model.ecommerce_datamart.fct_order_items", "model.ecommerce_datamart.dim_date"]}}
[0m13:57:11.635453 [info ] [MainThread]: {"name": "fct_monthly_sales", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/facts/fct_monthly_sales.sql", "unique_id": "model.ecommerce_datamart.fct_monthly_sales", "alias": "fct_monthly_sales", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "facts", "datamart", "facts"], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": ["year", "month"], "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "facts"], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["model.ecommerce_datamart.fct_orders", "model.ecommerce_datamart.fct_order_items", "model.ecommerce_datamart.dim_customers"]}}
[0m13:57:11.635770 [info ] [MainThread]: {"name": "fct_order_items", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/core/fct_order_items.sql", "unique_id": "model.ecommerce_datamart.fct_order_items", "alias": "fct_order_items", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["core", "facts"], "meta": {"owner": "Sales Team", "update_frequency": "daily"}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["core", "facts"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.stg_order_items", "model.ecommerce_datamart.stg_orders", "model.ecommerce_datamart.stg_products"]}}
[0m13:57:11.636066 [info ] [MainThread]: {"name": "fct_orders", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/core/fct_orders.sql", "unique_id": "model.ecommerce_datamart.fct_orders", "alias": "fct_orders", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["core", "facts"], "meta": {"owner": "Sales Team", "update_frequency": "daily"}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["core", "facts"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.stg_orders", "model.ecommerce_datamart.stg_order_items"]}}
[0m13:57:11.636358 [info ] [MainThread]: {"name": "metric_customer_retention", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/metrics/metric_customer_retention.sql", "unique_id": "model.ecommerce_datamart.metric_customer_retention", "alias": "metric_customer_retention", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "metrics", "datamart", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "metrics"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_customer_retention"]}}
[0m13:57:11.636647 [info ] [MainThread]: {"name": "metric_daily_sales", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/metrics/metric_daily_sales.sql", "unique_id": "model.ecommerce_datamart.metric_daily_sales", "alias": "metric_daily_sales", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "metrics", "datamart", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "metrics"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_daily_sales"]}}
[0m13:57:11.636944 [info ] [MainThread]: {"name": "metric_monthly_sales", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/mart/metrics/metric_monthly_sales.sql", "unique_id": "model.ecommerce_datamart.metric_monthly_sales", "alias": "metric_monthly_sales", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": ["datamart", "metrics", "datamart", "metrics"], "meta": {}, "group": null, "materialized": "table", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": ["datamart", "metrics"], "depends_on": {"macros": [], "nodes": ["model.ecommerce_datamart.fct_monthly_sales"]}}
[0m13:57:11.637219 [info ] [MainThread]: {"name": "stg_customers", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/staging/stg_customers.sql", "unique_id": "model.ecommerce_datamart.stg_customers", "alias": "stg_customers", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": [], "nodes": ["source.ecommerce_datamart.ecommerce_raw.customers"]}}
[0m13:57:11.637491 [info ] [MainThread]: {"name": "stg_order_items", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/staging/stg_order_items.sql", "unique_id": "model.ecommerce_datamart.stg_order_items", "alias": "stg_order_items", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "order_item_id", "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.ecommerce_datamart.ecommerce_raw.order_items"]}}
[0m13:57:11.637759 [info ] [MainThread]: {"name": "stg_orders", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/staging/stg_orders.sql", "unique_id": "model.ecommerce_datamart.stg_orders", "alias": "stg_orders", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "incremental", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": "order_id", "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": ["macro.dbt.is_incremental"], "nodes": ["source.ecommerce_datamart.ecommerce_raw.orders"]}}
[0m13:57:11.638020 [info ] [MainThread]: {"name": "stg_products", "resource_type": "model", "package_name": "ecommerce_datamart", "original_file_path": "models/staging/stg_products.sql", "unique_id": "model.ecommerce_datamart.stg_products", "alias": "stg_products", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": [], "nodes": ["source.ecommerce_datamart.ecommerce_raw.products"]}}
[0m13:57:11.638968 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.59806436, "process_in_blocks": "0", "process_kernel_time": 0.147743, "process_mem_max_rss": "113033216", "process_out_blocks": "0", "process_user_time": 1.374097}
[0m13:57:11.639249 [debug] [MainThread]: Command `dbt ls` succeeded at 13:57:11.639188 after 0.60 seconds
[0m13:57:11.639476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e1a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dc3a0>]}
[0m13:57:11.639718 [debug] [MainThread]: Flushing usage events
[0m13:57:12.639774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:13.920854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952bd30>]}


============================== 13:57:13.923409 | 27df3efa-31f8-4bfd-b8f2-8e187d39b3c6 ==============================
[0m13:57:13.923409 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:57:13.923788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:14.052908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27df3efa-31f8-4bfd-b8f2-8e187d39b3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109995160>]}
[0m13:57:14.099373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27df3efa-31f8-4bfd-b8f2-8e187d39b3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f6190>]}
[0m13:57:14.099966 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:57:14.175939 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:57:14.280364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:57:14.280649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:57:14.346177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27df3efa-31f8-4bfd-b8f2-8e187d39b3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aeddf0>]}
[0m13:57:14.357564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27df3efa-31f8-4bfd-b8f2-8e187d39b3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a345e50>]}
[0m13:57:14.357887 [info ] [MainThread]: Found 17 models, 35 data tests, 4 sources, 591 macros
[0m13:57:14.358116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27df3efa-31f8-4bfd-b8f2-8e187d39b3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a345dc0>]}
[0m13:57:14.360010 [info ] [MainThread]: 
[0m13:57:14.360256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:14.360452 [info ] [MainThread]: 
[0m13:57:14.360747 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:57:14.364009 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_ex3_public'
[0m13:57:14.396473 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:57:14.396772 [debug] [ThreadPool]: On list_dbt_db_ex3_public: BEGIN
[0m13:57:14.396958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:14.410527 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:57:14.410804 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_ex3_public"
[0m13:57:14.411014 [debug] [ThreadPool]: On list_dbt_db_ex3_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "list_dbt_db_ex3_public"} */
select
      'dbt_db_ex3' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db_ex3' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:57:14.415069 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.004 seconds
[0m13:57:14.416139 [debug] [ThreadPool]: On list_dbt_db_ex3_public: ROLLBACK
[0m13:57:14.416778 [debug] [ThreadPool]: On list_dbt_db_ex3_public: Close
[0m13:57:14.422348 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:14.422575 [debug] [MainThread]: On master: BEGIN
[0m13:57:14.422762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:14.427740 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:57:14.427972 [debug] [MainThread]: Using postgres connection "master"
[0m13:57:14.428227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:57:14.432382 [debug] [MainThread]: SQL status: SELECT 2 in 0.004 seconds
[0m13:57:14.433505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27df3efa-31f8-4bfd-b8f2-8e187d39b3c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109956c70>]}
[0m13:57:14.433837 [debug] [MainThread]: On master: ROLLBACK
[0m13:57:14.434362 [debug] [MainThread]: On master: Close
[0m13:57:14.435570 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_date
[0m13:57:14.435875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_ex3_public, now model.ecommerce_datamart.dim_date)
[0m13:57:14.436148 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_date
[0m13:57:14.455480 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:57:14.455791 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: BEGIN
[0m13:57:14.456010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:57:14.461249 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:57:14.461561 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_datamart.dim_date"
[0m13:57:14.461805 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "node_id": "model.ecommerce_datamart.dim_date"} */


        select 
        ((cast('2025-12-31' as date))::date - (cast('2020-01-01' as date))::date)
    
[0m13:57:14.462569 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m13:57:14.471095 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_date"
[0m13:57:14.472027 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_date
[0m13:57:14.472349 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: ROLLBACK
[0m13:57:14.473127 [debug] [Thread-1  ]: On model.ecommerce_datamart.dim_date: Close
[0m13:57:14.473692 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_date
[0m13:57:14.473969 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_customers
[0m13:57:14.474251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_date, now model.ecommerce_datamart.stg_customers)
[0m13:57:14.474500 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_customers
[0m13:57:14.478016 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_customers"
[0m13:57:14.478591 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_customers
[0m13:57:14.479046 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_customers
[0m13:57:14.479293 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_order_items
[0m13:57:14.479546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_customers, now model.ecommerce_datamart.stg_order_items)
[0m13:57:14.479779 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_order_items
[0m13:57:14.486641 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_order_items"
[0m13:57:14.487282 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_order_items
[0m13:57:14.487752 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_order_items
[0m13:57:14.488011 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_orders
[0m13:57:14.488317 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_order_items, now model.ecommerce_datamart.stg_orders)
[0m13:57:14.488592 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_orders
[0m13:57:14.491667 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_orders"
[0m13:57:14.492142 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_orders
[0m13:57:14.492561 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_orders
[0m13:57:14.492808 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.stg_products
[0m13:57:14.493055 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_orders, now model.ecommerce_datamart.stg_products)
[0m13:57:14.493387 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.stg_products
[0m13:57:14.495754 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.stg_products"
[0m13:57:14.496310 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.stg_products
[0m13:57:14.496736 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.stg_products
[0m13:57:14.496977 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers
[0m13:57:14.497271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.stg_products, now model.ecommerce_datamart.dim_customers)
[0m13:57:14.497506 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers
[0m13:57:14.500897 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers"
[0m13:57:14.501521 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers
[0m13:57:14.501966 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers
[0m13:57:14.502216 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_orders
[0m13:57:14.502468 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers, now model.ecommerce_datamart.fct_orders)
[0m13:57:14.502864 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_orders
[0m13:57:14.509791 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_orders"
[0m13:57:14.511668 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_orders
[0m13:57:14.512217 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_orders
[0m13:57:14.512473 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products
[0m13:57:14.512723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_orders, now model.ecommerce_datamart.dim_products)
[0m13:57:14.512948 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products
[0m13:57:14.516404 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products"
[0m13:57:14.516868 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products
[0m13:57:14.517268 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products
[0m13:57:14.517504 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_order_items
[0m13:57:14.517779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products, now model.ecommerce_datamart.fct_order_items)
[0m13:57:14.518117 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_order_items
[0m13:57:14.520524 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_order_items"
[0m13:57:14.520902 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_order_items
[0m13:57:14.521279 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_order_items
[0m13:57:14.521507 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_customers_mart
[0m13:57:14.521782 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_order_items, now model.ecommerce_datamart.dim_customers_mart)
[0m13:57:14.522187 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_customers_mart
[0m13:57:14.524538 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_customers_mart"
[0m13:57:14.524894 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_customers_mart
[0m13:57:14.525275 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_customers_mart
[0m13:57:14.525500 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:57:14.525753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_customers_mart, now test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m13:57:14.525971 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:57:14.533273 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m13:57:14.533670 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:57:14.534051 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d
[0m13:57:14.534277 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:57:14.534539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a)
[0m13:57:14.534762 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:57:14.537388 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a"
[0m13:57:14.537726 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:57:14.538095 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a
[0m13:57:14.538319 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:57:14.538564 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_email.ed68b54d1a, now test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m13:57:14.538776 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:57:14.542120 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m13:57:14.542516 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:57:14.542904 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m13:57:14.543133 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:57:14.543448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888)
[0m13:57:14.543675 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:57:14.546347 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888"
[0m13:57:14.546758 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:57:14.547130 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888
[0m13:57:14.547351 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:57:14.547611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_lifetime_value.8655024888, now test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1)
[0m13:57:14.547833 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:57:14.550457 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1"
[0m13:57:14.550807 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:57:14.551175 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1
[0m13:57:14.551401 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:57:14.551653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_customers_name.e0448e04f1, now test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd)
[0m13:57:14.551867 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:57:14.555803 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd"
[0m13:57:14.556161 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:57:14.556538 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd
[0m13:57:14.556763 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:57:14.557013 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8)
[0m13:57:14.557226 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:57:14.559830 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8"
[0m13:57:14.560183 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:57:14.560550 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8
[0m13:57:14.560774 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_customer_retention
[0m13:57:14.561025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_customers_email.0472f7c2e8, now model.ecommerce_datamart.fct_customer_retention)
[0m13:57:14.561238 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_customer_retention
[0m13:57:14.563880 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_customer_retention"
[0m13:57:14.564213 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_customer_retention
[0m13:57:14.564586 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_customer_retention
[0m13:57:14.564809 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:57:14.565073 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_customer_retention, now test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339)
[0m13:57:14.565299 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:57:14.572251 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339"
[0m13:57:14.572629 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:57:14.573027 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339
[0m13:57:14.573249 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:57:14.573498 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_fct_orders_status__completed__processing__cancelled__refunded.2a979f9339, now test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b)
[0m13:57:14.573710 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:57:14.576320 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b"
[0m13:57:14.576668 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:57:14.577040 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b
[0m13:57:14.577261 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:57:14.577506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362)
[0m13:57:14.577719 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:57:14.580487 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362"
[0m13:57:14.581014 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:57:14.581409 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362
[0m13:57:14.581632 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:57:14.581887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_date.84f0a76362, now test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0)
[0m13:57:14.582104 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:57:14.584791 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0"
[0m13:57:14.585636 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:57:14.586034 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0
[0m13:57:14.586264 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:57:14.586525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_datamart.not_null_fct_orders_status.1455048989)
[0m13:57:14.586740 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:57:14.589414 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_status.1455048989"
[0m13:57:14.589769 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:57:14.590145 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_status.1455048989
[0m13:57:14.590370 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:57:14.590619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_status.1455048989, now test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38)
[0m13:57:14.590832 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:57:14.594177 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38"
[0m13:57:14.594569 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:57:14.594955 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38
[0m13:57:14.595188 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:57:14.595451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m13:57:14.595695 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:57:14.601026 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m13:57:14.601524 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:57:14.601925 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m13:57:14.602156 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:57:14.602421 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5)
[0m13:57:14.602637 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:57:14.605289 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5"
[0m13:57:14.605630 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:57:14.606010 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5
[0m13:57:14.606249 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.dim_products_mart
[0m13:57:14.606506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_orders_order_id.523ddb6ce5, now model.ecommerce_datamart.dim_products_mart)
[0m13:57:14.606724 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.dim_products_mart
[0m13:57:14.609043 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.dim_products_mart"
[0m13:57:14.609385 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.dim_products_mart
[0m13:57:14.609755 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.dim_products_mart
[0m13:57:14.609984 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:57:14.610239 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.dim_products_mart, now test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd)
[0m13:57:14.610469 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:57:14.614446 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd"
[0m13:57:14.617187 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:57:14.617598 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd
[0m13:57:14.617836 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:57:14.618100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.accepted_values_dim_products_category__Electronics__Clothing__Footwear__Accessories.e081bd3fbd, now test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0)
[0m13:57:14.618326 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:57:14.621157 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0"
[0m13:57:14.621510 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:57:14.621893 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0
[0m13:57:14.622124 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:57:14.622372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_category.b4c6ea8fb0, now test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e)
[0m13:57:14.622591 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:57:14.626132 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e"
[0m13:57:14.627886 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:57:14.628284 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e
[0m13:57:14.628518 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:57:14.628782 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_inventory_count.ac9dd6f09e, now test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff)
[0m13:57:14.629008 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:57:14.631842 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff"
[0m13:57:14.632688 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:57:14.633080 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff
[0m13:57:14.633309 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:57:14.633558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_name.bffc7524ff, now test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed)
[0m13:57:14.633776 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:57:14.636508 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed"
[0m13:57:14.636883 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:57:14.637261 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed
[0m13:57:14.637487 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:57:14.637734 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_price.93519fc0ed, now test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1)
[0m13:57:14.637951 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:57:14.640666 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1"
[0m13:57:14.641021 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:57:14.641397 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1
[0m13:57:14.641627 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:57:14.641876 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985)
[0m13:57:14.642089 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:57:14.644729 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985"
[0m13:57:14.645073 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:57:14.645443 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985
[0m13:57:14.645669 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_daily_sales
[0m13:57:14.645900 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_dim_products_product_id.ef7b2a9985, now model.ecommerce_datamart.fct_daily_sales)
[0m13:57:14.646137 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_daily_sales
[0m13:57:14.649628 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_daily_sales"
[0m13:57:14.649984 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_daily_sales
[0m13:57:14.650362 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_daily_sales
[0m13:57:14.650588 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.fct_monthly_sales
[0m13:57:14.650880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_daily_sales, now model.ecommerce_datamart.fct_monthly_sales)
[0m13:57:14.651101 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.fct_monthly_sales
[0m13:57:14.654492 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.fct_monthly_sales"
[0m13:57:14.654856 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.fct_monthly_sales
[0m13:57:14.655242 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.fct_monthly_sales
[0m13:57:14.655469 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:57:14.655736 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.fct_monthly_sales, now test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6)
[0m13:57:14.655956 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:57:14.658675 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6"
[0m13:57:14.659034 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:57:14.659436 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6
[0m13:57:14.659677 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:57:14.659937 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_item_total.d3cdfdf7d6, now test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02)
[0m13:57:14.660163 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:57:14.662887 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02"
[0m13:57:14.663242 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:57:14.663619 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02
[0m13:57:14.663845 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:57:14.664101 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_id.e887a2de02, now test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55)
[0m13:57:14.664316 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:57:14.666940 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55"
[0m13:57:14.667300 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:57:14.667692 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55
[0m13:57:14.667917 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:57:14.668170 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_order_item_id.dbaab21f55, now test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc)
[0m13:57:14.668383 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:57:14.671005 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc"
[0m13:57:14.671348 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:57:14.671721 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc
[0m13:57:14.671945 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:57:14.672192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_product_id.6fbedef7dc, now test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03)
[0m13:57:14.672405 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:57:14.675780 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03"
[0m13:57:14.676126 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:57:14.676501 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03
[0m13:57:14.676725 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:57:14.676977 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_quantity.2785769c03, now test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8)
[0m13:57:14.677192 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:57:14.679846 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8"
[0m13:57:14.680198 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:57:14.680571 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8
[0m13:57:14.680798 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:57:14.681047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_fct_order_items_unit_price.25a5837cb8, now test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec)
[0m13:57:14.681266 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:57:14.684845 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec"
[0m13:57:14.685205 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:57:14.685584 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec
[0m13:57:14.685814 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:57:14.686068 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_order_id__order_id__ref_fct_orders_.f1e7dbc0ec, now test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1)
[0m13:57:14.686289 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:57:14.689809 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1"
[0m13:57:14.690176 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:57:14.690563 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1
[0m13:57:14.690791 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:57:14.691047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.relationships_fct_order_items_product_id__product_id__ref_dim_products_.adfb860dd1, now test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768)
[0m13:57:14.691262 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:57:14.693875 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768"
[0m13:57:14.694213 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:57:14.694578 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768
[0m13:57:14.694803 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_customer_retention
[0m13:57:14.695045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_fct_order_items_order_item_id.0dec5f6768, now model.ecommerce_datamart.metric_customer_retention)
[0m13:57:14.695259 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_customer_retention
[0m13:57:14.698336 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_customer_retention"
[0m13:57:14.698713 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_customer_retention
[0m13:57:14.699100 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_customer_retention
[0m13:57:14.699327 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_daily_sales
[0m13:57:14.699593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_customer_retention, now model.ecommerce_datamart.metric_daily_sales)
[0m13:57:14.699809 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_daily_sales
[0m13:57:14.702239 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_daily_sales"
[0m13:57:14.702590 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_daily_sales
[0m13:57:14.702972 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_daily_sales
[0m13:57:14.703212 [debug] [Thread-1  ]: Began running node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:14.703444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_daily_sales, now model.ecommerce_datamart.metric_monthly_sales)
[0m13:57:14.703662 [debug] [Thread-1  ]: Began compiling node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:14.706089 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_datamart.metric_monthly_sales"
[0m13:57:14.706489 [debug] [Thread-1  ]: Began executing node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:14.706868 [debug] [Thread-1  ]: Finished running node model.ecommerce_datamart.metric_monthly_sales
[0m13:57:14.707096 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:14.707369 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_datamart.metric_monthly_sales, now test.ecommerce_datamart.assert_retention_rate_decreases)
[0m13:57:14.707581 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:14.709687 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.assert_retention_rate_decreases"
[0m13:57:14.710022 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:14.710391 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.assert_retention_rate_decreases
[0m13:57:14.710613 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:14.710861 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.assert_retention_rate_decreases, now test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875)
[0m13:57:14.711073 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:14.713834 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875"
[0m13:57:14.714363 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:14.714743 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875
[0m13:57:14.714966 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:14.715225 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.not_null_metric_daily_sales_date_key.6d6c4a8875, now test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea)
[0m13:57:14.715442 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:14.718141 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea"
[0m13:57:14.718611 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:14.719005 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea
[0m13:57:14.719234 [debug] [Thread-1  ]: Began running node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:14.719488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_datamart.unique_metric_daily_sales_date_key.5f5035b1ea, now test.ecommerce_datamart.assert_metrics_consistency)
[0m13:57:14.720323 [debug] [Thread-1  ]: Began compiling node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:14.723527 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_datamart.assert_metrics_consistency"
[0m13:57:14.725280 [debug] [Thread-1  ]: Began executing node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:14.725906 [debug] [Thread-1  ]: Finished running node test.ecommerce_datamart.assert_metrics_consistency
[0m13:57:14.726442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:14.726692 [debug] [MainThread]: Connection 'test.ecommerce_datamart.assert_metrics_consistency' was properly closed.
[0m13:57:14.730610 [debug] [MainThread]: Command end result
[0m13:57:14.812616 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:57:14.815319 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:57:14.820942 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/run_results.json
[0m13:57:14.822793 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:57:14.823007 [info ] [MainThread]: Building catalog
[0m13:57:14.831537 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db_ex3.information_schema'
[0m13:57:14.837945 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex3.information_schema"
[0m13:57:14.838243 [debug] [ThreadPool]: On dbt_db_ex3.information_schema: BEGIN
[0m13:57:14.838431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:14.846781 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:57:14.846991 [debug] [ThreadPool]: Using postgres connection "dbt_db_ex3.information_schema"
[0m13:57:14.847268 [debug] [ThreadPool]: On dbt_db_ex3.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_datamart", "target_name": "dev", "connection_name": "dbt_db_ex3.information_schema"} */

    
    

    select
        'dbt_db_ex3' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_daily_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_customer_retention')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_monthly_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers_mart')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products_mart')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('metric_customer_retention')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('metric_monthly_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fct_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('metric_daily_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_date')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:57:14.853294 [debug] [ThreadPool]: SQL status: SELECT 297 in 0.006 seconds
[0m13:57:14.865932 [debug] [ThreadPool]: On dbt_db_ex3.information_schema: ROLLBACK
[0m13:57:14.866498 [debug] [ThreadPool]: On dbt_db_ex3.information_schema: Close
[0m13:57:14.885238 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/catalog.json
[0m13:57:14.942629 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/manifest.json
[0m13:57:14.943651 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/semantic_manifest.json
[0m13:57:14.943859 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/target/catalog.json
[0m13:57:14.944976 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.0755479, "process_in_blocks": "0", "process_kernel_time": 0.173037, "process_mem_max_rss": "126222336", "process_out_blocks": "0", "process_user_time": 1.788788}
[0m13:57:14.945255 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:57:14.945205 after 1.08 seconds
[0m13:57:14.945469 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:57:14.945643 [debug] [MainThread]: Connection 'dbt_db_ex3.information_schema' was properly closed.
[0m13:57:14.945848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ab850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d1e80>]}
[0m13:57:14.946090 [debug] [MainThread]: Flushing usage events
[0m13:57:15.991617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:00.343018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120593760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12623acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12623aeb0>]}


============================== 13:58:00.346643 | c1e8426b-18f1-43bd-8e5d-f9ae301488fd ==============================
[0m13:58:00.346643 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:58:00.347038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex3/ecommerce_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:58:00.557591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1e8426b-18f1-43bd-8e5d-f9ae301488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126588790>]}
[0m13:58:00.613050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1e8426b-18f1-43bd-8e5d-f9ae301488fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1265568b0>]}
