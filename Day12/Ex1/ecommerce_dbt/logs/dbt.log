[0m11:02:07.653183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10365e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c9220>]}


============================== 11:02:07.656955 | 8a11193a-eac1-49df-b710-398fb7b98d76 ==============================
[0m11:02:07.656955 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:02:07.657711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:02:09.580466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048244c0>]}
[0m11:02:09.630104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc9250>]}
[0m11:02:09.630952 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:02:09.710841 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:02:09.711398 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:02:09.711822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a78a90>]}
[0m11:02:10.598340 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:02:10.608227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ede80>]}
[0m11:02:10.721527 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:02:10.724164 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:02:10.735287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b3a30>]}
[0m11:02:10.735662 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:02:10.735891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054eb340>]}
[0m11:02:10.737029 [info ] [MainThread]: 
[0m11:02:10.737261 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:10.737457 [info ] [MainThread]: 
[0m11:02:10.737769 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:02:10.740622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m11:02:10.817684 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m11:02:10.817980 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m11:02:10.818170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:10.984201 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.166 seconds
[0m11:02:10.985611 [debug] [ThreadPool]: On list_dbt_db: Close
[0m11:02:10.988829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m11:02:10.995703 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:02:10.996103 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:02:10.996375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:11.006310 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:02:11.006738 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:02:11.007002 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:02:11.013720 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m11:02:11.014992 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:02:11.015631 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:02:11.021390 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:11.021787 [debug] [MainThread]: On master: BEGIN
[0m11:02:11.022055 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:11.031855 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m11:02:11.032246 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:11.032601 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:02:11.043979 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m11:02:11.045336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a80d0>]}
[0m11:02:11.045813 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:11.046463 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:11.046777 [debug] [MainThread]: On master: BEGIN
[0m11:02:11.047649 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:02:11.047964 [debug] [MainThread]: On master: COMMIT
[0m11:02:11.048258 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:11.048542 [debug] [MainThread]: On master: COMMIT
[0m11:02:11.049099 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:02:11.049411 [debug] [MainThread]: On master: Close
[0m11:02:11.052216 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m11:02:11.052640 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_order_items
[0m11:02:11.053403 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_orders
[0m11:02:11.053147 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m11:02:11.053892 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.stg_products
[0m11:02:11.054324 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m11:02:11.054795 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m11:02:11.055234 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m11:02:11.055631 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m11:02:11.056085 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_order_items'
[0m11:02:11.056602 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_orders'
[0m11:02:11.056925 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m11:02:11.057333 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_products'
[0m11:02:11.057653 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_order_items
[0m11:02:11.057960 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_orders
[0m11:02:11.065757 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m11:02:11.066079 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.stg_products
[0m11:02:11.068778 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_order_items"
[0m11:02:11.071628 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_orders"
[0m11:02:11.074987 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_products"
[0m11:02:11.075914 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m11:02:11.076194 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.stg_products
[0m11:02:11.076448 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_orders
[0m11:02:11.082217 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_order_items
[0m11:02:11.109946 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customers"
[0m11:02:11.113348 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_products"
[0m11:02:11.117216 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_orders"
[0m11:02:11.120295 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_order_items"
[0m11:02:11.121465 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:02:11.121743 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: BEGIN
[0m11:02:11.122015 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:02:11.122267 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:02:11.122509 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:02:11.122734 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:02:11.122968 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: BEGIN
[0m11:02:11.123189 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: BEGIN
[0m11:02:11.123415 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: BEGIN
[0m11:02:11.123719 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:02:11.123936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:02:11.124162 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:02:11.145252 [debug] [Thread-2  ]: SQL status: BEGIN in 0.022 seconds
[0m11:02:11.145856 [debug] [Thread-3  ]: SQL status: BEGIN in 0.022 seconds
[0m11:02:11.146246 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:02:11.147362 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:02:11.149257 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */

  create view "dbt_db"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        created_at
    from source
)

select * from staged
  );
[0m11:02:11.150202 [debug] [Thread-4  ]: SQL status: BEGIN in 0.026 seconds
[0m11:02:11.150702 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */

  create view "dbt_db"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at
    from source
)

select * from staged
  );
[0m11:02:11.151439 [debug] [Thread-1  ]: SQL status: BEGIN in 0.027 seconds
[0m11:02:11.152586 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:02:11.153719 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:02:11.154161 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */

  create view "dbt_db"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."products"
),

staged as (
    select
        product_id,
        name,
        price,
        category,
        created_at
    from source
)

select * from staged
  );
[0m11:02:11.154598 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */

  create view "dbt_db"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        email,
        created_at
    from source
)

select * from staged
  );
[0m11:02:11.167036 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.013 seconds
[0m11:02:11.167586 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.015 seconds
[0m11:02:11.167870 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.013 seconds
[0m11:02:11.168127 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.013 seconds
[0m11:02:11.174222 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:02:11.176836 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:02:11.179306 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:02:11.181765 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:02:11.182091 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
alter table "dbt_db"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:02:11.182428 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
alter table "dbt_db"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m11:02:11.182691 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
alter table "dbt_db"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:02:11.182945 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
alter table "dbt_db"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:02:11.183973 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:11.184237 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:11.184468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:11.190174 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.007 seconds
[0m11:02:11.198487 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m11:02:11.201096 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m11:02:11.202985 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m11:02:11.204622 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m11:02:11.204958 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:02:11.205240 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:02:11.205489 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:02:11.205743 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:02:11.205986 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m11:02:11.206227 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m11:02:11.206456 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m11:02:11.206710 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m11:02:11.208002 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:02:11.208266 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m11:02:11.208494 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m11:02:11.212807 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."stg_customers__dbt_backup"
[0m11:02:11.213045 [debug] [Thread-3  ]: SQL status: COMMIT in 0.006 seconds
[0m11:02:11.214971 [debug] [Thread-2  ]: Applying DROP to: "dbt_db"."public"."stg_order_items__dbt_backup"
[0m11:02:11.217447 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."stg_products__dbt_backup"
[0m11:02:11.221019 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:02:11.223052 [debug] [Thread-3  ]: Applying DROP to: "dbt_db"."public"."stg_orders__dbt_backup"
[0m11:02:11.223577 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:02:11.224105 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:02:11.224350 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
drop view if exists "dbt_db"."public"."stg_customers__dbt_backup" cascade
[0m11:02:11.224891 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:02:11.225142 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
drop view if exists "dbt_db"."public"."stg_order_items__dbt_backup" cascade
[0m11:02:11.225383 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
drop view if exists "dbt_db"."public"."stg_products__dbt_backup" cascade
[0m11:02:11.225649 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
drop view if exists "dbt_db"."public"."stg_orders__dbt_backup" cascade
[0m11:02:11.226475 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m11:02:11.226736 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m11:02:11.226990 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.001 seconds
[0m11:02:11.227224 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.001 seconds
[0m11:02:11.229014 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: Close
[0m11:02:11.229861 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: Close
[0m11:02:11.230617 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: Close
[0m11:02:11.231349 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: Close
[0m11:02:11.234056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052eb7f0>]}
[0m11:02:11.234561 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m11:02:11.234884 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517a100>]}
[0m11:02:11.235233 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m11:02:11.235461 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c5160>]}
[0m11:02:11.235876 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.18s]
[0m11:02:11.236116 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052289d0>]}
[0m11:02:11.236595 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m11:02:11.236864 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_customers
[0m11:02:11.237184 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_order_items
[0m11:02:11.237578 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.stg_products
[0m11:02:11.237875 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.18s]
[0m11:02:11.238200 [info ] [Thread-1  ]: 5 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m11:02:11.238653 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_orders
[0m11:02:11.238972 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customers, now model.ecommerce_dbt.dim_customers)
[0m11:02:11.239197 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.dim_products
[0m11:02:11.239485 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m11:02:11.239894 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_orders
[0m11:02:11.240348 [info ] [Thread-2  ]: 6 of 7 START sql table model public.dim_products ............................... [RUN]
[0m11:02:11.242717 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m11:02:11.243055 [info ] [Thread-4  ]: 7 of 7 START sql table model public.fact_orders ................................ [RUN]
[0m11:02:11.243385 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_order_items, now model.ecommerce_dbt.dim_products)
[0m11:02:11.243690 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_products, now model.ecommerce_dbt.fact_orders)
[0m11:02:11.243932 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.dim_products
[0m11:02:11.244160 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m11:02:11.246098 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_products"
[0m11:02:11.248555 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m11:02:11.249031 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m11:02:11.266845 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.dim_products
[0m11:02:11.267457 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m11:02:11.277386 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_customers"
[0m11:02:11.281480 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_products"
[0m11:02:11.284308 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_orders"
[0m11:02:11.284933 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:02:11.285178 [debug] [Thread-2  ]: On model.ecommerce_dbt.dim_products: BEGIN
[0m11:02:11.285391 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:02:11.285724 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:02:11.285967 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: BEGIN
[0m11:02:11.286177 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:02:11.286512 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:02:11.286750 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: BEGIN
[0m11:02:11.286963 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:02:11.299325 [debug] [Thread-4  ]: SQL status: BEGIN in 0.012 seconds
[0m11:02:11.299666 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m11:02:11.299928 [debug] [Thread-2  ]: SQL status: BEGIN in 0.015 seconds
[0m11:02:11.300172 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:02:11.300423 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:02:11.300662 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:02:11.300926 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */

  
    

  create  table "dbt_db"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db"."public"."stg_order_items"
),

order_with_items as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        sum(oi.quantity * oi.unit_price) as total_amount,
        count(oi.order_item_id) as total_items
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    group by 1, 2, 3, 4
)

select
    order_id,
    customer_id,
    order_date,
    status,
    total_amount,
    total_items,
    current_timestamp as updated_at
from order_with_items
  );
  
[0m11:02:11.301198 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */

  
    

  create  table "dbt_db"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db"."public"."stg_customers"
)

select
    customer_id,
    name,
    email,
    created_at,
    current_timestamp as updated_at
from customers
  );
  
[0m11:02:11.301451 [debug] [Thread-2  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */

  
    

  create  table "dbt_db"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db"."public"."stg_products"
)

select
    product_id,
    name,
    price,
    category,
    created_at,
    current_timestamp as updated_at
from products
  );
  
[0m11:02:11.307309 [debug] [Thread-2  ]: SQL status: SELECT 4 in 0.005 seconds
[0m11:02:11.307843 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.006 seconds
[0m11:02:11.313518 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:02:11.313846 [debug] [Thread-4  ]: SQL status: SELECT 3 in 0.012 seconds
[0m11:02:11.316474 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:02:11.316783 [debug] [Thread-2  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
alter table "dbt_db"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m11:02:11.319377 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:02:11.319643 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:02:11.319917 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
alter table "dbt_db"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m11:02:11.320929 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:11.321218 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:11.321444 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:02:11.322441 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:02:11.323347 [debug] [Thread-2  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m11:02:11.324231 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m11:02:11.324479 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:02:11.324715 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:02:11.324950 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:02:11.325176 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:02:11.325396 [debug] [Thread-2  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m11:02:11.325611 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m11:02:11.326616 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:02:11.326850 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m11:02:11.328815 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."dim_customers__dbt_backup"
[0m11:02:11.329037 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m11:02:11.330810 [debug] [Thread-2  ]: Applying DROP to: "dbt_db"."public"."dim_products__dbt_backup"
[0m11:02:11.332975 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:02:11.336204 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."fact_orders__dbt_backup"
[0m11:02:11.336793 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:02:11.337050 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
drop table if exists "dbt_db"."public"."dim_customers__dbt_backup" cascade
[0m11:02:11.337551 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:02:11.337778 [debug] [Thread-2  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
drop table if exists "dbt_db"."public"."dim_products__dbt_backup" cascade
[0m11:02:11.338033 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
drop table if exists "dbt_db"."public"."fact_orders__dbt_backup" cascade
[0m11:02:11.338575 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m11:02:11.338806 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.001 seconds
[0m11:02:11.339021 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.001 seconds
[0m11:02:11.339830 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: Close
[0m11:02:11.340532 [debug] [Thread-2  ]: On model.ecommerce_dbt.dim_products: Close
[0m11:02:11.341214 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: Close
[0m11:02:11.341595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105228760>]}
[0m11:02:11.341985 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486e250>]}
[0m11:02:11.342329 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a11193a-eac1-49df-b710-398fb7b98d76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105945d60>]}
[0m11:02:11.342904 [info ] [Thread-1  ]: 5 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.10s]
[0m11:02:11.343352 [info ] [Thread-4  ]: 7 of 7 OK created sql table model public.fact_orders ........................... [[32mSELECT 3[0m in 0.10s]
[0m11:02:11.343801 [info ] [Thread-2  ]: 6 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.10s]
[0m11:02:11.344229 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m11:02:11.344592 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m11:02:11.344893 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.dim_products
[0m11:02:11.345682 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:11.345882 [debug] [MainThread]: On master: BEGIN
[0m11:02:11.346057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:11.353012 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:02:11.353314 [debug] [MainThread]: On master: COMMIT
[0m11:02:11.353522 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:11.353755 [debug] [MainThread]: On master: COMMIT
[0m11:02:11.354368 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:02:11.354631 [debug] [MainThread]: On master: Close
[0m11:02:11.354936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:11.355124 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m11:02:11.355299 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_products' was properly closed.
[0m11:02:11.355466 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_orders' was properly closed.
[0m11:02:11.355628 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m11:02:11.355892 [info ] [MainThread]: 
[0m11:02:11.356118 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m11:02:11.356972 [debug] [MainThread]: Command end result
[0m11:02:11.374463 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:02:11.375698 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:02:11.380756 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:02:11.381022 [info ] [MainThread]: 
[0m11:02:11.381268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:11.381473 [info ] [MainThread]: 
[0m11:02:11.381684 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:02:11.383289 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7949507, "process_in_blocks": "0", "process_kernel_time": 0.309833, "process_mem_max_rss": "129220608", "process_out_blocks": "0", "process_user_time": 2.547844}
[0m11:02:11.383574 [debug] [MainThread]: Command `dbt run` succeeded at 11:02:11.383525 after 3.80 seconds
[0m11:02:11.383807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10365e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105534100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048244c0>]}
[0m11:02:11.384048 [debug] [MainThread]: Flushing usage events
[0m11:02:12.679866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:13.870905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105082cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105082eb0>]}


============================== 11:02:13.873770 | 1546827a-72f7-431b-a8ce-f4dbbcac117e ==============================
[0m11:02:13.873770 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:02:13.874150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:02:13.999741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1546827a-72f7-431b-a8ce-f4dbbcac117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053db790>]}
[0m11:02:14.046887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1546827a-72f7-431b-a8ce-f4dbbcac117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b1a3d0>]}
[0m11:02:14.047548 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:02:14.118151 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:02:14.206976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:14.207269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:14.211448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:02:14.242740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1546827a-72f7-431b-a8ce-f4dbbcac117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf3130>]}
[0m11:02:14.310265 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:02:14.312629 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:02:14.353915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1546827a-72f7-431b-a8ce-f4dbbcac117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f7a90>]}
[0m11:02:14.354286 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:02:14.354507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1546827a-72f7-431b-a8ce-f4dbbcac117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c8220>]}
[0m11:02:14.355686 [info ] [MainThread]: 
[0m11:02:14.355911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:14.356101 [info ] [MainThread]: 
[0m11:02:14.356398 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:02:14.359307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m11:02:14.386106 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:02:14.386412 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:02:14.386602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:14.408379 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m11:02:14.408699 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:02:14.408916 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:02:14.414323 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m11:02:14.415396 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:02:14.415921 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:02:14.420521 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:14.420804 [debug] [MainThread]: On master: BEGIN
[0m11:02:14.421011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:14.430169 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:02:14.430521 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:14.430813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:02:14.440350 [debug] [MainThread]: SQL status: SELECT 4 in 0.009 seconds
[0m11:02:14.442420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1546827a-72f7-431b-a8ce-f4dbbcac117e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ad1cd0>]}
[0m11:02:14.442806 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:14.443436 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:14.443699 [debug] [MainThread]: On master: BEGIN
[0m11:02:14.444320 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:02:14.444597 [debug] [MainThread]: On master: COMMIT
[0m11:02:14.444834 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:14.445056 [debug] [MainThread]: On master: COMMIT
[0m11:02:14.445446 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:02:14.445668 [debug] [MainThread]: On master: Close
[0m11:02:14.447344 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:02:14.447659 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:02:14.447909 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:02:14.448163 [info ] [Thread-1  ]: 1 of 12 START test source_not_null_ecommerce_raw_customers_customer_id ......... [RUN]
[0m11:02:14.448445 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:02:14.448732 [info ] [Thread-2  ]: 2 of 12 START test source_not_null_ecommerce_raw_order_items_order_item_id ..... [RUN]
[0m11:02:14.449045 [info ] [Thread-3  ]: 3 of 12 START test source_not_null_ecommerce_raw_orders_order_id ............... [RUN]
[0m11:02:14.449387 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m11:02:14.449658 [info ] [Thread-4  ]: 4 of 12 START test source_not_null_ecommerce_raw_products_product_id ........... [RUN]
[0m11:02:14.449986 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0'
[0m11:02:14.450288 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf'
[0m11:02:14.450531 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:02:14.450828 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea'
[0m11:02:14.451063 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:02:14.451299 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:02:14.464422 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:02:14.464808 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:02:14.467756 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:02:14.471427 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:02:14.474224 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:02:14.474946 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:02:14.475198 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:02:14.481256 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:02:14.487887 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:02:14.492037 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:02:14.493672 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:02:14.495479 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:02:14.497236 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:02:14.498018 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:02:14.498269 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: BEGIN
[0m11:02:14.498483 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:02:14.498818 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:02:14.499045 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: BEGIN
[0m11:02:14.499252 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:02:14.499583 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:02:14.499821 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: BEGIN
[0m11:02:14.500042 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:02:14.500350 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:02:14.500591 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: BEGIN
[0m11:02:14.500802 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:02:14.515611 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m11:02:14.515994 [debug] [Thread-3  ]: SQL status: BEGIN in 0.017 seconds
[0m11:02:14.516282 [debug] [Thread-4  ]: SQL status: BEGIN in 0.016 seconds
[0m11:02:14.516521 [debug] [Thread-2  ]: SQL status: BEGIN in 0.016 seconds
[0m11:02:14.516798 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:02:14.517048 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:02:14.517285 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:02:14.517518 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:02:14.517773 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt_db"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m11:02:14.518041 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt_db"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m11:02:14.518302 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "dbt_db"."public"."products"
where product_id is null



      
    ) dbt_internal_test
[0m11:02:14.518566 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_id
from "dbt_db"."public"."order_items"
where order_item_id is null



      
    ) dbt_internal_test
[0m11:02:14.520312 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:02:14.520637 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:02:14.520877 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:02:14.521099 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:02:14.524385 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: ROLLBACK
[0m11:02:14.525584 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: ROLLBACK
[0m11:02:14.526564 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: ROLLBACK
[0m11:02:14.527443 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: ROLLBACK
[0m11:02:14.528682 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: Close
[0m11:02:14.529517 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: Close
[0m11:02:14.529789 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: Close
[0m11:02:14.530021 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: Close
[0m11:02:14.530578 [info ] [Thread-4  ]: 4 of 12 PASS source_not_null_ecommerce_raw_products_product_id ................. [[32mPASS[0m in 0.08s]
[0m11:02:14.530971 [info ] [Thread-2  ]: 2 of 12 PASS source_not_null_ecommerce_raw_order_items_order_item_id ........... [[32mPASS[0m in 0.08s]
[0m11:02:14.531432 [info ] [Thread-3  ]: 3 of 12 PASS source_not_null_ecommerce_raw_orders_order_id ..................... [[32mPASS[0m in 0.08s]
[0m11:02:14.531864 [info ] [Thread-1  ]: 1 of 12 PASS source_not_null_ecommerce_raw_customers_customer_id ............... [[32mPASS[0m in 0.08s]
[0m11:02:14.532268 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:02:14.532601 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:02:14.532915 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:02:14.535467 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:02:14.537069 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:02:14.538489 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:02:14.539137 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:02:14.539896 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:02:14.540196 [info ] [Thread-4  ]: 5 of 12 START test source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [RUN]
[0m11:02:14.540907 [info ] [Thread-2  ]: 6 of 12 START test source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [RUN]
[0m11:02:14.541524 [info ] [Thread-3  ]: 7 of 12 START test source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [RUN]
[0m11:02:14.542455 [info ] [Thread-1  ]: 8 of 12 START test source_unique_ecommerce_raw_customers_customer_id ........... [RUN]
[0m11:02:14.542963 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m11:02:14.543279 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m11:02:14.543572 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m11:02:14.543840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m11:02:14.544122 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:02:14.545153 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:02:14.545528 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:02:14.545795 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:02:14.562606 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:02:14.576115 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:02:14.576743 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:02:14.583561 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:02:14.584537 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:02:14.586967 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:02:14.587403 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:02:14.588211 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:02:14.588575 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:02:14.591581 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:02:14.595328 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:02:14.599587 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:02:14.600220 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:02:14.601481 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:02:14.603026 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: BEGIN
[0m11:02:14.603478 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: BEGIN
[0m11:02:14.603876 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:02:14.604363 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:02:14.604651 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:02:14.604921 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:02:14.605173 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: BEGIN
[0m11:02:14.605559 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: BEGIN
[0m11:02:14.606190 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:02:14.606521 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:02:14.628747 [debug] [Thread-4  ]: SQL status: BEGIN in 0.024 seconds
[0m11:02:14.629641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.023 seconds
[0m11:02:14.630268 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:02:14.630575 [debug] [Thread-2  ]: SQL status: BEGIN in 0.024 seconds
[0m11:02:14.630930 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:02:14.631422 [debug] [Thread-3  ]: SQL status: BEGIN in 0.027 seconds
[0m11:02:14.631694 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from "dbt_db"."public"."order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "dbt_db"."public"."orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:02:14.632070 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:02:14.632378 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:02:14.632715 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:02:14.633582 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "dbt_db"."public"."order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "dbt_db"."public"."products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:02:14.635022 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt_db"."public"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:02:14.637277 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.004 seconds
[0m11:02:14.637895 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m11:02:14.638678 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:02:14.642017 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: ROLLBACK
[0m11:02:14.643579 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.005 seconds
[0m11:02:14.648101 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: ROLLBACK
[0m11:02:14.650070 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: ROLLBACK
[0m11:02:14.651205 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: ROLLBACK
[0m11:02:14.651901 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: Close
[0m11:02:14.652229 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: Close
[0m11:02:14.653343 [info ] [Thread-4  ]: 5 of 12 PASS source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [[32mPASS[0m in 0.11s]
[0m11:02:14.654470 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:02:14.655273 [info ] [Thread-1  ]: 8 of 12 PASS source_unique_ecommerce_raw_customers_customer_id ................. [[32mPASS[0m in 0.11s]
[0m11:02:14.655606 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: Close
[0m11:02:14.655848 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: Close
[0m11:02:14.656132 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:02:14.656558 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:02:14.657081 [info ] [Thread-2  ]: 6 of 12 PASS source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [[32mPASS[0m in 0.11s]
[0m11:02:14.657609 [info ] [Thread-3  ]: 7 of 12 PASS source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [[32mPASS[0m in 0.11s]
[0m11:02:14.658382 [info ] [Thread-4  ]: 9 of 12 START test source_unique_ecommerce_raw_customers_email ................. [RUN]
[0m11:02:14.659018 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:02:14.660407 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:02:14.661084 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:02:14.661435 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m11:02:14.662670 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:02:14.662135 [info ] [Thread-1  ]: 10 of 12 START test source_unique_ecommerce_raw_order_items_order_item_id ...... [RUN]
[0m11:02:14.663380 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:02:14.663681 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:02:14.663969 [info ] [Thread-2  ]: 11 of 12 START test source_unique_ecommerce_raw_orders_order_id ................ [RUN]
[0m11:02:14.664352 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m11:02:14.665004 [info ] [Thread-3  ]: 12 of 12 START test source_unique_ecommerce_raw_products_product_id ............ [RUN]
[0m11:02:14.670371 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:02:14.670805 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m11:02:14.671122 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:02:14.671655 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m11:02:14.672018 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:02:14.677694 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:02:14.678110 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:02:14.682290 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:02:14.682774 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:02:14.686112 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:02:14.686722 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:02:14.689241 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:02:14.692187 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:02:14.692684 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:02:14.693165 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:02:14.696442 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:02:14.698602 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:02:14.699088 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:02:14.699488 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:02:14.699834 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: BEGIN
[0m11:02:14.700096 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: BEGIN
[0m11:02:14.700461 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:02:14.700771 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:02:14.701038 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:02:14.701299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:02:14.701906 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: BEGIN
[0m11:02:14.702179 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: BEGIN
[0m11:02:14.702778 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:02:14.703055 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:02:14.719938 [debug] [Thread-4  ]: SQL status: BEGIN in 0.019 seconds
[0m11:02:14.720321 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:02:14.720724 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db"."public"."customers"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m11:02:14.723082 [debug] [Thread-1  ]: SQL status: BEGIN in 0.022 seconds
[0m11:02:14.723504 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:02:14.724110 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:02:14.724489 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.003 seconds
[0m11:02:14.725660 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: ROLLBACK
[0m11:02:14.726406 [debug] [Thread-2  ]: SQL status: BEGIN in 0.023 seconds
[0m11:02:14.727331 [debug] [Thread-3  ]: SQL status: BEGIN in 0.024 seconds
[0m11:02:14.727861 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.003 seconds
[0m11:02:14.728470 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: Close
[0m11:02:14.728824 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:02:14.729339 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:02:14.731124 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: ROLLBACK
[0m11:02:14.731646 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:02:14.733519 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:02:14.732780 [info ] [Thread-4  ]: 9 of 12 PASS source_unique_ecommerce_raw_customers_email ....................... [[32mPASS[0m in 0.07s]
[0m11:02:14.734212 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:02:14.734465 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: Close
[0m11:02:14.735469 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:02:14.734996 [info ] [Thread-1  ]: 10 of 12 PASS source_unique_ecommerce_raw_order_items_order_item_id ............ [[32mPASS[0m in 0.07s]
[0m11:02:14.736653 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: ROLLBACK
[0m11:02:14.736904 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.003 seconds
[0m11:02:14.737243 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:02:14.738141 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: ROLLBACK
[0m11:02:14.738462 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: Close
[0m11:02:14.739035 [info ] [Thread-2  ]: 11 of 12 PASS source_unique_ecommerce_raw_orders_order_id ...................... [[32mPASS[0m in 0.07s]
[0m11:02:14.739584 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:02:14.739894 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: Close
[0m11:02:14.740311 [info ] [Thread-3  ]: 12 of 12 PASS source_unique_ecommerce_raw_products_product_id .................. [[32mPASS[0m in 0.07s]
[0m11:02:14.740940 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:02:14.743192 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:14.743580 [debug] [MainThread]: On master: BEGIN
[0m11:02:14.743793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:14.751466 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:02:14.751778 [debug] [MainThread]: On master: COMMIT
[0m11:02:14.751970 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:14.752147 [debug] [MainThread]: On master: COMMIT
[0m11:02:14.752547 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:02:14.752774 [debug] [MainThread]: On master: Close
[0m11:02:14.753053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:14.753244 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559' was properly closed.
[0m11:02:14.753426 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65' was properly closed.
[0m11:02:14.753599 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9' was properly closed.
[0m11:02:14.753769 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548' was properly closed.
[0m11:02:14.754018 [info ] [MainThread]: 
[0m11:02:14.754477 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:02:14.755701 [debug] [MainThread]: Command end result
[0m11:02:14.776507 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:02:14.777630 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:02:14.782837 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:02:14.783148 [info ] [MainThread]: 
[0m11:02:14.783419 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:14.783703 [info ] [MainThread]: 
[0m11:02:14.783929 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m11:02:14.784941 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9657908, "process_in_blocks": "0", "process_kernel_time": 0.186098, "process_mem_max_rss": "124895232", "process_out_blocks": "0", "process_user_time": 1.61768}
[0m11:02:14.785212 [debug] [MainThread]: Command `dbt test` succeeded at 11:02:14.785162 after 0.97 seconds
[0m11:02:14.785461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10420c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053db730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053dbeb0>]}
[0m11:02:14.785711 [debug] [MainThread]: Flushing usage events
[0m11:02:15.747148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:16.812107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110002730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11166a250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11166a070>]}


============================== 11:02:16.814578 | 0bf789ca-9c17-46ad-adf4-4677dae2cfd8 ==============================
[0m11:02:16.814578 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:02:16.814952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:02:16.933777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bf789ca-9c17-46ad-adf4-4677dae2cfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112389a30>]}
[0m11:02:16.978937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bf789ca-9c17-46ad-adf4-4677dae2cfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161aa90>]}
[0m11:02:16.979604 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:02:17.048527 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:02:17.140236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:17.140669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:17.145228 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:02:17.177053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bf789ca-9c17-46ad-adf4-4677dae2cfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca9130>]}
[0m11:02:17.185629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bf789ca-9c17-46ad-adf4-4677dae2cfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cdcdf0>]}
[0m11:02:17.185985 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:02:17.186212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf789ca-9c17-46ad-adf4-4677dae2cfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cdcdc0>]}
[0m11:02:17.187573 [info ] [MainThread]: 
[0m11:02:17.187812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:02:17.188007 [info ] [MainThread]: 
[0m11:02:17.188312 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:02:17.191453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m11:02:17.248009 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:02:17.248298 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:02:17.248477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:17.266129 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m11:02:17.266425 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:02:17.266628 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:02:17.271986 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m11:02:17.273037 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:02:17.273543 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:02:17.278016 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:17.278291 [debug] [MainThread]: On master: BEGIN
[0m11:02:17.278490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:17.285696 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:02:17.286000 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:17.286271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:02:17.295729 [debug] [MainThread]: SQL status: SELECT 4 in 0.009 seconds
[0m11:02:17.297336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf789ca-9c17-46ad-adf4-4677dae2cfd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106461cd0>]}
[0m11:02:17.297689 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:17.298226 [debug] [MainThread]: On master: Close
[0m11:02:17.299987 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m11:02:17.300316 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_order_items
[0m11:02:17.300587 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_orders
[0m11:02:17.300891 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m11:02:17.301149 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.stg_products
[0m11:02:17.301494 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_order_items'
[0m11:02:17.301834 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_orders'
[0m11:02:17.302095 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m11:02:17.302411 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_products'
[0m11:02:17.302660 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_order_items
[0m11:02:17.302903 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_orders
[0m11:02:17.309460 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.stg_products
[0m11:02:17.310236 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m11:02:17.312463 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_order_items"
[0m11:02:17.314555 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_orders"
[0m11:02:17.316701 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_products"
[0m11:02:17.317324 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_order_items
[0m11:02:17.317576 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_orders
[0m11:02:17.318008 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_order_items
[0m11:02:17.318220 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.stg_products
[0m11:02:17.318421 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m11:02:17.318830 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_orders
[0m11:02:17.319098 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:02:17.319497 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.stg_products
[0m11:02:17.319909 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m11:02:17.320147 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:02:17.320459 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_order_items, now test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m11:02:17.320719 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:02:17.320955 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:02:17.321231 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_orders, now test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0)
[0m11:02:17.321498 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:02:17.321739 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_products, now test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf)
[0m11:02:17.321985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customers, now test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea)
[0m11:02:17.322207 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:02:17.330495 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:02:17.330830 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:02:17.331062 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:02:17.333860 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:02:17.336784 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:02:17.340279 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:02:17.340671 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:02:17.341201 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:02:17.341455 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:02:17.341703 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m11:02:17.341929 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:02:17.347206 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:02:17.347507 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:02:17.348023 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:02:17.348282 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:02:17.348512 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:02:17.348833 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m11:02:17.349071 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:02:17.349303 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:02:17.349800 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:02:17.350044 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:02:17.350436 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:02:17.350811 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:02:17.351053 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:02:17.354760 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:02:17.355023 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:02:17.355291 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:02:17.355561 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m11:02:17.355870 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m11:02:17.356146 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m11:02:17.356388 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:02:17.356610 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:02:17.356835 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:02:17.357048 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:02:17.360633 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:02:17.361073 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:02:17.365302 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:02:17.367875 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:02:17.368193 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:02:17.368661 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m11:02:17.368916 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:02:17.369172 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:02:17.369392 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:02:17.369599 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:02:17.369993 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:02:17.370371 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:02:17.372998 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:02:17.373408 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:02:17.373651 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:02:17.373922 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:02:17.374232 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.fact_orders
[0m11:02:17.374511 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m11:02:17.374770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m11:02:17.374989 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:02:17.375227 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548, now model.ecommerce_dbt.fact_orders)
[0m11:02:17.375451 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:02:17.375664 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:02:17.376096 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:02:17.376324 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m11:02:17.379849 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:02:17.382472 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:02:17.382728 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.dim_customers
[0m11:02:17.384831 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m11:02:17.385215 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559, now model.ecommerce_dbt.dim_customers)
[0m11:02:17.385542 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m11:02:17.385785 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:02:17.387564 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m11:02:17.387778 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:02:17.388201 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:02:17.388410 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m11:02:17.388847 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:02:17.389094 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.dim_products
[0m11:02:17.389413 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m11:02:17.389820 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m11:02:17.390119 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65, now model.ecommerce_dbt.dim_products)
[0m11:02:17.390501 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m11:02:17.390765 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.dim_products
[0m11:02:17.392693 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_products"
[0m11:02:17.393068 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.dim_products
[0m11:02:17.393445 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.dim_products
[0m11:02:17.393967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:17.394152 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9' was properly closed.
[0m11:02:17.394320 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m11:02:17.394474 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m11:02:17.394627 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_products' was properly closed.
[0m11:02:17.396139 [debug] [MainThread]: Command end result
[0m11:02:17.462095 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:02:17.464412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:02:17.472262 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:02:17.482396 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:02:17.482638 [info ] [MainThread]: Building catalog
[0m11:02:17.496501 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db.information_schema'
[0m11:02:17.502482 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m11:02:17.502785 [debug] [ThreadPool]: On dbt_db.information_schema: BEGIN
[0m11:02:17.502989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:17.514190 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m11:02:17.514500 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m11:02:17.514816 [debug] [ThreadPool]: On dbt_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "dbt_db.information_schema"} */

    
    

    select
        'dbt_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fact_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:02:17.523244 [debug] [ThreadPool]: SQL status: SELECT 58 in 0.008 seconds
[0m11:02:17.529208 [debug] [ThreadPool]: On dbt_db.information_schema: ROLLBACK
[0m11:02:17.529890 [debug] [ThreadPool]: On dbt_db.information_schema: Close
[0m11:02:17.543231 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/catalog.json
[0m11:02:17.560039 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:02:17.561012 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:02:17.561226 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/catalog.json
[0m11:02:17.562252 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.80182874, "process_in_blocks": "0", "process_kernel_time": 0.138081, "process_mem_max_rss": "123633664", "process_out_blocks": "0", "process_user_time": 1.452649}
[0m11:02:17.562531 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:02:17.562481 after 0.80 seconds
[0m11:02:17.562741 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:02:17.563063 [debug] [MainThread]: Connection 'dbt_db.information_schema' was properly closed.
[0m11:02:17.563334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110002730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101af7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161aa90>]}
[0m11:02:17.563613 [debug] [MainThread]: Flushing usage events
[0m11:02:18.556327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:48.777851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a3dc0>]}


============================== 11:49:48.781005 | af7b0408-c2e8-43d9-b8de-920a831cec90 ==============================
[0m11:49:48.781005 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:49:48.781388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:48.926912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b1eeb0>]}
[0m11:49:48.973579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106720d60>]}
[0m11:49:48.974394 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:49:49.050661 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:49:49.158199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:49:49.158505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:49:49.162764 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:49:49.214519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107423130>]}
[0m11:49:49.284780 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:49:49.287596 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:49:49.329440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b5340>]}
[0m11:49:49.329858 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:49:49.330115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b5cd0>]}
[0m11:49:49.331447 [info ] [MainThread]: 
[0m11:49:49.331700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:49:49.331904 [info ] [MainThread]: 
[0m11:49:49.332229 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:49:49.335099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m11:49:49.368782 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m11:49:49.369123 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m11:49:49.369338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:49.403541 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m11:49:49.404432 [debug] [ThreadPool]: On list_dbt_db: Close
[0m11:49:49.405539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m11:49:49.410392 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:49:49.410714 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:49:49.410924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:49:49.419846 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m11:49:49.420137 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:49:49.420371 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:49:49.423924 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m11:49:49.425045 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:49:49.425543 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:49:49.430790 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:49.431076 [debug] [MainThread]: On master: BEGIN
[0m11:49:49.431342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:49:49.440275 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:49:49.440600 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:49.440897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:49:49.451275 [debug] [MainThread]: SQL status: SELECT 4 in 0.010 seconds
[0m11:49:49.452791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fd6a0>]}
[0m11:49:49.453131 [debug] [MainThread]: On master: ROLLBACK
[0m11:49:49.453633 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:49.453857 [debug] [MainThread]: On master: BEGIN
[0m11:49:49.454516 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:49:49.454744 [debug] [MainThread]: On master: COMMIT
[0m11:49:49.454960 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:49.455167 [debug] [MainThread]: On master: COMMIT
[0m11:49:49.455617 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:49:49.455860 [debug] [MainThread]: On master: Close
[0m11:49:49.458681 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m11:49:49.459015 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_order_items
[0m11:49:49.459602 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_orders
[0m11:49:49.460157 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.stg_products
[0m11:49:49.459380 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m11:49:49.459957 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m11:49:49.460671 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m11:49:49.461041 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m11:49:49.461387 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m11:49:49.461726 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_order_items'
[0m11:49:49.462158 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_orders'
[0m11:49:49.462509 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_products'
[0m11:49:49.462782 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m11:49:49.463039 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_order_items
[0m11:49:49.463287 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_orders
[0m11:49:49.463529 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.stg_products
[0m11:49:49.470108 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m11:49:49.472580 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_order_items"
[0m11:49:49.474948 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_orders"
[0m11:49:49.477382 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_products"
[0m11:49:49.478254 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.stg_products
[0m11:49:49.478512 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_order_items
[0m11:49:49.484446 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_orders
[0m11:49:49.491096 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m11:49:49.517845 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_orders"
[0m11:49:49.518293 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_products"
[0m11:49:49.518492 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_order_items"
[0m11:49:49.521085 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customers"
[0m11:49:49.521732 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:49:49.521975 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: BEGIN
[0m11:49:49.522190 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:49:49.522525 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:49:49.522740 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: BEGIN
[0m11:49:49.523021 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:49:49.523261 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:49:49.523527 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:49:49.523754 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: BEGIN
[0m11:49:49.524082 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: BEGIN
[0m11:49:49.524320 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:49:49.524559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:49:49.538269 [debug] [Thread-3  ]: SQL status: BEGIN in 0.014 seconds
[0m11:49:49.538627 [debug] [Thread-2  ]: SQL status: BEGIN in 0.015 seconds
[0m11:49:49.538876 [debug] [Thread-4  ]: SQL status: BEGIN in 0.017 seconds
[0m11:49:49.539149 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:49:49.539400 [debug] [Thread-1  ]: SQL status: BEGIN in 0.015 seconds
[0m11:49:49.539606 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:49:49.539818 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:49:49.540040 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */

  create view "dbt_db"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at
    from source
)

select * from staged
  );
[0m11:49:49.540265 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:49:49.540480 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */

  create view "dbt_db"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        created_at
    from source
)

select * from staged
  );
[0m11:49:49.540707 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */

  create view "dbt_db"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."products"
),

staged as (
    select
        product_id,
        name,
        price,
        category,
        created_at
    from source
)

select * from staged
  );
[0m11:49:49.540962 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */

  create view "dbt_db"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        email,
        created_at
    from source
)

select * from staged
  );
[0m11:49:49.544935 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:49:49.545242 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:49:49.545462 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.005 seconds
[0m11:49:49.550162 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:49:49.550450 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.009 seconds
[0m11:49:49.552808 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:49:49.555493 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:49:49.555756 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
alter table "dbt_db"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m11:49:49.558163 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:49:49.558412 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
alter table "dbt_db"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m11:49:49.558633 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
alter table "dbt_db"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:49:49.558904 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
alter table "dbt_db"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:49:49.559535 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:49:49.561654 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:49:49.561893 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
alter table "dbt_db"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:49:49.562141 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:49:49.564297 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:49:49.564550 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m11:49:49.564773 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
alter table "dbt_db"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m11:49:49.564981 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m11:49:49.565195 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:49:49.567137 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:49:49.569260 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:49:49.569556 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:49:49.580454 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m11:49:49.580721 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
alter table "dbt_db"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:49:49.580959 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
alter table "dbt_db"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:49:49.581981 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m11:49:49.582229 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:49:49.582554 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:49:49.582819 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m11:49:49.583074 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m11:49:49.583500 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:49:49.584482 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m11:49:49.584710 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:49:49.584918 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m11:49:49.585396 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:49:49.586292 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m11:49:49.586509 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:49:49.586710 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m11:49:49.586936 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m11:49:49.591993 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."stg_products__dbt_backup"
[0m11:49:49.594739 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:49:49.594978 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
drop view if exists "dbt_db"."public"."stg_products__dbt_backup" cascade
[0m11:49:49.595231 [debug] [Thread-1  ]: SQL status: COMMIT in 0.010 seconds
[0m11:49:49.595509 [debug] [Thread-3  ]: SQL status: COMMIT in 0.009 seconds
[0m11:49:49.595758 [debug] [Thread-2  ]: SQL status: COMMIT in 0.012 seconds
[0m11:49:49.597798 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."stg_customers__dbt_backup"
[0m11:49:49.599812 [debug] [Thread-3  ]: Applying DROP to: "dbt_db"."public"."stg_orders__dbt_backup"
[0m11:49:49.601513 [debug] [Thread-2  ]: Applying DROP to: "dbt_db"."public"."stg_order_items__dbt_backup"
[0m11:49:49.602058 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:49:49.602524 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:49:49.602737 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.007 seconds
[0m11:49:49.603177 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:49:49.603392 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
drop view if exists "dbt_db"."public"."stg_customers__dbt_backup" cascade
[0m11:49:49.603602 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
drop view if exists "dbt_db"."public"."stg_orders__dbt_backup" cascade
[0m11:49:49.605105 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: Close
[0m11:49:49.605347 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
drop view if exists "dbt_db"."public"."stg_order_items__dbt_backup" cascade
[0m11:49:49.606808 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780db80>]}
[0m11:49:49.607499 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m11:49:49.607286 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m11:49:49.607928 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.002 seconds
[0m11:49:49.608812 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: Close
[0m11:49:49.609024 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.003 seconds
[0m11:49:49.609353 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.stg_products
[0m11:49:49.610045 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: Close
[0m11:49:49.610846 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: Close
[0m11:49:49.611198 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790b040>]}
[0m11:49:49.611680 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078efaf0>]}
[0m11:49:49.611913 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.dim_products
[0m11:49:49.612216 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790c0a0>]}
[0m11:49:49.612621 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m11:49:49.613161 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m11:49:49.613558 [info ] [Thread-4  ]: 5 of 7 START sql table model public.dim_products ............................... [RUN]
[0m11:49:49.614071 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m11:49:49.614797 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_order_items
[0m11:49:49.614414 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.15s]
[0m11:49:49.615162 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_products, now model.ecommerce_dbt.dim_products)
[0m11:49:49.615657 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_orders
[0m11:49:49.615882 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_customers
[0m11:49:49.616108 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.dim_products
[0m11:49:49.616477 [info ] [Thread-1  ]: 6 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m11:49:49.616740 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.fact_orders
[0m11:49:49.618830 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_products"
[0m11:49:49.619110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customers, now model.ecommerce_dbt.dim_customers)
[0m11:49:49.619599 [info ] [Thread-2  ]: 7 of 7 START sql table model public.fact_orders ................................ [RUN]
[0m11:49:49.619953 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m11:49:49.620399 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_order_items, now model.ecommerce_dbt.fact_orders)
[0m11:49:49.622873 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m11:49:49.623279 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m11:49:49.623726 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.dim_products
[0m11:49:49.626424 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m11:49:49.638920 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m11:49:49.642941 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_products"
[0m11:49:49.645808 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_customers"
[0m11:49:49.646257 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m11:49:49.648927 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_orders"
[0m11:49:49.649279 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:49:49.649573 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: BEGIN
[0m11:49:49.649798 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:49:49.650128 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:49:49.650363 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: BEGIN
[0m11:49:49.650846 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:49:49.651436 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:49:49.651679 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: BEGIN
[0m11:49:49.651889 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:49:49.663921 [debug] [Thread-2  ]: SQL status: BEGIN in 0.012 seconds
[0m11:49:49.664274 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m11:49:49.664543 [debug] [Thread-4  ]: SQL status: BEGIN in 0.015 seconds
[0m11:49:49.665112 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:49:49.665639 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:49:49.665966 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:49:49.666245 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */

  
    

  create  table "dbt_db"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db"."public"."stg_order_items"
),

order_with_items as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        sum(oi.quantity * oi.unit_price) as total_amount,
        count(oi.order_item_id) as total_items
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    group by 1, 2, 3, 4
)

select
    order_id,
    customer_id,
    order_date,
    status,
    total_amount,
    total_items,
    current_timestamp as updated_at
from order_with_items
  );
  
[0m11:49:49.666532 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */

  
    

  create  table "dbt_db"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db"."public"."stg_customers"
)

select
    customer_id,
    name,
    email,
    created_at,
    current_timestamp as updated_at
from customers
  );
  
[0m11:49:49.666790 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */

  
    

  create  table "dbt_db"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db"."public"."stg_products"
)

select
    product_id,
    name,
    price,
    category,
    created_at,
    current_timestamp as updated_at
from products
  );
  
[0m11:49:49.673351 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.006 seconds
[0m11:49:49.679635 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:49:49.679959 [debug] [Thread-4  ]: SQL status: SELECT 4 in 0.013 seconds
[0m11:49:49.680223 [debug] [Thread-2  ]: SQL status: SELECT 3 in 0.013 seconds
[0m11:49:49.680467 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:49:49.682987 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:49:49.685387 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:49:49.685698 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
alter table "dbt_db"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m11:49:49.685949 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
alter table "dbt_db"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m11:49:49.686212 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:49:49.689201 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:49:49.689786 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:49:49.690055 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:49:49.690388 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:49:49.693167 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:49:49.695505 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:49:49.695800 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
alter table "dbt_db"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m11:49:49.696047 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
alter table "dbt_db"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m11:49:49.696730 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:49:49.697788 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:49:49.698030 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:49:49.698244 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:49:49.698511 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:49:49.698752 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:49:49.699807 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m11:49:49.700782 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m11:49:49.701003 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:49:49.701313 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:49:49.701597 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:49:49.703883 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."dim_customers__dbt_backup"
[0m11:49:49.704151 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m11:49:49.704385 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m11:49:49.706082 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:49:49.706386 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
drop table if exists "dbt_db"."public"."dim_customers__dbt_backup" cascade
[0m11:49:49.707309 [debug] [Thread-2  ]: SQL status: COMMIT in 0.001 seconds
[0m11:49:49.709239 [debug] [Thread-2  ]: Applying DROP to: "dbt_db"."public"."fact_orders__dbt_backup"
[0m11:49:49.709743 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:49:49.709966 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
drop table if exists "dbt_db"."public"."fact_orders__dbt_backup" cascade
[0m11:49:49.710204 [debug] [Thread-4  ]: SQL status: COMMIT in 0.004 seconds
[0m11:49:49.710430 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.004 seconds
[0m11:49:49.712287 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."dim_products__dbt_backup"
[0m11:49:49.712550 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:49:49.713400 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: Close
[0m11:49:49.713939 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:49:49.714705 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: Close
[0m11:49:49.714977 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
drop table if exists "dbt_db"."public"."dim_products__dbt_backup" cascade
[0m11:49:49.715356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5bb20>]}
[0m11:49:49.715908 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aacd90>]}
[0m11:49:49.716493 [info ] [Thread-2  ]: 7 of 7 OK created sql table model public.fact_orders ........................... [[32mSELECT 3[0m in 0.10s]
[0m11:49:49.717309 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m11:49:49.716819 [info ] [Thread-1  ]: 6 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.10s]
[0m11:49:49.718209 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m11:49:49.718602 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:49:49.719542 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: Close
[0m11:49:49.719973 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af7b0408-c2e8-43d9-b8de-920a831cec90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5b250>]}
[0m11:49:49.720400 [info ] [Thread-4  ]: 5 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.10s]
[0m11:49:49.720751 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.dim_products
[0m11:49:49.721502 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:49.721717 [debug] [MainThread]: On master: BEGIN
[0m11:49:49.721902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:49:49.731079 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:49:49.731618 [debug] [MainThread]: On master: COMMIT
[0m11:49:49.731895 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:49.732099 [debug] [MainThread]: On master: COMMIT
[0m11:49:49.732654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:49:49.732875 [debug] [MainThread]: On master: Close
[0m11:49:49.733154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:49.733339 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m11:49:49.733510 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m11:49:49.733674 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_orders' was properly closed.
[0m11:49:49.733833 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_products' was properly closed.
[0m11:49:49.734100 [info ] [MainThread]: 
[0m11:49:49.734315 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:49:49.735140 [debug] [MainThread]: Command end result
[0m11:49:49.751945 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:49:49.752987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:49:49.757699 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:49:49.757961 [info ] [MainThread]: 
[0m11:49:49.758202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:49.758410 [info ] [MainThread]: 
[0m11:49:49.758609 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:49:49.760186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0445302, "process_in_blocks": "0", "process_kernel_time": 0.248951, "process_mem_max_rss": "124026880", "process_out_blocks": "0", "process_user_time": 1.705533}
[0m11:49:49.760460 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:49.760410 after 1.04 seconds
[0m11:49:49.760689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fde80>]}
[0m11:49:49.760925 [debug] [MainThread]: Flushing usage events
[0m11:49:52.833123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:53.994048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110002790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e7ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e7af10>]}


============================== 11:49:53.996552 | f71969b5-83ab-4599-a9d3-84fa98b016d4 ==============================
[0m11:49:53.996552 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:49:53.996978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:54.119758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f71969b5-83ab-4599-a9d3-84fa98b016d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd9ee0>]}
[0m11:49:54.166140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f71969b5-83ab-4599-a9d3-84fa98b016d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109749d0>]}
[0m11:49:54.166787 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:49:54.237704 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:49:54.328045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:49:54.328351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:49:54.332824 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:49:54.365695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f71969b5-83ab-4599-a9d3-84fa98b016d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dbe130>]}
[0m11:49:54.437181 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:49:54.440231 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:49:54.482234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f71969b5-83ab-4599-a9d3-84fa98b016d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112afdf0>]}
[0m11:49:54.482605 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:49:54.482828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f71969b5-83ab-4599-a9d3-84fa98b016d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dc10d0>]}
[0m11:49:54.484103 [info ] [MainThread]: 
[0m11:49:54.484366 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:49:54.484566 [info ] [MainThread]: 
[0m11:49:54.484881 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:49:54.487830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m11:49:54.519022 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:49:54.519839 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:49:54.520123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:54.538469 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m11:49:54.538792 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:49:54.539004 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:49:54.542651 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m11:49:54.543616 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:49:54.544086 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:49:54.548767 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:54.549044 [debug] [MainThread]: On master: BEGIN
[0m11:49:54.549230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:49:54.556630 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:49:54.557043 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:54.557379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:49:54.567259 [debug] [MainThread]: SQL status: SELECT 4 in 0.009 seconds
[0m11:49:54.568786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f71969b5-83ab-4599-a9d3-84fa98b016d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112647c0>]}
[0m11:49:54.569135 [debug] [MainThread]: On master: ROLLBACK
[0m11:49:54.569694 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:54.569978 [debug] [MainThread]: On master: BEGIN
[0m11:49:54.570772 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:49:54.571044 [debug] [MainThread]: On master: COMMIT
[0m11:49:54.571274 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:54.571491 [debug] [MainThread]: On master: COMMIT
[0m11:49:54.571957 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:49:54.572185 [debug] [MainThread]: On master: Close
[0m11:49:54.573930 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:49:54.574262 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:49:54.574560 [info ] [Thread-1  ]: 1 of 12 START test source_not_null_ecommerce_raw_customers_customer_id ......... [RUN]
[0m11:49:54.574887 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:49:54.575184 [info ] [Thread-2  ]: 2 of 12 START test source_not_null_ecommerce_raw_order_items_order_item_id ..... [RUN]
[0m11:49:54.575475 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:49:54.575776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m11:49:54.576047 [info ] [Thread-3  ]: 3 of 12 START test source_not_null_ecommerce_raw_orders_order_id ............... [RUN]
[0m11:49:54.576387 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0'
[0m11:49:54.576643 [info ] [Thread-4  ]: 4 of 12 START test source_not_null_ecommerce_raw_products_product_id ........... [RUN]
[0m11:49:54.576911 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:49:54.577221 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf'
[0m11:49:54.577469 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:49:54.577767 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea'
[0m11:49:54.590685 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:49:54.591326 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:49:54.594321 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:49:54.594595 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:49:54.598139 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:49:54.601404 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:49:54.601980 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:49:54.602243 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:49:54.608532 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:49:54.608776 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:49:54.618870 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:49:54.620718 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:49:54.622458 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:49:54.624130 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:49:54.625518 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:49:54.626258 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: BEGIN
[0m11:49:54.626655 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:49:54.626932 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:49:54.627195 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:49:54.627422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:49:54.627665 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: BEGIN
[0m11:49:54.627894 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: BEGIN
[0m11:49:54.628115 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: BEGIN
[0m11:49:54.628407 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:49:54.628628 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:49:54.628848 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:49:54.641434 [debug] [Thread-1  ]: SQL status: BEGIN in 0.014 seconds
[0m11:49:54.641753 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:49:54.641995 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt_db"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m11:49:54.643320 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:49:54.646328 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: ROLLBACK
[0m11:49:54.646622 [debug] [Thread-2  ]: SQL status: BEGIN in 0.018 seconds
[0m11:49:54.646866 [debug] [Thread-3  ]: SQL status: BEGIN in 0.018 seconds
[0m11:49:54.647099 [debug] [Thread-4  ]: SQL status: BEGIN in 0.018 seconds
[0m11:49:54.647362 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:49:54.647597 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:49:54.647805 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: Close
[0m11:49:54.648039 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:49:54.648280 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_id
from "dbt_db"."public"."order_items"
where order_item_id is null



      
    ) dbt_internal_test
[0m11:49:54.648524 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt_db"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m11:49:54.648922 [info ] [Thread-1  ]: 1 of 12 PASS source_not_null_ecommerce_raw_customers_customer_id ............... [[32mPASS[0m in 0.07s]
[0m11:49:54.649181 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "dbt_db"."public"."products"
where product_id is null



      
    ) dbt_internal_test
[0m11:49:54.649720 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:49:54.650301 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:49:54.650740 [info ] [Thread-1  ]: 5 of 12 START test source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [RUN]
[0m11:49:54.651091 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:49:54.651418 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m11:49:54.651684 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:49:54.651924 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:49:54.653510 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: ROLLBACK
[0m11:49:54.653771 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:49:54.654542 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: ROLLBACK
[0m11:49:54.655497 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: ROLLBACK
[0m11:49:54.661324 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:49:54.661639 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: Close
[0m11:49:54.662107 [info ] [Thread-3  ]: 3 of 12 PASS source_not_null_ecommerce_raw_orders_order_id ..................... [[32mPASS[0m in 0.08s]
[0m11:49:54.662378 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: Close
[0m11:49:54.662603 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: Close
[0m11:49:54.662911 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:49:54.663292 [info ] [Thread-4  ]: 4 of 12 PASS source_not_null_ecommerce_raw_products_product_id ................. [[32mPASS[0m in 0.09s]
[0m11:49:54.663596 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:49:54.664026 [info ] [Thread-2  ]: 2 of 12 PASS source_not_null_ecommerce_raw_order_items_order_item_id ........... [[32mPASS[0m in 0.09s]
[0m11:49:54.664417 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:49:54.665006 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:49:54.667081 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:49:54.667493 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:49:54.667984 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:49:54.667755 [info ] [Thread-3  ]: 6 of 12 START test source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [RUN]
[0m11:49:54.668508 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:49:54.669046 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m11:49:54.668786 [info ] [Thread-4  ]: 7 of 12 START test source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [RUN]
[0m11:49:54.669379 [info ] [Thread-2  ]: 8 of 12 START test source_unique_ecommerce_raw_customers_customer_id ........... [RUN]
[0m11:49:54.669649 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:49:54.669929 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:49:54.670182 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m11:49:54.670447 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m11:49:54.674333 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:49:54.674635 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: BEGIN
[0m11:49:54.675072 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:49:54.675332 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:49:54.675613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:49:54.679809 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:49:54.684198 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:49:54.684702 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:49:54.686650 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:49:54.687038 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:49:54.687301 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:49:54.689778 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:49:54.691869 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:49:54.692256 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:49:54.692758 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: BEGIN
[0m11:49:54.693033 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:49:54.693478 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:49:54.693735 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: BEGIN
[0m11:49:54.693971 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:49:54.694262 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:49:54.694551 [debug] [Thread-1  ]: SQL status: BEGIN in 0.019 seconds
[0m11:49:54.694890 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: BEGIN
[0m11:49:54.695146 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:49:54.695431 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:49:54.695721 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from "dbt_db"."public"."order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "dbt_db"."public"."orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:49:54.697849 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:49:54.698947 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: ROLLBACK
[0m11:49:54.699775 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: Close
[0m11:49:54.700200 [info ] [Thread-1  ]: 5 of 12 PASS source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [[32mPASS[0m in 0.05s]
[0m11:49:54.700573 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:49:54.700834 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:49:54.701220 [info ] [Thread-1  ]: 9 of 12 START test source_unique_ecommerce_raw_customers_email ................. [RUN]
[0m11:49:54.701633 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m11:49:54.701872 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:49:54.705104 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:49:54.705527 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m11:49:54.705921 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:49:54.706477 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "dbt_db"."public"."order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "dbt_db"."public"."products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:49:54.706791 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m11:49:54.707059 [debug] [Thread-2  ]: SQL status: BEGIN in 0.013 seconds
[0m11:49:54.707360 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:49:54.707619 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:49:54.707897 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt_db"."public"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:49:54.708193 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:49:54.708448 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:49:54.708720 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:49:54.710692 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:49:54.710976 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:49:54.711937 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: ROLLBACK
[0m11:49:54.712226 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:49:54.713060 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: ROLLBACK
[0m11:49:54.713917 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: ROLLBACK
[0m11:49:54.714208 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:49:54.714442 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: Close
[0m11:49:54.714665 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: Close
[0m11:49:54.714922 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: BEGIN
[0m11:49:54.715136 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: Close
[0m11:49:54.715738 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:49:54.715534 [info ] [Thread-4  ]: 7 of 12 PASS source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [[32mPASS[0m in 0.05s]
[0m11:49:54.716081 [info ] [Thread-3  ]: 6 of 12 PASS source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [[32mPASS[0m in 0.05s]
[0m11:49:54.717055 [info ] [Thread-2  ]: 8 of 12 PASS source_unique_ecommerce_raw_customers_customer_id ................. [[32mPASS[0m in 0.05s]
[0m11:49:54.717680 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:49:54.718434 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:49:54.718804 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:49:54.719109 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:49:54.719459 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:49:54.719758 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:49:54.720034 [info ] [Thread-4  ]: 10 of 12 START test source_unique_ecommerce_raw_order_items_order_item_id ...... [RUN]
[0m11:49:54.720310 [info ] [Thread-3  ]: 11 of 12 START test source_unique_ecommerce_raw_orders_order_id ................ [RUN]
[0m11:49:54.720816 [info ] [Thread-2  ]: 12 of 12 START test source_unique_ecommerce_raw_products_product_id ............ [RUN]
[0m11:49:54.721178 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m11:49:54.721454 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m11:49:54.721711 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m11:49:54.721956 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:49:54.722180 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:49:54.722412 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:49:54.725655 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:49:54.728872 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:49:54.729172 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m11:49:54.732033 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:49:54.732799 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:49:54.733231 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db"."public"."customers"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m11:49:54.733530 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:49:54.735440 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:49:54.735795 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:49:54.737438 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: ROLLBACK
[0m11:49:54.737752 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:49:54.737988 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:49:54.738224 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: Close
[0m11:49:54.738496 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:49:54.740176 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:49:54.741882 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:49:54.742153 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: BEGIN
[0m11:49:54.742497 [info ] [Thread-1  ]: 9 of 12 PASS source_unique_ecommerce_raw_customers_email ....................... [[32mPASS[0m in 0.04s]
[0m11:49:54.742894 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:49:54.743237 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:49:54.743649 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:49:54.743919 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:49:54.744334 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: BEGIN
[0m11:49:54.744900 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: BEGIN
[0m11:49:54.745277 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:49:54.745545 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:49:54.752436 [debug] [Thread-4  ]: SQL status: BEGIN in 0.009 seconds
[0m11:49:54.752776 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:49:54.753027 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:49:54.753961 [debug] [Thread-3  ]: SQL status: BEGIN in 0.008 seconds
[0m11:49:54.754238 [debug] [Thread-2  ]: SQL status: BEGIN in 0.009 seconds
[0m11:49:54.754464 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:49:54.754696 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:49:54.754984 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:49:54.755976 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: ROLLBACK
[0m11:49:54.756231 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:49:54.756477 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:49:54.757126 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: Close
[0m11:49:54.757600 [info ] [Thread-4  ]: 10 of 12 PASS source_unique_ecommerce_raw_order_items_order_item_id ............ [[32mPASS[0m in 0.04s]
[0m11:49:54.758158 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:49:54.758480 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:49:54.759637 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: ROLLBACK
[0m11:49:54.759985 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.003 seconds
[0m11:49:54.760928 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: ROLLBACK
[0m11:49:54.761186 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: Close
[0m11:49:54.761461 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: Close
[0m11:49:54.761880 [info ] [Thread-3  ]: 11 of 12 PASS source_unique_ecommerce_raw_orders_order_id ...................... [[32mPASS[0m in 0.04s]
[0m11:49:54.762251 [info ] [Thread-2  ]: 12 of 12 PASS source_unique_ecommerce_raw_products_product_id .................. [[32mPASS[0m in 0.04s]
[0m11:49:54.762826 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:49:54.763197 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:49:54.764056 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:54.764282 [debug] [MainThread]: On master: BEGIN
[0m11:49:54.764468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:49:54.771621 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:49:54.771942 [debug] [MainThread]: On master: COMMIT
[0m11:49:54.772142 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:54.772335 [debug] [MainThread]: On master: COMMIT
[0m11:49:54.772918 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:49:54.773147 [debug] [MainThread]: On master: Close
[0m11:49:54.773435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:54.773614 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548' was properly closed.
[0m11:49:54.773784 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9' was properly closed.
[0m11:49:54.773950 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65' was properly closed.
[0m11:49:54.774116 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559' was properly closed.
[0m11:49:54.774338 [info ] [MainThread]: 
[0m11:49:54.774596 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m11:49:54.775760 [debug] [MainThread]: Command end result
[0m11:49:54.792584 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:49:54.793602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:49:54.798618 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:49:54.798925 [info ] [MainThread]: 
[0m11:49:54.799186 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:54.799401 [info ] [MainThread]: 
[0m11:49:54.799619 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m11:49:54.800662 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8589626, "process_in_blocks": "0", "process_kernel_time": 0.180941, "process_mem_max_rss": "124780544", "process_out_blocks": "0", "process_user_time": 1.572054}
[0m11:49:54.800921 [debug] [MainThread]: Command `dbt test` succeeded at 11:49:54.800872 after 0.86 seconds
[0m11:49:54.801158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110002790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11018d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118d9e20>]}
[0m11:49:54.801397 [debug] [MainThread]: Flushing usage events
[0m11:49:55.853325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:57.018593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c36730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a9d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a9d0d0>]}


============================== 11:49:57.022018 | f3bb239a-89da-4657-8c8f-9c3977648167 ==============================
[0m11:49:57.022018 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:49:57.022520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:57.162231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3bb239a-89da-4657-8c8f-9c3977648167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2c070>]}
[0m11:49:57.217489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3bb239a-89da-4657-8c8f-9c3977648167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e5130>]}
[0m11:49:57.218237 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:49:57.297789 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:49:57.404884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:49:57.405214 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:49:57.410279 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:49:57.447923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3bb239a-89da-4657-8c8f-9c3977648167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571d130>]}
[0m11:49:57.459033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3bb239a-89da-4657-8c8f-9c3977648167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105750dc0>]}
[0m11:49:57.459568 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:49:57.459821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bb239a-89da-4657-8c8f-9c3977648167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105750d90>]}
[0m11:49:57.461332 [info ] [MainThread]: 
[0m11:49:57.461604 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:49:57.461806 [info ] [MainThread]: 
[0m11:49:57.462202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:49:57.466139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m11:49:57.533838 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:49:57.534164 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:49:57.534364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:57.554406 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m11:49:57.554723 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:49:57.554952 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:49:57.560225 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m11:49:57.561300 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:49:57.561947 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:49:57.566942 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:57.567241 [debug] [MainThread]: On master: BEGIN
[0m11:49:57.567447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:49:57.576928 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:49:57.577254 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:57.577529 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:49:57.586912 [debug] [MainThread]: SQL status: SELECT 4 in 0.009 seconds
[0m11:49:57.588284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bb239a-89da-4657-8c8f-9c3977648167', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024fdcd0>]}
[0m11:49:57.588575 [debug] [MainThread]: On master: ROLLBACK
[0m11:49:57.589036 [debug] [MainThread]: On master: Close
[0m11:49:57.590597 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m11:49:57.590920 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_order_items
[0m11:49:57.591339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m11:49:57.591582 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_orders
[0m11:49:57.591883 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.stg_products
[0m11:49:57.592240 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_order_items'
[0m11:49:57.592494 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m11:49:57.592907 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_orders'
[0m11:49:57.593218 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_products'
[0m11:49:57.593459 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_order_items
[0m11:49:57.600123 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m11:49:57.600428 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_orders
[0m11:49:57.600674 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.stg_products
[0m11:49:57.602959 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_order_items"
[0m11:49:57.605074 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_orders"
[0m11:49:57.607307 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_products"
[0m11:49:57.607809 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m11:49:57.608296 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m11:49:57.608555 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:49:57.608976 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_orders
[0m11:49:57.609256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customers, now test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m11:49:57.609486 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_order_items
[0m11:49:57.609703 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.stg_products
[0m11:49:57.610093 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_orders
[0m11:49:57.610324 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:49:57.610702 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_order_items
[0m11:49:57.611086 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.stg_products
[0m11:49:57.611333 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:49:57.618089 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:49:57.620861 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:49:57.621253 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:49:57.621631 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_orders, now test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0)
[0m11:49:57.622032 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_order_items, now test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf)
[0m11:49:57.622739 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_products, now test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea)
[0m11:49:57.623358 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:49:57.623692 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:49:57.623973 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:49:57.624265 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:49:57.624738 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:49:57.628620 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:49:57.632007 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:49:57.636507 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:49:57.636892 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:49:57.637831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m11:49:57.638869 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:49:57.639698 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:49:57.640112 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:49:57.640668 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:49:57.640906 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:49:57.646756 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:49:57.647976 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:49:57.648250 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:49:57.648695 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:49:57.649013 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:49:57.649292 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m11:49:57.649574 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:49:57.649860 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m11:49:57.650155 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:49:57.650393 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:49:57.650644 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m11:49:57.650881 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:49:57.651307 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:49:57.655567 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:49:57.655897 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:49:57.659598 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:49:57.659955 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:49:57.664209 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:49:57.664587 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m11:49:57.665035 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:49:57.665389 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:49:57.665920 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:49:57.666213 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:49:57.666446 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:49:57.669206 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:49:57.669479 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:49:57.669900 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:49:57.670330 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:49:57.670631 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m11:49:57.670903 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:49:57.671165 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:49:57.671424 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:49:57.671632 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:49:57.671873 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m11:49:57.672124 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m11:49:57.672514 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:49:57.675397 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:49:57.675673 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:49:57.675906 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:49:57.676152 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_customers
[0m11:49:57.680079 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:49:57.683034 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:49:57.683351 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548, now model.ecommerce_dbt.dim_customers)
[0m11:49:57.683860 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:49:57.684201 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m11:49:57.684456 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:49:57.684877 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:49:57.685136 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:49:57.687262 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m11:49:57.687729 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:49:57.687973 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_orders
[0m11:49:57.688425 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:49:57.688725 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.dim_products
[0m11:49:57.688992 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559, now model.ecommerce_dbt.fact_orders)
[0m11:49:57.689330 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65, now model.ecommerce_dbt.dim_products)
[0m11:49:57.689598 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m11:49:57.689820 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m11:49:57.690030 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.dim_products
[0m11:49:57.692174 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m11:49:57.692706 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m11:49:57.694691 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_products"
[0m11:49:57.695184 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.dim_products
[0m11:49:57.695411 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m11:49:57.695798 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.dim_products
[0m11:49:57.696170 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m11:49:57.696788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:57.696981 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m11:49:57.697153 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9' was properly closed.
[0m11:49:57.697317 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m11:49:57.697478 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_products' was properly closed.
[0m11:49:57.699075 [debug] [MainThread]: Command end result
[0m11:49:57.770453 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:49:57.773318 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:49:57.778183 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:49:57.780087 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:49:57.780334 [info ] [MainThread]: Building catalog
[0m11:49:57.788133 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db.information_schema'
[0m11:49:57.793567 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m11:49:57.793867 [debug] [ThreadPool]: On dbt_db.information_schema: BEGIN
[0m11:49:57.794058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:57.806186 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:49:57.806478 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m11:49:57.806746 [debug] [ThreadPool]: On dbt_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "dbt_db.information_schema"} */

    
    

    select
        'dbt_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fact_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:49:57.813347 [debug] [ThreadPool]: SQL status: SELECT 58 in 0.006 seconds
[0m11:49:57.818589 [debug] [ThreadPool]: On dbt_db.information_schema: ROLLBACK
[0m11:49:57.819272 [debug] [ThreadPool]: On dbt_db.information_schema: Close
[0m11:49:57.829756 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/catalog.json
[0m11:49:57.848337 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:49:57.849371 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:49:57.849583 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/catalog.json
[0m11:49:57.850602 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.8934753, "process_in_blocks": "0", "process_kernel_time": 0.176985, "process_mem_max_rss": "124518400", "process_out_blocks": "0", "process_user_time": 1.597522}
[0m11:49:57.850884 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:49:57.850833 after 0.89 seconds
[0m11:49:57.851091 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:49:57.851262 [debug] [MainThread]: Connection 'dbt_db.information_schema' was properly closed.
[0m11:49:57.851460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c36730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c346a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030579a0>]}
[0m11:49:57.851799 [debug] [MainThread]: Flushing usage events
[0m11:49:58.891009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:13.800145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d66760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ec340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ec160>]}


============================== 11:51:13.803794 | c4c27977-2ec3-44c8-b052-86a0f95b0398 ==============================
[0m11:51:13.803794 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:51:13.804198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:51:13.949548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4c27977-2ec3-44c8-b052-86a0f95b0398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a0a4c0>]}
[0m11:51:13.996269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4c27977-2ec3-44c8-b052-86a0f95b0398', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110df3d0>]}
[0m11:55:05.799200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aac460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aac280>]}


============================== 11:55:05.802037 | ba31fabc-0016-41c3-8b84-f60f969912e1 ==============================
[0m11:55:05.802037 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:55:05.802424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:05.943029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbacd0>]}
[0m11:55:05.987651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a936d0>]}
[0m11:55:05.988360 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:55:06.069891 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:55:06.179092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:06.179385 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:06.183494 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:55:06.214619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ff130>]}
[0m11:55:06.280999 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:55:06.283525 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:55:06.323756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077012e0>]}
[0m11:55:06.324145 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:55:06.324372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077018e0>]}
[0m11:55:06.325477 [info ] [MainThread]: 
[0m11:55:06.325705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:06.325895 [info ] [MainThread]: 
[0m11:55:06.326192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:06.329027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m11:55:06.363553 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m11:55:06.363908 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m11:55:06.364156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:06.398935 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.035 seconds
[0m11:55:06.399800 [debug] [ThreadPool]: On list_dbt_db: Close
[0m11:55:06.400902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m11:55:06.405673 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:55:06.405934 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:55:06.406139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:06.413788 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m11:55:06.414070 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:55:06.414297 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:55:06.420534 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m11:55:06.421611 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:55:06.422099 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:55:06.427307 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:06.427579 [debug] [MainThread]: On master: BEGIN
[0m11:55:06.427860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:06.435452 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:55:06.435751 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:06.436051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:06.447692 [debug] [MainThread]: SQL status: SELECT 4 in 0.011 seconds
[0m11:55:06.449205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075c9970>]}
[0m11:55:06.449541 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:06.450064 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:06.450286 [debug] [MainThread]: On master: BEGIN
[0m11:55:06.450972 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:55:06.451242 [debug] [MainThread]: On master: COMMIT
[0m11:55:06.451473 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:06.451686 [debug] [MainThread]: On master: COMMIT
[0m11:55:06.452094 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:55:06.452316 [debug] [MainThread]: On master: Close
[0m11:55:06.455002 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m11:55:06.455312 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_order_items
[0m11:55:06.455932 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_orders
[0m11:55:06.455697 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m11:55:06.456290 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.stg_products
[0m11:55:06.456606 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m11:55:06.456963 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m11:55:06.457302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m11:55:06.457639 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m11:55:06.457993 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_order_items'
[0m11:55:06.458410 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_orders'
[0m11:55:06.458683 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m11:55:06.459006 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_products'
[0m11:55:06.459252 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_order_items
[0m11:55:06.459477 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_orders
[0m11:55:06.465954 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m11:55:06.466380 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.stg_products
[0m11:55:06.469513 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_order_items"
[0m11:55:06.471616 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_orders"
[0m11:55:06.476959 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_products"
[0m11:55:06.477475 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m11:55:06.501957 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customers"
[0m11:55:06.502302 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_orders
[0m11:55:06.502577 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.stg_products
[0m11:55:06.505231 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_orders"
[0m11:55:06.505490 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_order_items
[0m11:55:06.508062 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_products"
[0m11:55:06.508368 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:55:06.510968 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_order_items"
[0m11:55:06.511291 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: BEGIN
[0m11:55:06.511647 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:55:06.511899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:06.512167 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: BEGIN
[0m11:55:06.512405 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:55:06.512645 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:55:06.512932 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:55:06.513157 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: BEGIN
[0m11:55:06.513392 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: BEGIN
[0m11:55:06.513709 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:55:06.513935 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:55:06.528143 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m11:55:06.528652 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:55:06.529068 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */

  create view "dbt_db"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        email,
        created_at
    from source
)

select * from staged
  );
[0m11:55:06.529365 [debug] [Thread-2  ]: SQL status: BEGIN in 0.016 seconds
[0m11:55:06.529640 [debug] [Thread-4  ]: SQL status: BEGIN in 0.016 seconds
[0m11:55:06.529956 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:55:06.530222 [debug] [Thread-3  ]: SQL status: BEGIN in 0.017 seconds
[0m11:55:06.530471 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:55:06.530729 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */

  create view "dbt_db"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        created_at
    from source
)

select * from staged
  );
[0m11:55:06.530975 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:55:06.531219 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */

  create view "dbt_db"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."products"
),

staged as (
    select
        product_id,
        name,
        price,
        category,
        created_at
    from source
)

select * from staged
  );
[0m11:55:06.531516 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */

  create view "dbt_db"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at
    from source
)

select * from staged
  );
[0m11:55:06.539236 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m11:55:06.539626 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m11:55:06.539900 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.010 seconds
[0m11:55:06.545903 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.014 seconds
[0m11:55:06.545617 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:55:06.548719 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:55:06.551622 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:55:06.554139 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:55:06.554406 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
alter table "dbt_db"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:55:06.554660 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
alter table "dbt_db"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m11:55:06.554897 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
alter table "dbt_db"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:55:06.555117 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
alter table "dbt_db"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m11:55:06.556040 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:55:06.556270 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:55:06.558380 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:55:06.558591 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:55:06.558812 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:55:06.560879 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:55:06.561122 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
alter table "dbt_db"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m11:55:06.563178 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:55:06.565190 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:55:06.565417 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
alter table "dbt_db"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:55:06.565674 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
alter table "dbt_db"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:55:06.565924 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
alter table "dbt_db"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:55:06.566181 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:55:06.566452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:55:06.566713 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:55:06.572658 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.006 seconds
[0m11:55:06.578132 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m11:55:06.579201 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m11:55:06.580181 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m11:55:06.581122 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m11:55:06.581364 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:55:06.581586 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:55:06.581800 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:55:06.582008 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:55:06.582216 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m11:55:06.582426 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m11:55:06.582702 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m11:55:06.582932 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m11:55:06.584945 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m11:55:06.585256 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:55:06.585506 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m11:55:06.592697 [debug] [Thread-3  ]: SQL status: COMMIT in 0.009 seconds
[0m11:55:06.592017 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."stg_products__dbt_backup"
[0m11:55:06.594946 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."stg_customers__dbt_backup"
[0m11:55:06.597047 [debug] [Thread-2  ]: Applying DROP to: "dbt_db"."public"."stg_order_items__dbt_backup"
[0m11:55:06.599093 [debug] [Thread-3  ]: Applying DROP to: "dbt_db"."public"."stg_orders__dbt_backup"
[0m11:55:06.602134 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:55:06.602630 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:55:06.603116 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:55:06.603573 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:55:06.603796 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
drop view if exists "dbt_db"."public"."stg_products__dbt_backup" cascade
[0m11:55:06.604016 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
drop view if exists "dbt_db"."public"."stg_customers__dbt_backup" cascade
[0m11:55:06.604228 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
drop view if exists "dbt_db"."public"."stg_order_items__dbt_backup" cascade
[0m11:55:06.604439 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
drop view if exists "dbt_db"."public"."stg_orders__dbt_backup" cascade
[0m11:55:06.607286 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.003 seconds
[0m11:55:06.607571 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.003 seconds
[0m11:55:06.607799 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.003 seconds
[0m11:55:06.608004 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.003 seconds
[0m11:55:06.609744 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: Close
[0m11:55:06.610521 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: Close
[0m11:55:06.611249 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: Close
[0m11:55:06.612023 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: Close
[0m11:55:06.614511 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce3ca0>]}
[0m11:55:06.614805 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce3a30>]}
[0m11:55:06.615163 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc4910>]}
[0m11:55:06.615791 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024d6580>]}
[0m11:55:06.615578 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.15s]
[0m11:55:06.616341 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m11:55:06.616629 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m11:55:06.617121 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.15s]
[0m11:55:06.617493 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_orders
[0m11:55:06.617805 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m11:55:06.618176 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.stg_products
[0m11:55:06.618586 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_order_items
[0m11:55:06.619084 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.dim_customers
[0m11:55:06.619398 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.dim_products
[0m11:55:06.619751 [info ] [Thread-3  ]: 5 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m11:55:06.620084 [info ] [Thread-4  ]: 6 of 7 START sql table model public.dim_products ............................... [RUN]
[0m11:55:06.620418 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_orders, now model.ecommerce_dbt.dim_customers)
[0m11:55:06.620643 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.fact_orders
[0m11:55:06.620881 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_products, now model.ecommerce_dbt.dim_products)
[0m11:55:06.621107 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m11:55:06.621378 [info ] [Thread-2  ]: 7 of 7 START sql table model public.fact_orders ................................ [RUN]
[0m11:55:06.621612 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.dim_products
[0m11:55:06.624058 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m11:55:06.624417 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_order_items, now model.ecommerce_dbt.fact_orders)
[0m11:55:06.626841 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_products"
[0m11:55:06.627322 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m11:55:06.629801 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m11:55:06.630097 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m11:55:06.643034 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.dim_products
[0m11:55:06.652350 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_customers"
[0m11:55:06.653568 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_products"
[0m11:55:06.653905 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m11:55:06.657809 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_orders"
[0m11:55:06.658422 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:55:06.658713 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:55:06.658980 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: BEGIN
[0m11:55:06.659254 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:55:06.659474 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_customers: BEGIN
[0m11:55:06.659719 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:55:06.659965 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: BEGIN
[0m11:55:06.660179 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:55:06.660474 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:55:06.670803 [debug] [Thread-3  ]: SQL status: BEGIN in 0.011 seconds
[0m11:55:06.671134 [debug] [Thread-4  ]: SQL status: BEGIN in 0.011 seconds
[0m11:55:06.671389 [debug] [Thread-2  ]: SQL status: BEGIN in 0.011 seconds
[0m11:55:06.671619 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:55:06.671887 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:55:06.672140 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:55:06.672393 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */

  
    

  create  table "dbt_db"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db"."public"."stg_customers"
)

select
    customer_id,
    name,
    email,
    created_at,
    current_timestamp as updated_at
from customers
  );
  
[0m11:55:06.672646 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */

  
    

  create  table "dbt_db"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db"."public"."stg_products"
)

select
    product_id,
    name,
    price,
    category,
    created_at,
    current_timestamp as updated_at
from products
  );
  
[0m11:55:06.672904 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */

  
    

  create  table "dbt_db"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db"."public"."stg_order_items"
),

order_with_items as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        sum(oi.quantity * oi.unit_price) as total_amount,
        count(oi.order_item_id) as total_items
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    group by 1, 2, 3, 4
)

select
    order_id,
    customer_id,
    order_date,
    status,
    total_amount,
    total_items,
    current_timestamp as updated_at
from order_with_items
  );
  
[0m11:55:06.678953 [debug] [Thread-4  ]: SQL status: SELECT 4 in 0.006 seconds
[0m11:55:06.684439 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:55:06.684748 [debug] [Thread-3  ]: SQL status: SELECT 3 in 0.012 seconds
[0m11:55:06.685017 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
alter table "dbt_db"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m11:55:06.685279 [debug] [Thread-2  ]: SQL status: SELECT 3 in 0.012 seconds
[0m11:55:06.688162 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:55:06.690786 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:55:06.691044 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:55:06.691270 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:55:06.691523 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
alter table "dbt_db"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m11:55:06.694058 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:55:06.694352 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
alter table "dbt_db"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m11:55:06.694711 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:55:06.696910 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:55:06.697145 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:55:06.697355 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
alter table "dbt_db"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m11:55:06.697558 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:55:06.699579 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:55:06.700669 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m11:55:06.700904 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:55:06.701133 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:55:06.701361 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:55:06.702301 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m11:55:06.702551 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m11:55:06.702788 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:55:06.703045 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:55:06.703293 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m11:55:06.704397 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:55:06.704620 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m11:55:06.704857 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:55:06.706877 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."dim_products__dbt_backup"
[0m11:55:06.707119 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m11:55:06.707321 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:55:06.709044 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:55:06.710801 [debug] [Thread-2  ]: Applying DROP to: "dbt_db"."public"."fact_orders__dbt_backup"
[0m11:55:06.711068 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
drop table if exists "dbt_db"."public"."dim_products__dbt_backup" cascade
[0m11:55:06.711680 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:55:06.711927 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m11:55:06.712177 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
drop table if exists "dbt_db"."public"."fact_orders__dbt_backup" cascade
[0m11:55:06.713979 [debug] [Thread-3  ]: Applying DROP to: "dbt_db"."public"."dim_customers__dbt_backup"
[0m11:55:06.714237 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:55:06.714834 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:55:06.715773 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: Close
[0m11:55:06.716046 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
drop table if exists "dbt_db"."public"."dim_customers__dbt_backup" cascade
[0m11:55:06.716505 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddddc0>]}
[0m11:55:06.716764 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:55:06.717831 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_orders: Close
[0m11:55:06.718472 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c074f40>]}
[0m11:55:06.719588 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:55:06.718954 [info ] [Thread-4  ]: 6 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.10s]
[0m11:55:06.720711 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_customers: Close
[0m11:55:06.719326 [info ] [Thread-2  ]: 7 of 7 OK created sql table model public.fact_orders ........................... [[32mSELECT 3[0m in 0.09s]
[0m11:55:06.721154 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.dim_products
[0m11:55:06.721506 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m11:55:06.721862 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba31fabc-0016-41c3-8b84-f60f969912e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecd430>]}
[0m11:55:06.722382 [info ] [Thread-3  ]: 5 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.10s]
[0m11:55:06.722756 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m11:55:06.723433 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:06.723625 [debug] [MainThread]: On master: BEGIN
[0m11:55:06.723792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:06.732804 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:55:06.733134 [debug] [MainThread]: On master: COMMIT
[0m11:55:06.733335 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:06.733520 [debug] [MainThread]: On master: COMMIT
[0m11:55:06.733863 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:55:06.734097 [debug] [MainThread]: On master: Close
[0m11:55:06.734393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:06.734613 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_customers' was properly closed.
[0m11:55:06.734797 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m11:55:06.734968 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m11:55:06.735130 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_products' was properly closed.
[0m11:55:06.735390 [info ] [MainThread]: 
[0m11:55:06.735608 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m11:55:06.736470 [debug] [MainThread]: Command end result
[0m11:55:06.753519 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:55:06.754807 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:55:06.759389 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:55:06.759654 [info ] [MainThread]: 
[0m11:55:06.759914 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:06.760120 [info ] [MainThread]: 
[0m11:55:06.760330 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:55:06.761700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0165619, "process_in_blocks": "0", "process_kernel_time": 0.183007, "process_mem_max_rss": "123682816", "process_out_blocks": "0", "process_user_time": 1.58978}
[0m11:55:06.761954 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:06.761906 after 1.02 seconds
[0m11:55:06.762184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ee0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffc790>]}
[0m11:55:06.762413 [debug] [MainThread]: Flushing usage events
[0m11:55:08.060334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:09.359369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33ad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33af10>]}


============================== 11:55:09.362585 | 05038d7e-9cc0-4870-8409-51066d64bde3 ==============================
[0m11:55:09.362585 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:55:09.362993 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m11:55:09.511595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05038d7e-9cc0-4870-8409-51066d64bde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b1ee0>]}
[0m11:55:09.562004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05038d7e-9cc0-4870-8409-51066d64bde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e33250>]}
[0m11:55:09.562720 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:55:09.640085 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:55:09.734725 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:09.735062 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:09.739590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:55:09.771852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05038d7e-9cc0-4870-8409-51066d64bde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1bf130>]}
[0m11:55:09.838665 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:55:09.841074 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:55:09.882656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05038d7e-9cc0-4870-8409-51066d64bde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6af1f0>]}
[0m11:55:09.883030 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:55:09.883254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05038d7e-9cc0-4870-8409-51066d64bde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c10d0>]}
[0m11:55:09.884444 [info ] [MainThread]: 
[0m11:55:09.884667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:09.884857 [info ] [MainThread]: 
[0m11:55:09.885152 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:09.888214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m11:55:09.915326 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:55:09.915623 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:55:09.915803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:09.935848 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m11:55:09.936145 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:55:09.936348 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:55:09.941696 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m11:55:09.942659 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:55:09.943145 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:55:09.947480 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:09.947735 [debug] [MainThread]: On master: BEGIN
[0m11:55:09.947925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:09.955338 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:55:09.955719 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:09.956080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:09.966729 [debug] [MainThread]: SQL status: SELECT 4 in 0.010 seconds
[0m11:55:09.968270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05038d7e-9cc0-4870-8409-51066d64bde3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6647c0>]}
[0m11:55:09.968627 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:09.969293 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:09.969518 [debug] [MainThread]: On master: BEGIN
[0m11:55:09.970220 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:55:09.970443 [debug] [MainThread]: On master: COMMIT
[0m11:55:09.970660 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:09.970866 [debug] [MainThread]: On master: COMMIT
[0m11:55:09.971280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:55:09.971558 [debug] [MainThread]: On master: Close
[0m11:55:09.973253 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:55:09.973579 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:55:09.973868 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:55:09.974375 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:55:09.974146 [info ] [Thread-1  ]: 1 of 12 START test source_not_null_ecommerce_raw_customers_customer_id ......... [RUN]
[0m11:55:09.974740 [info ] [Thread-2  ]: 2 of 12 START test source_not_null_ecommerce_raw_order_items_order_item_id ..... [RUN]
[0m11:55:09.975040 [info ] [Thread-3  ]: 3 of 12 START test source_not_null_ecommerce_raw_orders_order_id ............... [RUN]
[0m11:55:09.975339 [info ] [Thread-4  ]: 4 of 12 START test source_not_null_ecommerce_raw_products_product_id ........... [RUN]
[0m11:55:09.975699 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m11:55:09.976061 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0'
[0m11:55:09.976395 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf'
[0m11:55:09.976721 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea'
[0m11:55:09.976986 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:55:09.977242 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:55:09.977490 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:55:09.977740 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:55:09.991099 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:55:09.994017 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:55:09.997901 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:55:10.000772 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:55:10.001395 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:55:10.007946 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:55:10.008222 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:55:10.011833 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:55:10.013547 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:55:10.013897 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:55:10.015583 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:55:10.017386 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:55:10.017814 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:55:10.018071 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:55:10.018317 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: BEGIN
[0m11:55:10.018584 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: BEGIN
[0m11:55:10.018847 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:55:10.019086 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:55:10.019293 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:10.019517 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:55:10.019746 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: BEGIN
[0m11:55:10.019980 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: BEGIN
[0m11:55:10.020363 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:55:10.020586 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:55:10.035429 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m11:55:10.035795 [debug] [Thread-4  ]: SQL status: BEGIN in 0.015 seconds
[0m11:55:10.036041 [debug] [Thread-2  ]: SQL status: BEGIN in 0.016 seconds
[0m11:55:10.036271 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:55:10.036489 [debug] [Thread-3  ]: SQL status: BEGIN in 0.017 seconds
[0m11:55:10.036716 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:55:10.036937 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:55:10.037174 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt_db"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m11:55:10.037401 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:55:10.037632 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "dbt_db"."public"."products"
where product_id is null



      
    ) dbt_internal_test
[0m11:55:10.037870 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_id
from "dbt_db"."public"."order_items"
where order_item_id is null



      
    ) dbt_internal_test
[0m11:55:10.038157 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt_db"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m11:55:10.039411 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:55:10.042269 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: ROLLBACK
[0m11:55:10.042541 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.004 seconds
[0m11:55:10.042781 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.004 seconds
[0m11:55:10.043654 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: ROLLBACK
[0m11:55:10.043897 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.005 seconds
[0m11:55:10.044116 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: Close
[0m11:55:10.044893 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: ROLLBACK
[0m11:55:10.045708 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: ROLLBACK
[0m11:55:10.045967 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: Close
[0m11:55:10.046358 [info ] [Thread-1  ]: 1 of 12 PASS source_not_null_ecommerce_raw_customers_customer_id ............... [[32mPASS[0m in 0.07s]
[0m11:55:10.046823 [info ] [Thread-4  ]: 4 of 12 PASS source_not_null_ecommerce_raw_products_product_id ................. [[32mPASS[0m in 0.07s]
[0m11:55:10.047098 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: Close
[0m11:55:10.047308 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: Close
[0m11:55:10.047643 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:55:10.048010 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:55:10.048387 [info ] [Thread-3  ]: 3 of 12 PASS source_not_null_ecommerce_raw_orders_order_id ..................... [[32mPASS[0m in 0.07s]
[0m11:55:10.048756 [info ] [Thread-2  ]: 2 of 12 PASS source_not_null_ecommerce_raw_order_items_order_item_id ........... [[32mPASS[0m in 0.07s]
[0m11:55:10.049057 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:55:10.049385 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:55:10.049738 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:55:10.050066 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:55:10.050331 [info ] [Thread-1  ]: 5 of 12 START test source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [RUN]
[0m11:55:10.050611 [info ] [Thread-4  ]: 6 of 12 START test source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [RUN]
[0m11:55:10.050894 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:55:10.051138 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:55:10.051437 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m11:55:10.051700 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m11:55:10.051944 [info ] [Thread-3  ]: 7 of 12 START test source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [RUN]
[0m11:55:10.052339 [info ] [Thread-2  ]: 8 of 12 START test source_unique_ecommerce_raw_customers_customer_id ........... [RUN]
[0m11:55:10.052648 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:55:10.052890 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:55:10.053175 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m11:55:10.053429 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m11:55:10.060665 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:55:10.065779 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:55:10.066124 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:55:10.066354 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:55:10.070379 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:55:10.074817 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:55:10.075304 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:55:10.077087 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:55:10.077376 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:55:10.079074 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:55:10.079855 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:55:10.080106 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:55:10.080381 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:55:10.080620 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:55:10.082286 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:55:10.084506 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:55:10.084751 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: BEGIN
[0m11:55:10.084991 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: BEGIN
[0m11:55:10.085332 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:55:10.085623 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:10.085930 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:55:10.086197 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:55:10.086566 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: BEGIN
[0m11:55:10.086803 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: BEGIN
[0m11:55:10.087034 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:55:10.087267 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:55:10.101704 [debug] [Thread-3  ]: SQL status: BEGIN in 0.014 seconds
[0m11:55:10.102051 [debug] [Thread-2  ]: SQL status: BEGIN in 0.015 seconds
[0m11:55:10.102309 [debug] [Thread-1  ]: SQL status: BEGIN in 0.017 seconds
[0m11:55:10.102547 [debug] [Thread-4  ]: SQL status: BEGIN in 0.017 seconds
[0m11:55:10.102789 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:55:10.103036 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:55:10.103276 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:55:10.103517 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:55:10.103789 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt_db"."public"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:55:10.104072 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:55:10.104347 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from "dbt_db"."public"."order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "dbt_db"."public"."orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:55:10.104611 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "dbt_db"."public"."order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "dbt_db"."public"."products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:55:10.106255 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:55:10.106627 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:55:10.106891 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:55:10.107885 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: ROLLBACK
[0m11:55:10.108135 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.003 seconds
[0m11:55:10.108970 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: ROLLBACK
[0m11:55:10.109798 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: ROLLBACK
[0m11:55:10.110674 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: ROLLBACK
[0m11:55:10.110917 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: Close
[0m11:55:10.111382 [info ] [Thread-2  ]: 8 of 12 PASS source_unique_ecommerce_raw_customers_customer_id ................. [[32mPASS[0m in 0.06s]
[0m11:55:10.111734 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:55:10.111959 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: Close
[0m11:55:10.112205 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:55:10.112416 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: Close
[0m11:55:10.112674 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: Close
[0m11:55:10.113004 [info ] [Thread-3  ]: 7 of 12 PASS source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [[32mPASS[0m in 0.06s]
[0m11:55:10.113273 [info ] [Thread-2  ]: 9 of 12 START test source_unique_ecommerce_raw_customers_email ................. [RUN]
[0m11:55:10.113638 [info ] [Thread-4  ]: 6 of 12 PASS source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [[32mPASS[0m in 0.06s]
[0m11:55:10.114012 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:55:10.114321 [info ] [Thread-1  ]: 5 of 12 PASS source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [[32mPASS[0m in 0.06s]
[0m11:55:10.114729 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m11:55:10.115093 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:55:10.115398 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:55:10.115790 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:55:10.116029 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:55:10.116287 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:55:10.116526 [info ] [Thread-3  ]: 10 of 12 START test source_unique_ecommerce_raw_order_items_order_item_id ...... [RUN]
[0m11:55:10.116796 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:55:10.120537 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:55:10.120884 [info ] [Thread-4  ]: 11 of 12 START test source_unique_ecommerce_raw_orders_order_id ................ [RUN]
[0m11:55:10.121199 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m11:55:10.121486 [info ] [Thread-1  ]: 12 of 12 START test source_unique_ecommerce_raw_products_product_id ............ [RUN]
[0m11:55:10.122021 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m11:55:10.122360 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:55:10.122619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m11:55:10.122873 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:55:10.123098 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:55:10.126107 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:55:10.126399 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:55:10.128582 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:55:10.131986 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:55:10.134867 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:55:10.135487 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:55:10.137251 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:55:10.137579 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:55:10.140033 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:55:10.140395 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:55:10.140684 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: BEGIN
[0m11:55:10.141011 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m11:55:10.141309 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:55:10.141563 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:55:10.141899 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:55:10.142148 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: BEGIN
[0m11:55:10.144278 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:55:10.144635 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: BEGIN
[0m11:55:10.144893 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:55:10.145179 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:55:10.145673 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:55:10.145912 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: BEGIN
[0m11:55:10.146140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:10.150969 [debug] [Thread-2  ]: SQL status: BEGIN in 0.010 seconds
[0m11:55:10.151307 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:55:10.151591 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db"."public"."customers"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m11:55:10.153032 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:55:10.154234 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: ROLLBACK
[0m11:55:10.155654 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: Close
[0m11:55:10.157628 [debug] [Thread-1  ]: SQL status: BEGIN in 0.011 seconds
[0m11:55:10.157922 [debug] [Thread-3  ]: SQL status: BEGIN in 0.013 seconds
[0m11:55:10.158402 [info ] [Thread-2  ]: 9 of 12 PASS source_unique_ecommerce_raw_customers_email ....................... [[32mPASS[0m in 0.04s]
[0m11:55:10.158713 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:55:10.159016 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:55:10.159421 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:55:10.159712 [debug] [Thread-4  ]: SQL status: BEGIN in 0.015 seconds
[0m11:55:10.159972 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:55:10.160241 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:55:10.160586 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:55:10.160888 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:55:10.162085 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.001 seconds
[0m11:55:10.163070 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: ROLLBACK
[0m11:55:10.163344 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:55:10.163627 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.002 seconds
[0m11:55:10.163855 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: Close
[0m11:55:10.164832 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: ROLLBACK
[0m11:55:10.165630 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: ROLLBACK
[0m11:55:10.166119 [info ] [Thread-1  ]: 12 of 12 PASS source_unique_ecommerce_raw_products_product_id .................. [[32mPASS[0m in 0.04s]
[0m11:55:10.166534 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: Close
[0m11:55:10.166950 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:55:10.167191 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: Close
[0m11:55:10.167793 [info ] [Thread-3  ]: 10 of 12 PASS source_unique_ecommerce_raw_order_items_order_item_id ............ [[32mPASS[0m in 0.05s]
[0m11:55:10.168396 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:55:10.168948 [info ] [Thread-4  ]: 11 of 12 PASS source_unique_ecommerce_raw_orders_order_id ...................... [[32mPASS[0m in 0.05s]
[0m11:55:10.169608 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:55:10.170423 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:10.170631 [debug] [MainThread]: On master: BEGIN
[0m11:55:10.170816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:10.178009 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:55:10.178310 [debug] [MainThread]: On master: COMMIT
[0m11:55:10.178515 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:10.178712 [debug] [MainThread]: On master: COMMIT
[0m11:55:10.179151 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:55:10.179354 [debug] [MainThread]: On master: Close
[0m11:55:10.179662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:10.179852 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9' was properly closed.
[0m11:55:10.180028 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548' was properly closed.
[0m11:55:10.180197 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559' was properly closed.
[0m11:55:10.180364 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65' was properly closed.
[0m11:55:10.180595 [info ] [MainThread]: 
[0m11:55:10.180950 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m11:55:10.182225 [debug] [MainThread]: Command end result
[0m11:55:10.200089 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:55:10.201208 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:55:10.205924 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:55:10.206141 [info ] [MainThread]: 
[0m11:55:10.206389 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:10.206660 [info ] [MainThread]: 
[0m11:55:10.206892 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m11:55:10.207924 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.91154665, "process_in_blocks": "0", "process_kernel_time": 0.174693, "process_mem_max_rss": "125517824", "process_out_blocks": "0", "process_user_time": 1.707454}
[0m11:55:10.208206 [debug] [MainThread]: Command `dbt test` succeeded at 11:55:10.208154 after 0.91 seconds
[0m11:55:10.208468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e91310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66ba90>]}
[0m11:55:10.208793 [debug] [MainThread]: Flushing usage events
[0m11:55:11.164064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:12.324402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2a040>]}


============================== 11:55:12.326939 | 8fccdd25-9609-4d27-b769-00a3f41eb525 ==============================
[0m11:55:12.326939 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:55:12.327327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:12.449939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fccdd25-9609-4d27-b769-00a3f41eb525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107049d00>]}
[0m11:55:12.494293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fccdd25-9609-4d27-b769-00a3f41eb525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106789730>]}
[0m11:55:12.494806 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:55:12.563293 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:55:12.649851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:12.650131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:12.654157 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:55:12.685056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fccdd25-9609-4d27-b769-00a3f41eb525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a7f130>]}
[0m11:55:12.693666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fccdd25-9609-4d27-b769-00a3f41eb525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab1e20>]}
[0m11:55:12.693999 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:55:12.694219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fccdd25-9609-4d27-b769-00a3f41eb525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab1df0>]}
[0m11:55:12.695523 [info ] [MainThread]: 
[0m11:55:12.695754 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:12.695941 [info ] [MainThread]: 
[0m11:55:12.696238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:12.699046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m11:55:12.754171 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:55:12.754481 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:55:12.754675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:12.773577 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m11:55:12.773891 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:55:12.774100 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:55:12.778097 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.004 seconds
[0m11:55:12.779025 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:55:12.779500 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:55:12.785021 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:12.785310 [debug] [MainThread]: On master: BEGIN
[0m11:55:12.785490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:12.792706 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m11:55:12.792983 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:12.793251 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:12.808598 [debug] [MainThread]: SQL status: SELECT 4 in 0.015 seconds
[0m11:55:12.810096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fccdd25-9609-4d27-b769-00a3f41eb525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102845cd0>]}
[0m11:55:12.810422 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:12.810951 [debug] [MainThread]: On master: Close
[0m11:55:12.812607 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m11:55:12.812913 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_order_items
[0m11:55:12.813175 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_orders
[0m11:55:12.813467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m11:55:12.813716 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.stg_products
[0m11:55:12.814050 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_order_items'
[0m11:55:12.814371 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_orders'
[0m11:55:12.814625 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m11:55:12.814940 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_products'
[0m11:55:12.815190 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_order_items
[0m11:55:12.815428 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_orders
[0m11:55:12.822442 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m11:55:12.822729 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.stg_products
[0m11:55:12.826122 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_order_items"
[0m11:55:12.828642 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_orders"
[0m11:55:12.831033 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_products"
[0m11:55:12.831683 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_order_items
[0m11:55:12.831957 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m11:55:12.832422 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_order_items
[0m11:55:12.832652 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_orders
[0m11:55:12.833096 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m11:55:12.833326 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.stg_products
[0m11:55:12.833605 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:55:12.834078 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_orders
[0m11:55:12.834325 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:55:12.834744 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.stg_products
[0m11:55:12.835026 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_order_items, now test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m11:55:12.835279 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:55:12.835560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customers, now test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0)
[0m11:55:12.835835 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:55:12.836099 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:55:12.836344 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_orders, now test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf)
[0m11:55:12.836571 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:55:12.836808 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_products, now test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea)
[0m11:55:12.844920 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m11:55:12.845196 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:55:12.847994 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m11:55:12.848246 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:55:12.851059 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m11:55:12.854515 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m11:55:12.854859 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:55:12.855099 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:55:12.855410 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:55:12.855630 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:55:12.856004 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m11:55:12.856361 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m11:55:12.856708 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m11:55:12.857051 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m11:55:12.857280 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:55:12.857544 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:55:12.857812 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:55:12.858055 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:55:12.858317 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m11:55:12.858574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m11:55:12.858817 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m11:55:12.859053 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m11:55:12.859274 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:55:12.859490 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:55:12.859702 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:55:12.859910 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:55:12.865131 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m11:55:12.868660 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m11:55:12.872166 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m11:55:12.876163 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m11:55:12.876751 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:55:12.877160 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m11:55:12.877398 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:55:12.877641 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:55:12.877921 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:55:12.878183 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m11:55:12.878419 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:55:12.878798 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m11:55:12.879171 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m11:55:12.879390 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:55:12.879770 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m11:55:12.880003 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:55:12.880262 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:55:12.882896 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m11:55:12.883155 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:55:12.883429 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m11:55:12.883681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m11:55:12.883968 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m11:55:12.884222 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:55:12.884449 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:55:12.884657 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:55:12.884862 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:55:12.887501 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m11:55:12.890957 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m11:55:12.891382 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m11:55:12.893963 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m11:55:12.894319 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.dim_customers
[0m11:55:12.894648 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:55:12.894886 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:55:12.895131 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548, now model.ecommerce_dbt.dim_customers)
[0m11:55:12.895559 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m11:55:12.895769 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:55:12.896141 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m11:55:12.896355 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m11:55:12.896594 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.fact_orders
[0m11:55:12.896982 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m11:55:12.897206 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.dim_products
[0m11:55:12.899099 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m11:55:12.899359 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65, now model.ecommerce_dbt.fact_orders)
[0m11:55:12.899666 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559, now model.ecommerce_dbt.dim_products)
[0m11:55:12.899938 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m11:55:12.900171 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.dim_products
[0m11:55:12.902198 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m11:55:12.904007 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_products"
[0m11:55:12.904218 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m11:55:12.904694 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m11:55:12.905013 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m11:55:12.905385 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m11:55:12.905601 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.dim_products
[0m11:55:12.905974 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.dim_products
[0m11:55:12.906662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:12.906854 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m11:55:12.907023 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m11:55:12.907183 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9' was properly closed.
[0m11:55:12.907339 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_products' was properly closed.
[0m11:55:12.908865 [debug] [MainThread]: Command end result
[0m11:55:12.974950 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:55:12.977191 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:55:12.982030 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:55:12.983725 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m11:55:12.983941 [info ] [MainThread]: Building catalog
[0m11:55:12.991153 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db.information_schema'
[0m11:55:12.996517 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m11:55:12.996809 [debug] [ThreadPool]: On dbt_db.information_schema: BEGIN
[0m11:55:12.997017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:13.008917 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m11:55:13.009295 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m11:55:13.009598 [debug] [ThreadPool]: On dbt_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "dbt_db.information_schema"} */

    
    

    select
        'dbt_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fact_orders')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m11:55:13.016980 [debug] [ThreadPool]: SQL status: SELECT 58 in 0.007 seconds
[0m11:55:13.022197 [debug] [ThreadPool]: On dbt_db.information_schema: ROLLBACK
[0m11:55:13.022700 [debug] [ThreadPool]: On dbt_db.information_schema: Close
[0m11:55:13.032499 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/catalog.json
[0m11:55:13.049781 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:55:13.051758 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:55:13.052036 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/catalog.json
[0m11:55:13.053083 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.7825103, "process_in_blocks": "0", "process_kernel_time": 0.146003, "process_mem_max_rss": "125255680", "process_out_blocks": "0", "process_user_time": 1.476363}
[0m11:55:13.053365 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:55:13.053314 after 0.78 seconds
[0m11:55:13.053575 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:55:13.053747 [debug] [MainThread]: Connection 'dbt_db.information_schema' was properly closed.
[0m11:55:13.053944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e35610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106789730>]}
[0m11:55:13.054183 [debug] [MainThread]: Flushing usage events
[0m11:55:14.763627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:58.872595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b1f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104988340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104988160>]}


============================== 11:55:58.876760 | 43d6d7eb-af11-4197-83d9-4f0432432311 ==============================
[0m11:55:58.876760 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:55:58.877212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:55:59.035101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43d6d7eb-af11-4197-83d9-4f0432432311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca64c0>]}
[0m11:55:59.083645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43d6d7eb-af11-4197-83d9-4f0432432311', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10447b3d0>]}
[0m11:56:43.049028 [error] [MainThread]: Encountered an error:

[0m11:56:43.073076 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m11:56:43.075525 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 44.266434, "process_in_blocks": "0", "process_kernel_time": 0.143921, "process_mem_max_rss": "105988096", "process_out_blocks": "0", "process_user_time": 1.108326}
[0m11:56:43.076146 [debug] [MainThread]: Command `dbt docs serve` failed at 11:56:43.076039 after 44.27 seconds
[0m11:56:43.076614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b1f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053482e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105348550>]}
[0m11:56:43.077098 [debug] [MainThread]: Flushing usage events
[0m11:57:10.497458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff9e80>]}


============================== 11:57:10.500979 | 5d5e2521-86fd-4c7a-ae5f-e09a025cc540 ==============================
[0m11:57:10.500979 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:57:10.501374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:57:10.650420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110413940>]}
[0m11:57:10.696360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11043e1f0>]}
[0m11:57:10.697218 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:57:10.776579 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:57:10.885187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:57:10.885517 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:57:10.889739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:57:10.921514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f3e130>]}
[0m11:57:10.990441 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:57:10.993418 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:57:11.036981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e58e50>]}
[0m11:57:11.037355 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:57:11.037712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11064f880>]}
[0m11:57:11.039118 [info ] [MainThread]: 
[0m11:57:11.039393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:57:11.039595 [info ] [MainThread]: 
[0m11:57:11.039927 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:57:11.043434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m11:57:11.158092 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m11:57:11.158644 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m11:57:11.158953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:11.192077 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m11:57:11.193011 [debug] [ThreadPool]: On list_dbt_db: Close
[0m11:57:11.194176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m11:57:11.202737 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:57:11.203072 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:57:11.203274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:57:11.216522 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m11:57:11.216878 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:57:11.217107 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:57:11.228985 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.012 seconds
[0m11:57:11.230192 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:57:11.231006 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:57:11.240564 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:11.240955 [debug] [MainThread]: On master: BEGIN
[0m11:57:11.241298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:57:11.253601 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m11:57:11.254003 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:11.254320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:57:11.267560 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m11:57:11.268958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c18ac0>]}
[0m11:57:11.269279 [debug] [MainThread]: On master: ROLLBACK
[0m11:57:11.269949 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:11.270164 [debug] [MainThread]: On master: BEGIN
[0m11:57:11.271272 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:57:11.272087 [debug] [MainThread]: On master: COMMIT
[0m11:57:11.272571 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:11.273696 [debug] [MainThread]: On master: COMMIT
[0m11:57:11.275346 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:57:11.276273 [debug] [MainThread]: On master: Close
[0m11:57:11.279470 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m11:57:11.279908 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_order_items
[0m11:57:11.280494 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_orders
[0m11:57:11.280273 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m11:57:11.280826 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.stg_products
[0m11:57:11.281128 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m11:57:11.281473 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m11:57:11.281824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m11:57:11.282462 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_order_items'
[0m11:57:11.282118 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m11:57:11.282814 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_orders'
[0m11:57:11.283039 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m11:57:11.283257 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_order_items
[0m11:57:11.283553 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_products'
[0m11:57:11.283780 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_orders
[0m11:57:11.290078 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m11:57:11.292916 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_order_items"
[0m11:57:11.293377 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.stg_products
[0m11:57:11.295456 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_orders"
[0m11:57:11.297474 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_products"
[0m11:57:11.297875 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m11:57:11.316251 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_order_items
[0m11:57:11.316565 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_orders
[0m11:57:11.316805 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.stg_products
[0m11:57:11.326900 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customers"
[0m11:57:11.330015 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_order_items"
[0m11:57:11.334089 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_orders"
[0m11:57:11.337019 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_products"
[0m11:57:11.337697 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:57:11.337968 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:57:11.338211 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: BEGIN
[0m11:57:11.338552 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:57:11.338873 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:57:11.339108 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: BEGIN
[0m11:57:11.339457 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m11:57:11.339742 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: BEGIN
[0m11:57:11.339991 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: BEGIN
[0m11:57:11.340233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:57:11.340532 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m11:57:11.340754 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:57:11.353602 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m11:57:11.353982 [debug] [Thread-4  ]: SQL status: BEGIN in 0.013 seconds
[0m11:57:11.354258 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:57:11.354517 [debug] [Thread-2  ]: SQL status: BEGIN in 0.015 seconds
[0m11:57:11.354792 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:57:11.354997 [debug] [Thread-3  ]: SQL status: BEGIN in 0.014 seconds
[0m11:57:11.355227 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */

  create view "dbt_db"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        email,
        created_at
    from source
)

select * from staged
  );
[0m11:57:11.355451 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:57:11.355667 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */

  create view "dbt_db"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."products"
),

staged as (
    select
        product_id,
        name,
        price,
        category,
        created_at
    from source
)

select * from staged
  );
[0m11:57:11.355929 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:57:11.356209 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */

  create view "dbt_db"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        created_at
    from source
)

select * from staged
  );
[0m11:57:11.356503 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */

  create view "dbt_db"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at
    from source
)

select * from staged
  );
[0m11:57:11.365104 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.008 seconds
[0m11:57:11.370198 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:57:11.370507 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.014 seconds
[0m11:57:11.370907 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.015 seconds
[0m11:57:11.371577 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
alter table "dbt_db"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m11:57:11.371852 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.015 seconds
[0m11:57:11.374564 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:57:11.377324 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:57:11.380195 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:57:11.380502 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:57:11.380728 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
alter table "dbt_db"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m11:57:11.380982 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
alter table "dbt_db"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m11:57:11.381209 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
alter table "dbt_db"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m11:57:11.383320 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:57:11.383787 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
alter table "dbt_db"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m11:57:11.384888 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:57:11.385189 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:57:11.385451 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:57:11.385671 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:57:11.387914 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:57:11.389929 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:57:11.392061 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:57:11.403661 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m11:57:11.403966 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
alter table "dbt_db"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m11:57:11.404225 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
alter table "dbt_db"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m11:57:11.404449 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
alter table "dbt_db"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m11:57:11.404677 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:57:11.405059 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m11:57:11.406335 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:57:11.407491 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m11:57:11.407744 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:57:11.407960 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m11:57:11.408201 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m11:57:11.412939 [debug] [Thread-3  ]: Applying DROP to: "dbt_db"."public"."stg_orders__dbt_backup"
[0m11:57:11.413314 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.008 seconds
[0m11:57:11.413573 [debug] [Thread-1  ]: SQL status: COMMIT in 0.005 seconds
[0m11:57:11.413820 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.009 seconds
[0m11:57:11.417663 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m11:57:11.419054 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m11:57:11.421287 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."stg_customers__dbt_backup"
[0m11:57:11.422555 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m11:57:11.422842 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
drop view if exists "dbt_db"."public"."stg_orders__dbt_backup" cascade
[0m11:57:11.423116 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:57:11.423760 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m11:57:11.425639 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:57:11.426576 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m11:57:11.426887 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
drop view if exists "dbt_db"."public"."stg_customers__dbt_backup" cascade
[0m11:57:11.427134 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m11:57:11.430152 [debug] [Thread-2  ]: SQL status: COMMIT in 0.002 seconds
[0m11:57:11.432857 [debug] [Thread-2  ]: Applying DROP to: "dbt_db"."public"."stg_order_items__dbt_backup"
[0m11:57:11.433231 [debug] [Thread-4  ]: SQL status: COMMIT in 0.005 seconds
[0m11:57:11.433843 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m11:57:11.434173 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.006 seconds
[0m11:57:11.434520 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.008 seconds
[0m11:57:11.436641 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."stg_products__dbt_backup"
[0m11:57:11.436967 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
drop view if exists "dbt_db"."public"."stg_order_items__dbt_backup" cascade
[0m11:57:11.439759 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: Close
[0m11:57:11.440876 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: Close
[0m11:57:11.441435 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m11:57:11.442667 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
drop view if exists "dbt_db"."public"."stg_products__dbt_backup" cascade
[0m11:57:11.443240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3a520>]}
[0m11:57:11.443450 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d67520>]}
[0m11:57:11.443921 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m11:57:11.444548 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m11:57:11.444802 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.003 seconds
[0m11:57:11.445054 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.002 seconds
[0m11:57:11.445386 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:57:11.446411 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: Close
[0m11:57:11.447195 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: Close
[0m11:57:11.447414 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_customers
[0m11:57:11.447745 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_orders
[0m11:57:11.448138 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e2a790>]}
[0m11:57:11.448472 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eaff40>]}
[0m11:57:11.448797 [info ] [Thread-1  ]: 5 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m11:57:11.449648 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.17s]
[0m11:57:11.450010 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m11:57:11.450340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customers, now model.ecommerce_dbt.dim_customers)
[0m11:57:11.451015 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_order_items
[0m11:57:11.451682 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.stg_products
[0m11:57:11.451953 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m11:57:11.452365 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_orders
[0m11:57:11.454607 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m11:57:11.454838 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.dim_products
[0m11:57:11.455155 [info ] [Thread-3  ]: 6 of 7 START sql table model public.fact_orders ................................ [RUN]
[0m11:57:11.455666 [info ] [Thread-4  ]: 7 of 7 START sql table model public.dim_products ............................... [RUN]
[0m11:57:11.456008 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_orders, now model.ecommerce_dbt.fact_orders)
[0m11:57:11.456321 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_products, now model.ecommerce_dbt.dim_products)
[0m11:57:11.456574 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m11:57:11.456798 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m11:57:11.457136 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.dim_products
[0m11:57:11.472174 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m11:57:11.476578 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_customers"
[0m11:57:11.479057 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_products"
[0m11:57:11.479701 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.dim_products
[0m11:57:11.483031 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_products"
[0m11:57:11.483518 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:57:11.483785 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m11:57:11.484007 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: BEGIN
[0m11:57:11.484274 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:57:11.487175 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_orders"
[0m11:57:11.487469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:57:11.487738 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: BEGIN
[0m11:57:11.488120 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m11:57:11.488550 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:57:11.488782 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_orders: BEGIN
[0m11:57:11.488992 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m11:57:11.500748 [debug] [Thread-1  ]: SQL status: BEGIN in 0.013 seconds
[0m11:57:11.501068 [debug] [Thread-4  ]: SQL status: BEGIN in 0.013 seconds
[0m11:57:11.501318 [debug] [Thread-3  ]: SQL status: BEGIN in 0.012 seconds
[0m11:57:11.501541 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:57:11.501779 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:57:11.502007 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:57:11.502247 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */

  
    

  create  table "dbt_db"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db"."public"."stg_customers"
)

select
    customer_id,
    name,
    email,
    created_at,
    current_timestamp as updated_at
from customers
  );
  
[0m11:57:11.502490 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */

  
    

  create  table "dbt_db"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db"."public"."stg_products"
)

select
    product_id,
    name,
    price,
    category,
    created_at,
    current_timestamp as updated_at
from products
  );
  
[0m11:57:11.502747 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */

  
    

  create  table "dbt_db"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db"."public"."stg_order_items"
),

order_with_items as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        sum(oi.quantity * oi.unit_price) as total_amount,
        count(oi.order_item_id) as total_items
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    group by 1, 2, 3, 4
)

select
    order_id,
    customer_id,
    order_date,
    status,
    total_amount,
    total_items,
    current_timestamp as updated_at
from order_with_items
  );
  
[0m11:57:11.508330 [debug] [Thread-4  ]: SQL status: SELECT 4 in 0.005 seconds
[0m11:57:11.508680 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.006 seconds
[0m11:57:11.514189 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:57:11.514541 [debug] [Thread-3  ]: SQL status: SELECT 3 in 0.011 seconds
[0m11:57:11.517721 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:57:11.518144 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
alter table "dbt_db"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m11:57:11.520822 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:57:11.521106 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:57:11.521395 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
alter table "dbt_db"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m11:57:11.521960 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:57:11.522200 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:57:11.522418 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:57:11.525213 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:57:11.527400 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:57:11.529554 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:57:11.529847 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
alter table "dbt_db"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m11:57:11.530095 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:57:11.530367 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
alter table "dbt_db"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m11:57:11.533321 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:57:11.534590 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m11:57:11.534848 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:57:11.535121 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:57:11.535357 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.005 seconds
[0m11:57:11.536488 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m11:57:11.536743 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m11:57:11.537746 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:57:11.537989 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:57:11.538255 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:57:11.538505 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m11:57:11.538763 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:57:11.540294 [debug] [Thread-3  ]: SQL status: COMMIT in 0.002 seconds
[0m11:57:11.540561 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m11:57:11.540781 [debug] [Thread-4  ]: SQL status: COMMIT in 0.002 seconds
[0m11:57:11.542715 [debug] [Thread-3  ]: Applying DROP to: "dbt_db"."public"."fact_orders__dbt_backup"
[0m11:57:11.545656 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."dim_customers__dbt_backup"
[0m11:57:11.547593 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."dim_products__dbt_backup"
[0m11:57:11.549347 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m11:57:11.549848 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:57:11.550344 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m11:57:11.550572 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
drop table if exists "dbt_db"."public"."fact_orders__dbt_backup" cascade
[0m11:57:11.550811 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
drop table if exists "dbt_db"."public"."dim_customers__dbt_backup" cascade
[0m11:57:11.551044 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
drop table if exists "dbt_db"."public"."dim_products__dbt_backup" cascade
[0m11:57:11.553160 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.002 seconds
[0m11:57:11.554054 [debug] [Thread-4  ]: On model.ecommerce_dbt.dim_products: Close
[0m11:57:11.554297 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:57:11.554516 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:57:11.554924 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f13970>]}
[0m11:57:11.555756 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: Close
[0m11:57:11.556531 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_orders: Close
[0m11:57:11.557027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fc9be0>]}
[0m11:57:11.557834 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5e2521-86fd-4c7a-ae5f-e09a025cc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d67520>]}
[0m11:57:11.557469 [info ] [Thread-4  ]: 7 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.10s]
[0m11:57:11.559055 [info ] [Thread-1  ]: 5 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.11s]
[0m11:57:11.559985 [info ] [Thread-3  ]: 6 of 7 OK created sql table model public.fact_orders ........................... [[32mSELECT 3[0m in 0.10s]
[0m11:57:11.560515 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.dim_products
[0m11:57:11.560866 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m11:57:11.561192 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m11:57:11.562050 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:11.562250 [debug] [MainThread]: On master: BEGIN
[0m11:57:11.562428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:57:11.571653 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m11:57:11.572022 [debug] [MainThread]: On master: COMMIT
[0m11:57:11.572246 [debug] [MainThread]: Using postgres connection "master"
[0m11:57:11.572443 [debug] [MainThread]: On master: COMMIT
[0m11:57:11.573082 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:57:11.573314 [debug] [MainThread]: On master: Close
[0m11:57:11.573615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:11.573807 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m11:57:11.573980 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_order_items' was properly closed.
[0m11:57:11.574149 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m11:57:11.574315 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_products' was properly closed.
[0m11:57:11.574579 [info ] [MainThread]: 
[0m11:57:11.574800 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m11:57:11.575670 [debug] [MainThread]: Command end result
[0m11:57:11.597592 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:57:11.599175 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:57:11.603691 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:57:11.603954 [info ] [MainThread]: 
[0m11:57:11.604202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:57:11.604402 [info ] [MainThread]: 
[0m11:57:11.604608 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:57:11.606049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1707437, "process_in_blocks": "0", "process_kernel_time": 0.221928, "process_mem_max_rss": "124698624", "process_out_blocks": "0", "process_user_time": 1.663179}
[0m11:57:11.606321 [debug] [MainThread]: Command `dbt run` succeeded at 11:57:11.606269 after 1.17 seconds
[0m11:57:11.606566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110647160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110647a90>]}
[0m11:57:11.606814 [debug] [MainThread]: Flushing usage events
[0m11:57:12.863095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:14.241868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110202730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136c190>]}


============================== 11:57:14.244572 | 0b21e74d-0892-45a2-b70a-ab5aa82b7584 ==============================
[0m11:57:14.244572 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:57:14.244941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m11:57:14.370136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b21e74d-0892-45a2-b70a-ab5aa82b7584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066991f0>]}
[0m11:57:14.420222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b21e74d-0892-45a2-b70a-ab5aa82b7584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111683850>]}
[0m11:59:35.130134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118faf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118fa280>]}


============================== 11:59:35.134498 | 3f31c9d9-3ace-4d80-bf58-3f62811ddbed ==============================
[0m11:59:35.134498 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:59:35.134907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt list', 'send_anonymous_usage_stats': 'True'}
[0m11:59:35.275404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f31c9d9-3ace-4d80-bf58-3f62811ddbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d08340>]}
[0m11:59:35.321751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f31c9d9-3ace-4d80-bf58-3f62811ddbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d77d30>]}
[0m11:59:35.322533 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:59:35.400897 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:59:35.505761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:59:35.506085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:59:35.510473 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:59:35.542147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f31c9d9-3ace-4d80-bf58-3f62811ddbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112841130>]}
[0m11:59:35.610294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:59:35.613335 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:59:35.653328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f31c9d9-3ace-4d80-bf58-3f62811ddbed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11280d8e0>]}
[0m11:59:35.654060 [info ] [MainThread]: ecommerce_dbt.core.dim_customers
[0m11:59:35.654289 [info ] [MainThread]: ecommerce_dbt.core.dim_products
[0m11:59:35.654483 [info ] [MainThread]: ecommerce_dbt.core.fact_orders
[0m11:59:35.654665 [info ] [MainThread]: ecommerce_dbt.staging.stg_customers
[0m11:59:35.654847 [info ] [MainThread]: ecommerce_dbt.staging.stg_order_items
[0m11:59:35.655025 [info ] [MainThread]: ecommerce_dbt.staging.stg_orders
[0m11:59:35.655203 [info ] [MainThread]: ecommerce_dbt.staging.stg_products
[0m11:59:35.655377 [info ] [MainThread]: source:ecommerce_dbt.ecommerce_raw.customers
[0m11:59:35.655553 [info ] [MainThread]: source:ecommerce_dbt.ecommerce_raw.order_items
[0m11:59:35.655727 [info ] [MainThread]: source:ecommerce_dbt.ecommerce_raw.orders
[0m11:59:35.655904 [info ] [MainThread]: source:ecommerce_dbt.ecommerce_raw.products
[0m11:59:35.656079 [info ] [MainThread]: ecommerce_dbt.sources.source_not_null_ecommerce_raw_customers_customer_id
[0m11:59:35.656255 [info ] [MainThread]: ecommerce_dbt.sources.source_not_null_ecommerce_raw_order_items_order_item_id
[0m11:59:35.656434 [info ] [MainThread]: ecommerce_dbt.sources.source_not_null_ecommerce_raw_orders_order_id
[0m11:59:35.656610 [info ] [MainThread]: ecommerce_dbt.sources.source_not_null_ecommerce_raw_products_product_id
[0m11:59:35.656789 [info ] [MainThread]: ecommerce_dbt.sources.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_
[0m11:59:35.656968 [info ] [MainThread]: ecommerce_dbt.sources.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_
[0m11:59:35.657146 [info ] [MainThread]: ecommerce_dbt.sources.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_
[0m11:59:35.657323 [info ] [MainThread]: ecommerce_dbt.sources.source_unique_ecommerce_raw_customers_customer_id
[0m11:59:35.657498 [info ] [MainThread]: ecommerce_dbt.sources.source_unique_ecommerce_raw_customers_email
[0m11:59:35.657673 [info ] [MainThread]: ecommerce_dbt.sources.source_unique_ecommerce_raw_order_items_order_item_id
[0m11:59:35.657850 [info ] [MainThread]: ecommerce_dbt.sources.source_unique_ecommerce_raw_orders_order_id
[0m11:59:35.658026 [info ] [MainThread]: ecommerce_dbt.sources.source_unique_ecommerce_raw_products_product_id
[0m11:59:35.659152 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.5864698, "process_in_blocks": "0", "process_kernel_time": 0.171175, "process_mem_max_rss": "111329280", "process_out_blocks": "0", "process_user_time": 1.319281}
[0m11:59:35.659399 [debug] [MainThread]: Command `dbt list` succeeded at 11:59:35.659352 after 0.59 seconds
[0m11:59:35.659624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11084a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128437f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112518880>]}
[0m11:59:35.659844 [debug] [MainThread]: Flushing usage events
[0m11:59:36.694374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:51.328556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105402700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646c2e0>]}


============================== 11:59:51.331548 | 04ee715a-e891-473e-b98f-9a9211ce52d8 ==============================
[0m11:59:51.331548 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:59:51.331962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select dim_customers+', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:59:51.461568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04ee715a-e891-473e-b98f-9a9211ce52d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b3a60>]}
[0m11:59:51.507178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04ee715a-e891-473e-b98f-9a9211ce52d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106437160>]}
[0m11:59:51.508066 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:59:51.583924 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:59:51.687033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:59:51.687344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:59:51.691529 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m11:59:51.723125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04ee715a-e891-473e-b98f-9a9211ce52d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b40130>]}
[0m11:59:51.791871 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:59:51.794516 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:59:51.834450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04ee715a-e891-473e-b98f-9a9211ce52d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107302850>]}
[0m11:59:51.834835 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m11:59:51.835062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04ee715a-e891-473e-b98f-9a9211ce52d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a3250>]}
[0m11:59:51.835873 [info ] [MainThread]: 
[0m11:59:51.836104 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:51.836297 [info ] [MainThread]: 
[0m11:59:51.836607 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:59:51.837090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m11:59:51.873438 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m11:59:51.873792 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m11:59:51.874015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:51.895158 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m11:59:51.896044 [debug] [ThreadPool]: On list_dbt_db: Close
[0m11:59:51.899778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m11:59:51.903976 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:59:51.904213 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m11:59:51.904403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:59:51.914369 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m11:59:51.914696 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m11:59:51.914916 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:59:51.917696 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m11:59:51.918684 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m11:59:51.919168 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m11:59:51.924353 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:51.924724 [debug] [MainThread]: On master: BEGIN
[0m11:59:51.924932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:59:51.933169 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:59:51.933478 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:51.933754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:59:51.944217 [debug] [MainThread]: SQL status: SELECT 4 in 0.010 seconds
[0m11:59:51.945813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04ee715a-e891-473e-b98f-9a9211ce52d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107906a30>]}
[0m11:59:51.946164 [debug] [MainThread]: On master: ROLLBACK
[0m11:59:51.946731 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:51.946978 [debug] [MainThread]: On master: BEGIN
[0m11:59:51.947666 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m11:59:51.947906 [debug] [MainThread]: On master: COMMIT
[0m11:59:51.948129 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:51.948343 [debug] [MainThread]: On master: COMMIT
[0m11:59:51.948786 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:59:51.949065 [debug] [MainThread]: On master: Close
[0m11:59:51.952229 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_customers
[0m11:59:51.952655 [info ] [Thread-1  ]: 1 of 1 START sql table model public.dim_customers .............................. [RUN]
[0m11:59:51.953010 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.dim_customers)
[0m11:59:51.953257 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m11:59:51.959637 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m11:59:51.960230 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m11:59:51.989363 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_customers"
[0m11:59:51.990003 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:59:51.990323 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: BEGIN
[0m11:59:51.990630 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:59:52.001060 [debug] [Thread-1  ]: SQL status: BEGIN in 0.010 seconds
[0m11:59:52.001416 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:59:52.001678 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */

  
    

  create  table "dbt_db"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db"."public"."stg_customers"
)

select
    customer_id,
    name,
    email,
    created_at,
    current_timestamp as updated_at
from customers
  );
  
[0m11:59:52.006296 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.004 seconds
[0m11:59:52.014013 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:59:52.014400 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m11:59:52.015226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:59:52.018224 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:59:52.018549 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m11:59:52.019468 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:59:52.031788 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:59:52.032119 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:59:52.032344 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m11:59:52.034017 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m11:59:52.038491 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."dim_customers__dbt_backup"
[0m11:59:52.041418 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m11:59:52.041677 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
drop table if exists "dbt_db"."public"."dim_customers__dbt_backup" cascade
[0m11:59:52.045253 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m11:59:52.047073 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: Close
[0m11:59:52.048424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04ee715a-e891-473e-b98f-9a9211ce52d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2f7c0>]}
[0m11:59:52.048874 [info ] [Thread-1  ]: 1 of 1 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.09s]
[0m11:59:52.049234 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m11:59:52.049884 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:52.050099 [debug] [MainThread]: On master: BEGIN
[0m11:59:52.050289 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:59:52.058599 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m11:59:52.058920 [debug] [MainThread]: On master: COMMIT
[0m11:59:52.059141 [debug] [MainThread]: Using postgres connection "master"
[0m11:59:52.059339 [debug] [MainThread]: On master: COMMIT
[0m11:59:52.059837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:59:52.060072 [debug] [MainThread]: On master: Close
[0m11:59:52.060494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:52.060739 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m11:59:52.060968 [info ] [MainThread]: 
[0m11:59:52.061202 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m11:59:52.061728 [debug] [MainThread]: Command end result
[0m11:59:52.078717 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m11:59:52.079713 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m11:59:52.083616 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m11:59:52.083866 [info ] [MainThread]: 
[0m11:59:52.084240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:52.084455 [info ] [MainThread]: 
[0m11:59:52.084674 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:59:52.085809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.81129605, "process_in_blocks": "0", "process_kernel_time": 0.182468, "process_mem_max_rss": "123224064", "process_out_blocks": "0", "process_user_time": 1.454708}
[0m11:59:52.086090 [debug] [MainThread]: Command `dbt run` succeeded at 11:59:52.086037 after 0.81 seconds
[0m11:59:52.086370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105402700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039feeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105686b50>]}
[0m11:59:52.086630 [debug] [MainThread]: Flushing usage events
[0m11:59:53.311637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:45.595130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d0a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239bbca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239bbe80>]}


============================== 12:00:45.598395 | 66ca8d94-7f17-4637-8eda-afa4c1fd10af ==============================
[0m12:00:45.598395 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:00:45.598788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --select fact_orders', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:00:45.736786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66ca8d94-7f17-4637-8eda-afa4c1fd10af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107309ee0>]}
[0m12:00:45.782309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66ca8d94-7f17-4637-8eda-afa4c1fd10af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ca9d90>]}
[0m12:00:45.783173 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:00:45.858495 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:00:45.965768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:45.966085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:45.970291 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m12:00:46.003189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66ca8d94-7f17-4637-8eda-afa4c1fd10af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124700130>]}
[0m12:00:46.072760 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:00:46.076085 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:00:46.115957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66ca8d94-7f17-4637-8eda-afa4c1fd10af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124602a90>]}
[0m12:00:46.116337 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m12:00:46.116580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ca8d94-7f17-4637-8eda-afa4c1fd10af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124705bb0>]}
[0m12:00:46.117481 [info ] [MainThread]: 
[0m12:00:46.117757 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:00:46.117963 [info ] [MainThread]: 
[0m12:00:46.118282 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:46.121151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m12:00:46.156138 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:00:46.156729 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m12:00:46.156969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:46.176837 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m12:00:46.177146 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:00:46.177353 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:00:46.184411 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m12:00:46.185367 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m12:00:46.186004 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m12:00:46.190299 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:46.190564 [debug] [MainThread]: On master: BEGIN
[0m12:00:46.190795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:46.198481 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:00:46.198800 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:46.199088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:00:46.212813 [debug] [MainThread]: SQL status: SELECT 4 in 0.013 seconds
[0m12:00:46.214398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66ca8d94-7f17-4637-8eda-afa4c1fd10af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238ecc70>]}
[0m12:00:46.214732 [debug] [MainThread]: On master: ROLLBACK
[0m12:00:46.215306 [debug] [MainThread]: On master: Close
[0m12:00:46.217244 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.fact_orders
[0m12:00:46.217642 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.fact_orders)
[0m12:00:46.217964 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m12:00:46.224888 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m12:00:46.225467 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m12:00:46.225952 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m12:00:46.226541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:46.226775 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m12:00:46.227184 [debug] [MainThread]: Command end result
[0m12:00:46.248754 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:00:46.249760 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:00:46.254599 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m12:00:46.254916 [info ] [MainThread]: Compiled node 'fact_orders' is:
with orders as (
    select * from "dbt_db"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db"."public"."stg_order_items"
),

order_with_items as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        sum(oi.quantity * oi.unit_price) as total_amount,
        count(oi.order_item_id) as total_items
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    group by 1, 2, 3, 4
)

select
    order_id,
    customer_id,
    order_date,
    status,
    total_amount,
    total_items,
    current_timestamp as updated_at
from order_with_items
[0m12:00:46.256052 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.7135407, "process_in_blocks": "0", "process_kernel_time": 0.185737, "process_mem_max_rss": "121880576", "process_out_blocks": "0", "process_user_time": 1.379246}
[0m12:00:46.256328 [debug] [MainThread]: Command `dbt compile` succeeded at 12:00:46.256275 after 0.71 seconds
[0m12:00:46.256569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d0a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12471d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12471d610>]}
[0m12:00:46.256811 [debug] [MainThread]: Flushing usage events
[0m12:00:47.503229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:54.060041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10364a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c3e50>]}


============================== 12:00:54.062930 | b66075d1-663f-4cfe-9196-a33e13b47dbb ==============================
[0m12:00:54.062930 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:00:54.063295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile --select stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m12:00:54.189174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b66075d1-663f-4cfe-9196-a33e13b47dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f02b0>]}
[0m12:00:54.235147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b66075d1-663f-4cfe-9196-a33e13b47dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f0070>]}
[0m12:00:54.236087 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:00:54.311652 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:00:54.416431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:54.416763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:54.421025 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m12:00:54.454333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b66075d1-663f-4cfe-9196-a33e13b47dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105134130>]}
[0m12:00:54.528621 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:00:54.531250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:00:54.572912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b66075d1-663f-4cfe-9196-a33e13b47dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105101160>]}
[0m12:00:54.573385 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m12:00:54.573675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b66075d1-663f-4cfe-9196-a33e13b47dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105134ca0>]}
[0m12:00:54.574593 [info ] [MainThread]: 
[0m12:00:54.574868 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:00:54.575069 [info ] [MainThread]: 
[0m12:00:54.575386 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:54.578529 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m12:00:54.613004 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:00:54.613553 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m12:00:54.613852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:54.633162 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m12:00:54.633470 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:00:54.633674 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:00:54.640439 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m12:00:54.641451 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m12:00:54.642014 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m12:00:54.646800 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:54.647121 [debug] [MainThread]: On master: BEGIN
[0m12:00:54.647335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:54.656497 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:00:54.656811 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:54.657114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:00:54.668100 [debug] [MainThread]: SQL status: SELECT 4 in 0.011 seconds
[0m12:00:54.669634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b66075d1-663f-4cfe-9196-a33e13b47dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0bee0>]}
[0m12:00:54.669975 [debug] [MainThread]: On master: ROLLBACK
[0m12:00:54.670501 [debug] [MainThread]: On master: Close
[0m12:00:54.672515 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m12:00:54.672883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m12:00:54.673155 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m12:00:54.680254 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m12:00:54.680922 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m12:00:54.681384 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m12:00:54.681933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:54.682151 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_customers' was properly closed.
[0m12:00:54.682569 [debug] [MainThread]: Command end result
[0m12:00:54.699529 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:00:54.700444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:00:54.704779 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m12:00:54.705010 [info ] [MainThread]: Compiled node 'stg_customers' is:
with source as (
    select * from "dbt_db"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        email,
        created_at
    from source
)

select * from staged
[0m12:00:54.706078 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 0.70127475, "process_in_blocks": "0", "process_kernel_time": 0.168359, "process_mem_max_rss": "121946112", "process_out_blocks": "0", "process_user_time": 1.383188}
[0m12:00:54.706338 [debug] [MainThread]: Command `dbt compile` succeeded at 12:00:54.706287 after 0.70 seconds
[0m12:00:54.706621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10364a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105136160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105101160>]}
[0m12:00:54.706875 [debug] [MainThread]: Flushing usage events
[0m12:00:56.740551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:49.154992 [error] [MainThread]: Encountered an error:

[0m12:07:49.183109 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
  File "/Users/user/Library/Python/3.9/lib/python/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/Library/Developer/CommandLineTools/Library/Frameworks/Python3.framework/Versions/3.9/lib/python3.9/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:07:49.187083 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 635.02356, "process_in_blocks": "0", "process_kernel_time": 0.167535, "process_mem_max_rss": "105840640", "process_out_blocks": "0", "process_user_time": 1.275535}
[0m12:07:49.187880 [debug] [MainThread]: Command `dbt docs serve` failed at 12:07:49.187748 after 635.02 seconds
[0m12:07:49.188527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110202730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dec2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dec490>]}
[0m12:07:49.189095 [debug] [MainThread]: Flushing usage events
[0m12:12:14.307143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c8460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c8280>]}


============================== 12:12:14.310282 | c6a2b776-960c-4e9a-bd27-6ddecfd25b41 ==============================
[0m12:12:14.310282 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:12:14.310710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:12:14.456622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2f910>]}
[0m12:12:14.502604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a00c40>]}
[0m12:12:14.503479 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:12:14.578496 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:12:14.683825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:14.684102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:14.688240 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m12:12:14.719268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107348130>]}
[0m12:12:14.788047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:12:14.791071 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:12:14.830652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107316490>]}
[0m12:12:14.831027 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m12:12:14.831249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c63e80>]}
[0m12:12:14.832335 [info ] [MainThread]: 
[0m12:12:14.832560 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:14.832760 [info ] [MainThread]: 
[0m12:12:14.833066 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:12:14.835936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db'
[0m12:12:14.870797 [debug] [ThreadPool]: Using postgres connection "list_dbt_db"
[0m12:12:14.871150 [debug] [ThreadPool]: On list_dbt_db: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db"} */

    select distinct nspname from pg_namespace
  
[0m12:12:14.871386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:14.905084 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m12:12:14.905986 [debug] [ThreadPool]: On list_dbt_db: Close
[0m12:12:14.906967 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_db, now list_dbt_db_public)
[0m12:12:14.911417 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:12:14.911722 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m12:12:14.911936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:14.921474 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m12:12:14.921819 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:12:14.922061 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:12:14.925483 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.003 seconds
[0m12:12:14.926530 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m12:12:14.927040 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m12:12:14.932281 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:14.932565 [debug] [MainThread]: On master: BEGIN
[0m12:12:14.932836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:14.940399 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:12:14.940788 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:14.941113 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:12:14.952591 [debug] [MainThread]: SQL status: SELECT 4 in 0.011 seconds
[0m12:12:14.954475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3250>]}
[0m12:12:14.954858 [debug] [MainThread]: On master: ROLLBACK
[0m12:12:14.959134 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:14.959401 [debug] [MainThread]: On master: BEGIN
[0m12:12:14.960107 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:12:14.960397 [debug] [MainThread]: On master: COMMIT
[0m12:12:14.960656 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:14.960894 [debug] [MainThread]: On master: COMMIT
[0m12:12:14.961351 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:12:14.961642 [debug] [MainThread]: On master: Close
[0m12:12:14.963791 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m12:12:14.964095 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_order_items
[0m12:12:14.964361 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_orders
[0m12:12:14.964975 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.stg_products
[0m12:12:14.964736 [info ] [Thread-1  ]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m12:12:14.965429 [info ] [Thread-2  ]: 2 of 7 START sql view model public.stg_order_items ............................. [RUN]
[0m12:12:14.965810 [info ] [Thread-3  ]: 3 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m12:12:14.966174 [info ] [Thread-4  ]: 4 of 7 START sql view model public.stg_products ................................ [RUN]
[0m12:12:14.966533 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m12:12:14.966889 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_order_items'
[0m12:12:14.967364 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_orders'
[0m12:12:14.967701 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_products'
[0m12:12:14.967972 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m12:12:14.968226 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_order_items
[0m12:12:14.968537 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_orders
[0m12:12:14.968797 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.stg_products
[0m12:12:14.975853 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m12:12:14.978470 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_order_items"
[0m12:12:14.980675 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_orders"
[0m12:12:14.982612 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_products"
[0m12:12:14.983208 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_order_items
[0m12:12:14.983461 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_orders
[0m12:12:15.008792 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m12:12:15.011702 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_orders"
[0m12:12:15.011932 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.stg_products
[0m12:12:15.012210 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_order_items"
[0m12:12:15.014825 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customers"
[0m12:12:15.017606 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_products"
[0m12:12:15.018251 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m12:12:15.018482 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: BEGIN
[0m12:12:15.018691 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:12:15.019022 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m12:12:15.019258 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: BEGIN
[0m12:12:15.019469 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:12:15.019778 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m12:12:15.020001 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: BEGIN
[0m12:12:15.020213 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:12:15.020511 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m12:12:15.020747 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: BEGIN
[0m12:12:15.020959 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:12:15.034373 [debug] [Thread-3  ]: SQL status: BEGIN in 0.016 seconds
[0m12:12:15.034768 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m12:12:15.035071 [debug] [Thread-2  ]: SQL status: BEGIN in 0.015 seconds
[0m12:12:15.035343 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */

  create view "dbt_db"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."orders"
),

staged as (
    select
        order_id,
        customer_id,
        order_date,
        status,
        created_at
    from source
)

select * from staged
  );
[0m12:12:15.035594 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m12:12:15.035871 [debug] [Thread-4  ]: SQL status: BEGIN in 0.015 seconds
[0m12:12:15.036116 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m12:12:15.036433 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m12:12:15.036670 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m12:12:15.036918 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */

  create view "dbt_db"."public"."stg_order_items__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."order_items"
),

staged as (
    select
        order_item_id,
        order_id,
        product_id,
        quantity,
        unit_price,
        created_at
    from source
)

select * from staged
  );
[0m12:12:15.037178 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */

  create view "dbt_db"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."customers"
),

staged as (
    select
        customer_id,
        name,
        email,
        created_at
    from source
)

select * from staged
  );
[0m12:12:15.037432 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */

  create view "dbt_db"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "dbt_db"."public"."products"
),

staged as (
    select
        product_id,
        name,
        price,
        category,
        created_at
    from source
)

select * from staged
  );
[0m12:12:15.040807 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.004 seconds
[0m12:12:15.046092 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m12:12:15.046396 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:12:15.046638 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:12:15.046894 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
alter table "dbt_db"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m12:12:15.047124 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:12:15.049608 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m12:12:15.052522 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m12:12:15.054947 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m12:12:15.055194 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:12:15.055413 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
alter table "dbt_db"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m12:12:15.055649 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
alter table "dbt_db"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m12:12:15.055880 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
alter table "dbt_db"."public"."stg_order_items" rename to "stg_order_items__dbt_backup"
[0m12:12:15.057942 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m12:12:15.058269 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
alter table "dbt_db"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m12:12:15.058667 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:12:15.058939 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:12:15.061074 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m12:12:15.061293 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:12:15.061521 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:12:15.063670 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m12:12:15.063918 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
alter table "dbt_db"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m12:12:15.065922 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m12:12:15.072477 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
alter table "dbt_db"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m12:12:15.076992 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m12:12:15.077291 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
alter table "dbt_db"."public"."stg_order_items__dbt_tmp" rename to "stg_order_items"
[0m12:12:15.077562 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m12:12:15.077808 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: COMMIT
[0m12:12:15.078364 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:12:15.079364 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m12:12:15.079611 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m12:12:15.079836 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: COMMIT
[0m12:12:15.080059 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:12:15.081066 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m12:12:15.081296 [debug] [Thread-3  ]: SQL status: COMMIT in 0.003 seconds
[0m12:12:15.081493 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:12:15.081688 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m12:12:15.081875 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m12:12:15.086788 [debug] [Thread-3  ]: Applying DROP to: "dbt_db"."public"."stg_orders__dbt_backup"
[0m12:12:15.088009 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m12:12:15.088265 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: COMMIT
[0m12:12:15.090042 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."stg_customers__dbt_backup"
[0m12:12:15.092873 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.stg_orders"
[0m12:12:15.093114 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m12:12:15.093613 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.stg_customers"
[0m12:12:15.093834 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_orders"} */
drop view if exists "dbt_db"."public"."stg_orders__dbt_backup" cascade
[0m12:12:15.094046 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: COMMIT
[0m12:12:15.094254 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customers"} */
drop view if exists "dbt_db"."public"."stg_customers__dbt_backup" cascade
[0m12:12:15.094463 [debug] [Thread-4  ]: SQL status: COMMIT in 0.001 seconds
[0m12:12:15.096210 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."stg_products__dbt_backup"
[0m12:12:15.096733 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.stg_products"
[0m12:12:15.096949 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_products"} */
drop view if exists "dbt_db"."public"."stg_products__dbt_backup" cascade
[0m12:12:15.097190 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m12:12:15.098819 [debug] [Thread-1  ]: On model.ecommerce_dbt.stg_customers: Close
[0m12:12:15.099089 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.004 seconds
[0m12:12:15.099322 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.002 seconds
[0m12:12:15.099539 [debug] [Thread-2  ]: SQL status: COMMIT in 0.005 seconds
[0m12:12:15.101132 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_orders: Close
[0m12:12:15.101900 [debug] [Thread-4  ]: On model.ecommerce_dbt.stg_products: Close
[0m12:12:15.103715 [debug] [Thread-2  ]: Applying DROP to: "dbt_db"."public"."stg_order_items__dbt_backup"
[0m12:12:15.104528 [debug] [Thread-2  ]: Using postgres connection "model.ecommerce_dbt.stg_order_items"
[0m12:12:15.104785 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_order_items"} */
drop view if exists "dbt_db"."public"."stg_order_items__dbt_backup" cascade
[0m12:12:15.105075 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107736c10>]}
[0m12:12:15.105322 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a0f70>]}
[0m12:12:15.105641 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782d250>]}
[0m12:12:15.106064 [info ] [Thread-1  ]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:12:15.106353 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.001 seconds
[0m12:12:15.106778 [info ] [Thread-3  ]: 3 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m12:12:15.107188 [info ] [Thread-4  ]: 4 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m12:12:15.107532 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m12:12:15.108360 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_order_items: Close
[0m12:12:15.108677 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_orders
[0m12:12:15.108969 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.stg_products
[0m12:12:15.109321 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_customers
[0m12:12:15.109660 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107736d90>]}
[0m12:12:15.110071 [info ] [Thread-1  ]: 5 of 7 START sql table model public.dim_customers .............................. [RUN]
[0m12:12:15.110326 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.dim_products
[0m12:12:15.110632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customers, now model.ecommerce_dbt.dim_customers)
[0m12:12:15.110952 [info ] [Thread-2  ]: 2 of 7 OK created sql view model public.stg_order_items ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m12:12:15.111458 [info ] [Thread-3  ]: 6 of 7 START sql table model public.dim_products ............................... [RUN]
[0m12:12:15.111837 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m12:12:15.112255 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_order_items
[0m12:12:15.112675 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_orders, now model.ecommerce_dbt.dim_products)
[0m12:12:15.115475 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m12:12:15.116117 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.dim_products
[0m12:12:15.116586 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_orders
[0m12:12:15.119027 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_products"
[0m12:12:15.119436 [info ] [Thread-4  ]: 7 of 7 START sql table model public.fact_orders ................................ [RUN]
[0m12:12:15.120033 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_products, now model.ecommerce_dbt.fact_orders)
[0m12:12:15.120277 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m12:12:15.122630 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m12:12:15.123058 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.dim_products
[0m12:12:15.129335 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m12:12:15.143723 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_customers"
[0m12:12:15.144896 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_products"
[0m12:12:15.145280 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m12:12:15.147980 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_orders"
[0m12:12:15.148427 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m12:12:15.148701 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m12:12:15.148961 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m12:12:15.149180 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_products: BEGIN
[0m12:12:15.149400 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: BEGIN
[0m12:12:15.149613 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: BEGIN
[0m12:12:15.149825 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:12:15.150033 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:12:15.150246 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:12:15.166569 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m12:12:15.166934 [debug] [Thread-3  ]: SQL status: BEGIN in 0.017 seconds
[0m12:12:15.167176 [debug] [Thread-4  ]: SQL status: BEGIN in 0.017 seconds
[0m12:12:15.167400 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m12:12:15.167627 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m12:12:15.167843 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m12:12:15.168073 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */

  
    

  create  table "dbt_db"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    with customers as (
    select * from "dbt_db"."public"."stg_customers"
)

select
    customer_id,
    name,
    email,
    created_at,
    current_timestamp as updated_at
from customers
  );
  
[0m12:12:15.168314 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */

  
    

  create  table "dbt_db"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    with products as (
    select * from "dbt_db"."public"."stg_products"
)

select
    product_id,
    name,
    price,
    category,
    created_at,
    current_timestamp as updated_at
from products
  );
  
[0m12:12:15.168560 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */

  
    

  create  table "dbt_db"."public"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select * from "dbt_db"."public"."stg_orders"
),

order_items as (
    select * from "dbt_db"."public"."stg_order_items"
),

order_with_items as (
    select
        o.order_id,
        o.customer_id,
        o.order_date,
        o.status,
        sum(oi.quantity * oi.unit_price) as total_amount,
        count(oi.order_item_id) as total_items
    from orders o
    left join order_items oi on o.order_id = oi.order_id
    group by 1, 2, 3, 4
)

select
    order_id,
    customer_id,
    order_date,
    status,
    total_amount,
    total_items,
    current_timestamp as updated_at
from order_with_items
  );
  
[0m12:12:15.173891 [debug] [Thread-1  ]: SQL status: SELECT 3 in 0.005 seconds
[0m12:12:15.179406 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m12:12:15.179703 [debug] [Thread-4  ]: SQL status: SELECT 3 in 0.011 seconds
[0m12:12:15.179950 [debug] [Thread-3  ]: SQL status: SELECT 4 in 0.011 seconds
[0m12:12:15.180203 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m12:12:15.182646 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m12:12:15.185287 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m12:12:15.185646 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
alter table "dbt_db"."public"."fact_orders" rename to "fact_orders__dbt_backup"
[0m12:12:15.185906 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
alter table "dbt_db"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m12:12:15.186164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:12:15.188496 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m12:12:15.189367 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:12:15.189609 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:12:15.189843 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
alter table "dbt_db"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m12:12:15.192008 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m12:12:15.194099 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m12:12:15.194369 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
alter table "dbt_db"."public"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m12:12:15.194630 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
alter table "dbt_db"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m12:12:15.195056 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:12:15.196138 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m12:12:15.196397 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m12:12:15.196606 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: COMMIT
[0m12:12:15.196834 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:12:15.197076 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:12:15.198078 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m12:12:15.198300 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m12:12:15.199227 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m12:12:15.199456 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m12:12:15.201247 [debug] [Thread-1  ]: Applying DROP to: "dbt_db"."public"."dim_customers__dbt_backup"
[0m12:12:15.201477 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m12:12:15.201699 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_products: COMMIT
[0m12:12:15.203312 [debug] [Thread-1  ]: Using postgres connection "model.ecommerce_dbt.dim_customers"
[0m12:12:15.203592 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: COMMIT
[0m12:12:15.203873 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_customers"} */
drop table if exists "dbt_db"."public"."dim_customers__dbt_backup" cascade
[0m12:12:15.204766 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m12:12:15.206812 [debug] [Thread-3  ]: Applying DROP to: "dbt_db"."public"."dim_products__dbt_backup"
[0m12:12:15.207091 [debug] [Thread-4  ]: SQL status: COMMIT in 0.003 seconds
[0m12:12:15.207317 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.003 seconds
[0m12:12:15.207827 [debug] [Thread-3  ]: Using postgres connection "model.ecommerce_dbt.dim_products"
[0m12:12:15.209604 [debug] [Thread-4  ]: Applying DROP to: "dbt_db"."public"."fact_orders__dbt_backup"
[0m12:12:15.210415 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_customers: Close
[0m12:12:15.210657 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_products"} */
drop table if exists "dbt_db"."public"."dim_products__dbt_backup" cascade
[0m12:12:15.211140 [debug] [Thread-4  ]: Using postgres connection "model.ecommerce_dbt.fact_orders"
[0m12:12:15.211545 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c5160>]}
[0m12:12:15.211809 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_orders"} */
drop table if exists "dbt_db"."public"."fact_orders__dbt_backup" cascade
[0m12:12:15.212283 [info ] [Thread-1  ]: 5 of 7 OK created sql table model public.dim_customers ......................... [[32mSELECT 3[0m in 0.10s]
[0m12:12:15.212644 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m12:12:15.213935 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.003 seconds
[0m12:12:15.214788 [debug] [Thread-3  ]: On model.ecommerce_dbt.dim_products: Close
[0m12:12:15.215026 [debug] [Thread-4  ]: SQL status: DROP TABLE in 0.003 seconds
[0m12:12:15.215395 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f5dc0>]}
[0m12:12:15.216212 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_orders: Close
[0m12:12:15.216991 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a2b776-960c-4e9a-bd27-6ddecfd25b41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e9eb0>]}
[0m12:12:15.216657 [info ] [Thread-3  ]: 6 of 7 OK created sql table model public.dim_products .......................... [[32mSELECT 4[0m in 0.10s]
[0m12:12:15.217547 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.dim_products
[0m12:12:15.217943 [info ] [Thread-4  ]: 7 of 7 OK created sql table model public.fact_orders ........................... [[32mSELECT 3[0m in 0.10s]
[0m12:12:15.218805 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m12:12:15.219603 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:15.219819 [debug] [MainThread]: On master: BEGIN
[0m12:12:15.220001 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:12:15.227450 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:12:15.227814 [debug] [MainThread]: On master: COMMIT
[0m12:12:15.228029 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:15.228260 [debug] [MainThread]: On master: COMMIT
[0m12:12:15.228743 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:12:15.228938 [debug] [MainThread]: On master: Close
[0m12:12:15.229235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:15.229473 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m12:12:15.229681 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_order_items' was properly closed.
[0m12:12:15.229904 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_products' was properly closed.
[0m12:12:15.230092 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m12:12:15.230732 [info ] [MainThread]: 
[0m12:12:15.231051 [info ] [MainThread]: Finished running 3 table models, 4 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:12:15.232028 [debug] [MainThread]: Command end result
[0m12:12:15.250812 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:12:15.252685 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:12:15.257236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m12:12:15.257480 [info ] [MainThread]: 
[0m12:12:15.257729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:15.257928 [info ] [MainThread]: 
[0m12:12:15.258138 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:12:15.259651 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0053678, "process_in_blocks": "0", "process_kernel_time": 0.203152, "process_mem_max_rss": "123715584", "process_out_blocks": "0", "process_user_time": 1.629651}
[0m12:12:15.259927 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:15.259874 after 1.01 seconds
[0m12:12:15.260204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a2f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10734f0d0>]}
[0m12:12:15.260466 [debug] [MainThread]: Flushing usage events
[0m12:12:16.476544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:17.824280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11158a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253af40>]}


============================== 12:12:17.827409 | 19f7aa7a-cbe9-4651-9047-4ee5b6abb51d ==============================
[0m12:12:17.827409 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:12:17.827835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/user/.dbt', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:18.075643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19f7aa7a-cbe9-4651-9047-4ee5b6abb51d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112824250>]}
[0m12:12:18.154783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19f7aa7a-cbe9-4651-9047-4ee5b6abb51d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112512040>]}
[0m12:12:18.155577 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:12:18.266719 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:12:18.376765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:18.377110 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:18.383116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m12:12:18.424108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19f7aa7a-cbe9-4651-9047-4ee5b6abb51d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11327e130>]}
[0m12:12:18.509304 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:12:18.512287 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:12:18.559989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19f7aa7a-cbe9-4651-9047-4ee5b6abb51d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286df70>]}
[0m12:12:18.560406 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m12:12:18.560643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19f7aa7a-cbe9-4651-9047-4ee5b6abb51d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112373d90>]}
[0m12:12:18.562006 [info ] [MainThread]: 
[0m12:12:18.562280 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:18.562488 [info ] [MainThread]: 
[0m12:12:18.562811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:12:18.566226 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m12:12:18.596222 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:12:18.596526 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m12:12:18.596716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:18.617187 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m12:12:18.617483 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:12:18.617695 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:12:18.623022 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.005 seconds
[0m12:12:18.623998 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m12:12:18.624492 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m12:12:18.628868 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:18.629133 [debug] [MainThread]: On master: BEGIN
[0m12:12:18.629314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:18.638183 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:12:18.638490 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:18.638742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:12:18.648963 [debug] [MainThread]: SQL status: SELECT 4 in 0.010 seconds
[0m12:12:18.650486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19f7aa7a-cbe9-4651-9047-4ee5b6abb51d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0dcd0>]}
[0m12:12:18.650853 [debug] [MainThread]: On master: ROLLBACK
[0m12:12:18.651410 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:18.651636 [debug] [MainThread]: On master: BEGIN
[0m12:12:18.652417 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:12:18.652687 [debug] [MainThread]: On master: COMMIT
[0m12:12:18.652921 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:18.653138 [debug] [MainThread]: On master: COMMIT
[0m12:12:18.653632 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:12:18.653914 [debug] [MainThread]: On master: Close
[0m12:12:18.655592 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:12:18.655905 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:12:18.656171 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:12:18.656711 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:12:18.656456 [info ] [Thread-1  ]: 1 of 12 START test source_not_null_ecommerce_raw_customers_customer_id ......... [RUN]
[0m12:12:18.657078 [info ] [Thread-2  ]: 2 of 12 START test source_not_null_ecommerce_raw_order_items_order_item_id ..... [RUN]
[0m12:12:18.657370 [info ] [Thread-3  ]: 3 of 12 START test source_not_null_ecommerce_raw_orders_order_id ............... [RUN]
[0m12:12:18.657680 [info ] [Thread-4  ]: 4 of 12 START test source_not_null_ecommerce_raw_products_product_id ........... [RUN]
[0m12:12:18.658028 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m12:12:18.658375 [debug] [Thread-2  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0'
[0m12:12:18.658701 [debug] [Thread-3  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf'
[0m12:12:18.659027 [debug] [Thread-4  ]: Acquiring new postgres connection 'test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea'
[0m12:12:18.659291 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:12:18.659542 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:12:18.659788 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:12:18.660030 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:12:18.672907 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:12:18.676285 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:12:18.679828 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:12:18.682674 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:12:18.684483 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:12:18.694600 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:12:18.694929 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:12:18.695188 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:12:18.695409 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:12:18.697668 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:12:18.699412 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:12:18.701104 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:12:18.701429 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:12:18.701785 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: BEGIN
[0m12:12:18.702067 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:12:18.702328 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:12:18.702667 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: BEGIN
[0m12:12:18.702929 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:12:18.703215 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:12:18.703444 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m12:12:18.703693 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: BEGIN
[0m12:12:18.703940 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: BEGIN
[0m12:12:18.704233 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m12:12:18.704452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:12:18.719944 [debug] [Thread-3  ]: SQL status: BEGIN in 0.018 seconds
[0m12:12:18.720314 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m12:12:18.720584 [debug] [Thread-2  ]: SQL status: BEGIN in 0.017 seconds
[0m12:12:18.720839 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:12:18.721071 [debug] [Thread-4  ]: SQL status: BEGIN in 0.017 seconds
[0m12:12:18.721318 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:12:18.721556 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:12:18.721812 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "dbt_db"."public"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m12:12:18.722063 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:12:18.722309 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "dbt_db"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m12:12:18.722569 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_item_id
from "dbt_db"."public"."order_items"
where order_item_id is null



      
    ) dbt_internal_test
[0m12:12:18.722877 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from "dbt_db"."public"."products"
where product_id is null



      
    ) dbt_internal_test
[0m12:12:18.724258 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:12:18.724564 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.001 seconds
[0m12:12:18.724826 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:12:18.727846 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: ROLLBACK
[0m12:12:18.728124 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.005 seconds
[0m12:12:18.729010 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: ROLLBACK
[0m12:12:18.729839 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: ROLLBACK
[0m12:12:18.730727 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: ROLLBACK
[0m12:12:18.731006 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea: Close
[0m12:12:18.731274 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0: Close
[0m12:12:18.731730 [info ] [Thread-4  ]: 4 of 12 PASS source_not_null_ecommerce_raw_products_product_id ................. [[32mPASS[0m in 0.07s]
[0m12:12:18.731987 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2: Close
[0m12:12:18.732362 [info ] [Thread-2  ]: 2 of 12 PASS source_not_null_ecommerce_raw_order_items_order_item_id ........... [[32mPASS[0m in 0.07s]
[0m12:12:18.732610 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf: Close
[0m12:12:18.733101 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:12:18.733511 [info ] [Thread-1  ]: 1 of 12 PASS source_not_null_ecommerce_raw_customers_customer_id ............... [[32mPASS[0m in 0.08s]
[0m12:12:18.733858 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:12:18.734199 [info ] [Thread-3  ]: 3 of 12 PASS source_not_null_ecommerce_raw_orders_order_id ..................... [[32mPASS[0m in 0.08s]
[0m12:12:18.734511 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:12:18.734894 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:12:18.735175 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:12:18.735560 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:12:18.735826 [info ] [Thread-4  ]: 5 of 12 START test source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [RUN]
[0m12:12:18.736101 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:12:18.736343 [info ] [Thread-2  ]: 6 of 12 START test source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [RUN]
[0m12:12:18.736607 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:12:18.737098 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m12:12:18.737377 [info ] [Thread-1  ]: 7 of 12 START test source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [RUN]
[0m12:12:18.737781 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m12:12:18.738048 [info ] [Thread-3  ]: 8 of 12 START test source_unique_ecommerce_raw_customers_customer_id ........... [RUN]
[0m12:12:18.738303 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:12:18.738588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m12:12:18.738885 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:12:18.739343 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m12:12:18.746431 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:12:18.746724 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:12:18.750503 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:12:18.750775 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:12:18.754878 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:12:18.759270 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:12:18.759596 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:12:18.759939 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:12:18.761746 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:12:18.763560 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:12:18.763822 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:12:18.764058 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:12:18.765996 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:12:18.768466 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:12:18.768868 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:12:18.769131 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:12:18.769446 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: BEGIN
[0m12:12:18.769713 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:12:18.769965 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: BEGIN
[0m12:12:18.770226 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:12:18.770466 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:12:18.770688 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: BEGIN
[0m12:12:18.770921 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:12:18.771215 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: BEGIN
[0m12:12:18.771442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:12:18.771747 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:12:18.787122 [debug] [Thread-4  ]: SQL status: BEGIN in 0.016 seconds
[0m12:12:18.787533 [debug] [Thread-1  ]: SQL status: BEGIN in 0.016 seconds
[0m12:12:18.787791 [debug] [Thread-2  ]: SQL status: BEGIN in 0.018 seconds
[0m12:12:18.788026 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:12:18.788244 [debug] [Thread-3  ]: SQL status: BEGIN in 0.016 seconds
[0m12:12:18.788482 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:12:18.788736 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:12:18.789003 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select order_id as from_field
    from "dbt_db"."public"."order_items"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "dbt_db"."public"."orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:12:18.789263 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:12:18.789531 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "dbt_db"."public"."orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dbt_db"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:12:18.789817 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select product_id as from_field
    from "dbt_db"."public"."order_items"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "dbt_db"."public"."products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:12:18.790154 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:12:18.792152 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:12:18.792495 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:12:18.792754 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.002 seconds
[0m12:12:18.792991 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.003 seconds
[0m12:12:18.794001 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: ROLLBACK
[0m12:12:18.794812 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: ROLLBACK
[0m12:12:18.795583 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: ROLLBACK
[0m12:12:18.796348 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: ROLLBACK
[0m12:12:18.796939 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5: Close
[0m12:12:18.797200 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf: Close
[0m12:12:18.797471 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665: Close
[0m12:12:18.797961 [info ] [Thread-1  ]: 7 of 12 PASS source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_  [[32mPASS[0m in 0.06s]
[0m12:12:18.798359 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:12:18.798893 [info ] [Thread-4  ]: 5 of 12 PASS source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_  [[32mPASS[0m in 0.06s]
[0m12:12:18.799214 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:12:18.799435 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c: Close
[0m12:12:18.799850 [info ] [Thread-3  ]: 8 of 12 PASS source_unique_ecommerce_raw_customers_customer_id ................. [[32mPASS[0m in 0.06s]
[0m12:12:18.800194 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:12:18.800459 [info ] [Thread-1  ]: 9 of 12 START test source_unique_ecommerce_raw_customers_email ................. [RUN]
[0m12:12:18.800817 [info ] [Thread-2  ]: 6 of 12 PASS source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_  [[32mPASS[0m in 0.06s]
[0m12:12:18.801146 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:12:18.801388 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:12:18.801741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m12:12:18.802123 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:12:18.802382 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:12:18.802650 [info ] [Thread-4  ]: 10 of 12 START test source_unique_ecommerce_raw_order_items_order_item_id ...... [RUN]
[0m12:12:18.802909 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:12:18.803334 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:12:18.803578 [info ] [Thread-3  ]: 11 of 12 START test source_unique_ecommerce_raw_orders_order_id ................ [RUN]
[0m12:12:18.803859 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m12:12:18.807281 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:12:18.807672 [info ] [Thread-2  ]: 12 of 12 START test source_unique_ecommerce_raw_products_product_id ............ [RUN]
[0m12:12:18.808098 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m12:12:18.808778 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:12:18.809184 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m12:12:18.809519 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:12:18.812586 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:12:18.812868 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:12:18.815614 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:12:18.815958 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:12:18.818710 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:12:18.820795 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:12:18.821138 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:12:18.823161 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:12:18.823460 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:12:18.825884 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:12:18.826357 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:12:18.826661 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:12:18.826891 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:12:18.827130 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: BEGIN
[0m12:12:18.827393 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: BEGIN
[0m12:12:18.827657 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:12:18.829377 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:12:18.829612 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:12:18.829848 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m12:12:18.830077 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: BEGIN
[0m12:12:18.830523 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m12:12:18.830779 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:12:18.831069 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: BEGIN
[0m12:12:18.831296 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m12:12:18.915558 [debug] [Thread-4  ]: SQL status: BEGIN in 0.085 seconds
[0m12:12:18.916246 [debug] [Thread-4  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:12:18.916906 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_item_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."order_items"
where order_item_id is not null
group by order_item_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:12:18.934289 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.013 seconds
[0m12:12:18.934997 [debug] [Thread-3  ]: SQL status: BEGIN in 0.104 seconds
[0m12:12:18.935291 [debug] [Thread-2  ]: SQL status: BEGIN in 0.104 seconds
[0m12:12:18.935528 [debug] [Thread-1  ]: SQL status: BEGIN in 0.106 seconds
[0m12:12:18.936650 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: ROLLBACK
[0m12:12:18.937004 [debug] [Thread-3  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:12:18.937407 [debug] [Thread-2  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:12:18.937711 [debug] [Thread-1  ]: Using postgres connection "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:12:18.938351 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:12:18.939368 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dbt_db"."public"."products"
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:12:18.939846 [debug] [Thread-4  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559: Close
[0m12:12:18.940115 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    email as unique_field,
    count(*) as n_records

from "dbt_db"."public"."customers"
where email is not null
group by email
having count(*) > 1



      
    ) dbt_internal_test
[0m12:12:18.941063 [info ] [Thread-4  ]: 10 of 12 PASS source_unique_ecommerce_raw_order_items_order_item_id ............ [[32mPASS[0m in 0.14s]
[0m12:12:18.943232 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:12:18.943930 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.003 seconds
[0m12:12:18.944992 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: ROLLBACK
[0m12:12:18.945747 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.005 seconds
[0m12:12:18.946182 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.004 seconds
[0m12:12:18.947266 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: ROLLBACK
[0m12:12:18.947620 [debug] [Thread-2  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9: Close
[0m12:12:18.949118 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: ROLLBACK
[0m12:12:18.949832 [info ] [Thread-2  ]: 12 of 12 PASS source_unique_ecommerce_raw_products_product_id .................. [[32mPASS[0m in 0.14s]
[0m12:12:18.951403 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:12:18.952114 [debug] [Thread-3  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65: Close
[0m12:12:18.952613 [info ] [Thread-3  ]: 11 of 12 PASS source_unique_ecommerce_raw_orders_order_id ...................... [[32mPASS[0m in 0.14s]
[0m12:12:18.953503 [debug] [Thread-1  ]: On test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548: Close
[0m12:12:18.954613 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:12:18.956764 [info ] [Thread-1  ]: 9 of 12 PASS source_unique_ecommerce_raw_customers_email ....................... [[32mPASS[0m in 0.15s]
[0m12:12:18.957345 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:12:18.959569 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:18.959896 [debug] [MainThread]: On master: BEGIN
[0m12:12:18.960151 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:12:18.974007 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:12:18.974593 [debug] [MainThread]: On master: COMMIT
[0m12:12:18.975026 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:18.975250 [debug] [MainThread]: On master: COMMIT
[0m12:12:18.976072 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:12:18.976333 [debug] [MainThread]: On master: Close
[0m12:12:18.976746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:18.977299 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548' was properly closed.
[0m12:12:18.977905 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9' was properly closed.
[0m12:12:18.978171 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65' was properly closed.
[0m12:12:18.978489 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559' was properly closed.
[0m12:12:18.978943 [info ] [MainThread]: 
[0m12:12:18.979260 [info ] [MainThread]: Finished running 12 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m12:12:18.982042 [debug] [MainThread]: Command end result
[0m12:12:19.038971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:12:19.041258 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:12:19.049407 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m12:12:19.049861 [info ] [MainThread]: 
[0m12:12:19.050326 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:19.050610 [info ] [MainThread]: 
[0m12:12:19.050878 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m12:12:19.052645 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.286992, "process_in_blocks": "0", "process_kernel_time": 0.220088, "process_mem_max_rss": "125222912", "process_out_blocks": "0", "process_user_time": 1.847767}
[0m12:12:19.053039 [debug] [MainThread]: Command `dbt test` succeeded at 12:12:19.052961 after 1.29 seconds
[0m12:12:19.053346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11158a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fae3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f93550>]}
[0m12:12:19.053665 [debug] [MainThread]: Flushing usage events
[0m12:12:20.001221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:21.195744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706a130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706adc0>]}


============================== 12:12:21.198562 | 2e1062c2-6a00-4de7-a8e4-2b326c28dfeb ==============================
[0m12:12:21.198562 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:12:21.198941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/user/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:21.322686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e1062c2-6a00-4de7-a8e4-2b326c28dfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e4b50>]}
[0m12:12:21.375755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e1062c2-6a00-4de7-a8e4-2b326c28dfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740fb50>]}
[0m12:12:21.376514 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:12:21.450219 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:12:21.543914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:12:21.544221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:12:21.548460 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_dbt.sources
[0m12:12:21.580646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e1062c2-6a00-4de7-a8e4-2b326c28dfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dea130>]}
[0m12:12:21.590317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e1062c2-6a00-4de7-a8e4-2b326c28dfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1aee0>]}
[0m12:12:21.590686 [info ] [MainThread]: Found 7 models, 12 data tests, 4 sources, 433 macros
[0m12:12:21.590916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e1062c2-6a00-4de7-a8e4-2b326c28dfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1aeb0>]}
[0m12:12:21.592285 [info ] [MainThread]: 
[0m12:12:21.592838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:21.593144 [info ] [MainThread]: 
[0m12:12:21.593682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:12:21.597282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_db_public'
[0m12:12:21.656532 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:12:21.656850 [debug] [ThreadPool]: On list_dbt_db_public: BEGIN
[0m12:12:21.657038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:21.676063 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m12:12:21.676409 [debug] [ThreadPool]: Using postgres connection "list_dbt_db_public"
[0m12:12:21.676632 [debug] [ThreadPool]: On list_dbt_db_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "list_dbt_db_public"} */
select
      'dbt_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'dbt_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:12:21.682360 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.006 seconds
[0m12:12:21.684197 [debug] [ThreadPool]: On list_dbt_db_public: ROLLBACK
[0m12:12:21.685100 [debug] [ThreadPool]: On list_dbt_db_public: Close
[0m12:12:21.690534 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:21.690832 [debug] [MainThread]: On master: BEGIN
[0m12:12:21.691036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:21.700460 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:12:21.700795 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:21.701081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:12:21.712837 [debug] [MainThread]: SQL status: SELECT 4 in 0.011 seconds
[0m12:12:21.714380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e1062c2-6a00-4de7-a8e4-2b326c28dfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c1700>]}
[0m12:12:21.714714 [debug] [MainThread]: On master: ROLLBACK
[0m12:12:21.715254 [debug] [MainThread]: On master: Close
[0m12:12:21.717038 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.stg_customers
[0m12:12:21.717363 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_order_items
[0m12:12:21.717638 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_orders
[0m12:12:21.717957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_dbt_db_public, now model.ecommerce_dbt.stg_customers)
[0m12:12:21.718236 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.stg_products
[0m12:12:21.718869 [debug] [Thread-2  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_order_items'
[0m12:12:21.719267 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_orders'
[0m12:12:21.719584 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.stg_customers
[0m12:12:21.719970 [debug] [Thread-4  ]: Acquiring new postgres connection 'model.ecommerce_dbt.stg_products'
[0m12:12:21.720244 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_order_items
[0m12:12:21.720522 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_orders
[0m12:12:21.727947 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customers"
[0m12:12:21.728265 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.stg_products
[0m12:12:21.730551 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_order_items"
[0m12:12:21.732639 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_orders"
[0m12:12:21.734773 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_products"
[0m12:12:21.735281 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_order_items
[0m12:12:21.735540 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.stg_customers
[0m12:12:21.735986 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_order_items
[0m12:12:21.736264 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_orders
[0m12:12:21.736651 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.stg_customers
[0m12:12:21.736858 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.stg_products
[0m12:12:21.737110 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:12:21.737542 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_orders
[0m12:12:21.737789 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:12:21.738200 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.stg_products
[0m12:12:21.738488 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_order_items, now test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2)
[0m12:12:21.738739 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:12:21.739013 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customers, now test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0)
[0m12:12:21.739385 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:12:21.739805 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:12:21.740137 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_orders, now test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf)
[0m12:12:21.740400 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:12:21.740662 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_products, now test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea)
[0m12:12:21.748988 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2"
[0m12:12:21.749296 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:12:21.752129 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0"
[0m12:12:21.752744 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:12:21.756139 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf"
[0m12:12:21.760081 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea"
[0m12:12:21.760504 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:12:21.760943 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0
[0m12:12:21.761185 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:12:21.761467 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_order_items_order_item_id.78d281ded0, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5)
[0m12:12:21.761721 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:12:21.768650 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5"
[0m12:12:21.769276 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:12:21.769517 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:12:21.769743 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:12:21.769963 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:12:21.770395 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2
[0m12:12:21.770780 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5
[0m12:12:21.771146 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf
[0m12:12:21.771506 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea
[0m12:12:21.771745 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:12:21.772012 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:12:21.772338 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:12:21.772609 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:12:21.772892 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_customers_customer_id.01284a76f2, now test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c)
[0m12:12:21.773142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_order_id__order_id__source_ecommerce_raw_orders_.ffc8d2fee5, now test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf)
[0m12:12:21.773393 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_orders_order_id.eafb3f97bf, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665)
[0m12:12:21.773642 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_not_null_ecommerce_raw_products_product_id.b4d7655eea, now test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548)
[0m12:12:21.773872 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:12:21.774093 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:12:21.774307 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:12:21.774516 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:12:21.778341 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c"
[0m12:12:21.782179 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf"
[0m12:12:21.786642 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665"
[0m12:12:21.789717 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548"
[0m12:12:21.790443 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:12:21.790723 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:12:21.791165 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c
[0m12:12:21.791613 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf
[0m12:12:21.791828 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:12:21.792043 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:12:21.792297 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:12:21.792787 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:12:21.793715 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665
[0m12:12:21.794219 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548
[0m12:12:21.794484 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_order_items_product_id__product_id__source_ecommerce_raw_products_.f74535835c, now test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559)
[0m12:12:21.794761 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_relationships_ecommerce_raw_orders_customer_id__customer_id__source_ecommerce_raw_customers_.c0edf53bdf, now test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65)
[0m12:12:21.795041 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:12:21.795318 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.dim_customers
[0m12:12:21.795573 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:12:21.795798 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:12:21.796043 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_customer_id.efd9e75665, now test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9)
[0m12:12:21.796290 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_customers_email.10ef1ae548, now model.ecommerce_dbt.dim_customers)
[0m12:12:21.799291 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559"
[0m12:12:21.802877 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65"
[0m12:12:21.803158 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:12:21.803400 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.dim_customers
[0m12:12:21.806443 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9"
[0m12:12:21.808751 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_customers"
[0m12:12:21.809209 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:12:21.809663 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65
[0m12:12:21.809908 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.fact_orders
[0m12:12:21.810146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_orders_order_id.4e8cd80e65, now model.ecommerce_dbt.fact_orders)
[0m12:12:21.810359 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.fact_orders
[0m12:12:21.812365 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_orders"
[0m12:12:21.812758 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:12:21.812976 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.dim_customers
[0m12:12:21.813202 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:12:21.813425 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.fact_orders
[0m12:12:21.813808 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559
[0m12:12:21.814181 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.dim_customers
[0m12:12:21.814545 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9
[0m12:12:21.814996 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.fact_orders
[0m12:12:21.815232 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.dim_products
[0m12:12:21.815717 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.source_unique_ecommerce_raw_order_items_order_item_id.c116d70559, now model.ecommerce_dbt.dim_products)
[0m12:12:21.815983 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.dim_products
[0m12:12:21.817916 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_products"
[0m12:12:21.818496 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.dim_products
[0m12:12:21.818903 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.dim_products
[0m12:12:21.819836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:21.820108 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_orders' was properly closed.
[0m12:12:21.820302 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_products' was properly closed.
[0m12:12:21.820526 [debug] [MainThread]: Connection 'test.ecommerce_dbt.source_unique_ecommerce_raw_products_product_id.36ccdfb8c9' was properly closed.
[0m12:12:21.820704 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_customers' was properly closed.
[0m12:12:21.822331 [debug] [MainThread]: Command end result
[0m12:12:21.890318 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:12:21.892635 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:12:21.897449 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/run_results.json
[0m12:12:21.899366 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:12:21.899627 [info ] [MainThread]: Building catalog
[0m12:12:21.907440 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt_db.information_schema'
[0m12:12:21.913005 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m12:12:21.913294 [debug] [ThreadPool]: On dbt_db.information_schema: BEGIN
[0m12:12:21.913490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:21.925488 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:12:21.925810 [debug] [ThreadPool]: Using postgres connection "dbt_db.information_schema"
[0m12:12:21.926144 [debug] [ThreadPool]: On dbt_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "dbt_db.information_schema"} */

    
    

    select
        'dbt_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fact_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_items')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:12:21.932974 [debug] [ThreadPool]: SQL status: SELECT 58 in 0.006 seconds
[0m12:12:21.938889 [debug] [ThreadPool]: On dbt_db.information_schema: ROLLBACK
[0m12:12:21.939752 [debug] [ThreadPool]: On dbt_db.information_schema: Close
[0m12:12:21.950419 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/catalog.json
[0m12:12:21.971000 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/manifest.json
[0m12:12:21.972424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/semantic_manifest.json
[0m12:12:21.972660 [info ] [MainThread]: Catalog written to /Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/target/catalog.json
[0m12:12:21.973759 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.83226717, "process_in_blocks": "0", "process_kernel_time": 0.162897, "process_mem_max_rss": "123633664", "process_out_blocks": "0", "process_user_time": 1.531518}
[0m12:12:21.974073 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:12:21.974017 after 0.83 seconds
[0m12:12:21.974278 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:12:21.974443 [debug] [MainThread]: Connection 'dbt_db.information_schema' was properly closed.
[0m12:12:21.974641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dfd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ebe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1af70>]}
[0m12:12:21.974939 [debug] [MainThread]: Flushing usage events
[0m12:12:22.955389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:24.288470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114417f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eaa280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112eaa0a0>]}


============================== 12:12:24.291105 | 18459fc2-a3eb-4961-85c1-f68c8bdc12a0 ==============================
[0m12:12:24.291105 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:12:24.291493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/user/Desktop/Data-Engineering/Day12/Ex1/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/user/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:24.413863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18459fc2-a3eb-4961-85c1-f68c8bdc12a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107911550>]}
[0m12:12:24.460781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18459fc2-a3eb-4961-85c1-f68c8bdc12a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113230370>]}
